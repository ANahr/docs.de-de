---
title: "Herausforderungen und Lösungen für die Verwaltung von verteilten Daten"
description: ".NET Microservices Architektur für Datenvolumes .NET-Anwendungen | Herausforderungen und Lösungen für die Verwaltung von verteilten Daten"
keywords: Docker, Microservices, ASP.NET, Container
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 05/26/2017
ms.prod: .net-core
ms.technology: dotnet-docker
ms.topic: article
ms.openlocfilehash: f961475b40c74bf448cff1aeae04ae4866360e52
ms.sourcegitcommit: c2e216692ef7576a213ae16af2377cd98d1a67fa
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 10/22/2017
---
# <a name="challenges-and-solutions-for-distributed-data-management"></a><span data-ttu-id="ac147-104">Herausforderungen und Lösungen für die Verwaltung von verteilten Daten</span><span class="sxs-lookup"><span data-stu-id="ac147-104">Challenges and solutions for distributed data management</span></span>

## <a name="challenge-1-how-to-define-the-boundaries-of-each-microservice"></a><span data-ttu-id="ac147-105">Herausforderung \#1: Gewusst wie: Definieren der Grenzen von jeder Microservice</span><span class="sxs-lookup"><span data-stu-id="ac147-105">Challenge \#1: How to define the boundaries of each microservice</span></span>

<span data-ttu-id="ac147-106">Definieren von Grenzen Microservice ist wahrscheinlich die erste Abfrage angeboten, die jeder Benutzer auftritt.</span><span class="sxs-lookup"><span data-stu-id="ac147-106">Defining microservice boundaries is probably the first challenge anyone encounters.</span></span> <span data-ttu-id="ac147-107">Jede Microservice muss ein Teil der Anwendung und jeder Microservice sollte autonome mit alle vor- und Nachteile, die es vermittelt.</span><span class="sxs-lookup"><span data-stu-id="ac147-107">Each microservice has to be a piece of your application and each microservice should be autonomous with all the benefits and challenges that it conveys.</span></span> <span data-ttu-id="ac147-108">Aber wie erkennen Sie diese Grenzen?</span><span class="sxs-lookup"><span data-stu-id="ac147-108">But how do you identify those boundaries?</span></span>

<span data-ttu-id="ac147-109">Zunächst müssen Sie auf der Anwendungsverzeichnis logischen Domänenmodelle und zugehörige Daten konzentrieren.</span><span class="sxs-lookup"><span data-stu-id="ac147-109">First, you need to focus on the application’s logical domain models and related data.</span></span> <span data-ttu-id="ac147-110">Sie müssen versuchen entkoppelte Inseln von Daten und unterschiedlichen Kontexten innerhalb derselben Anwendung zu identifizieren.</span><span class="sxs-lookup"><span data-stu-id="ac147-110">You must try to identify decoupled islands of data and different contexts within the same application.</span></span> <span data-ttu-id="ac147-111">Jeder Kontext möglicherweise eine andere Business-Sprache (unterschiedliche geschäftsbegriffe).</span><span class="sxs-lookup"><span data-stu-id="ac147-111">Each context could have a different business language (different business terms).</span></span> <span data-ttu-id="ac147-112">Die Kontexte sollten definiert und unabhängig verwaltet werden.</span><span class="sxs-lookup"><span data-stu-id="ac147-112">The contexts should be defined and managed independently.</span></span> <span data-ttu-id="ac147-113">Die Begriffe und Entitäten, die in diesen unterschiedlichen Kontexten verwendet möglicherweise ähnlich klingen, aber Sie möglicherweise heraus, dass in einem bestimmten Kontext ein Geschäftskonzept mit einem für einen anderen Zweck in einem anderen Kontext verwendet wird, und möglicherweise auch einen anderen Namen.</span><span class="sxs-lookup"><span data-stu-id="ac147-113">The terms and entities used in those different contexts might sound similar, but you might discover that in a particular context, a business concept with one is used for a different purpose in another context, and might even have a different name.</span></span> <span data-ttu-id="ac147-114">Z. B. ein Benutzer kann als ein Benutzer im Kontext Identität oder die Mitgliedschaft verwiesen werden, als ein Kunde in einem Kontext CRM als Käufer in einem Kontext Reihenfolge usw.</span><span class="sxs-lookup"><span data-stu-id="ac147-114">For instance, a user can be referred as a user in the identity or membership context, as a customer in a CRM context, as a buyer in an ordering context, and so forth.</span></span>

<span data-ttu-id="ac147-115">Die Möglichkeit, die Grenzen zwischen mehreren Anwendungskontexten mit einer anderen Domäne zu identifizieren, für jeden Kontext genau ist, wie Sie die Grenzen für jedes Unternehmen Microservice und die zugehörigen identifizieren können Domänenmodell und Daten.</span><span class="sxs-lookup"><span data-stu-id="ac147-115">The way you identify boundaries between multiple application contexts with a different domain for each context is exactly how you can identify the boundaries for each business microservice and its related domain model and data.</span></span> <span data-ttu-id="ac147-116">Sie versuchen immer die Kopplung zwischen diesen Microservices zu minimieren.</span><span class="sxs-lookup"><span data-stu-id="ac147-116">You always attempt to minimize the coupling between those microservices.</span></span> <span data-ttu-id="ac147-117">Dieses Handbuch wird ausführlicher Informationen zu dieser Kennung und Domäne Modellentwurfs im Abschnitt [identifizieren Domänenmodell Grenzen für jeden Microservice](#identifying-domain-model-boundaries-for-each-microservice) später.</span><span class="sxs-lookup"><span data-stu-id="ac147-117">This guide goes into more detail about this identification and domain model design in the section [Identifying domain-model boundaries for each microservice](#identifying-domain-model-boundaries-for-each-microservice) later.</span></span>

## <a name="challenge-2-how-to-create-queries-that-retrieve-data-from-several-microservices"></a><span data-ttu-id="ac147-118">Herausforderung \#2: Erstellen von Abfragen, die Daten aus mehreren Microservices abrufen</span><span class="sxs-lookup"><span data-stu-id="ac147-118">Challenge \#2: How to create queries that retrieve data from several microservices</span></span>

<span data-ttu-id="ac147-119">Eine zweite Abfrage wird erklärt, wie Abfragen zu implementieren, die Abrufen von Daten aus mehreren Microservices ' geschwätzige ' Kommunikation von remote-Client-apps, die Microservices zu vermeiden.</span><span class="sxs-lookup"><span data-stu-id="ac147-119">A second challenge is how to implement queries that retrieve data from several microservices, while avoiding chatty communication to the microservices from remote client apps.</span></span> <span data-ttu-id="ac147-120">Ein Beispiel ist möglicherweise einer einzigen Seite aus einer mobilen app, die benötigt werden, um Benutzerinformationen anzuzeigen, die die Warenkorb-Katalog und Benutzer Identität Microservices gehört.</span><span class="sxs-lookup"><span data-stu-id="ac147-120">An example could be a single screen from a mobile app that needs to show user information that is owned by the basket, catalog, and user identity microservices.</span></span> <span data-ttu-id="ac147-121">Ein weiteres Beispiel wäre eine komplexe Bericht im Zusammenhang mit vielen Tabellen in mehreren Microservices.</span><span class="sxs-lookup"><span data-stu-id="ac147-121">Another example would be a complex report involving many tables located in multiple microservices.</span></span> <span data-ttu-id="ac147-122">Die richtige Lösung hängt von der Komplexität der Abfragen ab.</span><span class="sxs-lookup"><span data-stu-id="ac147-122">The right solution depends on the complexity of the queries.</span></span> <span data-ttu-id="ac147-123">Jedoch in jedem Fall benötigen Sie eine Möglichkeit, aggregierte Informationen gegebenenfalls verbessern die Effizienz der Kommunikation des Systems.</span><span class="sxs-lookup"><span data-stu-id="ac147-123">But in any case, you will need a way to aggregate information if you want to improve the efficiency in the communications of your system.</span></span> <span data-ttu-id="ac147-124">Die am häufigsten verwendeten Lösungen sind die folgenden.</span><span class="sxs-lookup"><span data-stu-id="ac147-124">The most popular solutions are the following.</span></span>

<span data-ttu-id="ac147-125">**API-Gateway**.</span><span class="sxs-lookup"><span data-stu-id="ac147-125">**API Gateway**.</span></span> <span data-ttu-id="ac147-126">Für einfache Datenaggregation aus mehreren Microservices, die verschiedene Datenbanken besitzen, ist die empfohlene Vorgehensweise eine Aggregation Microservice als ein API-Gateway bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="ac147-126">For simple data aggregation from multiple microservices that own different databases, the recommended approach is an aggregation microservice referred to as an API Gateway.</span></span> <span data-ttu-id="ac147-127">Allerdings müssen Sie berücksichtigen, dieses Muster implementieren, da es kann einen Punkt Drossel in Ihrem System, und können sie das Prinzip der Microservice Autonomie verletzen.</span><span class="sxs-lookup"><span data-stu-id="ac147-127">However, you need to be careful about implementing this pattern, because it can be a choke point in your system, and it can violate the principle of microservice autonomy.</span></span> <span data-ttu-id="ac147-128">Um diese Gefahr zu minimieren, können Sie mehrere detaillierte-API-Gateways verwenden, jede eine Fokussierung auf einer vertikalen "Segment" oder ein Geschäftsbereich des Systems.</span><span class="sxs-lookup"><span data-stu-id="ac147-128">To mitigate this possibility, you can have multiple fined-grained API Gateways each one focusing on a vertical “slice” or business area of the system.</span></span> <span data-ttu-id="ac147-129">Die API-Gateway-Muster wird ausführlicher im Abschnitt in der Using später ein API-Gateway.</span><span class="sxs-lookup"><span data-stu-id="ac147-129">The API Gateway pattern is explained in more detail in the section in the Using an API Gateway later.</span></span>

<span data-ttu-id="ac147-130">**CQRS mit Abfrage/Lesevorgänge Tabellen**.</span><span class="sxs-lookup"><span data-stu-id="ac147-130">**CQRS with query/reads tables**.</span></span> <span data-ttu-id="ac147-131">Eine andere Lösung für das Aggregieren von Daten aus mehreren Microservices wird die [materialisierte Sicht Muster](https://docs.microsoft.com/azure/architecture/patterns/materialized-view).</span><span class="sxs-lookup"><span data-stu-id="ac147-131">Another solution for aggregating data from multiple microservices is the [Materialized View pattern](https://docs.microsoft.com/azure/architecture/patterns/materialized-view).</span></span> <span data-ttu-id="ac147-132">Dieser Ansatz bietet Sie generiert haben, im voraus (vorbereiten denormalisierte Daten vor dem Auftreten von der tatsächlichen Abfragen), eine schreibgeschützte Tabelle mit den Daten, die mehrere Microservices gehört.</span><span class="sxs-lookup"><span data-stu-id="ac147-132">In this approach, you generate, in advance (prepare denormalized data before the actual queries happen), a read-only table with the data that is owned by multiple microservices.</span></span> <span data-ttu-id="ac147-133">Die Tabelle besitzt ein Format für die Client-app-Anforderungen geeignet sind.</span><span class="sxs-lookup"><span data-stu-id="ac147-133">The table has a format suited to the client app’s needs.</span></span>

<span data-ttu-id="ac147-134">Betrachten Sie etwa im Bildschirm zur einer mobilen app.</span><span class="sxs-lookup"><span data-stu-id="ac147-134">Consider something like the screen for a mobile app.</span></span> <span data-ttu-id="ac147-135">Wenn Sie eine einzelne Datenbank verfügen, können Sie zusammen Pullvorgänge für die Daten für einen Bildschirm mit einer SQL-Abfrage, die eine komplexe Verknüpfung, die im Zusammenhang mit mehreren Tabellen ausführt.</span><span class="sxs-lookup"><span data-stu-id="ac147-135">If you have a single database, you might pull together the data for that screen using a SQL query that performs a complex join involving multiple tables.</span></span> <span data-ttu-id="ac147-136">Wenn Sie mehrere Datenbanken vorhanden sein, und jede Datenbank ist im Besitz einer anderen Microservice, können keine Sie jedoch diese Datenbanken abzufragen und erstellt einen Join in SQL.</span><span class="sxs-lookup"><span data-stu-id="ac147-136">However, when you have multiple databases, and each database is owned by a different microservice, you cannot query those databases and create a SQL join.</span></span> <span data-ttu-id="ac147-137">Die komplexe Abfrage wird eine neue Herausforderung dar.</span><span class="sxs-lookup"><span data-stu-id="ac147-137">Your complex query becomes a challenge.</span></span> <span data-ttu-id="ac147-138">Können Sie die Anforderung mithilfe des Ansatzes CQRS beheben, erstellen Sie eine nicht normalisierte Tabelle in einer anderen Datenbank, die nur für Abfragen verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="ac147-138">You can address the requirement using a CQRS approach—you create a denormalized table in a different database that is used just for queries.</span></span> <span data-ttu-id="ac147-139">Die Tabelle kann speziell für die Daten entworfen werden, Sie mit der komplexen Abfrage mit einer 1: 1-Beziehung zwischen Feldern, die von Ihrer Anwendung Bildschirm und die Spalten in der Abfragetabelle benötigt müssen.</span><span class="sxs-lookup"><span data-stu-id="ac147-139">The table can be designed specifically for the data you need for the complex query, with a one-to-one relationship between fields needed by your application’s screen and the columns in the query table.</span></span> <span data-ttu-id="ac147-140">Es kann auch für Berichtszwecke dienen.</span><span class="sxs-lookup"><span data-stu-id="ac147-140">It could also serve for reporting purposes.</span></span>

<span data-ttu-id="ac147-141">Dieser Ansatz löst nicht nur das ursprüngliche Problem (wie die Abfrage und Join über Microservices); Es verbessert auch die Leistung erheblich, wenn mit dem eine komplexe Verknüpfung verglichen, da Sie bereits über Daten verfügen, die in der Abfragetabelle in der Anwendung benötigt.</span><span class="sxs-lookup"><span data-stu-id="ac147-141">This approach not only solves the original problem (how to query and join across microservices); it also improves performance considerably when compared with a complex join, because you already have the data that the application needs in the query table.</span></span> <span data-ttu-id="ac147-142">Natürlich Abfrage/Lesevorgänge Tabellen mit Befehl und Abfrage Verantwortung Segregation (CQRS) bedeutet, dass weitere Entwicklungsarbeit erforderlich, und Sie müssen eventuelle Konsistenz zu nutzen.</span><span class="sxs-lookup"><span data-stu-id="ac147-142">Of course, using Command and Query Responsibility Segregation (CQRS) with query/reads tables means additional development work, and you will need to embrace eventual consistency.</span></span> <span data-ttu-id="ac147-143">Dennoch eine überaus Anforderungen auf Leistung und hoher Skalierbarkeit in [zusammenarbeitsszenarien](http://udidahan.com/2011/10/02/why-you-should-be-using-cqrs-almost-everywhere/) (oder Wettbewerber Szenarien, abhängig von der Sicht) ist, in denen CQRS mit mehreren Datenbanken angewendet werden sollen.</span><span class="sxs-lookup"><span data-stu-id="ac147-143">Nonetheless, requirements on performance and high scalability in [collaborative scenarios](http://udidahan.com/2011/10/02/why-you-should-be-using-cqrs-almost-everywhere/) (or competitive scenarios, depending on the point of view) is where you should apply CQRS with multiple databases.</span></span>

<span data-ttu-id="ac147-144">**"Kalte Daten" in der zentralen Datenbanken**.</span><span class="sxs-lookup"><span data-stu-id="ac147-144">**“Cold data” in central databases**.</span></span> <span data-ttu-id="ac147-145">Für komplexe Berichte oder Abfragen, die möglicherweise nicht in Echtzeit Daten erfordern, ist eine gängige Methode so exportieren Sie Ihre "hot Data" (Transaktionsdaten aus der Microservices) als "kalte Daten" in großen Datenbanken, die nur für die Berichterstattung verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="ac147-145">For complex reports and queries that might not require real-time data, a common approach is to export your “hot data” (transactional data from the microservices) as “cold data” into large databases that are used only for reporting.</span></span> <span data-ttu-id="ac147-146">Das System für die zentrale Datenbank kann eine Big Data-basierten System, z. B. Hadoop, ein Datawarehouse wie basierend auf Azure SQL Data Warehouse oder sogar einer einzelnen SQL-Datenbank nur für Berichte verwendet werden, (wenn die Größe nicht über ein Problem werden) sein.</span><span class="sxs-lookup"><span data-stu-id="ac147-146">That central database system can be a Big Data-based system, like Hadoop, a data warehouse like one based on Azure SQL Data Warehouse, or even a single SQL database used just for reports (if size will not be an issue).</span></span>

<span data-ttu-id="ac147-147">Bedenken Sie, dass dieser zentralisierten Datenbank verwendet werden würde, nur für Abfragen und Berichte, die Daten in Echtzeit nicht benötigen.</span><span class="sxs-lookup"><span data-stu-id="ac147-147">Keep in mind that this centralized database would be used only for queries and reports that do not need real-time data.</span></span> <span data-ttu-id="ac147-148">Die ursprünglichen Updates und Transaktionen, wie Ihre Datenquelle besteht, müssen sich in Ihren Daten Microservices befinden.</span><span class="sxs-lookup"><span data-stu-id="ac147-148">The original updates and transactions, as your source of truth, have to be in your microservices data.</span></span> <span data-ttu-id="ac147-149">Die Möglichkeit, Daten zu synchronisieren, würde wäre mit ereignisgesteuerte Kommunikation (in den nächsten Abschnitten behandelt) oder mit anderen Datenbank-Infrastruktur-Import/Export-Tools.</span><span class="sxs-lookup"><span data-stu-id="ac147-149">The way you would synchronize data would be either by using event-driven communication (covered in the next sections) or by using other database infrastructure import/export tools.</span></span> <span data-ttu-id="ac147-150">Bei Verwendung von ereignisgesteuerten Kommunikation wäre, Integrationsprozesses ähnlich wie bei Daten zu übertragen, wie oben für CQRS Abfragetabellen beschrieben.</span><span class="sxs-lookup"><span data-stu-id="ac147-150">If you use event-driven communication, that integration process would be similar to the way you propagate data as described earlier for CQRS query tables.</span></span>

<span data-ttu-id="ac147-151">Jedoch wenn Ihren Anwendungsentwurf ständig Aggregieren von Daten aus mehreren Microservices für komplexe Abfragen umfasst, möglicherweise ein Symptom für ein schlechtes Design – ein Microservice sollte möglichst aus anderen Microservices als isolierte sein.</span><span class="sxs-lookup"><span data-stu-id="ac147-151">However, if your application design involves constantly aggregating information from multiple microservices for complex queries, it might be a symptom of a bad design—a microservice should be as isolated as possible from other microservices.</span></span> <span data-ttu-id="ac147-152">(Dies schließt Berichte/Analysen, die immer kalten Daten zentralen Datenbanken verwenden soll.) Häufig haben dieses Problem möglicherweise einen Grund Microservices zusammengeführt.</span><span class="sxs-lookup"><span data-stu-id="ac147-152">(This excludes reports/analytics that always should use cold-data central databases.) Having this problem often might be a reason to merge microservices.</span></span> <span data-ttu-id="ac147-153">Sie müssen die Autonomie der Entwicklung und Bereitstellung von jeder Microservice mit starke Abhängigkeiten, Kohäsion und Datenaggregation abwägen.</span><span class="sxs-lookup"><span data-stu-id="ac147-153">You need to balance the autonomy of evolution and deployment of each microservice with strong dependencies, cohesion, and data aggregation.</span></span>

## <a name="challenge-3-how-to-achieve-consistency-across-multiple-microservices"></a><span data-ttu-id="ac147-154">Herausforderung \#3: wie Konsistenz über mehrere Microservices zu erreichen.</span><span class="sxs-lookup"><span data-stu-id="ac147-154">Challenge \#3: How to achieve consistency across multiple microservices</span></span>

<span data-ttu-id="ac147-155">Wie bereits erwähnt, werden die Daten, die im Besitz von jeder Microservice ist für diese Microservice privat und können nur mit seiner Microservice API zugegriffen werden.</span><span class="sxs-lookup"><span data-stu-id="ac147-155">As stated previously, the data owned by each microservice is private to that microservice and can only be accessed using its microservice API.</span></span> <span data-ttu-id="ac147-156">Aus diesem Grund wird eine Aufforderung angezeigt wie End-to-End-Geschäftsprozesse Weiterleitungstopologie Konsistenz über mehrere Microservices implementiert.</span><span class="sxs-lookup"><span data-stu-id="ac147-156">Therefore, a challenge presented is how to implement end-to-end business processes while keeping consistency across multiple microservices.</span></span>

<span data-ttu-id="ac147-157">Um dieses Problem zu analysieren, sehen wir uns ein Beispiel aus der [eShopOnContainers verweisen Anwendung](http://aka.ms/eshoponcontainers).</span><span class="sxs-lookup"><span data-stu-id="ac147-157">To analyze this problem, let’s look at an example from the [eShopOnContainers reference application](http://aka.ms/eshoponcontainers).</span></span> <span data-ttu-id="ac147-158">Der Katalog Microservice verwaltet Informationen zu allen Produkten, einschließlich der vordefinierten Ebene.</span><span class="sxs-lookup"><span data-stu-id="ac147-158">The Catalog microservice maintains information about all the products, including their stock level.</span></span> <span data-ttu-id="ac147-159">Die Reihenfolge Microservice Bestellungen verwaltet und muss sicherstellen, dass eine neue Bestellung Aktie Produkt verfügbaren Katalog nicht überschritten wird.</span><span class="sxs-lookup"><span data-stu-id="ac147-159">The Ordering microservice manages orders and must verify that a new order does not exceed the available catalog product stock.</span></span> <span data-ttu-id="ac147-160">(Oder das Szenario kann das Logik, die behandelt rückständigen Produkte umfassen.) In einer hypothetischen monolithischen Version dieser Anwendung konnte die Reihenfolge Subsystem einfach verwenden eine ACID-Transaktion überprüfen Sie den verfügbaren Bestand, erstellen die Reihenfolge, in der Tabelle Orders, und aktualisieren den verfügbaren Bestand in der Tabelle Products.</span><span class="sxs-lookup"><span data-stu-id="ac147-160">(Or the scenario might involve logic that handles backordered products.) In a hypothetical monolithic version of this application, the ordering subsystem could simply use an ACID transaction to check the available stock, create the order in the Orders table, and update the available stock in the Products table.</span></span>

<span data-ttu-id="ac147-161">In einer Microservices-basierte Anwendung, die Bestellungen und Produkten Tabellen jedoch durch ihre jeweiligen Microservices gehören.</span><span class="sxs-lookup"><span data-stu-id="ac147-161">However, in a microservices- based application, the Order and Product tables are owned by their respective microservices.</span></span> <span data-ttu-id="ac147-162">Keine Microservice sollte jemals Datenbanken im Besitz einer anderen Microservice in einem eigenen Transaktionen oder Abfragen, enthalten, wie in Abbildung 4-9 gezeigt.</span><span class="sxs-lookup"><span data-stu-id="ac147-162">No microservice should ever include databases owned by another microservice in its own transactions or queries, as shown in Figure 4-9.</span></span>

![](./media/image9.PNG)

<span data-ttu-id="ac147-163">**Abbildung 4-9**.</span><span class="sxs-lookup"><span data-stu-id="ac147-163">**Figure 4-9**.</span></span> <span data-ttu-id="ac147-164">Ein Microservice kann nicht direkt auf eine Tabelle in einer anderen Microservice zugreifen.</span><span class="sxs-lookup"><span data-stu-id="ac147-164">A microservice cannot directly access a table in another microservice</span></span>

<span data-ttu-id="ac147-165">Die Reihenfolge Microservice sollte nicht direkt, die Products-Tabelle aktualisieren, da die Products-Tabelle der Katalog Microservice gehört.</span><span class="sxs-lookup"><span data-stu-id="ac147-165">The Ordering microservice should not update the Products table directly, because the Products table is owned by the Catalog microservice.</span></span> <span data-ttu-id="ac147-166">Um ein Update für den Katalog Microservice zu machen, sollten die Reihenfolge Microservice immer nur asynchronen Kommunikation, z. B. integrationsereignisse (Nachricht und das ereignisbasierte Kommunikation) verwenden.</span><span class="sxs-lookup"><span data-stu-id="ac147-166">To make an update to the Catalog microservice, the Ordering microservice should only ever use asynchronous communication such as integration events (message and event-based communication).</span></span> <span data-ttu-id="ac147-167">Dies ist wie die [eShopOnContainers](http://aka.ms/eshoponcontainers) Verweis Anwendung ausführt, diese Art von Update.</span><span class="sxs-lookup"><span data-stu-id="ac147-167">This is how the [eShopOnContainers](http://aka.ms/eshoponcontainers) reference application performs this type of update.</span></span>

<span data-ttu-id="ac147-168">Wie angegeben durch die [CAP theorems](https://en.wikipedia.org/wiki/CAP_theorem), müssen Sie die Wahl zwischen Verfügbarkeit und ACID starke Konsistenz.</span><span class="sxs-lookup"><span data-stu-id="ac147-168">As stated by the [CAP theorem](https://en.wikipedia.org/wiki/CAP_theorem), you need to choose between availability and ACID strong consistency.</span></span> <span data-ttu-id="ac147-169">Die meisten Microservice-basierten Szenarien mit "demand" Verfügbarkeit und hoher Skalierbarkeit, im Gegensatz zu starke Konsistenz.</span><span class="sxs-lookup"><span data-stu-id="ac147-169">Most microservice-based scenarios demand availability and high scalability as opposed to strong consistency.</span></span> <span data-ttu-id="ac147-170">Unternehmenswichtige Anwendungen müssen sich bleiben und ausgeführt wird, und Entwickler können umgehen, die starke Konsistenz mithilfe von Techniken zum Arbeiten mit schwachen oder eventuellen Konsistenz.</span><span class="sxs-lookup"><span data-stu-id="ac147-170">Mission-critical applications must remain up and running, and developers can work around strong consistency by using techniques for working with weak or eventual consistency.</span></span> <span data-ttu-id="ac147-171">Dies ist der Ansatz, der meisten Microservice basierende Architekturen.</span><span class="sxs-lookup"><span data-stu-id="ac147-171">This is the approach taken by most microservice-based architectures.</span></span>

<span data-ttu-id="ac147-172">Darüber hinaus werden ACID-Format oder Transaktionen mit Zweiphasen-Commit nicht nur mit den Prinzipien Microservices; Die meisten NoSQL-Datenbanken (z. B. Azure-Cosmos-DB, MongoDB, usw.) unterstützen keine Transaktionen mit Zweiphasen-Commit.</span><span class="sxs-lookup"><span data-stu-id="ac147-172">Moreover, ACID-style or two-phase commit transactions are not just against microservices principles; most NoSQL databases (like Azure Cosmos DB, MongoDB, etc.) do not support two-phase commit transactions.</span></span> <span data-ttu-id="ac147-173">Allerdings ist bei Verwalten von Daten die Konsistenz zwischen Diensten und Datenbanken wichtig.</span><span class="sxs-lookup"><span data-stu-id="ac147-173">However, maintaining data consistency across services and databases is essential.</span></span> <span data-ttu-id="ac147-174">Dieses Problem bezieht sich auch auf die Frage, wie Änderungen über mehrere Microservices weitergegeben, wenn bestimmte Daten redundant sein müssen – z. B. Wenn Sie müssen das Produkt Namen\noder Beschreibung in den Katalog Microservice und Korb haben Microservice.</span><span class="sxs-lookup"><span data-stu-id="ac147-174">This challenge is also related to the question of how to propagate changes across multiple microservices when certain data needs to be redundant—for example, when you need to have the product’s name or description in the Catalog microservice and the Basket microservice.</span></span>

<span data-ttu-id="ac147-175">Eine geeignete Lösung für dieses Problem ist die Verwendung von eventuellen Konsistenz zwischen Microservices formuliert, die über eine ereignisgesteuerte Kommunikation und einem System veröffentlichen und abonnieren.</span><span class="sxs-lookup"><span data-stu-id="ac147-175">A good solution for this problem is to use eventual consistency between microservices articulated through event-driven communication and a publish-and-subscribe system.</span></span> <span data-ttu-id="ac147-176">In diesen Themen finden Sie im Abschnitt [asynchrone ereignisgesteuerte Kommunikation](#async_event_driven_communication) weiter unten in diesem Handbuch.</span><span class="sxs-lookup"><span data-stu-id="ac147-176">These topics are covered in the section [Asynchronous event-driven communication](#async_event_driven_communication) later in this guide.</span></span>

## <a name="challenge-4-how-to-design-communication-across-microservice-boundaries"></a><span data-ttu-id="ac147-177">Herausforderung \#4: Kommunikation Microservice hinweg entwerfen</span><span class="sxs-lookup"><span data-stu-id="ac147-177">Challenge \#4: How to design communication across microservice boundaries</span></span>

<span data-ttu-id="ac147-178">Kommunikation über Microservice Grenzen ist eine echte Herausforderung.</span><span class="sxs-lookup"><span data-stu-id="ac147-178">Communicating across microservice boundaries is a real challenge.</span></span> <span data-ttu-id="ac147-179">In diesem Kontext Kommunikation verweist nicht auf welches Sie Protokoll (HTTP und REST AMQP, messaging, usw.) verwenden soll.</span><span class="sxs-lookup"><span data-stu-id="ac147-179">In this context, communication does not refer to what protocol you should use (HTTP and REST, AMQP, messaging, and so on).</span></span> <span data-ttu-id="ac147-180">Stattdessen, adressiert er welche Kommunikation-Stil, die Sie verwenden sollten, und insbesondere wie gekoppelten Ihrer Microservices sein soll.</span><span class="sxs-lookup"><span data-stu-id="ac147-180">Instead, it addresses what communication style you should use, and especially how coupled your microservices should be.</span></span> <span data-ttu-id="ac147-181">Je nach der Kopplung Wenn ein Fehler auftritt, variieren die Auswirkungen dieses Ausfalls auf Ihrem System erheblich.</span><span class="sxs-lookup"><span data-stu-id="ac147-181">Depending on the level of coupling, when failure occurs, the impact of that failure on your system will vary significantly.</span></span>

<span data-ttu-id="ac147-182">Komponenten werden in einem verteilten System wie eine Microservices basierende Anwendung, mit so vielen Elementen navigieren und mit verteilten Dienste über mehrere Server oder Hosts letztendlich fehlschlagen.</span><span class="sxs-lookup"><span data-stu-id="ac147-182">In a distributed system like a microservices-based application, with so many artifacts moving around and with distributed services across many servers or hosts, components will eventually fail.</span></span> <span data-ttu-id="ac147-183">Partielle Fehler, und auch größere Ausfälle erfolgt daher Sie Ihre Microservices und die Kommunikation zwischen diesen und berücksichtigt die Risiken allgemeine bei dieser Art der verteilten System entwerfen müssen.</span><span class="sxs-lookup"><span data-stu-id="ac147-183">Partial failure and even larger outages will occur, so you need to design your microservices and the communication across them taking into account the risks common in this type of distributed system.</span></span>

<span data-ttu-id="ac147-184">Eine gängige Vorgehensweise ist zum Implementieren von HTTP (REST)-basierten Microservices, aufgrund deren Einfachheit.</span><span class="sxs-lookup"><span data-stu-id="ac147-184">A popular approach is to implement HTTP (REST)- based microservices, due to their simplicity.</span></span> <span data-ttu-id="ac147-185">Ein HTTP-basierten Ansatz ist vollkommen akzeptabel; Hier das Problem bezieht sich auf dessen Verwendung.</span><span class="sxs-lookup"><span data-stu-id="ac147-185">An HTTP-based approach is perfectly acceptable; the issue here is related to how you use it.</span></span> <span data-ttu-id="ac147-186">Wenn Sie HTTP-Anforderungen und Antworten nur für die Interaktion mit Ihrem Microservices von Clientanwendungen oder von API-Gateways verwenden, ist dies in Ordnung.</span><span class="sxs-lookup"><span data-stu-id="ac147-186">If you use HTTP requests and responses just to interact with your microservices from client applications or from API Gateways, that is fine.</span></span> <span data-ttu-id="ac147-187">Sondern bei der Erstellung lange statusketten synchronen HTTP-Aufrufen über Microservices Kommunikation über Umrisslinien, als wären die Microservices Objekte in einer Anwendung aufgrund eines monolithischen Ihrer Anwendung schließlich Probleme.</span><span class="sxs-lookup"><span data-stu-id="ac147-187">But if you create long chains of synchronous HTTP calls across microservices, communicating across their boundaries as if the microservices were objects in a monolithic application, your application will eventually run into problems.</span></span>

<span data-ttu-id="ac147-188">Stellen Sie sich z. B. vor, dass Ihre Clientanwendung ein HTTP-API aufruft, die auf eine einzelne Microservice wie die Sortierung Microservice.</span><span class="sxs-lookup"><span data-stu-id="ac147-188">For instance, imagine that your client application makes an HTTP API call to an individual microservice like the Ordering microservice.</span></span> <span data-ttu-id="ac147-189">Wenn die Sortierung Microservice ruft anschließend zusätzliche Microservices über HTTP innerhalb der gleichen Anforderung/Antwort-Zyklus, erstellen Sie eine Kette von HTTP-aufrufen.</span><span class="sxs-lookup"><span data-stu-id="ac147-189">If the Ordering microservice in turn calls additional microservices using HTTP within the same request/response cycle, you are creating a chain of HTTP calls.</span></span> <span data-ttu-id="ac147-190">Anfänglich möglicherweise angemessen sound werden.</span><span class="sxs-lookup"><span data-stu-id="ac147-190">It might sound reasonable initially.</span></span> <span data-ttu-id="ac147-191">Es gibt jedoch wichtige Punkte zu berücksichtigen, wenn Sie diesen Pfad:</span><span class="sxs-lookup"><span data-stu-id="ac147-191">However, there are important points to consider when going down this path:</span></span>

-   <span data-ttu-id="ac147-192">Blockierende und mit niedriger Leistung.</span><span class="sxs-lookup"><span data-stu-id="ac147-192">Blocking and low performance.</span></span> <span data-ttu-id="ac147-193">Aufgrund der synchronen HTTP wird die ursprüngliche Anforderung keine Antwort erhalten, bis alle internen HTTP-Aufrufe abgeschlossen sind.</span><span class="sxs-lookup"><span data-stu-id="ac147-193">Due to the synchronous nature of HTTP, the original request will not get a response until all the internal HTTP calls are finished.</span></span> <span data-ttu-id="ac147-194">Stellen Sie vor, wenn die Anzahl der Aufrufe deutlich erhöht und zum gleichen Zeitpunkt eine intermediate HTTP-an ein Microservice Aufrufe blockiert wird.</span><span class="sxs-lookup"><span data-stu-id="ac147-194">Imagine if the number of these calls increases significantly and at the same time one of the intermediate HTTP calls to a microservice is blocked.</span></span> <span data-ttu-id="ac147-195">Das Ergebnis ist, dass die Leistung wird beeinträchtigt, und die allgemeine Skalierbarkeit exponentiell wirkt sich als zusätzliche Zunahme der HTTP-Anforderungen.</span><span class="sxs-lookup"><span data-stu-id="ac147-195">The result is that performance is impacted, and the overall scalability will be exponentially affected as additional HTTP requests increase.</span></span>

-   <span data-ttu-id="ac147-196">Kopplung Microservices mit HTTP.</span><span class="sxs-lookup"><span data-stu-id="ac147-196">Coupling microservices with HTTP.</span></span> <span data-ttu-id="ac147-197">Business Microservices sollte nicht mit anderen Microservices Business verbunden werden.</span><span class="sxs-lookup"><span data-stu-id="ac147-197">Business microservices should not be coupled with other business microservices.</span></span> <span data-ttu-id="ac147-198">Im Idealfall sollten sie "über das Vorhandensein der anderen Microservices weiß" nichts.</span><span class="sxs-lookup"><span data-stu-id="ac147-198">Ideally, they should not “know” about the existence of other microservices.</span></span> <span data-ttu-id="ac147-199">Wenn Ihre Anwendung Kopplung Microservices wie im Beispiel abhängig, werden Autonomie pro Microservice erreichen nahezu unmöglich.</span><span class="sxs-lookup"><span data-stu-id="ac147-199">If your application relies on coupling microservices as in the example, achieving autonomy per microservice will be almost impossible.</span></span>

-   <span data-ttu-id="ac147-200">Fehler in jeder ein Microservice.</span><span class="sxs-lookup"><span data-stu-id="ac147-200">Failure in any one microservice.</span></span> <span data-ttu-id="ac147-201">Wenn Sie eine Kette von Microservices, die durch HTTP-aufrufen, verknüpft werden, wenn die gesamte Kette der Microservices keines der Microservices ein Fehler auftritt (und sie werden letztendlich fehlschlagen) implementiert schlägt fehl.</span><span class="sxs-lookup"><span data-stu-id="ac147-201">If you implemented a chain of microservices linked by HTTP calls, when any of the microservices fails (and eventually they will fail) the whole chain of microservices will fail.</span></span> <span data-ttu-id="ac147-202">Ein Microservice-basiertes System sollten so entworfen werden, um den Vorgang fortzusetzen, um möglichst hohe Leistungsfähigkeit während teilfehler zu arbeiten.</span><span class="sxs-lookup"><span data-stu-id="ac147-202">A microservice-based system should be designed to continue to work as well as possible during partial failures.</span></span> <span data-ttu-id="ac147-203">Auch wenn Sie Client-Logik implementieren, Wiederholungen mit exponenzieller oder Trennschalter Mechanismen verwendet, sind weitere komplexe der HTTP-Aufruf Ketten es wird eine Strategie umzusetzen Fehler HTTP-basierte je komplexer.</span><span class="sxs-lookup"><span data-stu-id="ac147-203">Even if you implement client logic that uses retries with exponential backoff or circuit breaker mechanisms, the more complex the HTTP call chains are, the more complex it is implement a failure strategy based on HTTP.</span></span>

<span data-ttu-id="ac147-204">Tatsächlich, wenn durch das Erstellen von Ketten der HTTP-Anforderungen gemäß Ihrer internen Microservices kommunizieren, konnte geltend gemacht werden, dass Sie eine Anwendung aufgrund eines monolithischen bis auf eine HTTP-basierte zwischen Prozessen statt intraprocess Kommunikationsmechanismen verfügen.</span><span class="sxs-lookup"><span data-stu-id="ac147-204">In fact, if your internal microservices are communicating by creating chains of HTTP requests as described, it could be argued that you have a monolithic application, but one based on HTTP between processes instead of intraprocess communication mechanisms.</span></span>

<span data-ttu-id="ac147-205">Um Microservice Autonomie zu erzwingen und eine bessere resilienz haben, sollten Sie daher die Verwendung von Ketten Anforderung/Antwort-Kommunikation über Microservices minimieren.</span><span class="sxs-lookup"><span data-stu-id="ac147-205">Therefore, in order to enforce microservice autonomy and have better resiliency, you should minimize the use of chains of request/response communication across microservices.</span></span> <span data-ttu-id="ac147-206">Es wird empfohlen, nur asynchrone Aktivität für die übergreifende Microservice Kommunikation mithilfe von asynchronen und Ereignis-meldungsbasierte Kommunikation oder mithilfe von HTTP-Abruf unabhängig von der ursprünglichen HTTP-Anforderung/Antwort-Zyklus verwenden.</span><span class="sxs-lookup"><span data-stu-id="ac147-206">It is recommended that you use only asynchronous interaction for inter-microservice communication, either by using asynchronous message- and event-based communication, or by using HTTP polling independently of the original HTTP request/response cycle.</span></span>

<span data-ttu-id="ac147-207">Erläutert die Verwendung der asynchronen Kommunikation mit zusätzlichen Details weiter unten in diesem Handbuch in den Abschnitten [asynchrone Microservice Integration erzwingt die Microservice Autonomie](#asynchronous-microservice-integration-enforce-microservices-autonomy) und [asynchrone – meldungsbasierte Kommunikation](#asynchronous-message-based-communication).</span><span class="sxs-lookup"><span data-stu-id="ac147-207">The use of asynchronous communication is explained with additional details later in this guide in the sections [Asynchronous microservice integration enforces microservice’s autonomy](#asynchronous-microservice-integration-enforce-microservices-autonomy) and [Asynchronous message-based communication](#asynchronous-message-based-communication).</span></span>

## <a name="additional-resources"></a><span data-ttu-id="ac147-208">Zusätzliche Ressourcen</span><span class="sxs-lookup"><span data-stu-id="ac147-208">Additional resources</span></span>

-   <span data-ttu-id="ac147-209">**CAP theorems**
    [*https://en.wikipedia.org/wiki/CAP\_theorems*](https://en.wikipedia.org/wiki/CAP_theorem)</span><span class="sxs-lookup"><span data-stu-id="ac147-209">**CAP theorem**
[*https://en.wikipedia.org/wiki/CAP\_theorem*](https://en.wikipedia.org/wiki/CAP_theorem)</span></span>

-   <span data-ttu-id="ac147-210">**Eventuelle Konsistenz**
    [*https://en.wikipedia.org/wiki/Eventual\_Konsistenz*](https://en.wikipedia.org/wiki/Eventual_consistency)</span><span class="sxs-lookup"><span data-stu-id="ac147-210">**Eventual consistency**
[*https://en.wikipedia.org/wiki/Eventual\_consistency*](https://en.wikipedia.org/wiki/Eventual_consistency)</span></span>

-   <span data-ttu-id="ac147-211">**Einführung in Data-Konsistenz**
    [*https://msdn.microsoft.com/library/dn589800.aspx*](https://msdn.microsoft.com/library/dn589800.aspx)</span><span class="sxs-lookup"><span data-stu-id="ac147-211">**Data Consistency Primer**
[*https://msdn.microsoft.com/library/dn589800.aspx*](https://msdn.microsoft.com/library/dn589800.aspx)</span></span>

-   <span data-ttu-id="ac147-212">**Martin Fowler. CQRS (Befehl und Query Responsibility Segregation)**
    [*http://martinfowler.com/bliki/CQRS.html*](http://martinfowler.com/bliki/CQRS.html)</span><span class="sxs-lookup"><span data-stu-id="ac147-212">**Martin Fowler. CQRS (Command and Query Responsibility Segregation)**
[*http://martinfowler.com/bliki/CQRS.html*](http://martinfowler.com/bliki/CQRS.html)</span></span>

-   <span data-ttu-id="ac147-213">**Materialisierte Sicht**
    [*https://docs.microsoft.com/azure/architecture/patterns/materialized-view*](https://docs.microsoft.com/azure/architecture/patterns/materialized-view)</span><span class="sxs-lookup"><span data-stu-id="ac147-213">**Materialized View**
[*https://docs.microsoft.com/azure/architecture/patterns/materialized-view*](https://docs.microsoft.com/azure/architecture/patterns/materialized-view)</span></span>

-   <span data-ttu-id="ac147-214">**Charles Zeile. ACID im Vergleich zu Basis: Der verändern-pH der Datenbank Transaction Processing**
    [*http://www.dataversity.net/acid-vs-base-the-shifting-ph-of-database-transaction-processing/*](http://www.dataversity.net/acid-vs-base-the-shifting-ph-of-database-transaction-processing/)</span><span class="sxs-lookup"><span data-stu-id="ac147-214">**Charles Row. ACID vs. BASE: The Shifting pH of Database Transaction Processing**
[*http://www.dataversity.net/acid-vs-base-the-shifting-ph-of-database-transaction-processing/*](http://www.dataversity.net/acid-vs-base-the-shifting-ph-of-database-transaction-processing/)</span></span>

-   <span data-ttu-id="ac147-215">**Kompensierende Transaktion**
    [*https://docs.microsoft.com/azure/architecture/patterns/compensating-transaction*](https://docs.microsoft.com/azure/architecture/patterns/compensating-transaction)</span><span class="sxs-lookup"><span data-stu-id="ac147-215">**Compensating Transaction**
[*https://docs.microsoft.com/azure/architecture/patterns/compensating-transaction*](https://docs.microsoft.com/azure/architecture/patterns/compensating-transaction)</span></span>

-   <span data-ttu-id="ac147-216">**Udi Dahan. Dienstorientierte Komposition**
    [*http://udidahan.com/2014/07/30/service-oriented-composition-with-video/*](http://udidahan.com/2014/07/30/service-oriented-composition-with-video/)</span><span class="sxs-lookup"><span data-stu-id="ac147-216">**Udi Dahan. Service Oriented Composition**
[*http://udidahan.com/2014/07/30/service-oriented-composition-with-video/*](http://udidahan.com/2014/07/30/service-oriented-composition-with-video/)</span></span>


>[!div class="step-by-step"]
<span data-ttu-id="ac147-217">[Vorherigen] (logisches-im Vergleich zur-Physical-architecture.md) [weiter] (identifizieren-Microservice-Domain-Modell-boundaries.md)</span><span class="sxs-lookup"><span data-stu-id="ac147-217">[Previous] (logical-versus-physical-architecture.md) [Next] (identify-microservice-domain-model-boundaries.md)</span></span>
