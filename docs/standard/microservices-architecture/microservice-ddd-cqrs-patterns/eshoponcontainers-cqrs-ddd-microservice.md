---
title: "CQRS anwendet und CQS Ansätze in einer DDD Microservice in eShopOnContainers"
description: ".NET Microservices Architektur für Datenvolumes .NET-Anwendungen | CQRS anwendet und CQS Ansätze in einer DDD Microservice in eShopOnContainers"
keywords: Docker, Microservices, ASP.NET, Container
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 05/26/2017
ms.prod: .net-core
ms.technology: dotnet-docker
ms.topic: article
ms.openlocfilehash: a2c4429a75ca47d4fbcde868b95e76bc65ea2bef
ms.sourcegitcommit: bd1ef61f4bb794b25383d3d72e71041a5ced172e
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 10/18/2017
---
# <a name="applying-cqrs-and-cqs-approaches-in-a-ddd-microservice-in-eshoponcontainers"></a><span data-ttu-id="89b0e-104">CQRS anwendet und CQS Ansätze in einer DDD Microservice in eShopOnContainers</span><span class="sxs-lookup"><span data-stu-id="89b0e-104">Applying CQRS and CQS approaches in a DDD microservice in eShopOnContainers</span></span>

<span data-ttu-id="89b0e-105">Der Entwurf von der Reihenfolge Microservice Anwendungs-eShopOnContainers Verweis basiert auf CQRS-Prinzipien.</span><span class="sxs-lookup"><span data-stu-id="89b0e-105">The design of the ordering microservice at the eShopOnContainers reference application is based on CQRS principles.</span></span> <span data-ttu-id="89b0e-106">Allerdings verwendet er der einfachste Ansatz, nämlich die einfach trennen die Abfragen mit den Befehlen und zum beide Aktionen mithilfe der gleiche Datenbank.</span><span class="sxs-lookup"><span data-stu-id="89b0e-106">However, it uses the simplest approach, which is just separating the queries from the commands and using the same database for both actions.</span></span>

<span data-ttu-id="89b0e-107">Die wichtigste Komponente von diesen Mustern und der wichtige Punkt hier besteht darin, dass Abfragen Idempotent sind: unabhängig davon, wie oft Sie Abfragen ein Systems zu den Status des Systems nicht ändert auch können Sie ein Datenmodell verschiedene "Lesen" als die Transaktionslogik "Schreibvorgängen" Domäne zu modellieren, obwohl die Reihenfolge Microservices derselben Datenbank verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="89b0e-107">The essence of those patterns, and the important point here, is that queries are idempotent: no matter how many times you query a system, the state of that system will not change You could even use a different “reads” data model than the transactional logic “writes” domain model, although the ordering microservices is using the same database.</span></span> <span data-ttu-id="89b0e-108">Daher ist dies einen vereinfachten Ansatz ein CQRS.</span><span class="sxs-lookup"><span data-stu-id="89b0e-108">Hence this is a simplified CQRS approach.</span></span>

<span data-ttu-id="89b0e-109">Befehle, die Transaktionen und Datenupdates auslösen, andererseits, Änderungsstatus im System an.</span><span class="sxs-lookup"><span data-stu-id="89b0e-109">On the other hand, commands, which trigger transactions and data updates, change state in the system.</span></span> <span data-ttu-id="89b0e-110">Mit Befehlen, müssen Sie darauf achten, dass bei denen Komplexität und Geschäftsregeln jemals ändern.</span><span class="sxs-lookup"><span data-stu-id="89b0e-110">With commands, you need to be careful when dealing with complexity and ever-changing business rules.</span></span> <span data-ttu-id="89b0e-111">Dies ist die, wenn Sie DDD-Techniken, um ein besseres modellierten System verfügen anwenden möchten.</span><span class="sxs-lookup"><span data-stu-id="89b0e-111">This is the where you want to apply DDD techniques to have a better modeled system.</span></span>

<span data-ttu-id="89b0e-112">In diesem Handbuch dargestellten DDD Muster sollte nicht universell angewendet werden.</span><span class="sxs-lookup"><span data-stu-id="89b0e-112">The DDD patterns presented in this guide should not be applied universally.</span></span> <span data-ttu-id="89b0e-113">Sie führen Sie Einschränkungen auf den Entwurf.</span><span class="sxs-lookup"><span data-stu-id="89b0e-113">They introduce constraints on your design.</span></span> <span data-ttu-id="89b0e-114">Diese Einschränkungen bieten Vorteile, z. B. höherer Qualität im Laufe der Zeit vor allem in Befehlen und anderen Code, den Systemstatus ändert.</span><span class="sxs-lookup"><span data-stu-id="89b0e-114">Those constraints provide benefits such as higher quality over time, especially in commands and other code that modifies system state.</span></span> <span data-ttu-id="89b0e-115">Diese Einschränkungen wird jedoch Komplexität mit weniger Vorteile zum Lesen und Abfragen von Daten hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="89b0e-115">However, those constraints add complexity with fewer benefits for reading and querying data.</span></span>

<span data-ttu-id="89b0e-116">Eine solche Muster ist das Aggregieren Muster wir mehr in späteren Abschnitten untersuchen.</span><span class="sxs-lookup"><span data-stu-id="89b0e-116">One such pattern is the Aggregate pattern, which we examine more in later sections.</span></span> <span data-ttu-id="89b0e-117">Kurz gesagt behandeln in das Muster für aggregieren Sie zahlreiche Domänenobjekte als einzelne Einheit aufgrund ihrer Beziehung in der Domäne.</span><span class="sxs-lookup"><span data-stu-id="89b0e-117">Briefly, in the Aggregate pattern, you treat many domain objects as a single unit as a result of their relationship in the domain.</span></span> <span data-ttu-id="89b0e-118">Vorteile dieses Muster in Abfragen können Sie nicht immer erhalten; Sie können die Komplexität der Abfragelogik erhöhen.</span><span class="sxs-lookup"><span data-stu-id="89b0e-118">You might not always gain advantages from this pattern in queries; it can increase the complexity of query logic.</span></span> <span data-ttu-id="89b0e-119">Für schreibgeschützte Abfragen erhalten Sie nicht die Vorteile mit mehreren Objekten als einer einzelnen Gesamtverstärkung behandelt werden.</span><span class="sxs-lookup"><span data-stu-id="89b0e-119">For read-only queries, you do not get the advantages of treating multiple objects as a single Aggregate.</span></span> <span data-ttu-id="89b0e-120">Sie erhalten nur die Komplexität.</span><span class="sxs-lookup"><span data-stu-id="89b0e-120">You only get the complexity.</span></span>

<span data-ttu-id="89b0e-121">Wie in Abbildung 9 – 2 dargestellt, empfiehlt, diese Anleitung DDD Muster nur im Bereich Transaktions-/Updates von Ihrem Microservice (d. h., wie durch Befehle ausgelöst).</span><span class="sxs-lookup"><span data-stu-id="89b0e-121">As shown in Figure 9-2, this guide suggests using DDD patterns only in the transactional/updates area of your microservice (that is, as triggered by commands).</span></span> <span data-ttu-id="89b0e-122">Abfragen können einen einfacheren Ansatz folgen und sollte von Befehlen, die nach einem CQRS-Ansatz getrennt werden.</span><span class="sxs-lookup"><span data-stu-id="89b0e-122">Queries can follow a simpler approach and should be separated from commands, following a CQRS approach.</span></span>

<span data-ttu-id="89b0e-123">Implementieren die Seite"Abfragen", können Sie zwischen viele Ansätze, die aus Ihrem ausgestattete ORM wie EF Core, AutoMapper Projektionen, gespeicherte Prozeduren, Sichten, materialisierte Sichten oder eine micro-ORM auswählen.</span><span class="sxs-lookup"><span data-stu-id="89b0e-123">For implementing the “queries side”, you can choose between many approaches, from your full-blown ORM like EF Core, AutoMapper projections, stored procedures, views, materialized views or a micro ORM.</span></span>

<span data-ttu-id="89b0e-124">In diesem Handbuch und im eShopOnContainers (insbesondere die Reihenfolge Microservice), die wir gerade Abfragen, die mit einem Micro implementieren möchten, wie ORM [dapper, durch](https://github.com/StackExchange/dapper-dot-net).</span><span class="sxs-lookup"><span data-stu-id="89b0e-124">In this guide and in eShopOnContainers (specifically the ordering microservice) we chose to implement straight queries using a micro ORM like [Dapper](https://github.com/StackExchange/dapper-dot-net).</span></span> <span data-ttu-id="89b0e-125">Dadurch können Sie jede Abfrage, die basierend auf der SQL-Anweisungen, um die optimale Leistung Dank eine light-Framework mit äußerst wenig Aufwand abrufen zu implementieren.</span><span class="sxs-lookup"><span data-stu-id="89b0e-125">This lets you implement any query based on SQL statements to get the best performance, thanks to a light framework with very little overhead.</span></span>

<span data-ttu-id="89b0e-126">Beachten Sie, dass wenn Sie diesen Ansatz verwenden, alle Updates für Ihr Modell, die beeinflussen, wie die Entitäten in einer SQL­Datenbank beibehalten werden auch separate für Updates von dapper, durch oder einem anderen separaten (nicht EF) Methoden zum Abfragen verwendeten SQL-Abfragen erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="89b0e-126">Note that when you use this approach, any updates to your model that impact how entities are persisted to a SQL database also need separate updates to SQL queries used by Dapper or any other separate (non-EF) approaches to querying.</span></span>

## <a name="cqrs-and-ddd-patterns-are-not-top-level-architectures"></a><span data-ttu-id="89b0e-127">CQRS und DDD Muster sind nicht auf oberster Ebene Architekturen</span><span class="sxs-lookup"><span data-stu-id="89b0e-127">CQRS and DDD patterns are not top-level architectures</span></span>

<span data-ttu-id="89b0e-128">Es wichtig zu verstehen, CQRS und die meisten DDD-Muster (z. B. DDD Ebenen oder ein Domänenmodell mit Aggregaten) sind nicht architektonische Stile, sondern nur Architekturmuster.</span><span class="sxs-lookup"><span data-stu-id="89b0e-128">It important to understand that CQRS and most DDD patterns (like DDD layers or a domain model with aggregates) are not architectural styles, but only architecture patterns.</span></span> <span data-ttu-id="89b0e-129">Microservices, SOA und ereignisgesteuerte-Architektur (EDA) sind Beispiele für Stile Architektur auf.</span><span class="sxs-lookup"><span data-stu-id="89b0e-129">Microservices, SOA, and event-driven architecture (EDA) are examples of architectural styles.</span></span> <span data-ttu-id="89b0e-130">Sie beschreiben ein System von vielen Komponenten, wie viele Microservices.</span><span class="sxs-lookup"><span data-stu-id="89b0e-130">They describe a system of many components, such as many microservices.</span></span> <span data-ttu-id="89b0e-131">CQRS und DDD Muster beschreiben etwas in einem einzigen System oder einer Komponente. In diesem Fall etwas innerhalb einer Microservice.</span><span class="sxs-lookup"><span data-stu-id="89b0e-131">CQRS and DDD patterns describe something inside a single system or component; in this case, something inside a microservice.</span></span>

<span data-ttu-id="89b0e-132">Unterschiedliche Muster außerdem verschiedenen begrenzt Kontexten (BCs).</span><span class="sxs-lookup"><span data-stu-id="89b0e-132">Different Bounded Contexts (BCs) will employ different patterns.</span></span> <span data-ttu-id="89b0e-133">Unterschiedliche Aufgaben haben, und für andere Projektmappen führt.</span><span class="sxs-lookup"><span data-stu-id="89b0e-133">They have different responsibilities, and that leads to different solutions.</span></span> <span data-ttu-id="89b0e-134">Wichtig ist dabei, die durch das Erzwingen des demselben Musters, das überall zu einem Fehler führt.</span><span class="sxs-lookup"><span data-stu-id="89b0e-134">It is worth emphasizing that forcing the same pattern everywhere leads to failure.</span></span> <span data-ttu-id="89b0e-135">Verwenden Sie nicht überall CQRS und DDD-Muster.</span><span class="sxs-lookup"><span data-stu-id="89b0e-135">Do not use CQRS and DDD patterns everywhere.</span></span> <span data-ttu-id="89b0e-136">Viele Subsysteme, BCs oder Microservices sind einfacher und leichter mithilfe einfache CRUD-Dienste oder ein anderer Ansatz implementiert werden kann.</span><span class="sxs-lookup"><span data-stu-id="89b0e-136">Many subsystems, BCs, or microservices are simpler and can be implemented more easily using simple CRUD services or using another approach.</span></span>

<span data-ttu-id="89b0e-137">Es ist nur eine Anwendungsarchitektur: die Architektur der System- oder End-to-End-Anwendung entwerfen (z. B. die Microservices-Architektur).</span><span class="sxs-lookup"><span data-stu-id="89b0e-137">There is only one application architecture: the architecture of the system or end-to-end application you are designing (for example, the microservices architecture).</span></span> <span data-ttu-id="89b0e-138">Allerdings gibt des Entwurfs des einzelnen begrenzt, die den Kontext oder Microservice in dieser Anwendung eigene vor-und Nachteile und interne entwurfsentscheidungen auf Ebene Muster Architektur.</span><span class="sxs-lookup"><span data-stu-id="89b0e-138">However, the design of each Bounded Context or microservice within that application reflects its own tradeoffs and internal design decisions at an architecture patterns level.</span></span> <span data-ttu-id="89b0e-139">Versuchen Sie nicht die gleichen architektonische Muster wie CQRS oder DDD überall anwenden.</span><span class="sxs-lookup"><span data-stu-id="89b0e-139">Do not try to apply the same architectural patterns like CQRS or DDD everywhere.</span></span>

####  <a name="additional-resources"></a><span data-ttu-id="89b0e-140">Zusätzliche Ressourcen</span><span class="sxs-lookup"><span data-stu-id="89b0e-140">Additional resources</span></span>

-   <span data-ttu-id="89b0e-141">**Martin Fowler. CQRS**
    [*https://martinfowler.com/bliki/CQRS.html*](https://martinfowler.com/bliki/CQRS.html)</span><span class="sxs-lookup"><span data-stu-id="89b0e-141">**Martin Fowler. CQRS**
[*https://martinfowler.com/bliki/CQRS.html*](https://martinfowler.com/bliki/CQRS.html)</span></span>

-   <span data-ttu-id="89b0e-142">**Greg Young. CQS im Vergleich zu CQRS**
    [*http://codebetter.com/gregyoung/2009/08/13/command-query-separation/*](http://codebetter.com/gregyoung/2009/08/13/command-query-separation/)</span><span class="sxs-lookup"><span data-stu-id="89b0e-142">**Greg Young. CQS vs. CQRS**
[*http://codebetter.com/gregyoung/2009/08/13/command-query-separation/*](http://codebetter.com/gregyoung/2009/08/13/command-query-separation/)</span></span>

-   <span data-ttu-id="89b0e-143">**Greg Young. CQRS Dokumente**
    [*https://cqrs.files.wordpress.com/2010/11/cqrs\_documents.pdf*](https://cqrs.files.wordpress.com/2010/11/cqrs_documents.pdf)</span><span class="sxs-lookup"><span data-stu-id="89b0e-143">**Greg Young. CQRS Documents**
[*https://cqrs.files.wordpress.com/2010/11/cqrs\_documents.pdf*](https://cqrs.files.wordpress.com/2010/11/cqrs_documents.pdf)</span></span>

-   <span data-ttu-id="89b0e-144">**Greg Young. CQRS, Aufgabe basierend Benutzeroberflächen und Ereignis Sourcing**
    [*http://codebetter.com/gregyoung/2010/02/16/cqrs-task-based-uis-event-sourcing-agh/*](http://codebetter.com/gregyoung/2010/02/16/cqrs-task-based-uis-event-sourcing-agh/)</span><span class="sxs-lookup"><span data-stu-id="89b0e-144">**Greg Young. CQRS, Task Based UIs and Event Sourcing**
[*http://codebetter.com/gregyoung/2010/02/16/cqrs-task-based-uis-event-sourcing-agh/*](http://codebetter.com/gregyoung/2010/02/16/cqrs-task-based-uis-event-sourcing-agh/)</span></span>

-   <span data-ttu-id="89b0e-145">**Udi Dahan. Es wird erläutert CQRS**
    [*http://udidahan.com/2009/12/09/clarified-cqrs/*](http://udidahan.com/2009/12/09/clarified-cqrs/)</span><span class="sxs-lookup"><span data-stu-id="89b0e-145">**Udi Dahan. Clarified CQRS**
[*http://udidahan.com/2009/12/09/clarified-cqrs/*](http://udidahan.com/2009/12/09/clarified-cqrs/)</span></span>

-   <span data-ttu-id="89b0e-146">**CQRS**
    [*http://udidahan.com/2009/12/09/clarified-cqrs/*](http://udidahan.com/2009/12/09/clarified-cqrs/)</span><span class="sxs-lookup"><span data-stu-id="89b0e-146">**CQRS**
[*http://udidahan.com/2009/12/09/clarified-cqrs/*](http://udidahan.com/2009/12/09/clarified-cqrs/)</span></span>

-   <span data-ttu-id="89b0e-147">**Ereignis-Quellentnahme (ES)**
    [*http://codebetter.com/gregyoung/2010/02/20/why-use-event-sourcing/*](http://codebetter.com/gregyoung/2010/02/20/why-use-event-sourcing/)</span><span class="sxs-lookup"><span data-stu-id="89b0e-147">**Event-Sourcing (ES)**
[*http://codebetter.com/gregyoung/2010/02/20/why-use-event-sourcing/*](http://codebetter.com/gregyoung/2010/02/20/why-use-event-sourcing/)</span></span>


>[!div class="step-by-step"]
<span data-ttu-id="89b0e-148">[Vorherigen] (Apply-simplified-microservice-cqrs-ddd-patterns.md) [weiter] (Cqrs Microservice reads.md)</span><span class="sxs-lookup"><span data-stu-id="89b0e-148">[Previous] (apply-simplified-microservice-cqrs-ddd-patterns.md) [Next] (cqrs-microservice-reads.md)</span></span>
