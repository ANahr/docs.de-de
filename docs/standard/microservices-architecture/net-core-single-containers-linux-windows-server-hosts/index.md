---
title: Bereitstellen von einzelnen auf Containern basierenden .NET Core-Webanwendungen auf Linux- oder Windows Nano Server-Hosts
description: .NET-Microservices-Architektur für .NET-Containeranwendungen | Bereitstellen von einzelnen auf Containern basierenden .NET Core-Webanwendungen auf Linux- oder Windows Nano Server-Hosts
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 06/27/2018
ms.openlocfilehash: 45be99a86a52ed450b795ca5f91c01ab82c7da47
ms.sourcegitcommit: c7f3e2e9d6ead6cc3acd0d66b10a251d0c66e59d
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 09/08/2018
ms.locfileid: "44197354"
---
# <a name="deploying-single-container-based-net-core-web-applications-on-linux-or-windows-nano-server-hosts"></a><span data-ttu-id="df1c7-103">Bereitstellen von einzelnen auf Containern basierenden .NET Core-Webanwendungen auf Linux- oder Windows Nano Server-Hosts</span><span class="sxs-lookup"><span data-stu-id="df1c7-103">Deploying Single-Container-Based .NET Core Web Applications on Linux or Windows Nano Server Hosts</span></span>

<span data-ttu-id="df1c7-104">_Sie können Docker-Container für die monolithische Bereitstellung von einfachen Webanwendungen verwenden. Dies verbessert die fortlaufende Integration und die fortlaufenden Bereitstellungspipelines und unterstützt Sie bei der erfolgreichen Bereitstellung in der Produktion. Sie müssen sich nie wieder fragen, warum die Anwendung auf Ihrem Computer, aber nicht in der Produktion funktioniert._</span><span class="sxs-lookup"><span data-stu-id="df1c7-104">_You can use Docker containers for monolithic deployment of simpler web applications. This improves continuous integration and continuous deployment pipelines and helps achieve deployment-to-production success. No more “It works in my machine, why does it not work in production?”_</span></span>

<span data-ttu-id="df1c7-105">Eine auf Microservices basierende Architektur hat viele Vorteile, die jedoch eine erhöhte Komplexität mit sich bringen.</span><span class="sxs-lookup"><span data-stu-id="df1c7-105">A microservices-based architecture has many benefits, but those benefits come at a cost of increased complexity.</span></span> <span data-ttu-id="df1c7-106">In manchen Fällen sind die Kosten der ausschlaggebende Faktor und nicht die Vorteile, und eine monolithische Bereitstellung einer Anwendung, die in einem oder in wenigen Containern ausgeführt wird, ist eine bessere Option.</span><span class="sxs-lookup"><span data-stu-id="df1c7-106">In some cases, the costs outweigh the benefits and a monolithic deployment application running in one or a few containers is a better option.</span></span>

<span data-ttu-id="df1c7-107">Eine monolithische Anwendung in gut getrennte Microservices zu zerteilen, ist nicht einfach.</span><span class="sxs-lookup"><span data-stu-id="df1c7-107">A monolithic application might not be easily decomposable into well-separated microservices.</span></span> <span data-ttu-id="df1c7-108">Sie haben gelernt, dass diese Microservices nach Funktion partitioniert werden sollten: Sie sollten unabhängig voneinander funktionieren, um eine widerstandsfähigere Anwendung bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="df1c7-108">You've learned that these microservices should be partitioned by function: they should work independently of each other to provide a more resilient application.</span></span> <span data-ttu-id="df1c7-109">Wenn Sie keine Feature Slices der Anwendung bereitstellen können, führt das Trennen derselben nur zu erhöhter Komplexität.</span><span class="sxs-lookup"><span data-stu-id="df1c7-109">If you can't deliver feature slices of the application, separating it only adds complexity.</span></span>

<span data-ttu-id="df1c7-110">Eine Anwendung muss möglicherweise noch keine Features unabhängig voneinander skalieren.</span><span class="sxs-lookup"><span data-stu-id="df1c7-110">An application might not yet need to scale features independently.</span></span> <span data-ttu-id="df1c7-111">Nehmen wir an, dass der Datenverkehr in der Frühphase der `eShopOnContainers`-Referenzanwendung nicht gerechtfertigt hat, dass die Features in verschiedene Microservices aufgeteilt werden.</span><span class="sxs-lookup"><span data-stu-id="df1c7-111">Let’s suppose that in the early stages of the `eShopOnContainers` reference application, the traffic didn't justify separating features into different microservices.</span></span> <span data-ttu-id="df1c7-112">Der Datenverkehr war gering genug, sodass das Hinzufügen von Ressourcen zu einem Dienst üblicherweise bedeutet hat, dass Ressourcen zu allen Diensten hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="df1c7-112">Traffic was small enough that adding resources to one service typically meant adding resources to all services.</span></span> <span data-ttu-id="df1c7-113">Die zusätzliche Arbeit, die Anwendung in diskrete Dienste aufzuteilen, resultiert nur in minimalen Vorteilen.</span><span class="sxs-lookup"><span data-stu-id="df1c7-113">The additional work to separate the application into discrete services provided minimal benefit.</span></span>

<span data-ttu-id="df1c7-114">Zudem haben Sie zu einem frühen Zeitpunkt während der Entwicklung einer Anwendung möglicherweise noch keine Vorstellung davon, wo die natürlichen funktionalen Grenzen liegen.</span><span class="sxs-lookup"><span data-stu-id="df1c7-114">Also, early in the development of an application you might not have a clear idea where the natural functional boundaries are.</span></span> <span data-ttu-id="df1c7-115">Beim Entwickeln eines mindestens anwendungsfähigen Produkts könnte die natürliche Trennung noch nicht verfügbar sein.</span><span class="sxs-lookup"><span data-stu-id="df1c7-115">As you develop a minimum viable product, the natural separation might not yet have emerged.</span></span>

<span data-ttu-id="df1c7-116">Einige dieser Bedingungen können temporär sein.</span><span class="sxs-lookup"><span data-stu-id="df1c7-116">Some of these conditions might be temporary.</span></span> <span data-ttu-id="df1c7-117">Sie können mit dem Erstellen einer monolithischen Anwendung beginnen und später einige Features trennen, damit diese als Microservices entwickelt und bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="df1c7-117">You might start by creating a monolithic application, and later separate some features to be developed and deployed as microservices.</span></span> <span data-ttu-id="df1c7-118">Andere Bedingungen können entscheidend für den Problembereich der Anwendung sein. Das bedeutet, dass die Anwendung möglicherweise nicht in mehrere Microservices unterteilt werden kann.</span><span class="sxs-lookup"><span data-stu-id="df1c7-118">Other conditions might be essential to the application’s problem space, meaning that the application might never be broken into multiple microservices.</span></span>

<span data-ttu-id="df1c7-119">Das Trennen einer Anwendung in viele diskrete Prozesse führt außerdem zu Mehraufwand.</span><span class="sxs-lookup"><span data-stu-id="df1c7-119">Separating an application into many discrete processes also introduces overhead.</span></span> <span data-ttu-id="df1c7-120">Durch das Teilen der Features in verschiedene Prozesse wird die Komplexität erhöht.</span><span class="sxs-lookup"><span data-stu-id="df1c7-120">There's more complexity in separating features into different processes.</span></span> <span data-ttu-id="df1c7-121">Die Kommunikationsprotokolle werden komplexer.</span><span class="sxs-lookup"><span data-stu-id="df1c7-121">The communication protocols become more complex.</span></span> <span data-ttu-id="df1c7-122">Anstelle von Methodenaufrufen müssen Sie asynchrone Kommunikationen zwischen den Diensten verwenden.</span><span class="sxs-lookup"><span data-stu-id="df1c7-122">Instead of method calls, you must use asynchronous communications between services.</span></span> <span data-ttu-id="df1c7-123">Wenn Sie zu einer Microservicesarchitektur übergehen, müssen Sie viele der Bausteine hinzufügen, die in die Microservicesversion der `eShopOnContainers`-Anwendung implementiert sind: Eventbusbehandlung, Meldungsstabilität und -wiederholungen, Eventual Consistency usw.</span><span class="sxs-lookup"><span data-stu-id="df1c7-123">As you move to a microservices architecture, you need to add many of the building blocks implemented in the microservices version of the `eShopOnContainers` application: event bus handling, message resiliency and retries, eventual consistency, and more.</span></span>

<span data-ttu-id="df1c7-124">Eine wesentlich vereinfachte Version von eShopOnContainers (namens [eShopWeb](https://github.com/dotnet-architecture/eShopOnContainers/tree/master/src/Web/WebMonolithic), im selben GitHub-Repository enthalten) wird als monolithische MVC-Anwendung ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="df1c7-124">A much-simplified version of eShopOnContainers (named [eShopWeb](https://github.com/dotnet-architecture/eShopOnContainers/tree/master/src/Web/WebMonolithic) and included in the same GitHub repository) runs as a monolithic MVC application.</span></span> <span data-ttu-id="df1c7-125">Wie gerade beschrieben, entstehen durch diese Entwurfsentscheidung Vorteile.</span><span class="sxs-lookup"><span data-stu-id="df1c7-125">As described, there are advantages offered by that design choice.</span></span> <span data-ttu-id="df1c7-126">Sie können die Quelle für diese Anwendung von GitHub herunterladen und diese lokal ausführen.</span><span class="sxs-lookup"><span data-stu-id="df1c7-126">You can download the source for this application from GitHub and run it locally.</span></span> <span data-ttu-id="df1c7-127">Auch die monolithische Anwendung profitiert von der Bereitstellung in einer Containerumgebung.</span><span class="sxs-lookup"><span data-stu-id="df1c7-127">Even this monolithic application benefits from being deployed in a container environment.</span></span>

<span data-ttu-id="df1c7-128">Durch die Containerumgebung wird jede Instanz der Anwendung in derselben Umgebung ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="df1c7-128">For one, the containerized deployment means that every instance of the application runs in the same environment.</span></span> <span data-ttu-id="df1c7-129">Dies schließt die Entwicklungsumgebung ein, in der das frühe Testen und die Entwicklung stattfinden.</span><span class="sxs-lookup"><span data-stu-id="df1c7-129">This includes the developer environment where early testing and development take place.</span></span> <span data-ttu-id="df1c7-130">Das Entwicklungsteam kann die Anwendung in einer Containerumgebung ausführen, die der Produktionsumgebung entspricht.</span><span class="sxs-lookup"><span data-stu-id="df1c7-130">The development team can run the application in a containerized environment that matches the production environment.</span></span>

<span data-ttu-id="df1c7-131">Zudem können Containeranwendungen zu geringeren Kosten skaliert werden.</span><span class="sxs-lookup"><span data-stu-id="df1c7-131">Also, containerized applications scale out at lower cost.</span></span> <span data-ttu-id="df1c7-132">Wie zuvor gezeigt wurde, ermöglicht die Containerumgebung eine größere Ressourcenfreigabe als die herkömmlichen VM-Umgebungen.</span><span class="sxs-lookup"><span data-stu-id="df1c7-132">As you saw earlier, the container environment enables greater resource sharing than traditional VM environments.</span></span>

<span data-ttu-id="df1c7-133">Schließlich erzwingt das Containerisieren einer Anwendung eine Trennung zwischen der Geschäftslogik und dem Speicherserver.</span><span class="sxs-lookup"><span data-stu-id="df1c7-133">Finally, containerizing the application forces a separation between the business logic and the storage server.</span></span> <span data-ttu-id="df1c7-134">Wenn die Anwendung skaliert wird, verwenden unterschiedliche Container ein einziges physisches Speichermedium.</span><span class="sxs-lookup"><span data-stu-id="df1c7-134">As the application scales out, the various containers will all rely on a single physical storage medium.</span></span> <span data-ttu-id="df1c7-135">In der Regel ist dieser Speicher ein Hochverfügbarkeitsserver, auf dem eine SQL Server-Datenbank ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="df1c7-135">This storage would typically be a high-availability server running a SQL Server database.</span></span>

## <a name="application-tour"></a><span data-ttu-id="df1c7-136">Überblick über die Anwendung</span><span class="sxs-lookup"><span data-stu-id="df1c7-136">Application tour</span></span>

<span data-ttu-id="df1c7-137">Die [eShopWeb](https://github.com/dotnet-architecture/eShopOnContainers/tree/master/src/Web/WebMonolithic)-Anwendung stellt einige der eShopOnContainers-Anwendungen dar, die als monolithische Anwendungen ausgeführt werden, und zwar eine auf ASP.NET Core MVC-basierte Anwendung, die auf .NET Core ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="df1c7-137">The [eShopWeb](https://github.com/dotnet-architecture/eShopOnContainers/tree/master/src/Web/WebMonolithic) application represents some of the eShopOnContainers application running as a monolithic application — an ASP.NET Core MVC-based application running on .NET Core.</span></span> <span data-ttu-id="df1c7-138">Wie im vorherigen Abschnitt beschrieben, stellt diese hauptsächlich die Funktionen zum Durchsuchen des Katalogs bereit.</span><span class="sxs-lookup"><span data-stu-id="df1c7-138">It mainly provides the catalog browsing capabilities as described in earlier sections.</span></span>

<span data-ttu-id="df1c7-139">Die Anwendung verwendet eine SQL Server-Datenbank für den Katalogspeicher.</span><span class="sxs-lookup"><span data-stu-id="df1c7-139">The application uses a SQL Server database for the catalog storage.</span></span> <span data-ttu-id="df1c7-140">In auf Containern basierten Bereitstellungen kann diese monolithische Anwendung auf denselben Datenspeicher wie die auf Microservices basierte Anwendung zugreifen.</span><span class="sxs-lookup"><span data-stu-id="df1c7-140">In container-based deployments, this monolithic application can access the same data store as the microservices-based application.</span></span> <span data-ttu-id="df1c7-141">Die Anwendung wird dafür konfiguriert, SQL Server in einem Container neben der monolithischen Anwendung auszuführen.</span><span class="sxs-lookup"><span data-stu-id="df1c7-141">The application is configured to run SQL Server in a container alongside the monolithic application.</span></span> <span data-ttu-id="df1c7-142">In einer Produktionsumgebung wird SQL Server auf einem Hochverfügbarkeitscomputer außerhalb des Docker-Hosts ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="df1c7-142">In a production environment, SQL Server would run on a high-availability machine, outside of the Docker host.</span></span> <span data-ttu-id="df1c7-143">Zur Vereinfachung wird empfohlen, SQL Server in einer Entwicklungs- oder Testumgebung in einem eigenen Container auszuführen.</span><span class="sxs-lookup"><span data-stu-id="df1c7-143">For convenience, in a development or test environment, running SQL Server in its own container is recommended.</span></span>

<span data-ttu-id="df1c7-144">Die anfänglich festgelegten Features ermöglichen nur das Durchsuchen des Katalogs.</span><span class="sxs-lookup"><span data-stu-id="df1c7-144">The initial feature set only enables browsing the catalog.</span></span> <span data-ttu-id="df1c7-145">Updates aktivieren die vollständige Featuregruppe der Containeranwendung.</span><span class="sxs-lookup"><span data-stu-id="df1c7-145">Updates would enable the full feature set of the containerized application.</span></span> <span data-ttu-id="df1c7-146">Eine erweiterte Architektur mit einer monolithischen Webanwendung wird im E-Book [ASP.NET Web Application architecture practices (Methoden zur ASP.NET-Webanwendungarchitektur)](https://aka.ms/webappebook) und der dazugehörenden [eShopOnWeb-Beispielanwendung](https://aka.ms/WebAppArchitecture) beschrieben.</span><span class="sxs-lookup"><span data-stu-id="df1c7-146">A more advanced monolithic web application architecture is described in the [ASP.NET Web Application architecture practices](https://aka.ms/webappebook) e-book and related [eShopOnWeb sample application](https://aka.ms/WebAppArchitecture).</span></span>

## <a name="docker-support"></a><span data-ttu-id="df1c7-147">Docker-Unterstützung</span><span class="sxs-lookup"><span data-stu-id="df1c7-147">Docker support</span></span>

<span data-ttu-id="df1c7-148">Das eShopOnWeb-Projekt wird auf .NET Core ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="df1c7-148">The eShopOnWeb project runs on .NET Core.</span></span> <span data-ttu-id="df1c7-149">Darum kann sie entweder auf Linux- oder auf Windows-basierten Containern ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="df1c7-149">That means it can run in either Linux-based or Windows-based containers.</span></span> <span data-ttu-id="df1c7-150">Beachten Sie, dass Sie für die Docker-Bereitstellung den gleichen Hosttyp für SQL Server verwenden sollten.</span><span class="sxs-lookup"><span data-stu-id="df1c7-150">Note that for Docker deployment, you want to use the same host type for SQL Server.</span></span> <span data-ttu-id="df1c7-151">Linux-basierte Container haben einen geringeren Speicherbedarf und werden bevorzugt.</span><span class="sxs-lookup"><span data-stu-id="df1c7-151">Linux-based containers allow a smaller footprint and are preferred.</span></span>

<span data-ttu-id="df1c7-152">Visual Studio stellt eine Projektvorlage bereit, die die Unterstützung von Docker zu einer Projektmappe hinzufügt.</span><span class="sxs-lookup"><span data-stu-id="df1c7-152">Visual Studio provides a project template that adds support for Docker to a solution.</span></span> <span data-ttu-id="df1c7-153">Klicken Sie mit der rechten Maustaste auf das Projekt und dann auf **Hinzufügen** und **Docker-Unterstützung**.</span><span class="sxs-lookup"><span data-stu-id="df1c7-153">You right-click the project, click **Add** followed by **Docker Support**.</span></span> <span data-ttu-id="df1c7-154">Die Vorlage fügt eine Dockerfile und ein neues **Docker-Compose**-Projekt, das die Startdatei *docker-compose.yml* bereitstellt, zu Ihrem Projekt hinzu.</span><span class="sxs-lookup"><span data-stu-id="df1c7-154">The template adds a Dockerfile to your project, and a new **docker-compose** project that provides a starter *docker-compose.yml* file.</span></span> <span data-ttu-id="df1c7-155">Dieser Schritt wurde bereits in dem eShopOnWeb-Projekt durchgeführt, das von GitHub heruntergeladen wurde.</span><span class="sxs-lookup"><span data-stu-id="df1c7-155">This step has already been done in the eShopOnWeb project downloaded from GitHub.</span></span> <span data-ttu-id="df1c7-156">Es wird angezeigt, dass die Projektmappe die Projekte **eShopOnWeb** und **Docker-Compose** wie in Abbildung 6-1 dargestellt enthält.</span><span class="sxs-lookup"><span data-stu-id="df1c7-156">You can see that the solution contains the **eShopOnWeb** project and the **docker-compose** project as shown in Figure 6-1.</span></span>

![](./media/image1.png)

<span data-ttu-id="df1c7-157">**Abbildung 6-1**.</span><span class="sxs-lookup"><span data-stu-id="df1c7-157">**Figure 6-1**.</span></span> <span data-ttu-id="df1c7-158">Das **Docker-Compose**-Projekt in einer einzigen Container-Webanwendung</span><span class="sxs-lookup"><span data-stu-id="df1c7-158">The **docker-compose** project in a single-container web application</span></span>

<span data-ttu-id="df1c7-159">Bei diesen Dateien handelt es sich um Standarddateien von Docker-Compose, die mit jedem Docker-Projekt konsistent sind.</span><span class="sxs-lookup"><span data-stu-id="df1c7-159">These files are standard docker-compose files, consistent with any Docker project.</span></span> <span data-ttu-id="df1c7-160">Sie können diese mit Visual Studio oder über die Befehlszeile verwenden.</span><span class="sxs-lookup"><span data-stu-id="df1c7-160">You can use them with Visual Studio or from the command line.</span></span> <span data-ttu-id="df1c7-161">Diese Anwendung wird in .NET Core ausgeführt und verwendet Linux-Container.</span><span class="sxs-lookup"><span data-stu-id="df1c7-161">This application runs on .NET Core and uses Linux containers.</span></span> <span data-ttu-id="df1c7-162">Sie können sie also auf einem Mac- oder Linux-Computer programmieren, erstellen und ausführen.</span><span class="sxs-lookup"><span data-stu-id="df1c7-162">So, you can also code, build, and run it on a Mac or on a Linux machine.</span></span>

<span data-ttu-id="df1c7-163">Die Datei *docker-compose.yml* enthält Informationen darüber, welche Images erstellt und welche Container gestartet werden müssen.</span><span class="sxs-lookup"><span data-stu-id="df1c7-163">The *docker-compose.yml* file contains information about what images to build and what containers to launch.</span></span> <span data-ttu-id="df1c7-164">Die Vorlagen geben an, wie das `eshopweb`-Image erstellt und der Container der Anwendung ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="df1c7-164">The templates specify how to build the `eshopweb` image and launch the application’s containers.</span></span> <span data-ttu-id="df1c7-165">Sie müssen die Abhängigkeit von SQL Server hinzufügen, indem Sie ein Image (z.B. `mssql-server-linux`) integrieren sowie einen Dienst für das Image „sql.data“, damit Docker diesen Container erstellen und starten kann.</span><span class="sxs-lookup"><span data-stu-id="df1c7-165">You need to add the dependency on SQL Server by including an image for it (for example, `mssql-server-linux`), and a service for the sql.data image for Docker to build and launch that container.</span></span> <span data-ttu-id="df1c7-166">Diese Einstellungen sind im folgenden Beispiel dargestellt:</span><span class="sxs-lookup"><span data-stu-id="df1c7-166">These settings are shown in the following example:</span></span>

```yml
version: '2'

services:
  eshopweb:
    image: eshop/web
    build:
    context: ./eShopWeb
    dockerfile: Dockerfile
    depends_on:
      - sql.data

  sql.data:
    image: microsoft/mssql-server-linux
```

<span data-ttu-id="df1c7-167">Die Anweisung `depends_on` teilt Docker mit, dass das eShopWeb-Image vom sql.data-Image abhängig ist.</span><span class="sxs-lookup"><span data-stu-id="df1c7-167">The `depends_on` directive tells Docker that the eShopWeb image depends on the sql.data image.</span></span> <span data-ttu-id="df1c7-168">Die Zeilen unter `depends_on` sind die Anweisungen zum Erstellen des Images `sql.data` mithilfe des Images `microsoft/mssql-server-linux`.</span><span class="sxs-lookup"><span data-stu-id="df1c7-168">The lines below `depends_on` are the instructions to build an image tagged `sql.data` using the `microsoft/mssql-server-linux` image.</span></span>

<span data-ttu-id="df1c7-169">Das **Docker-Compose**-Projekt zeigt die anderen Docker-Compose-Dateien unter dem Hauptknoten *docker-compose.yml* an, damit die Verknüpfung dieser Dateien erkennbar ist.</span><span class="sxs-lookup"><span data-stu-id="df1c7-169">The **docker-compose** project displays the other docker-compose files under the main *docker-compose.yml* node to provide a visual indication that these files are related.</span></span> <span data-ttu-id="df1c7-170">Die Datei *docker-compose-override.yml* enthält Einstellungen für beide Dienste, z.B. Verbindungszeichenfolgen und andere Anwendungseinstellungen.</span><span class="sxs-lookup"><span data-stu-id="df1c7-170">The *docker-compose-override.yml* file contains settings for both services, such as connection strings and other application settings.</span></span>

<span data-ttu-id="df1c7-171">Das folgende Beispiel zeigt die Datei *docker-compose.vs.debug.yml*, die Einstellungen enthält, die für das Debuggen in Visual Studio verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="df1c7-171">The following example shows the *docker-compose.vs.debug.yml* file, which contains settings used for debugging in Visual Studio.</span></span> <span data-ttu-id="df1c7-172">In dieser Datei ist dem eShopWeb-Image der Entwicklungstag angefügt.</span><span class="sxs-lookup"><span data-stu-id="df1c7-172">In that file, the eshopweb image has the dev tag appended to it.</span></span> <span data-ttu-id="df1c7-173">Dadurch können Debug-Images besser von Release-Images getrennt werden, sodass Sie die Debuginformationen nicht versehentlich in einer Produktionsumgebung bereitstellen:</span><span class="sxs-lookup"><span data-stu-id="df1c7-173">That helps separate debug from release images so that you don't accidentally deploy the debug information to a production environment:</span></span>

```yml
version: '2'

services:
  eshopweb:
    image: eshop/web:dev
    build:
    args:
    source: ${DOCKER_BUILD_SOURCE}
    environment:
      - DOTNET_USE_POLLING_FILE_WATCHER=1
    volumes:
      - ./eShopWeb:/app
      - ~/.nuget/packages:/root/.nuget/packages:ro
      - ~/clrdbg:/clrdbg:ro
    entrypoint: tail -f /dev/null
    labels:
      - "com.microsoft.visualstudio.targetoperatingsystem=linux"
```

<span data-ttu-id="df1c7-174">Die letzte hinzugefügte Datei ist *docker-compose.ci.build.yml*.</span><span class="sxs-lookup"><span data-stu-id="df1c7-174">The last file added is *docker-compose.ci.build.yml*.</span></span> <span data-ttu-id="df1c7-175">Diese Datei wird über die Befehlszeile verwendet, um das Projekt von einem CI-Server zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="df1c7-175">This file would be used from the command line to build the project from a CI server.</span></span> <span data-ttu-id="df1c7-176">Diese compose-Datei startet einen Docker-Container, der das für die Anwendung benötigte Image erstellt.</span><span class="sxs-lookup"><span data-stu-id="df1c7-176">This compose file starts a Docker container that builds the images needed for your application.</span></span> <span data-ttu-id="df1c7-177">Das folgende Beispiel zeigt die Inhalte der Datei *docker-compose.ci.build.yml*.</span><span class="sxs-lookup"><span data-stu-id="df1c7-177">The following example shows the contents of the *docker-compose.ci.build.yml* file:</span></span>

```yml
version: '2'

services:
  ci-build:
    image: microsoft/aspnetcore-build:latest
    volumes:
      - .:/src
    working_dir: /src
  command: /bin/bash -c "dotnet restore ./eShopWeb.sln && dotnet publish  ./eShopWeb.sln -c Release -o ./obj/Docker/publish"
```

> [!NOTE]
> <span data-ttu-id="df1c7-178">Ab .NET Core 2.0 wird der Befehl [dotnet restore](../../../core/tools/dotnet-restore.md) automatisch beim Ausführen von [dotnet publish](../../../core/tools/dotnet-publish.md) ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="df1c7-178">Starting with .NET Core SDK 2.0, the [dotnet restore](../../../core/tools/dotnet-restore.md) command executes automatically when [dotnet publish](../../../core/tools/dotnet-publish.md) is executed.</span></span>

<span data-ttu-id="df1c7-179">Beachten Sie, dass das Image ein ASP.NET Core-Buildimage ist.</span><span class="sxs-lookup"><span data-stu-id="df1c7-179">Notice that the image is an ASP.NET Core build image.</span></span> <span data-ttu-id="df1c7-180">Dieses Image enthält das SDK und Buildtools, um Ihre Anwendung und die erforderlichen Images zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="df1c7-180">That image includes the SDK and build tools to build your application and create the required images.</span></span> <span data-ttu-id="df1c7-181">Das Ausführen des **Docker-Compose**-Projekts mit dieser Datei startet den Buildcontainer aus dem Image und erstellt dann das Image der Anwendung in diesem Container.</span><span class="sxs-lookup"><span data-stu-id="df1c7-181">Running the **docker-compose** project using this file starts the build container from the image, then builds your application’s image in that container.</span></span> <span data-ttu-id="df1c7-182">Sie geben die *Docker-Compose*-Datei als Teil der Befehlszeile an, um Ihre Anwendung in einem Docker-Container zu erstellen und diese anschließend zu starten.</span><span class="sxs-lookup"><span data-stu-id="df1c7-182">You specify that *docker-compose* file as part of the command line to build your application in a Docker container, then launch it.</span></span>

<span data-ttu-id="df1c7-183">In Visual Studio können Sie Ihre Anwendung in Docker-Containern starten, indem Sie das **Docker-Compose**-Projekt als Startprojekt auswählen und dann wie bei jeder anderen Anwendung STRG+F5 (F5 zum Debuggen) drücken.</span><span class="sxs-lookup"><span data-stu-id="df1c7-183">In Visual Studio, you can run your application in Docker containers by selecting the **docker-compose** project as the startup project, and then pressing Ctrl+F5 (F5 to debug), as you can with any other application.</span></span> <span data-ttu-id="df1c7-184">Wenn Sie das **Docker-Compose**-Projekt starten, führt Visual Studio **Docker-Compose** mithilfe der Dateien *docker-compose.yml* und *docker-compose.override.yml* sowie einer der docker-compose.vs.\*-Dateien aus.</span><span class="sxs-lookup"><span data-stu-id="df1c7-184">When you start the **docker-compose** project, Visual Studio runs **docker-compose** using the *docker-compose.yml* file, the *docker-compose.override.yml* file, and one of the docker-compose.vs.\* files.</span></span> <span data-ttu-id="df1c7-185">Nachdem die Anwendung gestartet wurde, startet Visual Studio den Browser für Sie.</span><span class="sxs-lookup"><span data-stu-id="df1c7-185">Once the application has started, Visual Studio launches the browser for you.</span></span>

<span data-ttu-id="df1c7-186">Wenn Sie die Anwendung im Debugger ausführen, wird Visual Studio an die ausgeführte Anwendung in Docker angefügt.</span><span class="sxs-lookup"><span data-stu-id="df1c7-186">If you launch the application in the debugger, Visual Studio attaches to the running application in Docker.</span></span>

## <a name="troubleshooting"></a><span data-ttu-id="df1c7-187">Problembehandlung</span><span class="sxs-lookup"><span data-stu-id="df1c7-187">Troubleshooting</span></span>

<span data-ttu-id="df1c7-188">Dieser Abschnitt beschreibt einige Probleme, die auftreten können, wenn Sie Container lokal ausführen und schlägt einige Lösungen vor.</span><span class="sxs-lookup"><span data-stu-id="df1c7-188">This section describes a few issues that might arise when your run containers locally and suggests some fixes.</span></span>

### <a name="stop-docker-containers"></a><span data-ttu-id="df1c7-189">Anhalten von Docker-Containern</span><span class="sxs-lookup"><span data-stu-id="df1c7-189">Stop Docker containers</span></span>

<span data-ttu-id="df1c7-190">Nachdem Sie die Containeranwendung gestartet haben, wird der Container weiter ausgeführt, auch nachdem Sie das Debuggen beendet haben.</span><span class="sxs-lookup"><span data-stu-id="df1c7-190">After you launch the containerized application, the containers continue to run, even after you have stopped debugging.</span></span> <span data-ttu-id="df1c7-191">Sie können den Befehl `docker ps` von der Befehlszeile aus ausführen, um die ausgeführten Container anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="df1c7-191">You can run the `docker ps` command from the command line to see which containers are running.</span></span> <span data-ttu-id="df1c7-192">Der Befehl `docker stop` hält wie in Abbildung 6-2 gezeigt den ausgeführten Container an.</span><span class="sxs-lookup"><span data-stu-id="df1c7-192">The `docker stop` command stops a running container, as shown in Figure 6-2.</span></span>

![](./media/image2.png)

<span data-ttu-id="df1c7-193">**Abbildung 6-2**.</span><span class="sxs-lookup"><span data-stu-id="df1c7-193">**Figure 6-2**.</span></span> <span data-ttu-id="df1c7-194">Auflisten und Anhalten von Containern mit den CLI-Befehlen „docker ps“ und „docker stop“</span><span class="sxs-lookup"><span data-stu-id="df1c7-194">Listing and stopping containers with the docker ps and docker stop CLI commands</span></span>

<span data-ttu-id="df1c7-195">Sie sollten ausgeführte Prozesse beenden, wenn Sie zwischen verschiedenen Konfigurationen wechseln.</span><span class="sxs-lookup"><span data-stu-id="df1c7-195">You might need to stop running processes when you switch between different configurations.</span></span> <span data-ttu-id="df1c7-196">Andernfalls verwendet der Container, der die Webanwendung ausführt, den Port für Ihre Anwendung (in diesem Beispiel 5106).</span><span class="sxs-lookup"><span data-stu-id="df1c7-196">Otherwise, the container that is running the web application is using the port for your application (5106 in this example).</span></span>

### <a name="add-docker-to-your-projects"></a><span data-ttu-id="df1c7-197">Hinzufügen von Docker zu Ihren Projekten</span><span class="sxs-lookup"><span data-stu-id="df1c7-197">Add Docker to your projects</span></span>

<span data-ttu-id="df1c7-198">Der Assistent, der die Docker-Unterstützung hinzufügt, kommuniziert mit dem ausgeführten Docker-Prozess.</span><span class="sxs-lookup"><span data-stu-id="df1c7-198">The wizard that adds Docker support communicates with the running Docker process.</span></span> <span data-ttu-id="df1c7-199">Der Assistent wird nicht ordnungsgemäß ausgeführt, wenn Docker beim Starten des Assistenten nicht ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="df1c7-199">If Docker isn't running when you start the wizard, the wizard won't run correctly.</span></span> <span data-ttu-id="df1c7-200">Der Assistent überprüft Ihre aktuelle Containerwahl, um die richtige Docker-Unterstützung hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="df1c7-200">The wizard examines your current container choice to add the correct Docker support.</span></span> <span data-ttu-id="df1c7-201">Führen Sie den Assistenten aus, während Docker mit der Konfiguration für Windows-Container ausgeführt wird, um Unterstützung für Windows-Container hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="df1c7-201">To add support for Windows Containers, run the wizard while you have Docker running with Windows Containers configured.</span></span> <span data-ttu-id="df1c7-202">Führen Sie den Assistenten aus, während Docker mit der Konfiguration für Linux-Container ausgeführt wird, um Unterstützung für Linux-Container hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="df1c7-202">To add support for Linux containers, run the wizard while you have Docker running with Linux containers configured.</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="df1c7-203">[Zurück](../docker-application-development-process/docker-app-development-workflow.md)
[Weiter](../containerize-net-framework-applications/index.md)</span><span class="sxs-lookup"><span data-stu-id="df1c7-203">[Previous](../docker-application-development-process/docker-app-development-workflow.md)
[Next](../containerize-net-framework-applications/index.md)</span></span>
