---
title: "Strategien für die Behandlung von teilweise fehlerhaft."
description: ".NET Microservices Architektur für Datenvolumes .NET-Anwendungen | Strategien für die Behandlung von teilweise fehlerhaft."
keywords: Docker, Microservices, ASP.NET, Container
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 05/26/2017
ms.prod: .net-core
ms.technology: dotnet-docker
ms.topic: article
ms.openlocfilehash: ff3bed530b13a9b1822c7cccf5a4d47df6fc6239
ms.sourcegitcommit: bd1ef61f4bb794b25383d3d72e71041a5ced172e
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 10/18/2017
---
# <a name="strategies-for-handling-partial-failure"></a><span data-ttu-id="71ef4-104">Strategien für die Behandlung von teilweise fehlerhaft.</span><span class="sxs-lookup"><span data-stu-id="71ef4-104">Strategies for handling partial failure</span></span>

<span data-ttu-id="71ef4-105">Strategien für den Umgang mit teilfehlern zählen den folgende:</span><span class="sxs-lookup"><span data-stu-id="71ef4-105">Strategies for dealing with partial failures include the following.</span></span>

<span data-ttu-id="71ef4-106">**Verwenden Sie asynchronen Kommunikation (z. B. die meldungsbasierte Kommunikation) über interne Microservices**.</span><span class="sxs-lookup"><span data-stu-id="71ef4-106">**Use asynchronous communication (for example, message-based communication) across internal microservices**.</span></span> <span data-ttu-id="71ef4-107">Es wird dringend empfohlen, nicht zu lange statusketten synchronen HTTP-Aufrufen über die interne Microservices erstellt werden, da dieser falsche Entwurf schließlich die Hauptursache für fehlerhafte Ausfälle werden soll.</span><span class="sxs-lookup"><span data-stu-id="71ef4-107">It is highly advisable not to create long chains of synchronous HTTP calls across the internal microservices because that incorrect design will eventually become the main cause of bad outages.</span></span> <span data-ttu-id="71ef4-108">Im Gegensatz dazu, mit Ausnahme der Front-End-Kommunikation zwischen Clientanwendungen und die erste Ebene des Microservices oder differenzierte-API-Gateways, es wird empfohlen, nur asynchrone (nachrichtenbasierte) Kommunikation erfolgt einmal nach der ursprünglichen Anforderung / Antwort-Zyklus, über die interne Microservices.</span><span class="sxs-lookup"><span data-stu-id="71ef4-108">On the contrary, except for the front-end communications between the client applications and the first level of microservices or fine-grained API Gateways, it is recommended to use only asynchronous (message-based) communication once past the initial request/response cycle, across the internal microservices.</span></span> <span data-ttu-id="71ef4-109">Eventuelle Konsistenz und ereignisgesteuerte Architekturen hilft um Ripple Auswirkungen zu minimieren.</span><span class="sxs-lookup"><span data-stu-id="71ef4-109">Eventual consistency and event-driven architectures will help to minimize ripple effects.</span></span> <span data-ttu-id="71ef4-110">Diese Ansätze erzwingen ein höheres Maß an Microservice Autonomie und daher gegen die hier erwähnt Problem verhindern.</span><span class="sxs-lookup"><span data-stu-id="71ef4-110">These approaches enforce a higher level of microservice autonomy and therefore prevent against the problem noted here.</span></span>

<span data-ttu-id="71ef4-111">**Verwenden von Wiederholungen mit exponenzieller**.</span><span class="sxs-lookup"><span data-stu-id="71ef4-111">**Use retries with exponential backoff**.</span></span> <span data-ttu-id="71ef4-112">Mit dieser Technik können um kurze zu vermeiden, und zwischenzeitliche Fehler die Ursache anhand der Aufruf wiederholt eine bestimmte Anzahl von Malen, aus, für den Fall, dass der Dienst nicht nur für kurze Zeit verfügbar war.</span><span class="sxs-lookup"><span data-stu-id="71ef4-112">This technique helps to avoid short and intermittent failures by performing call retries a certain number of times, in case the service was not available only for a short time.</span></span> <span data-ttu-id="71ef4-113">Dies kann auftreten, aufgrund von vorübergehenden Netzwerkproblemen oder wenn ein Microservice/Container auf einen anderen Knoten in einem Cluster verschoben wird.</span><span class="sxs-lookup"><span data-stu-id="71ef4-113">This might occur due to intermittent network issues or when a microservice/container is moved to a different node in a cluster.</span></span> <span data-ttu-id="71ef4-114">Jedoch, wenn diese Wiederholungen nicht ordnungsgemäß mit Trennschalter vorgesehen sind, es kann Vorteile die Effekte Ripple letztendlich auch führte dazu, dass eine [Denial of Service (DoS)](https://en.wikipedia.org/wiki/Denial-of-service_attack).</span><span class="sxs-lookup"><span data-stu-id="71ef4-114">However, if these retries are not designed properly with circuit breakers, it can aggravate the ripple effects, ultimately even causing a [Denial of Service (DoS)](https://en.wikipedia.org/wiki/Denial-of-service_attack).</span></span>

<span data-ttu-id="71ef4-115">**Umgehung von Netzwerktimeouts**.</span><span class="sxs-lookup"><span data-stu-id="71ef4-115">**Work around network timeouts**.</span></span> <span data-ttu-id="71ef4-116">Clients sollten im Allgemeinen nicht auf unbestimmte Zeit blockiert und Timeouts beim Warten auf einer Antwort entworfen werden.</span><span class="sxs-lookup"><span data-stu-id="71ef4-116">In general, clients should be designed not to block indefinitely and to always use timeouts when waiting for a response.</span></span> <span data-ttu-id="71ef4-117">Verwenden von Timeouts wird sichergestellt, dass Ressourcen nie unbegrenzt gebunden sind.</span><span class="sxs-lookup"><span data-stu-id="71ef4-117">Using timeouts ensures that resources are never tied up indefinitely.</span></span>

<span data-ttu-id="71ef4-118">**Verwenden Sie einen Trennschalter**.</span><span class="sxs-lookup"><span data-stu-id="71ef4-118">**Use the Circuit Breaker pattern**.</span></span> <span data-ttu-id="71ef4-119">Bei diesem Ansatz verfolgt der Prozess die Anzahl der fehlerhaften Anforderungen.</span><span class="sxs-lookup"><span data-stu-id="71ef4-119">In this approach, the client process tracks the number of failed requests.</span></span> <span data-ttu-id="71ef4-120">Wenn die Fehlerrate einer konfigurierte Limit, ein "Circuit-Breaker" Roundtrips überschreitet, damit weitere Versuche sofort einen Fehler auslösen.</span><span class="sxs-lookup"><span data-stu-id="71ef4-120">If the error rate exceeds a configured limit, a “circuit breaker” trips so that further attempts fail immediately.</span></span> <span data-ttu-id="71ef4-121">(Wenn eine große Anzahl von Anforderungen fehlschlägt, schlägt vor, die der Dienst nicht verfügbar ist, und Senden von Anforderungen nicht sinnvoll ist.) Nach Ablauf eines Timeouts der Client sollte versuchen Sie es erneut und, wenn neuen Anforderungen erfolgreich ist, schließen Sie der Trennschalter.</span><span class="sxs-lookup"><span data-stu-id="71ef4-121">(If a large number of requests are failing, that suggests the service is unavailable and that sending requests is pointless.) After a timeout period, the client should try again and, if the new requests are successful, close the circuit breaker.</span></span>

<span data-ttu-id="71ef4-122">**Bereitstellen der Zugriffe**.</span><span class="sxs-lookup"><span data-stu-id="71ef4-122">**Provide fallbacks**.</span></span> <span data-ttu-id="71ef4-123">Bei diesem Ansatz führt Clientprozess Fallbacklogik, wenn eine Anforderung fehlschlägt, z. B. das Zurückgeben der zwischengespeicherten Daten oder einen Standardwert.</span><span class="sxs-lookup"><span data-stu-id="71ef4-123">In this approach, the client process performs fallback logic when a request fails, such as returning cached data or a default value.</span></span> <span data-ttu-id="71ef4-124">Dies ist ein Ansatz für Abfragen geeignet, und ist komplexer nach Updates oder Befehle.</span><span class="sxs-lookup"><span data-stu-id="71ef4-124">This is an approach suitable for queries, and is more complex for updates or commands.</span></span>

<span data-ttu-id="71ef4-125">**Die Anzahl der Anforderungen in der Warteschlange**.</span><span class="sxs-lookup"><span data-stu-id="71ef4-125">**Limit the number of queued requests**.</span></span> <span data-ttu-id="71ef4-126">Clients sollten auch eine Obergrenze für die Anzahl der ausstehenden Anforderungen vorgeben, die ein Client Microservice an einen bestimmten Dienst senden kann.</span><span class="sxs-lookup"><span data-stu-id="71ef4-126">Clients should also impose an upper bound on the number of outstanding requests that a client microservice can send to a particular service.</span></span> <span data-ttu-id="71ef4-127">Wenn der Grenzwert erreicht wurde, ist es wahrscheinlich nicht sinnvoll, um zusätzliche Anforderungen zu erstellen und diese Versuche sollte sofort einen Fehler verursachen.</span><span class="sxs-lookup"><span data-stu-id="71ef4-127">If the limit has been reached, it is probably pointless to make additional requests, and those attempts should fail immediately.</span></span> <span data-ttu-id="71ef4-128">Im Hinblick auf die Implementierung, die Polly [sein Isolation](https://github.com/App-vNext/Polly/wiki/Bulkhead) Richtlinie kann verwendet werden, um diese Anforderung zu erfüllen.</span><span class="sxs-lookup"><span data-stu-id="71ef4-128">In terms of implementation, the Polly [Bulkhead Isolation](https://github.com/App-vNext/Polly/wiki/Bulkhead) policy can be used to fulfil this requirement.</span></span> <span data-ttu-id="71ef4-129">Dieser Ansatz ist im Wesentlichen eine Parallelisierung Drosselung mit [SemaphoreSlim](https://docs.microsoft.com/dotnet/api/system.threading.semaphoreslim?view=netcore-1.1) als Implementierung.</span><span class="sxs-lookup"><span data-stu-id="71ef4-129">This approach is essentially a parallelization throttle with [SemaphoreSlim](https://docs.microsoft.com/dotnet/api/system.threading.semaphoreslim?view=netcore-1.1) as the implementation.</span></span> <span data-ttu-id="71ef4-130">Es kann außerdem eine "Queue" außerhalb der sein.</span><span class="sxs-lookup"><span data-stu-id="71ef4-130">It also permits a "queue" outside the bulkhead.</span></span> <span data-ttu-id="71ef4-131">Sie können proaktiv übermäßige Auslastung auch vor der Ausführung ausgeschieden (z. B. weil Kapazität vollständige wiederhergestellt werden kann).</span><span class="sxs-lookup"><span data-stu-id="71ef4-131">You can proactively shed excess load even before execution (for example, because capacity is deemed full).</span></span> <span data-ttu-id="71ef4-132">Dadurch wird schneller als ein Trennschalter wäre, da der Trennschalter wartet, bis die Fehler, die als Antwort auf bestimmte Fehlerszenarien.</span><span class="sxs-lookup"><span data-stu-id="71ef4-132">This makes its response to certain failure scenarios faster than a circuit breaker would be, since the circuit breaker waits for the failures.</span></span> <span data-ttu-id="71ef4-133">Das Objekt BulkheadPolicy in Polly verfügbar macht, wie voll sein Warteschlange sind und Angebote Ereignisse bei einem Überlauf daher können auch verwendet werden um automatisierte horizontale Skalierung zu erzielen.</span><span class="sxs-lookup"><span data-stu-id="71ef4-133">The BulkheadPolicy object in Polly exposes how full the bulkhead and queue are, and offers events on overflow so can also be used to drive automated horizontal scaling.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="71ef4-134">Zusätzliche Ressourcen</span><span class="sxs-lookup"><span data-stu-id="71ef4-134">Additional resources</span></span>

-   <span data-ttu-id="71ef4-135">**Stabilität Muster**
    [*https://docs.microsoft.com/azure/architecture/patterns/category/resiliency*](https://docs.microsoft.com/azure/architecture/patterns/category/resiliency)</span><span class="sxs-lookup"><span data-stu-id="71ef4-135">**Resiliency patterns**
[*https://docs.microsoft.com/azure/architecture/patterns/category/resiliency*](https://docs.microsoft.com/azure/architecture/patterns/category/resiliency)</span></span>

-   <span data-ttu-id="71ef4-136">**Hinzufügen von Flexibilität und Optimieren der Leistung**
    [*https://msdn.microsoft.com/en-us/library/jj591574.aspx*](https://msdn.microsoft.com/en-us/library/jj591574.aspx)</span><span class="sxs-lookup"><span data-stu-id="71ef4-136">**Adding Resilience and Optimizing Performance**
[*https://msdn.microsoft.com/en-us/library/jj591574.aspx*](https://msdn.microsoft.com/en-us/library/jj591574.aspx)</span></span>

-   <span data-ttu-id="71ef4-137">**Sein.**</span><span class="sxs-lookup"><span data-stu-id="71ef4-137">**Bulkhead.**</span></span> <span data-ttu-id="71ef4-138">GitHub-Repository.</span><span class="sxs-lookup"><span data-stu-id="71ef4-138">GitHub repo.</span></span> <span data-ttu-id="71ef4-139">Implementierung mit Polly Richtlinie. \\</span><span class="sxs-lookup"><span data-stu-id="71ef4-139">Implementation with Polly policy.\\</span></span>
    [<span data-ttu-id="71ef4-140">*https://github.com/App-vNext/Polly/Wiki/Bulkhead*</span><span class="sxs-lookup"><span data-stu-id="71ef4-140">*https://github.com/App-vNext/Polly/wiki/Bulkhead*</span></span>](https://github.com/App-vNext/Polly/wiki/Bulkhead)

-   <span data-ttu-id="71ef4-141">**Entwerfen von robusten Anwendungen für Azure**
    [*https://docs.microsoft.com/azure/architecture/resiliency/*](https://docs.microsoft.com/azure/architecture/resiliency/)</span><span class="sxs-lookup"><span data-stu-id="71ef4-141">**Designing resilient applications for Azure**
[*https://docs.microsoft.com/azure/architecture/resiliency/*](https://docs.microsoft.com/azure/architecture/resiliency/)</span></span>

-   <span data-ttu-id="71ef4-142">**Behandlung vorübergehender Fehler**
    <https://docs.microsoft.com/azure/architecture/best-practices/transient-faults></span><span class="sxs-lookup"><span data-stu-id="71ef4-142">**Transient fault handling**
<https://docs.microsoft.com/azure/architecture/best-practices/transient-faults></span></span>


>[!div class="step-by-step"]
<span data-ttu-id="71ef4-143">[Vorherigen] (Handle-Partial-failure.md) [weiter] (implementieren-Wiederholungen-exponentiellen-backoff.md)</span><span class="sxs-lookup"><span data-stu-id="71ef4-143">[Previous] (handle-partial-failure.md) [Next] (implement-retries-exponential-backoff.md)</span></span>
