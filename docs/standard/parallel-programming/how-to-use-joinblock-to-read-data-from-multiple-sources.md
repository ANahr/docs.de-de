---
title: 'Gewusst wie: JoinBlock zum Lesen aus mehreren Quellen verwenden'
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-standard
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- csharp
- vb
helpviewer_keywords:
- Task Parallel Library, dataflows
- TPL dataflow library, joining blocks in
- dataflow blocks, joining in TPL
ms.assetid: e9c1ada4-ac57-4704-87cb-2f5117f8151d
caps.latest.revision: "7"
author: rpetrusha
ms.author: ronpet
manager: wpickett
ms.openlocfilehash: 41445e4874b94809840ecf9ebda6f27ccc955c9b
ms.sourcegitcommit: bd1ef61f4bb794b25383d3d72e71041a5ced172e
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 10/18/2017
---
# <a name="how-to-use-joinblock-to-read-data-from-multiple-sources"></a><span data-ttu-id="c8ad0-102">Gewusst wie: JoinBlock zum Lesen aus mehreren Quellen verwenden</span><span class="sxs-lookup"><span data-stu-id="c8ad0-102">How to: Use JoinBlock to Read Data From Multiple Sources</span></span>
<span data-ttu-id="c8ad0-103">Dieses Dokument erläutert die Verwendung der <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> Klasse, um einen Vorgang auszuführen, wenn Daten aus mehreren Quellen verfügbar sind.</span><span class="sxs-lookup"><span data-stu-id="c8ad0-103">This document explains how to use the <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> class to perform an operation when data is available from multiple sources.</span></span> <span data-ttu-id="c8ad0-104">Es wird veranschaulicht, wie nicht gierigen Modus zu verwenden, um mehrere gruppierungsblöcke eine Datenquelle effizienter gemeinsam verwenden können.</span><span class="sxs-lookup"><span data-stu-id="c8ad0-104">It also demonstrates how to use non-greedy mode to enable multiple join blocks to share a data source more efficiently.</span></span>  
  
> [!TIP]
>  <span data-ttu-id="c8ad0-105">Die TPL-Datenflussbibliothek (<xref:System.Threading.Tasks.Dataflow?displayProperty=nameWithType>-Namespace) ist nicht in [!INCLUDE[net_v45](../../../includes/net-v45-md.md)] enthalten.</span><span class="sxs-lookup"><span data-stu-id="c8ad0-105">The TPL Dataflow Library (<xref:System.Threading.Tasks.Dataflow?displayProperty=nameWithType> namespace) is not distributed with the [!INCLUDE[net_v45](../../../includes/net-v45-md.md)].</span></span> <span data-ttu-id="c8ad0-106">Öffnen Sie zum Installieren des <xref:System.Threading.Tasks.Dataflow>-Namespace das Projekt in [!INCLUDE[vs_dev11_long](../../../includes/vs-dev11-long-md.md)], wählen Sie im Menü "Projekt" die Option **NuGet-Pakete verwalten** aus, und suchen Sie online nach dem `Microsoft.Tpl.Dataflow` -Paket.</span><span class="sxs-lookup"><span data-stu-id="c8ad0-106">To install the <xref:System.Threading.Tasks.Dataflow> namespace, open your project in [!INCLUDE[vs_dev11_long](../../../includes/vs-dev11-long-md.md)], choose **Manage NuGet Packages** from the Project menu, and search online for the `Microsoft.Tpl.Dataflow` package.</span></span>  
  
## <a name="example"></a><span data-ttu-id="c8ad0-107">Beispiel</span><span class="sxs-lookup"><span data-stu-id="c8ad0-107">Example</span></span>  
 <span data-ttu-id="c8ad0-108">Das folgende Beispiel definiert drei Ressourcentypen, `NetworkResource`, `FileResource`, und `MemoryResource`, und Vorgänge ausführt, wenn Ressourcen verfügbar werden.</span><span class="sxs-lookup"><span data-stu-id="c8ad0-108">The following example defines three resource types, `NetworkResource`, `FileResource`, and `MemoryResource`, and performs operations when resources become available.</span></span> <span data-ttu-id="c8ad0-109">Dieses Beispiel benötigen Sie ein `NetworkResource` und `MemoryResource` Paar, um den ersten Vorgang auszuführen und ein `FileResource` und `MemoryResource` Paar, um den zweiten Vorgang auszuführen.</span><span class="sxs-lookup"><span data-stu-id="c8ad0-109">This example requires a `NetworkResource` and `MemoryResource` pair in order to perform the first operation and a `FileResource` and `MemoryResource` pair in order to perform the second operation.</span></span> <span data-ttu-id="c8ad0-110">Damit kann diese Vorgänge auftreten, wenn alle erforderliche Ressourcen verfügbar sind, in diesem Beispiel verwendet die <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> Klasse.</span><span class="sxs-lookup"><span data-stu-id="c8ad0-110">To enable these operations to occur when all required resources are available, this example uses the <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> class.</span></span> <span data-ttu-id="c8ad0-111">Wenn eine <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> Objekt empfängt Daten aus allen Quellen, die es überträgt diese Daten an das Ziel, die in diesem Beispiel wird ein <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> Objekt.</span><span class="sxs-lookup"><span data-stu-id="c8ad0-111">When a <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> object receives data from all sources, it propagates that data to its target, which in this example is an <xref:System.Threading.Tasks.Dataflow.ActionBlock%601> object.</span></span> <span data-ttu-id="c8ad0-112">Beide <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> Objekte zu lesen, aus einem freigegebenen Pool `MemoryResource` Objekte.</span><span class="sxs-lookup"><span data-stu-id="c8ad0-112">Both <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> objects read from a shared pool of `MemoryResource` objects.</span></span>  
  
 [!code-csharp[TPLDataflow_NonGreedyJoin#1](../../../samples/snippets/csharp/VS_Snippets_Misc/tpldataflow_nongreedyjoin/cs/nongreedyjoin.cs#1)]
 [!code-vb[TPLDataflow_NonGreedyJoin#1](../../../samples/snippets/visualbasic/VS_Snippets_Misc/tpldataflow_nongreedyjoin/vb/nongreedyjoin.vb#1)]  
  
 <span data-ttu-id="c8ad0-113">So aktivieren Sie die effiziente Verwendung von dem freigegebenen Pool mit `MemoryResource` Objekte in diesem Beispiel wird eine <xref:System.Threading.Tasks.Dataflow.GroupingDataflowBlockOptions> Objekt mit der <xref:System.Threading.Tasks.Dataflow.GroupingDataflowBlockOptions.Greedy%2A> -Eigenschaft auf festgelegt `False` erstellen <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> Objekte, die im nicht gierigen Modus bearbeiten.</span><span class="sxs-lookup"><span data-stu-id="c8ad0-113">To enable efficient use of the shared pool of `MemoryResource` objects, this example specifies a <xref:System.Threading.Tasks.Dataflow.GroupingDataflowBlockOptions> object that has the <xref:System.Threading.Tasks.Dataflow.GroupingDataflowBlockOptions.Greedy%2A> property set to `False` to create <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> objects that act in non-greedy mode.</span></span> <span data-ttu-id="c8ad0-114">Ein nicht gieriger Join-Block zurück alle eingehenden Nachrichten, bis eine aus der jeweiligen Quelle verfügbar ist.</span><span class="sxs-lookup"><span data-stu-id="c8ad0-114">A non-greedy join block postpones all incoming messages until one is available from each source.</span></span> <span data-ttu-id="c8ad0-115">Wenn eine der zurückgestellten Nachrichten durch einen anderen Block akzeptiert wurden, wird der gruppierungsblock des Prozesses neu gestartet.</span><span class="sxs-lookup"><span data-stu-id="c8ad0-115">If any of the postponed messages were accepted by another block, the join block restarts the process.</span></span> <span data-ttu-id="c8ad0-116">Nicht gieriger Modus ermöglicht gruppierungsblöcke, die gemeinsam eine oder mehrere Quellblöcke Fortschritte machen, wie die anderen Blöcken auf die Daten warten.</span><span class="sxs-lookup"><span data-stu-id="c8ad0-116">Non-greedy mode enables join blocks that share one or more source blocks to make forward progress as the other blocks wait for data.</span></span> <span data-ttu-id="c8ad0-117">In diesem Beispiel wenn eine `MemoryResource` Objekt hinzugefügt wird die `memoryResources` pool, den ersten Join Block, um die zweite Datenquelle empfangen kann Fortschritt vornehmen.</span><span class="sxs-lookup"><span data-stu-id="c8ad0-117">In this example, if a `MemoryResource` object is added to the `memoryResources` pool, the first join block to receive its second data source can make forward progress.</span></span> <span data-ttu-id="c8ad0-118">Wenn in diesem Beispiel gierigen Modus verwenden würden, also standardmäßig eine gruppierungsblock dauern die `MemoryResource` Objekt, und warten Sie, bis die zweite Ressource verfügbar wird.</span><span class="sxs-lookup"><span data-stu-id="c8ad0-118">If this example were to use greedy mode, which is the default, one join block might take the `MemoryResource` object and wait for the second resource to become available.</span></span> <span data-ttu-id="c8ad0-119">Jedoch, wenn der andere gruppierungsblock die zweite Datenquelle verfügt, kann nicht erleichtern Fortschritt da die `MemoryResource` Objekt von der anderen gruppierungsblock vorgenommen wurde.</span><span class="sxs-lookup"><span data-stu-id="c8ad0-119">However, if the other join block has its second data source available, it cannot make forward progress because the `MemoryResource` object has been taken by the other join block.</span></span>  
  
## <a name="compiling-the-code"></a><span data-ttu-id="c8ad0-120">Kompilieren des Codes</span><span class="sxs-lookup"><span data-stu-id="c8ad0-120">Compiling the Code</span></span>  
 <span data-ttu-id="c8ad0-121">Kopieren Sie den Beispielcode, und fügen Sie ihn in ein Visual Studio-Projekt ein. Alternativ können Sie ihn auch in eine Datei mit dem Namen `DataflowNonGreedyJoin.cs` (`DataflowNonGreedyJoin.vb` für [!INCLUDE[vbprvb](../../../includes/vbprvb-md.md)]) einfügen und dann folgenden Befehl in einem Visual Studio-Eingabeaufforderungsfenster ausführen.</span><span class="sxs-lookup"><span data-stu-id="c8ad0-121">Copy the example code and paste it in a Visual Studio project, or paste it in a file that is named `DataflowNonGreedyJoin.cs` (`DataflowNonGreedyJoin.vb` for [!INCLUDE[vbprvb](../../../includes/vbprvb-md.md)]), and then run the following command in a Visual Studio Command Prompt window.</span></span>  
  
 [!INCLUDE[csprcs](../../../includes/csprcs-md.md)]  
  
 <span data-ttu-id="c8ad0-122">**csc.exe /r:System.Threading.Tasks.Dataflow.dll DataflowNonGreedyJoin.cs**</span><span class="sxs-lookup"><span data-stu-id="c8ad0-122">**csc.exe /r:System.Threading.Tasks.Dataflow.dll DataflowNonGreedyJoin.cs**</span></span>  
  
 [!INCLUDE[vbprvb](../../../includes/vbprvb-md.md)]  
  
 <span data-ttu-id="c8ad0-123">**vbc.exe /r:System.Threading.Tasks.Dataflow.dll DataflowNonGreedyJoin.vb**</span><span class="sxs-lookup"><span data-stu-id="c8ad0-123">**vbc.exe /r:System.Threading.Tasks.Dataflow.dll DataflowNonGreedyJoin.vb**</span></span>  
  
## <a name="robust-programming"></a><span data-ttu-id="c8ad0-124">Stabile Programmierung</span><span class="sxs-lookup"><span data-stu-id="c8ad0-124">Robust Programming</span></span>  
 <span data-ttu-id="c8ad0-125">Die Verwendung des nicht gierigen Joins hilft auch Deadlocks in der Anwendung zu vermeiden.</span><span class="sxs-lookup"><span data-stu-id="c8ad0-125">The use of non-greedy joins can also help you prevent deadlock in your application.</span></span> <span data-ttu-id="c8ad0-126">In einer softwareanwendung *Deadlock* tritt auf, wenn mindestens zwei Prozesse jeweils über eine Ressource und warten Sie, sich gegenseitig einem anderen Prozess eine weitere Ressource freigegeben.</span><span class="sxs-lookup"><span data-stu-id="c8ad0-126">In a software application, *deadlock* occurs when two or more processes each hold a resource and mutually wait for another process to release some other resource.</span></span> <span data-ttu-id="c8ad0-127">Betrachten Sie eine Anwendung, die zwei definiert <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> Objekte.</span><span class="sxs-lookup"><span data-stu-id="c8ad0-127">Consider an application that defines two <xref:System.Threading.Tasks.Dataflow.JoinBlock%602> objects.</span></span> <span data-ttu-id="c8ad0-128">Beide Objekte Lesen von Daten aus zwei freigegebenen Quellblöcke.</span><span class="sxs-lookup"><span data-stu-id="c8ad0-128">Both objects each read data from two shared source blocks.</span></span> <span data-ttu-id="c8ad0-129">Im gierigen Modus Wenn ein Join-Block aus der ersten Quelle gelesen und der zweite gruppierungsblock aus der zweiten Quelle liest die Anwendung ein Deadlock auftreten kann, da beide Blöcke gegenseitig join warten, bis die andere die Ressource freigegeben.</span><span class="sxs-lookup"><span data-stu-id="c8ad0-129">In greedy mode, if one join block reads from the first source and the second join block reads from the second source, the application might deadlock because both join blocks mutually wait for the other to release its resource.</span></span> <span data-ttu-id="c8ad0-130">Im nicht gierigen Modus jedes Join-Block Lesevorgänge aus Quellen nur, wenn alle Daten verfügbar ist und daher das Risiko von Deadlocks wird entfernt.</span><span class="sxs-lookup"><span data-stu-id="c8ad0-130">In non-greedy mode, each join block reads from its sources only when all data is available, and therefore, the risk of deadlock is eliminated.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="c8ad0-131">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="c8ad0-131">See Also</span></span>  
 [<span data-ttu-id="c8ad0-132">Dataflow (Datenfluss)</span><span class="sxs-lookup"><span data-stu-id="c8ad0-132">Dataflow</span></span>](../../../docs/standard/parallel-programming/dataflow-task-parallel-library.md)
