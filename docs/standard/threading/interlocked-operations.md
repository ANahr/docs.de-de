---
title: Interlocked-Vorgänge
ms.date: 03/30/2017
ms.technology: dotnet-standard
dev_langs:
- csharp
- vb
- cpp
helpviewer_keywords:
- Interlocked class, about Interlocked class
- threading [.NET Framework], Interlocked class
ms.assetid: cbda7114-c752-4f3e-ada1-b1e8dd262f2b
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: 069a95656e7ceaf454c01c47d61ff391bcbed2fe
ms.sourcegitcommit: 2350a091ef6459f0fcfd894301242400374d8558
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 09/21/2018
ms.locfileid: "46538884"
---
# <a name="interlocked-operations"></a><span data-ttu-id="c5313-102">Interlocked-Vorgänge</span><span class="sxs-lookup"><span data-stu-id="c5313-102">Interlocked operations</span></span>

<span data-ttu-id="c5313-103">Die <xref:System.Threading.Interlocked?displayProperty=nameWithType>-Klasse stellt Methoden bereit, die den Zugriff auf eine Variable synchronisieren, die von mehreren Threads gemeinsam genutzt wird.</span><span class="sxs-lookup"><span data-stu-id="c5313-103">The <xref:System.Threading.Interlocked?displayProperty=nameWithType> class provides methods that synchronize access to a variable that is shared by multiple threads.</span></span> <span data-ttu-id="c5313-104">Threads aus verschiedenen Prozessen können diesen Mechanismus verwenden, wenn sich die Variable im freigegebenen Speicher befindet.</span><span class="sxs-lookup"><span data-stu-id="c5313-104">The threads of different processes can use this mechanism if the variable is in shared memory.</span></span> <span data-ttu-id="c5313-105">Interlocked-Vorgänge sind unteilbare (atomare) Vorgänge: Der gesamte Vorgang ist eine Einheit, die durch einen anderen Vorgang mit derselben Variablen nicht unterbrochen werden kann.</span><span class="sxs-lookup"><span data-stu-id="c5313-105">Interlocked operations are atomic — that is, the entire operation is a unit that cannot be interrupted by another operation on the same variable.</span></span> <span data-ttu-id="c5313-106">Dies ist in Betriebssystemen mit präemptivem Multithreading von Bedeutung, bei denen ein Thread nach dem Laden eines Werts aus einer Speicheradresse unterbrochen werden kann, bevor der Wert geändert oder gespeichert wurde.</span><span class="sxs-lookup"><span data-stu-id="c5313-106">This is important in operating systems with preemptive multithreading, where a thread can be suspended after loading a value from a memory address, but before having the chance to alter it and store it.</span></span>  
  
 <span data-ttu-id="c5313-107">Die <xref:System.Threading.Interlocked>-Klasse bietet folgende Vorgänge:</span><span class="sxs-lookup"><span data-stu-id="c5313-107">The <xref:System.Threading.Interlocked> class provides the following operations:</span></span>  
  
-   <span data-ttu-id="c5313-108">Die <xref:System.Threading.Interlocked.Add%2A?displayProperty=nameWithType>-Methode fügt einer Variablen einen ganzzahligen Wert hinzu und gibt den neuen Wert der Variablen zurück.</span><span class="sxs-lookup"><span data-stu-id="c5313-108">The <xref:System.Threading.Interlocked.Add%2A?displayProperty=nameWithType> method adds an integer value to a variable and returns the new value of the variable.</span></span>  
  
-   <span data-ttu-id="c5313-109">Die <xref:System.Threading.Interlocked.Read%2A?displayProperty=nameWithType>-Methode liest einen 64-Bit-Ganzzahlwert in einem atomaren Vorgang.</span><span class="sxs-lookup"><span data-stu-id="c5313-109">The <xref:System.Threading.Interlocked.Read%2A?displayProperty=nameWithType> method reads a 64-bit integer value as an atomic operation.</span></span> <span data-ttu-id="c5313-110">Dies ist von Vorteil für 32-Bit-Betriebssysteme, bei denen das Lesen eines 64-Bit-Ganzzahlwerts normalerweise keinen atomaren Vorgang darstellt.</span><span class="sxs-lookup"><span data-stu-id="c5313-110">This is useful on 32-bit operating systems, where reading a 64-bit integer is not ordinarily an atomic operation.</span></span>  
  
-   <span data-ttu-id="c5313-111">Die <xref:System.Threading.Interlocked.Increment%2A?displayProperty=nameWithType>- und <xref:System.Threading.Interlocked.Decrement%2A?displayProperty=nameWithType>-Methode inkrementieren oder dekrementieren eine Variable und geben den resultierenden Wert zurück.</span><span class="sxs-lookup"><span data-stu-id="c5313-111">The <xref:System.Threading.Interlocked.Increment%2A?displayProperty=nameWithType> and <xref:System.Threading.Interlocked.Decrement%2A?displayProperty=nameWithType> methods increment or decrement a variable and return the resulting value.</span></span>  
  
-   <span data-ttu-id="c5313-112">Die <xref:System.Threading.Interlocked.Exchange%2A?displayProperty=nameWithType>-Methode führt einen atomaren Werteaustausch in einer bestimmten Variablen aus. Dabei wird dieser Wert zurückgegeben und durch einen neuen Wert ersetzt.</span><span class="sxs-lookup"><span data-stu-id="c5313-112">The <xref:System.Threading.Interlocked.Exchange%2A?displayProperty=nameWithType> method performs an atomic exchange of the value in a specified variable, returning that value and replacing it with a new value.</span></span> <span data-ttu-id="c5313-113">Verwenden Sie eine generische <xref:System.Threading.Interlocked.Exchange%60%601%28%60%600%40%2C%60%600%29>-Überladung dieser Methode, um den Austausch für eine Variable eines beliebigen Verweistyps auszuführen.</span><span class="sxs-lookup"><span data-stu-id="c5313-113">Use a generic <xref:System.Threading.Interlocked.Exchange%60%601%28%60%600%40%2C%60%600%29> overload of this method to perform the exchange on a variable of any reference type.</span></span>  
  
-   <span data-ttu-id="c5313-114">Die <xref:System.Threading.Interlocked.CompareExchange%2A?displayProperty=nameWithType>-Methode tauscht außerdem zwei Werte aus, jedoch abhängig vom Ergebnis eines Vergleichs.</span><span class="sxs-lookup"><span data-stu-id="c5313-114">The <xref:System.Threading.Interlocked.CompareExchange%2A?displayProperty=nameWithType> method also exchanges two values, but contingent on the result of a comparison.</span></span> <span data-ttu-id="c5313-115">Verwenden Sie eine generische <xref:System.Threading.Interlocked.CompareExchange%60%601%28%60%600%40%2C%60%600%2C%60%600%29>-Überladung dieser Methode, um den Austausch für eine Variable eines beliebigen Verweistyps auszuführen.</span><span class="sxs-lookup"><span data-stu-id="c5313-115">Use a generic <xref:System.Threading.Interlocked.CompareExchange%60%601%28%60%600%40%2C%60%600%2C%60%600%29> overload of this method to perform the exchange on a variable of any reference type.</span></span>  
  
 <span data-ttu-id="c5313-116">Bei modernen Prozessoren können die Methoden der <xref:System.Threading.Interlocked>-Klasse oft durch eine einzige Anweisung implementiert werden.</span><span class="sxs-lookup"><span data-stu-id="c5313-116">On modern processors, the methods of the <xref:System.Threading.Interlocked> class can often be implemented by a single instruction.</span></span> <span data-ttu-id="c5313-117">Sie bieten folglich eine Hochleistungssynchronisierung und können verwendet werden, um Mechanismen für höherstufige Synchronisierung zu erstellen (z.B. Spinlocks).</span><span class="sxs-lookup"><span data-stu-id="c5313-117">Thus, they provide very high-performance synchronization and can be used to build higher-level synchronization mechanisms, like spin locks.</span></span>  
  
 <span data-ttu-id="c5313-118">Ein Beispiel, in dem die <xref:System.Threading.Monitor>- und <xref:System.Threading.Interlocked>-Klasse in Kombination verwendet werden, finden Sie unter [Monitor-Klasse](https://msdn.microsoft.com/library/33fe4aef-b44b-42fd-9e72-c908e39e75db).</span><span class="sxs-lookup"><span data-stu-id="c5313-118">For an example that uses the <xref:System.Threading.Monitor> and <xref:System.Threading.Interlocked> classes in combination, see [Monitors](https://msdn.microsoft.com/library/33fe4aef-b44b-42fd-9e72-c908e39e75db).</span></span>  
  
## <a name="compareexchange-example"></a><span data-ttu-id="c5313-119">CompareExchange-Beispiel</span><span class="sxs-lookup"><span data-stu-id="c5313-119">CompareExchange example</span></span>

 <span data-ttu-id="c5313-120">Mit der <xref:System.Threading.Interlocked.CompareExchange%2A>-Methode können Sie Berechnungen schützen, die komplexer sind als einfaches Inkrementieren und Dekrementieren.</span><span class="sxs-lookup"><span data-stu-id="c5313-120">The <xref:System.Threading.Interlocked.CompareExchange%2A> method can be used to protect computations that are more complicated than simple increment and decrement.</span></span> <span data-ttu-id="c5313-121">Im folgenden Beispiel wird eine threadsichere Methode dargestellt, durch die einer als Gleitkommazahl gespeicherten laufenden Summe Werte hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="c5313-121">The following example demonstrates a thread-safe method that adds to a running total stored as a floating point number.</span></span> <span data-ttu-id="c5313-122">(Für ganze Zahlen ist die <xref:System.Threading.Interlocked.Add%2A>-Methode eine einfachere Lösung.) Vollständige Codebeispiele finden Sie unter den Überladungen von <xref:System.Threading.Interlocked.CompareExchange%2A>, die Argumente mit einfacher Genauigkeit und Gleitkommaargumente mit doppelter Genauigkeit (<xref:System.Threading.Interlocked.CompareExchange%28System.Single%40%2CSystem.Single%2CSystem.Single%29> und <xref:System.Threading.Interlocked.CompareExchange%28System.Double%40%2CSystem.Double%2CSystem.Double%29>) annehmen.</span><span class="sxs-lookup"><span data-stu-id="c5313-122">(For integers, the <xref:System.Threading.Interlocked.Add%2A> method is a simpler solution.) For complete code examples, see the overloads of <xref:System.Threading.Interlocked.CompareExchange%2A> that take single-precision and double-precision floating-point arguments (<xref:System.Threading.Interlocked.CompareExchange%28System.Single%40%2CSystem.Single%2CSystem.Single%29> and <xref:System.Threading.Interlocked.CompareExchange%28System.Double%40%2CSystem.Double%2CSystem.Double%29>).</span></span>  
  
 [!code-cpp[Conceptual.Interlocked#1](../../../samples/snippets/cpp/VS_Snippets_CLR/conceptual.interlocked/cpp/source1.cpp#1)]
 [!code-csharp[Conceptual.Interlocked#1](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.interlocked/cs/source1.cs#1)]
 [!code-vb[Conceptual.Interlocked#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.interlocked/vb/source1.vb#1)]  
  
## <a name="untyped-overloads-of-exchange-and-compareexchange"></a><span data-ttu-id="c5313-123">Nicht typisierte Überladungen von Exchange und CompareExchange</span><span class="sxs-lookup"><span data-stu-id="c5313-123">Untyped overloads of Exchange and CompareExchange</span></span>

 <span data-ttu-id="c5313-124">Die Methoden <xref:System.Threading.Interlocked.Exchange%2A> und <xref:System.Threading.Interlocked.CompareExchange%2A> verfügen über Überladungen, die Argumente des Typs <xref:System.Object> annehmen.</span><span class="sxs-lookup"><span data-stu-id="c5313-124">The <xref:System.Threading.Interlocked.Exchange%2A> and <xref:System.Threading.Interlocked.CompareExchange%2A> methods have overloads that take arguments of type <xref:System.Object>.</span></span> <span data-ttu-id="c5313-125">Das erste Argument für jede dieser Überladungen ist `ref Object` (`ByRef … As Object` in Visual Basic). Die Typsicherheit erfordert, dass die an dieses Argument übergebene Variable strikt als <xref:System.Object> typisiert sein muss. Sie können beim Aufruf dieser Methoden das erste Argument nicht ohne Weiteres in den Typ <xref:System.Object> umwandeln.</span><span class="sxs-lookup"><span data-stu-id="c5313-125">The first argument of each of these overloads is `ref Object` (`ByRef … As Object` in Visual Basic), and type safety requires the variable passed to this argument to be typed strictly as <xref:System.Object>; you cannot simply cast the first argument to type <xref:System.Object> when calling these methods.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c5313-126">In .NET Framework Version 2.0 und höheren Versionen verwenden Sie die generische Überladung der <xref:System.Threading.Interlocked.Exchange%2A>- und <xref:System.Threading.Interlocked.CompareExchange%2A>-Methode für den Austausch stark typisierter Variablen.</span><span class="sxs-lookup"><span data-stu-id="c5313-126">In the .NET Framework version 2.0 and later, use the generic overloads of the <xref:System.Threading.Interlocked.Exchange%2A> and <xref:System.Threading.Interlocked.CompareExchange%2A> methods to exchange strongly typed variables.</span></span>  
  
 <span data-ttu-id="c5313-127">Das folgende Codebeispiel enthält eine Eigenschaft vom Typ `ClassA`, die nur einmal festgelegt werden kann, da sie möglicherweise in .NET Framework Version 1.0 oder 1.1 implementiert wurde.</span><span class="sxs-lookup"><span data-stu-id="c5313-127">The following code example shows a property of type `ClassA` that can be set only once, as it might be implemented in the .NET Framework version 1.0 or 1.1.</span></span>  
  
 [!code-cpp[Conceptual.Interlocked#2](../../../samples/snippets/cpp/VS_Snippets_CLR/conceptual.interlocked/cpp/source2.cpp#2)]
 [!code-csharp[Conceptual.Interlocked#2](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.interlocked/cs/source2.cs#2)]
 [!code-vb[Conceptual.Interlocked#2](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.interlocked/vb/source2.vb#2)]  
  
## <a name="see-also"></a><span data-ttu-id="c5313-128">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="c5313-128">See also</span></span>

- <xref:System.Threading.Interlocked?displayProperty=nameWithType>  
- <xref:System.Threading.Monitor?displayProperty=nameWithType>  
- [<span data-ttu-id="c5313-129">Threading</span><span class="sxs-lookup"><span data-stu-id="c5313-129">Threading</span></span>](index.md)  
- [<span data-ttu-id="c5313-130">Threadingobjekte und -funktionen</span><span class="sxs-lookup"><span data-stu-id="c5313-130">Threading objects and features</span></span>](threading-objects-and-features.md)
