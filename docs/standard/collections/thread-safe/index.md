---
title: Threadsichere Auflistungen
ms.custom: ''
ms.date: 03/30/2017
ms.prod: .net
ms.reviewer: ''
ms.suite: ''
ms.technology: dotnet-standard
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- thread-safe collections, overview
ms.assetid: 2e7ca21f-786c-4367-96be-0cf3f3dcc6bd
caps.latest.revision: 24
author: mairaw
ms.author: mairaw
manager: wpickett
ms.workload:
- dotnet
- dotnetcore
ms.openlocfilehash: ae53d5afbca15f8adafed428d4c2141312c972ed
ms.sourcegitcommit: e7f04439d78909229506b56935a1105a4149ff3d
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 12/23/2017
---
# <a name="thread-safe-collections"></a><span data-ttu-id="98412-102">Threadsichere Auflistungen</span><span class="sxs-lookup"><span data-stu-id="98412-102">Thread-Safe Collections</span></span>
<span data-ttu-id="98412-103">[!INCLUDE[net_v40_short](../../../../includes/net-v40-short-md.md)] führt den <xref:System.Collections.Concurrent?displayProperty=nameWithType>-Namespace ein, der mehrere Auflistungsklassen einschließt, die sowohl threadsicher als auch skalierbar sind.</span><span class="sxs-lookup"><span data-stu-id="98412-103">The [!INCLUDE[net_v40_short](../../../../includes/net-v40-short-md.md)] introduces the <xref:System.Collections.Concurrent?displayProperty=nameWithType> namespace, which includes several collection classes that are both thread-safe and scalable.</span></span> <span data-ttu-id="98412-104">Mehrere Threads können diesen Auflistungen sicher und effizient Elemente hinzufügen bzw. daraus entfernen, ohne dass zusätzliche Synchronisierung in Benutzercode erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="98412-104">Multiple threads can safely and efficiently add or remove items from these collections, without requiring additional synchronization in user code.</span></span> <span data-ttu-id="98412-105">Wenn Sie neuen Code schreiben, verwenden Sie die gleichzeitigen Auflistungsklassen, wenn von der Auflistung gleichzeitig Elemente in mehrere Threads geschrieben werden.</span><span class="sxs-lookup"><span data-stu-id="98412-105">When you write new code, use the concurrent collection classes whenever the collection will be writing to multiple threads concurrently.</span></span> <span data-ttu-id="98412-106">Wenn Sie nur von einer freigegebenen Auflistung lesen, können Sie die Klassen im <xref:System.Collections.Generic?displayProperty=nameWithType>-Namespace verwenden.</span><span class="sxs-lookup"><span data-stu-id="98412-106">If you are only reading from a shared collection, then you can use the classes in the <xref:System.Collections.Generic?displayProperty=nameWithType> namespace.</span></span> <span data-ttu-id="98412-107">Es wird empfohlen, keine 1.0-Auflistungsklassen zu verwenden, sofern als Zielversion nicht .NET Framework 1.1 oder eine frühere Laufzeit festgelegt wird.</span><span class="sxs-lookup"><span data-stu-id="98412-107">We recommend that you do not use 1.0 collection classes unless you are required to target the .NET Framework 1.1 or earlier runtime.</span></span>  
  
## <a name="thread-synchronization-in-the-net-framework-10-and-20-collections"></a><span data-ttu-id="98412-108">Threadsynchronisierung in den Auflistungen von .NET Framework 1.0 und 2.0</span><span class="sxs-lookup"><span data-stu-id="98412-108">Thread Synchronization in the .NET Framework 1.0 and 2.0 Collections</span></span>  
 <span data-ttu-id="98412-109">Die in .NET Framework 1.0 eingeführten Auflistungen befinden sich im <xref:System.Collections?displayProperty=nameWithType>-Namespace.</span><span class="sxs-lookup"><span data-stu-id="98412-109">The collections introduced in the .NET Framework 1.0 are found in the <xref:System.Collections?displayProperty=nameWithType> namespace.</span></span> <span data-ttu-id="98412-110">Diese Auflistungen, die das häufig verwendete <xref:System.Collections.ArrayList>-Objekt und das <xref:System.Collections.Hashtable>-Objekt einschließen, bieten eine gewisse Threadsicherheit durch die `Synchronized`-Eigenschaft, von der ein threadsicherer Wrapper um die Auflistung zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="98412-110">These collections, which include the commonly used <xref:System.Collections.ArrayList> and <xref:System.Collections.Hashtable>, provide some thread-safety through the `Synchronized` property, which returns a thread-safe wrapper around the collection.</span></span> <span data-ttu-id="98412-111">Der Wrapper funktioniert folgendermaßen: Die gesamte Auflistung wird bei jedem Hinzufüge- oder Entfernungsvorgang gesperrt.</span><span class="sxs-lookup"><span data-stu-id="98412-111">The wrapper works by locking the entire collection on every add or remove operation.</span></span> <span data-ttu-id="98412-112">Daher muss jeder Thread, der versucht, auf die Auflistung zuzugreifen, warten, bis er die jeweilige Sperre übernehmen kann.</span><span class="sxs-lookup"><span data-stu-id="98412-112">Therefore, each thread that is attempting to access the collection must wait for its turn to take the one lock.</span></span> <span data-ttu-id="98412-113">Dies ist nicht skalierbar und kann beträchtliche Leistungseinbußen für große Auflistungen verursachen.</span><span class="sxs-lookup"><span data-stu-id="98412-113">This is not scalable and can cause significant performance degradation for large collections.</span></span> <span data-ttu-id="98412-114">Außerdem wird der Entwurf nicht völlig vor Racebedingungen geschützt.</span><span class="sxs-lookup"><span data-stu-id="98412-114">Also, the design is not completely protected from race conditions.</span></span> <span data-ttu-id="98412-115">Weitere Informationen finden Sie unter [Synchronisierung in generischen Auflistungen](http://go.microsoft.com/fwlink/?LinkID=161130) auf der MSDN-Website.</span><span class="sxs-lookup"><span data-stu-id="98412-115">For more information, see [Synchronization in Generic Collections](http://go.microsoft.com/fwlink/?LinkID=161130) on the MSDN Web site.</span></span>  
  
 <span data-ttu-id="98412-116">Die in .NET Framework 2.0 eingeführten Auflistungsklassen befinden sich im <xref:System.Collections.Generic?displayProperty=nameWithType>-Namespace.</span><span class="sxs-lookup"><span data-stu-id="98412-116">The collection classes introduced in the .NET Framework 2.0 are found in the <xref:System.Collections.Generic?displayProperty=nameWithType> namespace.</span></span> <span data-ttu-id="98412-117">Dazu gehören <xref:System.Collections.Generic.List%601>, <xref:System.Collections.Generic.Dictionary%602> usw.</span><span class="sxs-lookup"><span data-stu-id="98412-117">These include <xref:System.Collections.Generic.List%601>, <xref:System.Collections.Generic.Dictionary%602>, and so on.</span></span> <span data-ttu-id="98412-118">Diese Klassen bieten verbesserte Typsicherheit und Leistung im Vergleich zu den .NET Framework 1.0-Klassen.</span><span class="sxs-lookup"><span data-stu-id="98412-118">These classes provide improved type safety and performance compared to the .NET Framework 1.0 classes.</span></span> <span data-ttu-id="98412-119">Die .NET Framework 2.0-Auflistungsklassen stellen jedoch keine Threadsynchronisierung bereit; Benutzercode muss die gesamte Synchronisierung bereitstellen, wenn Elemente gleichzeitig in mehreren Threads hinzugefügt oder entfernt werden.</span><span class="sxs-lookup"><span data-stu-id="98412-119">However, the .NET Framework 2.0 collection classes do not provide any thread synchronization; user code must provide all synchronization when items are added or removed on multiple threads concurrently.</span></span>  
  
 <span data-ttu-id="98412-120">Es wird empfohlen, die gleichzeitigen Auflistungsklassen in [!INCLUDE[net_v40_short](../../../../includes/net-v40-short-md.md)] zu verwenden, da sie nicht nur die Typsicherheit der .NET Framework 2.0-Auflistungsklassen, sondern auch effizientere und vollständigere Threadsicherheit als die [!INCLUDE[net_v10_short](../../../../includes/net-v10-short-md.md)]-Auflistungen bieten.</span><span class="sxs-lookup"><span data-stu-id="98412-120">We recommend the concurrent collections classes in the [!INCLUDE[net_v40_short](../../../../includes/net-v40-short-md.md)] because they provide not only the type safety of the .NET Framework 2.0 collection classes, but also more efficient and more complete thread safety than the [!INCLUDE[net_v10_short](../../../../includes/net-v10-short-md.md)] collections provide.</span></span>  
  
## <a name="fine-grained-locking-and-lock-free-mechanisms"></a><span data-ttu-id="98412-121">Differenzierte Sperre und sperrenfreie Mechanismen</span><span class="sxs-lookup"><span data-stu-id="98412-121">Fine-Grained Locking and Lock-Free Mechanisms</span></span>  
 <span data-ttu-id="98412-122">Einige der gleichzeitigen Auflistungstypen verwenden einfache Synchronisierungsmechanismen z. B. <xref:System.Threading.SpinLock>, <xref:System.Threading.SpinWait>, <xref:System.Threading.SemaphoreSlim>, und <xref:System.Threading.CountdownEvent>, die neu in [!INCLUDE[net_v40_short](../../../../includes/net-v40-short-md.md)] sind.</span><span class="sxs-lookup"><span data-stu-id="98412-122">Some of the concurrent collection types use lightweight synchronization mechanisms such as <xref:System.Threading.SpinLock>, <xref:System.Threading.SpinWait>, <xref:System.Threading.SemaphoreSlim>, and <xref:System.Threading.CountdownEvent>, which are new in the [!INCLUDE[net_v40_short](../../../../includes/net-v40-short-md.md)].</span></span> <span data-ttu-id="98412-123">Diese Synchronisierungstypen verwenden normalerweise *andauernde Spinvorgänge* für die kurzen Zeiträume, bevor der Thread in einen echten Wartezustand versetzt wird.</span><span class="sxs-lookup"><span data-stu-id="98412-123">These synchronization types typically use *busy spinning* for brief periods before they put the thread into a true Wait state.</span></span> <span data-ttu-id="98412-124">Wenn Wartezeiten als sehr kurz eingeschätzt werden, sind Spinvorgänge weitaus weniger rechenintensiv als Wartezustände, die einen aufwändigen Kernel-Übergang umfassen.</span><span class="sxs-lookup"><span data-stu-id="98412-124">When wait times are expected to be very short, spinning is far less computationally expensive than waiting, which involves an expensive kernel transition.</span></span> <span data-ttu-id="98412-125">Für Auflistungsklassen, für die Spinvorgänge verwendet werden, bedeutet diese Effizienz, dass mehrere Threads Elemente mit einer sehr hohen Rate hinzufügen und entfernen können.</span><span class="sxs-lookup"><span data-stu-id="98412-125">For collection classes that use spinning, this efficiency means that multiple threads can add and remove items at a very high rate.</span></span> <span data-ttu-id="98412-126">Weitere Informationen zu Spinvorgängen im Vergleich zu Blockierungen finden Sie unter [SpinLock](../../../../docs/standard/threading/spinlock.md) und [SpinWait](../../../../docs/standard/threading/spinwait.md).</span><span class="sxs-lookup"><span data-stu-id="98412-126">For more information about spinning vs. blocking, see [SpinLock](../../../../docs/standard/threading/spinlock.md) and [SpinWait](../../../../docs/standard/threading/spinwait.md).</span></span>  
  
 <span data-ttu-id="98412-127">Für die <xref:System.Collections.Concurrent.ConcurrentQueue%601>-Klasse und die <xref:System.Collections.Concurrent.ConcurrentStack%601>-Klasse werden gar keine Sperren verwendet.</span><span class="sxs-lookup"><span data-stu-id="98412-127">The <xref:System.Collections.Concurrent.ConcurrentQueue%601> and <xref:System.Collections.Concurrent.ConcurrentStack%601> classes do not use locks at all.</span></span> <span data-ttu-id="98412-128">Stattdessen wird die Threadsicherheit durch <xref:System.Threading.Interlocked>-Vorgänge gewährleistet.</span><span class="sxs-lookup"><span data-stu-id="98412-128">Instead, they rely on <xref:System.Threading.Interlocked> operations to achieve thread-safety.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="98412-129">Da die gleichzeitigen Auflistungsklassen <xref:System.Collections.ICollection> unterstützen, stellen sie Implementierungen für die <xref:System.Collections.ICollection.IsSynchronized%2A>-Eigenschaft und die <xref:System.Collections.ICollection.SyncRoot%2A>-Eigenschaft bereit, auch wenn diese Eigenschaften nicht relevant sind.</span><span class="sxs-lookup"><span data-stu-id="98412-129">Because the concurrent collections classes support <xref:System.Collections.ICollection>, they provide implementations for the <xref:System.Collections.ICollection.IsSynchronized%2A> and <xref:System.Collections.ICollection.SyncRoot%2A> properties, even though these properties are irrelevant.</span></span> <span data-ttu-id="98412-130">`IsSynchronized` gibt immer `false` zurück, und `SyncRoot` ist immer `null` (`Nothing` in Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="98412-130">`IsSynchronized` always returns `false` and `SyncRoot` is always `null` (`Nothing` in Visual Basic).</span></span>  
  
 <span data-ttu-id="98412-131">In der folgenden Tabelle sind die Auflistungstypen im <xref:System.Collections.Concurrent?displayProperty=nameWithType>-Namespace aufgeführt.</span><span class="sxs-lookup"><span data-stu-id="98412-131">The following table lists the collection types in the <xref:System.Collections.Concurrent?displayProperty=nameWithType> namespace.</span></span>  
  
|<span data-ttu-id="98412-132">Typ</span><span class="sxs-lookup"><span data-stu-id="98412-132">Type</span></span>|<span data-ttu-id="98412-133">description</span><span class="sxs-lookup"><span data-stu-id="98412-133">Description</span></span>|  
|----------|-----------------|  
|<xref:System.Collections.Concurrent.BlockingCollection%601>|<span data-ttu-id="98412-134">Stellt Begrenzungs- und Blockierungsfunktionen für jeden Typ bereit, von dem <xref:System.Collections.Concurrent.IProducerConsumerCollection%601> implementiert wird.</span><span class="sxs-lookup"><span data-stu-id="98412-134">Provides bounding and blocking functionality for any type that implements <xref:System.Collections.Concurrent.IProducerConsumerCollection%601>.</span></span> <span data-ttu-id="98412-135">Weitere Informationen finden Sie unter [Übersicht über BlockingCollection](../../../../docs/standard/collections/thread-safe/blockingcollection-overview.md).</span><span class="sxs-lookup"><span data-stu-id="98412-135">For more information, see [BlockingCollection Overview](../../../../docs/standard/collections/thread-safe/blockingcollection-overview.md).</span></span>|  
|<xref:System.Collections.Concurrent.ConcurrentDictionary%602>|<span data-ttu-id="98412-136">Threadsichere Implementierung eines Wörterbuchs von Schlüssel-Wert-Paaren.</span><span class="sxs-lookup"><span data-stu-id="98412-136">Thread-safe implementation of a dictionary of key-value pairs.</span></span>|  
|<xref:System.Collections.Concurrent.ConcurrentQueue%601>|<span data-ttu-id="98412-137">Threadsichere Implementierung einer First In, First Out (FIFO)-Warteschlange.</span><span class="sxs-lookup"><span data-stu-id="98412-137">Thread-safe implementation of a FIFO (first-in, first-out) queue.</span></span>|  
|<xref:System.Collections.Concurrent.ConcurrentStack%601>|<span data-ttu-id="98412-138">Threadsichere Implementierung eines Last In, First Out (LIFO)-Stapels.</span><span class="sxs-lookup"><span data-stu-id="98412-138">Thread-safe implementation of a LIFO (last-in, first-out) stack.</span></span>|  
|<xref:System.Collections.Concurrent.ConcurrentBag%601>|<span data-ttu-id="98412-139">Threadsichere Implementierung einer ungeordneten Auflistung von Elementen.</span><span class="sxs-lookup"><span data-stu-id="98412-139">Thread-safe implementation of an unordered collection of elements.</span></span>|  
|<xref:System.Collections.Concurrent.IProducerConsumerCollection%601>|<span data-ttu-id="98412-140">Die Schnittstelle, die ein Typ implementieren muss, damit sie in `BlockingCollection` verwendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="98412-140">The interface that a type must implement to be used in a `BlockingCollection`.</span></span>|  
  
## <a name="related-topics"></a><span data-ttu-id="98412-141">Verwandte Themen</span><span class="sxs-lookup"><span data-stu-id="98412-141">Related Topics</span></span>  
  
|<span data-ttu-id="98412-142">Titel</span><span class="sxs-lookup"><span data-stu-id="98412-142">Title</span></span>|<span data-ttu-id="98412-143">description</span><span class="sxs-lookup"><span data-stu-id="98412-143">Description</span></span>|  
|-----------|-----------------|  
|[<span data-ttu-id="98412-144">Übersicht über BlockingCollection</span><span class="sxs-lookup"><span data-stu-id="98412-144">BlockingCollection Overview</span></span>](../../../../docs/standard/collections/thread-safe/blockingcollection-overview.md)|<span data-ttu-id="98412-145">Beschreibt die vom <xref:System.Collections.Concurrent.BlockingCollection%601>-Typ bereitgestellte Funktion.</span><span class="sxs-lookup"><span data-stu-id="98412-145">Describes the functionality provided by the <xref:System.Collections.Concurrent.BlockingCollection%601> type.</span></span>|  
|[<span data-ttu-id="98412-146">Vorgehensweise: Hinzufügen und Entfernen von Elementen aus einem ConcurrentDictionary</span><span class="sxs-lookup"><span data-stu-id="98412-146">How to: Add and Remove Items from a ConcurrentDictionary</span></span>](../../../../docs/standard/collections/thread-safe/how-to-add-and-remove-items.md)|<span data-ttu-id="98412-147">Beschreibt, wie Elemente aus einem <xref:System.Collections.Concurrent.ConcurrentDictionary%602>-Objekt hinzugefügt und entfernt werden.</span><span class="sxs-lookup"><span data-stu-id="98412-147">Describes how to add and remove elements from a <xref:System.Collections.Concurrent.ConcurrentDictionary%602></span></span>|  
|[<span data-ttu-id="98412-148">Vorgehensweise: Hinzufügen und Entfernen von einzelnen Elementen zu bzw. aus einer BlockingCollection</span><span class="sxs-lookup"><span data-stu-id="98412-148">How to: Add and Take Items Individually from a BlockingCollection</span></span>](../../../../docs/standard/collections/thread-safe/how-to-add-and-take-items.md)|<span data-ttu-id="98412-149">Beschreibt, wie Elemente einer Blockierungsauflistung hinzugefügt und daraus abgerufen werden, ohne dass der schreibgeschützte Enumerator verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="98412-149">Describes how to add and retrieve items from a blocking collection without using the read-only enumerator.</span></span>|  
|[<span data-ttu-id="98412-150">Vorgehensweise: Hinzufügen von Begrenzungs- und Blockadefunktionen zu einer Auflistung</span><span class="sxs-lookup"><span data-stu-id="98412-150">How to: Add Bounding and Blocking Functionality to a Collection</span></span>](../../../../docs/standard/collections/thread-safe/how-to-add-bounding-and-blocking.md)|<span data-ttu-id="98412-151">Beschreibt, wie jede Auflistungsklasse als zugrunde liegender Speichermechanismus für eine <xref:System.Collections.Concurrent.IProducerConsumerCollection%601>-Auflistung verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="98412-151">Describes how to use any collection class as the underlying storage mechanism for an <xref:System.Collections.Concurrent.IProducerConsumerCollection%601> collection.</span></span>|  
|[<span data-ttu-id="98412-152">Vorgehensweise: Entfernen von Elementen in einer BlockingCollection mit ForEach</span><span class="sxs-lookup"><span data-stu-id="98412-152">How to: Use ForEach to Remove Items in a BlockingCollection</span></span>](../../../../docs/standard/collections/thread-safe/how-to-use-foreach-to-remove.md)|<span data-ttu-id="98412-153">Beschreibt, wie mit einer `foreach`-Anweisung (`For Each` in Visual Basic) alle Elemente in einer Blockierungsauflistung entfernt werden.</span><span class="sxs-lookup"><span data-stu-id="98412-153">Describes how to use `foreach`, (`For Each` in Visual Basic) to remove all items in a blocking collection.</span></span>|  
|[<span data-ttu-id="98412-154">Vorgehensweise: Verwenden von Arrays mit blockierenden Auflistungen in einer Pipeline</span><span class="sxs-lookup"><span data-stu-id="98412-154">How to: Use Arrays of Blocking Collections in a Pipeline</span></span>](../../../../docs/standard/collections/thread-safe/how-to-use-arrays-of-blockingcollections.md)|<span data-ttu-id="98412-155">Beschreibt, wie mit mehreren Blockierungsauflistungen gleichzeitig eine Pipeline implementiert wird.</span><span class="sxs-lookup"><span data-stu-id="98412-155">Describes how to use multiple blocking collections at the same time to implement a pipeline.</span></span>|  
|[<span data-ttu-id="98412-156">Vorgehensweise: Erstellen eines Objektpools mittels ConcurrentBag</span><span class="sxs-lookup"><span data-stu-id="98412-156">How to: Create an Object Pool by Using a ConcurrentBag</span></span>](../../../../docs/standard/collections/thread-safe/how-to-create-an-object-pool.md)|<span data-ttu-id="98412-157">Zeigt die Verwendung einer parallelen Sammlung zur Verbesserung der Leistung in Szenarien, in denen Sie Objekte nicht fortlaufend neu erstellen müssen, sondern diese wiederverwenden können.</span><span class="sxs-lookup"><span data-stu-id="98412-157">Shows how to use a concurrent bag to improve performance in scenarios where you can reuse objects instead of continually creating new ones.</span></span>|  
  
## <a name="reference"></a><span data-ttu-id="98412-158">Verweis</span><span class="sxs-lookup"><span data-stu-id="98412-158">Reference</span></span>  
 <xref:System.Collections.Concurrent?displayProperty=nameWithType>
