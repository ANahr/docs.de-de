---
title: "Übersicht über BlockingCollection"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-standard
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- csharp
- vb
helpviewer_keywords: BlockingCollection, overview
ms.assetid: 987ea3d7-0ad5-4238-8b64-331ce4eb3f0b
caps.latest.revision: "12"
author: mairaw
ms.author: mairaw
manager: wpickett
ms.openlocfilehash: 6dc6729bf4627164fbcde5980d4fcccd41b67645
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 11/21/2017
---
# <a name="blockingcollection-overview"></a><span data-ttu-id="775e8-102">Übersicht über BlockingCollection</span><span class="sxs-lookup"><span data-stu-id="775e8-102">BlockingCollection Overview</span></span>
<span data-ttu-id="775e8-103"><xref:System.Collections.Concurrent.BlockingCollection%601> ist eine threadsichere Auflistungsklasse, die die folgenden Features bietet:</span><span class="sxs-lookup"><span data-stu-id="775e8-103"><xref:System.Collections.Concurrent.BlockingCollection%601> is a thread-safe collection class that provides the following features:</span></span>  
  
-   <span data-ttu-id="775e8-104">Eine Implementierung des Producer-Consumer-Musters.</span><span class="sxs-lookup"><span data-stu-id="775e8-104">An implementation of the Producer-Consumer pattern.</span></span>  
  
-   <span data-ttu-id="775e8-105">Gleichzeitiges Hinzufügen und Entfernen von Elementen aus mehreren Threads.</span><span class="sxs-lookup"><span data-stu-id="775e8-105">Concurrent adding and taking of items from multiple threads.</span></span>  
  
-   <span data-ttu-id="775e8-106">Optionale maximale Kapazität.</span><span class="sxs-lookup"><span data-stu-id="775e8-106">Optional maximum capacity.</span></span>  
  
-   <span data-ttu-id="775e8-107">Einfüge- und Löschvorgänge, die blockiert werden, wenn die Auflistung leer oder voll ist.</span><span class="sxs-lookup"><span data-stu-id="775e8-107">Insertion and removal operations that block when collection is empty or full.</span></span>  
  
-   <span data-ttu-id="775e8-108">„Versuchs“-Einfüge- und Löschvorgänge, die nicht oder nur für eine angegebene Zeitspanne blockiert werden.</span><span class="sxs-lookup"><span data-stu-id="775e8-108">Insertion and removal "try" operations that do not block or that block up to a specified period of time.</span></span>  
  
-   <span data-ttu-id="775e8-109">Kapselt jeden Auflistungstyp, der <xref:System.Collections.Concurrent.IProducerConsumerCollection%601> implementiert.</span><span class="sxs-lookup"><span data-stu-id="775e8-109">Encapsulates any collection type that implements <xref:System.Collections.Concurrent.IProducerConsumerCollection%601></span></span>  
  
-   <span data-ttu-id="775e8-110">Abbruch mit Abbruchtoken.</span><span class="sxs-lookup"><span data-stu-id="775e8-110">Cancellation with cancellation tokens.</span></span>  
  
-   <span data-ttu-id="775e8-111">Zwei Arten von Enumeration mit `foreach` (`For Each` in Visual Basic):</span><span class="sxs-lookup"><span data-stu-id="775e8-111">Two kinds of enumeration with `foreach` (`For Each` in Visual Basic):</span></span>  
  
    1.  <span data-ttu-id="775e8-112">Schreibgeschützte Enumeration.</span><span class="sxs-lookup"><span data-stu-id="775e8-112">Read-only enumeration.</span></span>  
  
    2.  <span data-ttu-id="775e8-113">Enumeration, in deren Verlauf Elemente entfernt werden.</span><span class="sxs-lookup"><span data-stu-id="775e8-113">Enumeration that removes items as they are enumerated.</span></span>  
  
## <a name="bounding-and-blocking-support"></a><span data-ttu-id="775e8-114">Unterstützung von Begrenzen und Blockieren</span><span class="sxs-lookup"><span data-stu-id="775e8-114">Bounding and Blocking Support</span></span>  
 <span data-ttu-id="775e8-115"><xref:System.Collections.Concurrent.BlockingCollection%601> unterstützt das Begrenzen und Blockieren</span><span class="sxs-lookup"><span data-stu-id="775e8-115"><xref:System.Collections.Concurrent.BlockingCollection%601> supports bounding and blocking.</span></span> <span data-ttu-id="775e8-116">Begrenzen bedeutet, dass Sie die maximale Kapazität der Auflistung festlegen können.</span><span class="sxs-lookup"><span data-stu-id="775e8-116">Bounding means you can set the maximum capacity of the collection.</span></span> <span data-ttu-id="775e8-117">Begrenzen ist in bestimmten Szenarien wichtig, da es Ihnen ermöglicht, die maximale Größe der Auflistung im Arbeitsspeicher zu steuern, und es verhindert, dass die erzeugenden Threads sich zu weit vor die verbrauchenden Threads bewegen.</span><span class="sxs-lookup"><span data-stu-id="775e8-117">Bounding is important in certain scenarios because it enables you to control the maximum size of the collection in memory, and it prevents the producing threads from moving too far ahead of the consuming threads.</span></span>  
  
 <span data-ttu-id="775e8-118">Mehrere Threads oder Tasks können gleichzeitig der Auflistung Elemente hinzufügen, und wenn die Auflistung die angegebene maximale Kapazität erreicht, werden die erzeugenden Threads blockiert, bis ein Element entfernt wird.</span><span class="sxs-lookup"><span data-stu-id="775e8-118">Multiple threads or tasks can add items to the collection concurrently, and if the collection reaches its specified maximum capacity, the producing threads will block until an item is removed.</span></span> <span data-ttu-id="775e8-119">Mehrere Consumer können gleichzeitig Elemente entfernen, und wenn die Auflistung leer ist, werden die verbrauchenden Threads blockiert, bis ein Producer ein Element hinzufügt.</span><span class="sxs-lookup"><span data-stu-id="775e8-119">Multiple consumers can remove items concurrently, and if the collection becomes empty, the consuming threads will block until a producer adds an item.</span></span> <span data-ttu-id="775e8-120">Ein Producer-Thread kann <xref:System.Collections.Concurrent.BlockingCollection%601.CompleteAdding%2A> aufrufen, um anzuzeigen, dass keine Elemente mehr hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="775e8-120">A producing thread can call <xref:System.Collections.Concurrent.BlockingCollection%601.CompleteAdding%2A> to indicate that no more items will be added.</span></span> <span data-ttu-id="775e8-121">Consumer überwachen die <xref:System.Collections.Concurrent.BlockingCollection%601.IsCompleted%2A>-Eigenschaft, um zu wissen, wann die Auflistung leer ist, und keine Elemente mehr hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="775e8-121">Consumers monitor the <xref:System.Collections.Concurrent.BlockingCollection%601.IsCompleted%2A> property to know when the collection is empty and no more items will be added.</span></span> <span data-ttu-id="775e8-122">Das folgende Beispiel zeigt eine einfache BlockingCollection mit einer begrenzten Kapazität von 100.</span><span class="sxs-lookup"><span data-stu-id="775e8-122">The following example shows a simple BlockingCollection with a bounded capacity of 100.</span></span> <span data-ttu-id="775e8-123">Ein Producer-Task fügt der Auflistung Elemente hinzu, solange eine externe Bedingung wahr ist, und ruft dann <xref:System.Collections.Concurrent.BlockingCollection%601.CompleteAdding%2A> auf.</span><span class="sxs-lookup"><span data-stu-id="775e8-123">A producer task adds items to the collection as long as some external condition is true, and then calls <xref:System.Collections.Concurrent.BlockingCollection%601.CompleteAdding%2A>.</span></span> <span data-ttu-id="775e8-124">Der Consumer-Task entnimmt Elemente, bis die <xref:System.Collections.Concurrent.BlockingCollection%601.IsCompleted%2A>-Eigenschaft wahr ist.</span><span class="sxs-lookup"><span data-stu-id="775e8-124">The consumer task takes items until the <xref:System.Collections.Concurrent.BlockingCollection%601.IsCompleted%2A> property is true.</span></span>  
  
 [!code-csharp[CDS_BlockingCollection#04](../../../../samples/snippets/csharp/VS_Snippets_Misc/cds_blockingcollection/cs/blockingcollection.cs#04)]
 [!code-vb[CDS_BlockingCollection#04](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/cds_blockingcollection/vb/introsnippetsbc.vb#04)]  
  
 <span data-ttu-id="775e8-125">Ein vollständiges Beispiel finden Sie unter [Gewusst wie: Hinzufügen und Entfernen von einzelnen Elementen zu bzw. aus einer BlockingCollection](../../../../docs/standard/collections/thread-safe/how-to-add-and-take-items.md).</span><span class="sxs-lookup"><span data-stu-id="775e8-125">For a complete example, see [How to: Add and Take Items Individually from a BlockingCollection](../../../../docs/standard/collections/thread-safe/how-to-add-and-take-items.md).</span></span>  
  
## <a name="timed-blocking-operations"></a><span data-ttu-id="775e8-126">Zeitgesteuerte Blockierungsvorgänge</span><span class="sxs-lookup"><span data-stu-id="775e8-126">Timed Blocking Operations</span></span>  
 <span data-ttu-id="775e8-127">In zeitgesteuerten <xref:System.Collections.Concurrent.BlockingCollection%601.TryAdd%2A>- und <xref:System.Collections.Concurrent.BlockingCollection%601.TryTake%2A>-Blockierungsvorgängen, die für begrenzte Sammlungen durchgeführt werden, versucht die Methode, ein Element hinzuzufügen oder zu entnehmen.</span><span class="sxs-lookup"><span data-stu-id="775e8-127">In timed blocking <xref:System.Collections.Concurrent.BlockingCollection%601.TryAdd%2A> and <xref:System.Collections.Concurrent.BlockingCollection%601.TryTake%2A> operations on bounded collections, the method tries to add or take an item.</span></span> <span data-ttu-id="775e8-128">Wenn ein Element verfügbar ist, wird es in die Variable eingesetzt, die durch Verweis übergeben wurde, und die Methode gibt WAHR zurück.</span><span class="sxs-lookup"><span data-stu-id="775e8-128">If an item is available it is placed into the variable that was passed in by reference, and the method returns true.</span></span> <span data-ttu-id="775e8-129">Wenn nach einer angegebenen Timeoutfrist kein Element abgerufen wird, gibt die Methode FALSCH zurück.</span><span class="sxs-lookup"><span data-stu-id="775e8-129">If no item is retrieved after a specified time-out period the method returns false.</span></span> <span data-ttu-id="775e8-130">Der Thread ist dann vor dem erneuten Versuch, auf die Auflistung zuzugreifen, frei für andere nützliche Aufgaben.</span><span class="sxs-lookup"><span data-stu-id="775e8-130">The thread is then free to do some other useful work before trying again to access the collection.</span></span> <span data-ttu-id="775e8-131">Ein Beispiel für das zeitgesteuerte Blockieren des Zugriffs ist das zweite Beispiel unter [Gewusst wie: Hinzufügen und Entfernen von einzelnen Elementen zu bzw. aus einer BlockingCollection](../../../../docs/standard/collections/thread-safe/how-to-add-and-take-items.md).</span><span class="sxs-lookup"><span data-stu-id="775e8-131">For an example of timed blocking access, see the second example in [How to: Add and Take Items Individually from a BlockingCollection](../../../../docs/standard/collections/thread-safe/how-to-add-and-take-items.md).</span></span>  
  
## <a name="cancelling-add-and-take-operations"></a><span data-ttu-id="775e8-132">Abbrechen von Hinzufüge- und Nehmevorgängen</span><span class="sxs-lookup"><span data-stu-id="775e8-132">Cancelling Add and Take Operations</span></span>  
 <span data-ttu-id="775e8-133">Hinzufüge- und Nehmevorgänge werden in der Regel in einer Schleife ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="775e8-133">Add and Take operations are typically performed in a loop.</span></span> <span data-ttu-id="775e8-134">Sie können eine Schleife durch die Übergabe eines <xref:System.Threading.CancellationToken> an die <xref:System.Collections.Concurrent.BlockingCollection%601.TryAdd%2A>- oder <xref:System.Collections.Concurrent.BlockingCollection%601.TryTake%2A>-Methode abbrechen und dann den Wert der <xref:System.Threading.CancellationToken.IsCancellationRequested%2A>-Eigenschaft des Tokens in jeder Iteration überprüfen.</span><span class="sxs-lookup"><span data-stu-id="775e8-134">You can cancel a loop by passing in a <xref:System.Threading.CancellationToken> to the <xref:System.Collections.Concurrent.BlockingCollection%601.TryAdd%2A> or <xref:System.Collections.Concurrent.BlockingCollection%601.TryTake%2A> method, and then checking the value of the token's <xref:System.Threading.CancellationToken.IsCancellationRequested%2A> property on each iteration.</span></span> <span data-ttu-id="775e8-135">Wenn der Wert WAHR ist, liegt es an Ihnen, auf die Abbruchanforderung durch Bereinigen aller Ressourcen und Beenden der Schleife zu reagieren.</span><span class="sxs-lookup"><span data-stu-id="775e8-135">If the value is true, then it is up to you to respond the cancellation request by cleaning up any resources and exiting the loop.</span></span> <span data-ttu-id="775e8-136">Das folgende Beispiel zeigt eine Überladung von <xref:System.Collections.Concurrent.BlockingCollection%601.TryAdd%2A>, die ein Abbruchtoken entgegennimmt, und den Code, der es verwendet:</span><span class="sxs-lookup"><span data-stu-id="775e8-136">The following example shows an overload of <xref:System.Collections.Concurrent.BlockingCollection%601.TryAdd%2A> that takes a cancellation token, and the code that uses it:</span></span>  
  
 [!code-csharp[CDS_BlockingCollection#05](../../../../samples/snippets/csharp/VS_Snippets_Misc/cds_blockingcollection/cs/blockingcollection.cs#05)]
 [!code-vb[CDS_BlockingCollection#05](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/cds_blockingcollection/vb/introsnippetsbc.vb#05)]  
  
 <span data-ttu-id="775e8-137">Ein Beispiel für das Hinzufügen von Abbruchunterstützung ist das zweite Beispiel unter [Gewusst wie: Hinzufügen und Entfernen von einzelnen Elementen zu bzw. aus einer BlockingCollection](../../../../docs/standard/collections/thread-safe/how-to-add-and-take-items.md).</span><span class="sxs-lookup"><span data-stu-id="775e8-137">For an example of how to add cancellation support, see the second example in [How to: Add and Take Items Individually from a BlockingCollection](../../../../docs/standard/collections/thread-safe/how-to-add-and-take-items.md).</span></span>  
  
## <a name="specifying-the-collection-type"></a><span data-ttu-id="775e8-138">Angeben des Auflistungstyps</span><span class="sxs-lookup"><span data-stu-id="775e8-138">Specifying the Collection Type</span></span>  
 <span data-ttu-id="775e8-139">Beim Erstellen einer <xref:System.Collections.Concurrent.BlockingCollection%601> können Sie nicht nur die begrenzte Kapazität angeben, sondern auch den Typ der zu verwendenden Auflistung.</span><span class="sxs-lookup"><span data-stu-id="775e8-139">When you create a <xref:System.Collections.Concurrent.BlockingCollection%601>, you can specify not only the bounded capacity but also the type of collection to use.</span></span> <span data-ttu-id="775e8-140">Sie könnten z.B. einen <xref:System.Collections.Concurrent.ConcurrentQueue%601> für das First-in-First-out-Verhalten (FIFO) oder einen <xref:System.Collections.Concurrent.ConcurrentStack%601> für das Last-in-First-out-Verhalten (LIFO) angeben.</span><span class="sxs-lookup"><span data-stu-id="775e8-140">For example, you could specify a <xref:System.Collections.Concurrent.ConcurrentQueue%601> for first in-first out (FIFO) behavior, or a <xref:System.Collections.Concurrent.ConcurrentStack%601> for last in-first out (LIFO) behavior.</span></span> <span data-ttu-id="775e8-141">Sie können jede Auflistungsklasse verwenden, die die <xref:System.Collections.Concurrent.IProducerConsumerCollection%601>-Schnittstelle implementiert.</span><span class="sxs-lookup"><span data-stu-id="775e8-141">You can use any collection class that implements the <xref:System.Collections.Concurrent.IProducerConsumerCollection%601> interface.</span></span> <span data-ttu-id="775e8-142">Der standardmäßige Auflistungstyp für <xref:System.Collections.Concurrent.BlockingCollection%601> ist <xref:System.Collections.Concurrent.ConcurrentQueue%601>.</span><span class="sxs-lookup"><span data-stu-id="775e8-142">The default collection type for <xref:System.Collections.Concurrent.BlockingCollection%601> is <xref:System.Collections.Concurrent.ConcurrentQueue%601>.</span></span> <span data-ttu-id="775e8-143">Das folgende Codebeispiel veranschaulicht das Erstellen einer <xref:System.Collections.Concurrent.BlockingCollection%601> von Zeichenfolgen, die eine Kapazität von 1000 hat und einen <xref:System.Collections.Concurrent.ConcurrentBag%601> verwendet:</span><span class="sxs-lookup"><span data-stu-id="775e8-143">The following code example shows how to create a <xref:System.Collections.Concurrent.BlockingCollection%601> of strings that has a capacity of 1000 and uses a <xref:System.Collections.Concurrent.ConcurrentBag%601>:</span></span>  
  
```vb  
Dim bc = New BlockingCollection(Of String)(New ConcurrentBag(Of String()), 1000)  
```  
  
```csharp  
BlockingCollection<string> bc = new BlockingCollection<string>(new ConcurrentBag<string>(), 1000 );  
```  
  
 <span data-ttu-id="775e8-144">Weitere Informationen finden Sie unter [Gewusst wie: Hinzufügen von Begrenzungs- und Blockadefunktionen zu einer Auflistung](../../../../docs/standard/collections/thread-safe/how-to-add-bounding-and-blocking.md).</span><span class="sxs-lookup"><span data-stu-id="775e8-144">For more information, see [How to: Add Bounding and Blocking Functionality to a Collection](../../../../docs/standard/collections/thread-safe/how-to-add-bounding-and-blocking.md).</span></span>  
  
## <a name="ienumerable-support"></a><span data-ttu-id="775e8-145">IEnumerable-Unterstützung</span><span class="sxs-lookup"><span data-stu-id="775e8-145">IEnumerable Support</span></span>  
 <span data-ttu-id="775e8-146"><xref:System.Collections.Concurrent.BlockingCollection%601> bietet eine <xref:System.Collections.Concurrent.BlockingCollection%601.GetConsumingEnumerable%2A>-Methode, mit der Consumer eine `foreach` (`For Each` in [!INCLUDE[vbprvb](../../../../includes/vbprvb-md.md)]) verwenden können, um Elemente zu entfernen, bis die Sammlung abgeschlossen ist, d.h. bis sie leer ist und keine Elemente mehr hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="775e8-146"><xref:System.Collections.Concurrent.BlockingCollection%601> provides a <xref:System.Collections.Concurrent.BlockingCollection%601.GetConsumingEnumerable%2A> method that enables consumers to use `foreach` (`For Each` in [!INCLUDE[vbprvb](../../../../includes/vbprvb-md.md)]) to remove items until the collection is completed, which means it is empty and no more items will be added.</span></span> <span data-ttu-id="775e8-147">Weitere Informationen finden Sie unter [Gewusst wie: Entfernen von Elementen in einer BlockingCollection mit ForEach](../../../../docs/standard/collections/thread-safe/how-to-use-foreach-to-remove.md).</span><span class="sxs-lookup"><span data-stu-id="775e8-147">For more information, see [How to: Use ForEach to Remove Items in a BlockingCollection](../../../../docs/standard/collections/thread-safe/how-to-use-foreach-to-remove.md).</span></span>  
  
## <a name="using-many-blockingcollections-as-one"></a><span data-ttu-id="775e8-148">Verwenden vieler BlockingCollections als eine einzige</span><span class="sxs-lookup"><span data-stu-id="775e8-148">Using Many BlockingCollections As One</span></span>  
 <span data-ttu-id="775e8-149">Für Szenarien, in denen ein Consumer Elemente aus mehreren Auflistungen gleichzeitig nehmen muss, können Sie Arrays von <xref:System.Collections.Concurrent.BlockingCollection%601> erstellen und statische Methoden wie <xref:System.Collections.Concurrent.BlockingCollection%601.TakeFromAny%2A> und <xref:System.Collections.Concurrent.BlockingCollection%601.AddToAny%2A> verwenden, die Elemente beliebigen Auflistungen im Array hinzufügen bzw. daraus entnehmen.</span><span class="sxs-lookup"><span data-stu-id="775e8-149">For scenarios in which a consumer needs to take items from multiple collections simultaneously, you can create arrays of <xref:System.Collections.Concurrent.BlockingCollection%601> and use the static methods such as <xref:System.Collections.Concurrent.BlockingCollection%601.TakeFromAny%2A> and <xref:System.Collections.Concurrent.BlockingCollection%601.AddToAny%2A> that will add to or take from any of the collections in the array.</span></span> <span data-ttu-id="775e8-150">Wenn eine Auflistung blockiert wird, versucht die Methode sofort, eine andere zu verwenden, bis sie eine findet, die den Vorgang ausführen kann.</span><span class="sxs-lookup"><span data-stu-id="775e8-150">If one collection is blocking, the method immediately tries another until it finds one that can perform the operation.</span></span> <span data-ttu-id="775e8-151">Weitere Informationen finden Sie unter [Gewusst wie: Verwenden von Arrays mit blockierenden Auflistungen in einer Pipeline](../../../../docs/standard/collections/thread-safe/how-to-use-arrays-of-blockingcollections.md).</span><span class="sxs-lookup"><span data-stu-id="775e8-151">For more information, see [How to: Use Arrays of Blocking Collections in a Pipeline](../../../../docs/standard/collections/thread-safe/how-to-use-arrays-of-blockingcollections.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="775e8-152">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="775e8-152">See Also</span></span>  
 <xref:System.Collections.Concurrent?displayProperty=nameWithType>  
 [<span data-ttu-id="775e8-153">Auflistungen und Datenstrukturen</span><span class="sxs-lookup"><span data-stu-id="775e8-153">Collections and Data Structures</span></span>](../../../../docs/standard/collections/index.md)  
 [<span data-ttu-id="775e8-154">Threadsichere Sammlungen</span><span class="sxs-lookup"><span data-stu-id="775e8-154">Thread-Safe Collections</span></span>](../../../../docs/standard/collections/thread-safe/index.md)
