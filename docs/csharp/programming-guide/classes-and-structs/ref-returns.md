---
title: "Ref-Rückgabewerte und lokale ref-Variablen (Leitfaden für C#)"
description: "Erfahren Sie, wie Sie ref-Rückgaben und lokale ref-Werte definieren und verwenden können."
author: rpetrusha
ms.author: ronpet
ms.date: 05/30/2017
ms.topic: article
ms.prod: .net
ms.technology: devlang-csharp
ms.devlang: csharp
ms.assetid: 18cf7a4b-29f0-4b14-85b8-80af754aabd8
ms.translationtype: HT
ms.sourcegitcommit: 4582cb0ee091526423cce3fc1d8243029f34f59c
ms.openlocfilehash: 3f2ee35db5b77efcce629b6315060a723429b19c
ms.contentlocale: de-de
ms.lasthandoff: 08/16/2017

---
# <a name="ref-returns-and-ref-locals"></a><span data-ttu-id="222ec-103">Ref-Rückgaben und lokale ref-Variablen</span><span class="sxs-lookup"><span data-stu-id="222ec-103">Ref returns and ref locals</span></span>

<span data-ttu-id="222ec-104">Ab C# 7 unterstützt C# Verweisrückgabewerte (ref-Rückgaben).</span><span class="sxs-lookup"><span data-stu-id="222ec-104">Starting with C# 7, C# supports reference return values (ref returns).</span></span> <span data-ttu-id="222ec-105">Mit einem Verweisrückgabewert kann eine Methode einen Verweis auf ein Objekt statt einen Wert an eine aufrufende Funktion zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="222ec-105">A reference return value allows a method to return a reference to an object, rather than a value, back to a caller.</span></span> <span data-ttu-id="222ec-106">Die aufrufende Funktion kann dann wählen, ob sie das zurückgegebene Objekt behandelt, als wäre es als Wert oder als Verweis zurückgegeben worden.</span><span class="sxs-lookup"><span data-stu-id="222ec-106">The caller can then choose to treat the returned object returned as if it were returned by value or by reference.</span></span> <span data-ttu-id="222ec-107">Ein als Verweis zurückgegebener Wert, den die aufrufende Funktion als Verweis statt als Wert behandelt, ist ein lokaler ref-Wert.</span><span class="sxs-lookup"><span data-stu-id="222ec-107">A value returned by reference that the caller handles as a reference rather than a value is a ref local.</span></span>

## <a name="what-is-a-reference-return-value"></a><span data-ttu-id="222ec-108">Was ist ein Verweisrückgabewert?</span><span class="sxs-lookup"><span data-stu-id="222ec-108">What is a reference return value?</span></span>

<span data-ttu-id="222ec-109">Die meisten Entwickler sind mit dem Übergeben eines Arguments *als Verweis* an eine aufgerufene Methode vertraut.</span><span class="sxs-lookup"><span data-stu-id="222ec-109">Most developers are familiar with passing an argument to a called method *by reference*.</span></span> <span data-ttu-id="222ec-110">Die Argumentliste einer aufgerufenen Methode umfasst einen als Verweis übergebenen Wert, und alle durch die aufgerufene Methode am Wert vorgenommenen Änderungen werden an die aufrufende Funktion zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="222ec-110">A called method's argument list includes a value passed by reference, and any changes made to its value by the called method are returned to the caller.</span></span> <span data-ttu-id="222ec-111">Ein *Verweisrückgabewert* ist das Gegenteil:</span><span class="sxs-lookup"><span data-stu-id="222ec-111">A *reference return value* is the opposite:</span></span>

- <span data-ttu-id="222ec-112">Bei dem Rückgabewert der aufgerufenen Methode handelt es sich um einen Verweis statt um ein Argument, das an sie übergeben wurde.</span><span class="sxs-lookup"><span data-stu-id="222ec-112">The called method's return value, rather than an argument passed to it, is a reference.</span></span>

- <span data-ttu-id="222ec-113">Statt der aufgerufenen Methode kann die aufrufende Funktion den von der Methode zurückgegebenen Wert ändern.</span><span class="sxs-lookup"><span data-stu-id="222ec-113">The caller, rather than the called method, can modify the value returned by the method.</span></span>

- <span data-ttu-id="222ec-114">Anstelle von Änderungen am Argument, die im Zustand des Objekts auf der aufrufenden Funktion wiedergegeben werden, werden Änderungen durch die aufrufende Funktion am Rückgabewert der Methode im Zustand des Objekts wiedergegeben, dessen Methode aufgerufen wurde.</span><span class="sxs-lookup"><span data-stu-id="222ec-114">Instead of modifications to the argument that are reflected in state of the object on the caller, modifications to the method's return value by the caller are reflected in the state of the object whose method was called.</span></span>

<span data-ttu-id="222ec-115">Verweisrückgabewerte können kompakteren Code erzeugen sowie einem Objekt die Möglichkeit geben, nur die einzelnen Datenelemente wie ein Arrayelement verfügbar zu machen, die für die aufrufende Funktion von Interesse sind.</span><span class="sxs-lookup"><span data-stu-id="222ec-115">Reference return values can produce more compact code, as well as allow an object to expose only the individual data items, such as an array element, that are of interest to the caller.</span></span> <span data-ttu-id="222ec-116">Dadurch wird die Wahrscheinlichkeit geringer, dass die aufrufende Funktion den Zustand des Objekts versehentlich ändert.</span><span class="sxs-lookup"><span data-stu-id="222ec-116">This reduces the likelihood that the caller will inadvertently modify the object's state.</span></span>

<span data-ttu-id="222ec-117">Es gibt einige Einschränkungen für den Wert, den eine Methode als Rückgabewert zurückgeben kann.</span><span class="sxs-lookup"><span data-stu-id="222ec-117">There are some restrictions on the value that a method can return as a reference return value.</span></span> <span data-ttu-id="222ec-118">Dazu gehören:</span><span class="sxs-lookup"><span data-stu-id="222ec-118">These include:</span></span>

- <span data-ttu-id="222ec-119">Der Rückgabewert kann nicht `void` sein.</span><span class="sxs-lookup"><span data-stu-id="222ec-119">The return value cannot be `void`.</span></span> <span data-ttu-id="222ec-120">Bei dem Versuch, eine Methode mit einem `void`-Verweisrückgabewert zu definieren, tritt der Compilerfehler CS1547 „Das void-Schlüsselwort kann in diesem Kontext nicht verwendet werden.“ auf.</span><span class="sxs-lookup"><span data-stu-id="222ec-120">Attempting to define a method with a `void` reference return value generates compiler error CS1547, "Keyword 'void' cannot be used in this context."</span></span>
 
- <span data-ttu-id="222ec-121">Der zurückgegebene Wert darf keine lokale Variable in der Methode sein, die ihn zurückgibt; er muss über einen Bereich verfügen, der außerhalb der Methode liegt, die ihn zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="222ec-121">The return value cannot be a local variable in the method that returns it; it must have a scope that is outside the method that returns it.</span></span> <span data-ttu-id="222ec-122">Es kann sich dabei um eine Instanz oder ein statisches Feld einer Klasse oder um ein Argument handeln, das an die Methode übergeben wurde.</span><span class="sxs-lookup"><span data-stu-id="222ec-122">It can be an instance or static field of a class, or it can be an argument passed to the method.</span></span> <span data-ttu-id="222ec-123">Beim Versuch, eine lokale Variable zurückzugeben, tritt der Compilerfehler CS8168 „Cannot return local 'obj' by reference because it is not a ref local.“ (Der lokale Wert „obj“ kann nicht als Verweis zurückgegeben werden, da er kein lokaler ref-Wert ist.) auf.</span><span class="sxs-lookup"><span data-stu-id="222ec-123">Attempting to return a local variable generates compiler error CS8168, "Cannot return local 'obj' by reference because it is not a ref local."</span></span>

- <span data-ttu-id="222ec-124">Der Rückgabewert kann nicht `null` sein.</span><span class="sxs-lookup"><span data-stu-id="222ec-124">The return value cannot be a `null`.</span></span> <span data-ttu-id="222ec-125">Beim Versuch, `null` zurückzugeben, tritt der Compilerfehler CS8156 „Ein Ausdruck kann in diesem Kontext nicht verwendet werden, weil er ggf. nicht als Verweis zurückgegeben wird.“ auf.</span><span class="sxs-lookup"><span data-stu-id="222ec-125">Attempting to return `null` generates compiler error CS8156, "An expression cannot be used in this context because it may not be returned by reference."</span></span>

   <span data-ttu-id="222ec-126">Wenn eine Methode mit einer ref-Rückgabe einen NULL-Wert zurückgeben muss, können Sie entweder einen NULL-Wert (nicht instanziiert) für einen Verweistyp oder einen [Nullable-Typ](../nullable-types/index.md) für einen Werttyp zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="222ec-126">If a method with a ref return needs to return a null value, you can either return a null (uninstantiated) value for a reference type or a [nullable type](../nullable-types/index.md) for a value type.</span></span>
 
- <span data-ttu-id="222ec-127">Der zurückgegebene Wert darf keine Konstante, kein Enumerationsmember und keine Eigenschaft einer `class` oder `struct` sein.</span><span class="sxs-lookup"><span data-stu-id="222ec-127">The return value cannot be a constant, an enumeration member, or a property of a `class` or `struct`.</span></span> <span data-ttu-id="222ec-128">Beim Versuch, diese zurückzugeben, tritt der Compilerfehler CS8156 „Ein Ausdruck kann in diesem Kontext nicht verwendet werden, weil er ggf. nicht als Verweis zurückgegeben wird.“ auf.</span><span class="sxs-lookup"><span data-stu-id="222ec-128">Attempting to return these generates compiler error CS8156, "An expression cannot be used in this context because it may not be returned by reference."</span></span>

<span data-ttu-id="222ec-129">Darüber hinaus sind Verweisrückgabewerte bei asynchronen Methoden nicht erlaubt, da eine asynchrone Methode etwas zurückgeben könnte, bevor die Ausführung abgeschlossen und ihr Rückgabewert bekannt ist.</span><span class="sxs-lookup"><span data-stu-id="222ec-129">In addition, because an asynchronous method may return before it has finished execution, while its return value is still unknown, reference return values are not allowed on async methods.</span></span>
 
## <a name="defining-a-ref-return-value"></a><span data-ttu-id="222ec-130">Definieren eines ref-Rückgabewerts</span><span class="sxs-lookup"><span data-stu-id="222ec-130">Defining a ref return value</span></span>

<span data-ttu-id="222ec-131">Sie definieren einen ref-Rückgabewert, indem Sie dem Rückgabetyp der Methodensignatur das Schlüsselwort [ref](../../language-reference/keywords/ref.md) hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="222ec-131">You define a ref return value by adding the [ref](../../language-reference/keywords/ref.md) keyword to the return type of the method signature.</span></span> <span data-ttu-id="222ec-132">Beispielsweise gibt die folgende Signatur an, dass die `GetContactInformation`-Eigenschaft einen Verweis auf ein `Person`-Objekt an die aufrufende Funktion zurückgibt:</span><span class="sxs-lookup"><span data-stu-id="222ec-132">For example, the following signature indicates that the `GetContactInformation` property returns a reference to a `Person` object to the caller:</span></span>

```csharp
public ref Person GetContactInformation(string fname, string lname);
```

<span data-ttu-id="222ec-133">Darüber hinaus muss vor dem Namen des Objekts, das durch jede [return](../../language-reference/keywords/return.md)-Anweisung im Methodentext zurückgegeben wird, das Schlüsselwort [ref](../../language-reference/keywords/ref.md) stehen.</span><span class="sxs-lookup"><span data-stu-id="222ec-133">In addition, the name of the object returned by each [return](../../language-reference/keywords/return.md) statement in the method body must be preceded by the [ref](../../language-reference/keywords/ref.md) keyword.</span></span> <span data-ttu-id="222ec-134">Beispielsweise gibt die folgende `return`-Anweisung ein `Person`-Objekt mit dem Namen `p` als Verweis zurück:</span><span class="sxs-lookup"><span data-stu-id="222ec-134">For example, the following `return` statement returns a `Person` object named `p` by reference:</span></span>

```csharp
return ref p;
```

## <a name="consuming-a-ref-return-value"></a><span data-ttu-id="222ec-135">Verarbeiten eines ref-Rückgabewerts</span><span class="sxs-lookup"><span data-stu-id="222ec-135">Consuming a ref return value</span></span>

<span data-ttu-id="222ec-136">Eine aufrufende Funktion kann einen ref-Rückgabewert auf zwei Weisen behandeln:</span><span class="sxs-lookup"><span data-stu-id="222ec-136">A caller can handle a ref return value in either of two ways:</span></span>

- <span data-ttu-id="222ec-137">Als gewöhnlicher Wert, der von einer Methode als Wert zurückgegeben wurde.</span><span class="sxs-lookup"><span data-stu-id="222ec-137">As an ordinary value returned by value from a method.</span></span> <span data-ttu-id="222ec-138">Die aufrufende Funktion kann sich dazu entscheiden, zu ignorieren, dass es sich bei dem Rückgabewert um einen Verweisrückgabewert handelt.</span><span class="sxs-lookup"><span data-stu-id="222ec-138">The caller can choose to ignore that the return value is a reference return value.</span></span> <span data-ttu-id="222ec-139">In diesem Fall werden die Änderungen an dem vom Methodenaufruf zurückgegebenen Wert im Zustand des aufgerufenen Typs nicht wiedergegeben.</span><span class="sxs-lookup"><span data-stu-id="222ec-139">In this case, any changes made to the value returned by the method call are not reflected in the state of the called type.</span></span> <span data-ttu-id="222ec-140">Wenn es sich beim zurückgegebenen Wert um einen Werttyp handelt, werden die Änderungen an dem vom Methodenaufruf zurückgegebenen Wert im Zustand des aufgerufenen Typs nicht wiedergegeben.</span><span class="sxs-lookup"><span data-stu-id="222ec-140">If the returned value is a value type, any changes made to the value returned by the method call are not reflected in the state of the called type.</span></span>

- <span data-ttu-id="222ec-141">Als Verweisrückgabewert.</span><span class="sxs-lookup"><span data-stu-id="222ec-141">As a reference return value.</span></span> <span data-ttu-id="222ec-142">Die aufrufende Funktion muss die Variable, der der Verweisrückgabewert zugewiesen ist, als eine [lokale ref-Variable](#ref-local) definieren, und alle Änderungen an dem vom Methodenaufruf zurückgegebenen Wert werden im Zustand des aufgerufenen Typs wiedergegeben.</span><span class="sxs-lookup"><span data-stu-id="222ec-142">The caller must define the variable to which the reference return value is assigned as a [ref local](#ref-local), and any changes to the value returned by the method call are reflected in the state of the called type.</span></span> 

## <a name="ref-locals"></a><span data-ttu-id="222ec-143">Lokale ref-Variablen</span><span class="sxs-lookup"><span data-stu-id="222ec-143">Ref locals</span></span>

<span data-ttu-id="222ec-144">Um den Verweisrückgabewert als Verweis behandeln zu können, muss die aufrufende Funktion den Wert mithilfe des Schlüsselworts `ref` als *lokale ref-Variable* deklarieren.</span><span class="sxs-lookup"><span data-stu-id="222ec-144">To handle the reference return value as a reference, the caller must declare the value to be a *ref local* by using the `ref` keyword.</span></span> <span data-ttu-id="222ec-145">Wenn beispielsweise der von der `Person.GetContactInfomation`-Methode zurückgegebene Wert als Verweis anstatt als Wert bearbeitet werden soll, erscheint der Methodenaufruf folgendermaßen:</span><span class="sxs-lookup"><span data-stu-id="222ec-145">For example, if the value returned by the `Person.GetContactInfomation` method is to be consumed as a reference rather than a value, the method call appears as:</span></span>

```csharp
ref Person p = ref contacts.GetContactInformation("Brandie", "Best");
```

<span data-ttu-id="222ec-146">Beachten Sie, dass das Schlüsselwort `ref` sowohl vor der Deklaration lokaler Variablen *als auch* vor dem Methodenaufruf verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="222ec-146">Note that the `ref` keyword is used both before the local variable declaration *and* before the method call.</span></span> <span data-ttu-id="222ec-147">Wenn nicht beide `ref`-Schlüsselwörter in den Ergebnissen der Variablendeklaration und der Zuweisung enthalten sind, tritt der Compilerfehler CS8172 „Eine by-reference-Variable kann nicht mit einem Wert initialisiert werden.“ auf.</span><span class="sxs-lookup"><span data-stu-id="222ec-147">Failure to include both `ref` keywords in the variable declaration and assignment results in compiler error CS8172, "Cannot initialize a by-reference variable with a value."</span></span> 
 
<span data-ttu-id="222ec-148">Spätere Änderungen am von der Methode zurückgegebenen `Person`-Objekt werden im `contacts`-Objekt wiedergegeben.</span><span class="sxs-lookup"><span data-stu-id="222ec-148">Subsequent changes to the `Person` object returned by the method are reflected in the `contacts` object.</span></span>

<span data-ttu-id="222ec-149">Wenn `p` nicht mithilfe des `ref`-Schlüsselworts als eine lokale ref-Variable definiert wird, werden die von der aufrufenden Funktion vorgenommenen Änderungen an `p` nicht im `contacts`-Objekt wiedergegeben.</span><span class="sxs-lookup"><span data-stu-id="222ec-149">If `p` is not defined as a ref local by using the `ref` keyword, any changes made to `p` by the caller are not reflected in the `contacts` object.</span></span>
 
## <a name="ref-returns-and-ref-locals-an-example"></a><span data-ttu-id="222ec-150">Ref-Rückgaben und lokale ref-Variablen: ein Beispiel</span><span class="sxs-lookup"><span data-stu-id="222ec-150">Ref returns and ref locals: an example</span></span>

<span data-ttu-id="222ec-151">Das folgende Beispiel definiert eine `NumberStore`-Klasse, die ein Array von Integer-Werten speichert.</span><span class="sxs-lookup"><span data-stu-id="222ec-151">The following example defines a `NumberStore` class that stores an array of integer values.</span></span> <span data-ttu-id="222ec-152">Die `FindNumber`-Methode gibt die erste Anzahl, die größer als oder gleich der Anzahl ist, die als Argument übergeben wurde, als Verweis zurück.</span><span class="sxs-lookup"><span data-stu-id="222ec-152">The `FindNumber` method returns by reference the first number that is greater than or equal to the number passed as an argument.</span></span> <span data-ttu-id="222ec-153">Wenn keine Anzahl größer als oder gleich dem Argument ist, gibt die Methode die Anzahl im Index 0 zurück.</span><span class="sxs-lookup"><span data-stu-id="222ec-153">If no number is greater than or equal to the argument, the method returns the number in index 0.</span></span> 

<span data-ttu-id="222ec-154">[!CODE-cs[ref-Rückgaben](../../../../samples/snippets/csharp/programming-guide/ref-returns/ref-returns1.cs#1)]</span><span class="sxs-lookup"><span data-stu-id="222ec-154">[!CODE-cs[ref-returns](../../../../samples/snippets/csharp/programming-guide/ref-returns/ref-returns1.cs#1)]</span></span>

<span data-ttu-id="222ec-155">Im folgenden Beispiel wird die `NumberStore.FindNumber`-Methode aufgerufen, um den ersten Wert abzurufen, der größer als oder gleich 16 ist.</span><span class="sxs-lookup"><span data-stu-id="222ec-155">The following example calls the `NumberStore.FindNumber` method to retrieve the first value that is greater than or equal to 16.</span></span> <span data-ttu-id="222ec-156">Die aufrufende Funktion verdoppelt dann den von der Methode zurückgegebenen Wert.</span><span class="sxs-lookup"><span data-stu-id="222ec-156">The caller then doubles the value returned by the method.</span></span> <span data-ttu-id="222ec-157">Wie die Ausgabe aus dem Beispiel zeigt, wird diese Änderung im Wert der Arrayelemente der `NumberStore`-Instanz wiedergegeben.</span><span class="sxs-lookup"><span data-stu-id="222ec-157">As the output from the example shows, this change is reflected in the value of the array elements of the `NumberStore` instance.</span></span>

<span data-ttu-id="222ec-158">[!CODE-cs[ref-Rückgaben](../../../../samples/snippets/csharp/programming-guide/ref-returns/ref-returns1.cs#2)]</span><span class="sxs-lookup"><span data-stu-id="222ec-158">[!CODE-cs[ref-returns](../../../../samples/snippets/csharp/programming-guide/ref-returns/ref-returns1.cs#2)]</span></span>

<span data-ttu-id="222ec-159">Ohne Unterstützung für Verweisrückgabewerte wird ein solcher Vorgang in der Regel durchgeführt, indem der Index des Arrayelements zusammen mit seinem Wert zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="222ec-159">Without support for reference return values, such an operation is usually performed by returning the index of the array element along with its value.</span></span> <span data-ttu-id="222ec-160">Die aufrufende Funktion kann diesen Index dann dazu verwenden, den Wert in einem separaten Methodenaufruf zu ändern.</span><span class="sxs-lookup"><span data-stu-id="222ec-160">The caller can then use this index to modify the value in a separate method call.</span></span> <span data-ttu-id="222ec-161">Die aufrufende Funktion kann den Index jedoch auch ändern, um auf andere Arraywerte zuzugreifen und diese zu bearbeiten.</span><span class="sxs-lookup"><span data-stu-id="222ec-161">However, the caller can also modify the index to access and possibly modify other array values.</span></span>  
 
## <a name="see-also"></a><span data-ttu-id="222ec-162">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="222ec-162">See also</span></span>

[<span data-ttu-id="222ec-163">ref (C#-Referenz)</span><span class="sxs-lookup"><span data-stu-id="222ec-163">ref keyword</span></span>](../../language-reference/keywords/ref.md)

