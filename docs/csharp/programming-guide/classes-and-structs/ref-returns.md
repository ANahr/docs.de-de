---
title: "Ref-Rückgabewerte und lokale ref-Variablen (Leitfaden für C#)"
description: "Erfahren Sie, wie Sie ref-Rückgaben und lokale ref-Werte definieren und verwenden können."
author: rpetrusha
ms.author: ronpet
ms.date: 01/23/2017
ms.topic: article
ms.prod: .net
ms.technology: devlang-csharp
ms.devlang: csharp
ms.openlocfilehash: a74563c0d24b6cd2a2fa8534787f078f3cc92674
ms.sourcegitcommit: cf22b29db780e532e1090c6e755aa52d28273fa6
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 02/01/2018
---
# <a name="ref-returns-and-ref-locals"></a><span data-ttu-id="f9e08-103">Ref-Rückgaben und lokale ref-Variablen</span><span class="sxs-lookup"><span data-stu-id="f9e08-103">Ref returns and ref locals</span></span>

<span data-ttu-id="f9e08-104">Ab C# 7 unterstützt C# Verweisrückgabewerte (ref-Rückgaben).</span><span class="sxs-lookup"><span data-stu-id="f9e08-104">Starting with C# 7, C# supports reference return values (ref returns).</span></span> <span data-ttu-id="f9e08-105">Mit einem Verweisrückgabewert kann eine Methode einen Verweis auf eine Variable statt eines Werts an eine aufrufende Funktion zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="f9e08-105">A reference return value allows a method to return a reference to a variable, rather than a value, back to a caller.</span></span> <span data-ttu-id="f9e08-106">Die aufrufende Funktion kann dann wählen, ob sie die zurückgegebene Variable behandelt, als wäre sie als Wert oder als Verweis zurückgegeben worden.</span><span class="sxs-lookup"><span data-stu-id="f9e08-106">The caller can then choose to treat the returned variable as if it were returned by value or by reference.</span></span> <span data-ttu-id="f9e08-107">Die aufrufende Funktion kann eine neue Variable erstellen, die selbst einen Verweis auf den zurückgegebenen Wert (als lokaler Verweis bezeichnet) darstellt.</span><span class="sxs-lookup"><span data-stu-id="f9e08-107">The caller can create a new variable that is itself a reference to the returned value, called a ref local.</span></span>

## <a name="what-is-a-reference-return-value"></a><span data-ttu-id="f9e08-108">Was ist ein Verweisrückgabewert?</span><span class="sxs-lookup"><span data-stu-id="f9e08-108">What is a reference return value?</span></span>

<span data-ttu-id="f9e08-109">Die meisten Entwickler sind mit dem Übergeben eines Arguments *als Verweis* an eine aufgerufene Methode vertraut.</span><span class="sxs-lookup"><span data-stu-id="f9e08-109">Most developers are familiar with passing an argument to a called method *by reference*.</span></span> <span data-ttu-id="f9e08-110">Die Argumentliste einer aufgerufenen Methode umfasst eine als Verweis übergebene Variable, und alle durch die aufgerufene Methode am Wert vorgenommenen Änderungen werden von der aufrufenden Funktion überwacht.</span><span class="sxs-lookup"><span data-stu-id="f9e08-110">A called method's argument list includes a variable passed by reference, and any changes made to its value by the called method are observed by the caller.</span></span> <span data-ttu-id="f9e08-111">Ein *Verweisrückgabewert* bedeutet, dass eine Methode einen *Verweis* (oder Alias) an einige Variablen zurückgibt, deren Geltungsbereich die Methode umfasst und deren Lebensdauer über die Rückgabe der Methode hinausgehen muss.</span><span class="sxs-lookup"><span data-stu-id="f9e08-111">A *reference return value* means that a method returns a *reference* (or an alias) to some variable whose scope includes the method and whose lifetime must extend beyond the return of the method.</span></span> <span data-ttu-id="f9e08-112">Änderungen am Methodenrückgabewert durch die aufrufende Funktion werden auf die Variable angewendet, die von der Methode zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="f9e08-112">Modifications to the method's return value by the caller are made to the variable that is returned by the method.</span></span>

<span data-ttu-id="f9e08-113">Die Deklaration der Rückgabe eines *Verweisrückgabewerts* durch eine Methode weist darauf hin, dass die Methode einen Alias an eine Variable zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="f9e08-113">Declaring that a method returns a *reference return value* indicates that the method returns an alias to a variable.</span></span> <span data-ttu-id="f9e08-114">Das Entwurfsziel dahinter besteht häufig darin, dem aufrufenden Code über den Alias Zugriff auf diese Variable sowie die Möglichkeit zu deren Änderung zu gewähren.</span><span class="sxs-lookup"><span data-stu-id="f9e08-114">The design intent is often that the calling code should have access to that variable through the alias, including to modify it.</span></span> <span data-ttu-id="f9e08-115">Daraus folgt, dass vom Verweis zurückgegebene Methoden nicht den Rückgabetyp `void` aufweisen dürfen.</span><span class="sxs-lookup"><span data-stu-id="f9e08-115">It follows that methods returning by reference cannot have the return type `void`.</span></span>

<span data-ttu-id="f9e08-116">Es gibt einige Einschränkungen für den Ausdruck, den eine Methode als Verweisrückgabewert zurückgeben kann.</span><span class="sxs-lookup"><span data-stu-id="f9e08-116">There are some restrictions on the expression that a method can return as a reference return value.</span></span> <span data-ttu-id="f9e08-117">Dazu gehören:</span><span class="sxs-lookup"><span data-stu-id="f9e08-117">These include:</span></span>

- <span data-ttu-id="f9e08-118">Der Rückgabewert muss eine Lebensdauer aufweisen, die über die Ausführung der Methode hinausgeht.</span><span class="sxs-lookup"><span data-stu-id="f9e08-118">The return value must have a lifetime that extends beyond the execution of the method.</span></span> <span data-ttu-id="f9e08-119">Mit anderen Worten: Er darf in der Methode, die diesen zurückgibt, keine lokale Variable sein.</span><span class="sxs-lookup"><span data-stu-id="f9e08-119">In other words, it cannot be a local variable in the method that returns it.</span></span> <span data-ttu-id="f9e08-120">Es kann sich dabei um eine Instanz oder ein statisches Feld einer Klasse oder um ein Argument handeln, das an die Methode übergeben wurde.</span><span class="sxs-lookup"><span data-stu-id="f9e08-120">It can be an instance or static field of a class, or it can be an argument passed to the method.</span></span> <span data-ttu-id="f9e08-121">Beim Versuch, eine lokale Variable zurückzugeben, tritt der Compilerfehler CS8168 „Cannot return local 'obj' by reference because it is not a ref local.“ (Der lokale Wert „obj“ kann nicht als Verweis zurückgegeben werden, da er kein lokaler ref-Wert ist.) auf.</span><span class="sxs-lookup"><span data-stu-id="f9e08-121">Attempting to return a local variable generates compiler error CS8168, "Cannot return local 'obj' by reference because it is not a ref local."</span></span>

- <span data-ttu-id="f9e08-122">Der Rückgabewert darf nicht das `null`-Literal sein.</span><span class="sxs-lookup"><span data-stu-id="f9e08-122">The return value cannot be the literal `null`.</span></span> <span data-ttu-id="f9e08-123">Beim Versuch, `null` zurückzugeben, tritt der Compilerfehler CS8156 „Ein Ausdruck kann in diesem Kontext nicht verwendet werden, weil er ggf. nicht als Verweis zurückgegeben wird.“ auf.</span><span class="sxs-lookup"><span data-stu-id="f9e08-123">Attempting to return `null` generates compiler error CS8156, "An expression cannot be used in this context because it may not be returned by reference."</span></span>

   <span data-ttu-id="f9e08-124">Eine Methode mit einer Verweisrückgabe kann einen Alias an eine Variable zurückgeben, deren Wert derzeit null ist (nicht instanziiert) oder ein [Nullable-Typ](../nullable-types/index.md) für einen Werttyp darstellt.</span><span class="sxs-lookup"><span data-stu-id="f9e08-124">A method with a ref return can return an alias to a variable whose value is currently the null (uninstantiated) value or a [nullable type](../nullable-types/index.md) for a value type.</span></span>
 
- <span data-ttu-id="f9e08-125">Der Rückgabewert darf keine Konstante, kein Enumerationsmember, nicht der by-value-Rückgabewert einer Eigenschaft und keine Methode einer `class` oder `struct` sein.</span><span class="sxs-lookup"><span data-stu-id="f9e08-125">The return value cannot be a constant, an enumeration member, the by-value return value from a property, or a method of a `class` or `struct`.</span></span> <span data-ttu-id="f9e08-126">Beim Versuch, diese zurückzugeben, tritt der Compilerfehler CS8156 „Ein Ausdruck kann in diesem Kontext nicht verwendet werden, weil er ggf. nicht als Verweis zurückgegeben wird.“ auf.</span><span class="sxs-lookup"><span data-stu-id="f9e08-126">Attempting to return these generates compiler error CS8156, "An expression cannot be used in this context because it may not be returned by reference."</span></span>

<span data-ttu-id="f9e08-127">Darüber hinaus sind Verweisrückgabewerte bei asynchronen Methoden nicht erlaubt, da eine asynchrone Methode etwas zurückgeben könnte, bevor die Ausführung abgeschlossen und ihr Rückgabewert bekannt ist.</span><span class="sxs-lookup"><span data-stu-id="f9e08-127">In addition, because an asynchronous method may return before it has finished execution, while its return value is still unknown, reference return values are not allowed on async methods.</span></span>
 
## <a name="defining-a-ref-return-value"></a><span data-ttu-id="f9e08-128">Definieren eines ref-Rückgabewerts</span><span class="sxs-lookup"><span data-stu-id="f9e08-128">Defining a ref return value</span></span>

<span data-ttu-id="f9e08-129">Sie definieren einen ref-Rückgabewert, indem Sie dem Rückgabetyp der Methodensignatur das Schlüsselwort [ref](../../language-reference/keywords/ref.md) hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="f9e08-129">You define a ref return value by adding the [ref](../../language-reference/keywords/ref.md) keyword to the return type of the method signature.</span></span> <span data-ttu-id="f9e08-130">Beispielsweise gibt die folgende Signatur an, dass die `GetContactInformation`-Eigenschaft einen Verweis auf ein `Person`-Objekt an die aufrufende Funktion zurückgibt:</span><span class="sxs-lookup"><span data-stu-id="f9e08-130">For example, the following signature indicates that the `GetContactInformation` property returns a reference to a `Person` object to the caller:</span></span>

```csharp
public ref Person GetContactInformation(string fname, string lname);
```

<span data-ttu-id="f9e08-131">Darüber hinaus muss vor dem Namen des Objekts, das durch jede [return](../../language-reference/keywords/return.md)-Anweisung im Methodentext zurückgegeben wird, das Schlüsselwort [ref](../../language-reference/keywords/ref.md) stehen.</span><span class="sxs-lookup"><span data-stu-id="f9e08-131">In addition, the name of the object returned by each [return](../../language-reference/keywords/return.md) statement in the method body must be preceded by the [ref](../../language-reference/keywords/ref.md) keyword.</span></span> <span data-ttu-id="f9e08-132">Beispielsweise gibt die folgende `return`-Anweisung einen Verweis auf ein `Person`-Objekt mit dem Namen `p` zurück:</span><span class="sxs-lookup"><span data-stu-id="f9e08-132">For example, the following `return` statement returns a reference to a `Person` object named `p`:</span></span>

```csharp
return ref p;
```

## <a name="consuming-a-ref-return-value"></a><span data-ttu-id="f9e08-133">Verarbeiten eines ref-Rückgabewerts</span><span class="sxs-lookup"><span data-stu-id="f9e08-133">Consuming a ref return value</span></span>

<span data-ttu-id="f9e08-134">Der Verweisrückgabewert ist ein Alias für eine andere Variable im Bereich der aufgerufenen Methode.</span><span class="sxs-lookup"><span data-stu-id="f9e08-134">The ref return value is an alias to another variable in the called method's scope.</span></span> <span data-ttu-id="f9e08-135">Sie können jede Verwendung der Verweisrückgabe als Verwendung der Variable interpretieren, für die diese als Alias fungiert:</span><span class="sxs-lookup"><span data-stu-id="f9e08-135">You can interpret any use of the ref return as using the variable it aliases:</span></span>

- <span data-ttu-id="f9e08-136">Wenn Sie den jeweiligen Wert zuweisen, weisen Sie der Variable, für die diese als Alias fungiert, einen Wert zu.</span><span class="sxs-lookup"><span data-stu-id="f9e08-136">When you assign its value, you are assigning a value to the variable it aliases.</span></span>
- <span data-ttu-id="f9e08-137">Wenn Sie dessen Wert lesen, lesen Sie den Wert der Variable, für die diese als Alias fungiert.</span><span class="sxs-lookup"><span data-stu-id="f9e08-137">When you read its value, you are reading the value of the variable it aliases.</span></span>
- <span data-ttu-id="f9e08-138">Wenn Sie diesen *nach Verweis* zurückgeben, geben Sie einen Alias für diese Variable zurück.</span><span class="sxs-lookup"><span data-stu-id="f9e08-138">If you return it *by reference* you are returning an alias to that same variable.</span></span>
- <span data-ttu-id="f9e08-139">Wenn Sie ihn *nach Verweis* an eine andere Methode übergeben, übergeben Sie einen Verweis auf die Variable, für die diese als Alias fungiert.</span><span class="sxs-lookup"><span data-stu-id="f9e08-139">If you pass it to another method *by reference* you are passing a reference to the variable it aliases.</span></span>
- <span data-ttu-id="f9e08-140">Wenn Sie einen Alias für einen [lokalen Verweis](#ref-local) erstellen, erstellen Sie einen neuen Alias für diese Variable.</span><span class="sxs-lookup"><span data-stu-id="f9e08-140">When you make a [ref local](#ref-local) alias, you make a new alias to the same variable.</span></span>


## <a name="ref-locals"></a><span data-ttu-id="f9e08-141">Lokale ref-Variablen</span><span class="sxs-lookup"><span data-stu-id="f9e08-141">Ref locals</span></span>

<span data-ttu-id="f9e08-142">Nehmen Sie an, dass die `GetContactInformation`-Methode als Verweisrückgabe deklariert ist:</span><span class="sxs-lookup"><span data-stu-id="f9e08-142">Assume the `GetContactInformation` method is declared as a ref return:</span></span>

```csharp
public ref Person GetContactInformation(string fname, string lname)
```

<span data-ttu-id="f9e08-143">Eine by-value-Zuweisung liest den Wert einer Variable und weist diesen einer neuen Variable zu:</span><span class="sxs-lookup"><span data-stu-id="f9e08-143">A by-value assignment reads the value of a variable and assigns it to a new variable:</span></span>

```csharp
Person p = contacts.GetContactInformation("Brandie", "Best");
```

<span data-ttu-id="f9e08-144">Die vorangehende Zuweisung deklariert `p` als lokale Variable.</span><span class="sxs-lookup"><span data-stu-id="f9e08-144">The preceding assignment declares `p` as a local variable.</span></span> <span data-ttu-id="f9e08-145">Der ursprüngliche Wert wird durch Lesen des Rückgabewerts kopiert, der von `GetContactInformation` zurückgegeben wurde.</span><span class="sxs-lookup"><span data-stu-id="f9e08-145">Its initial value is copied from reading the value returned by `GetContactInformation`.</span></span> <span data-ttu-id="f9e08-146">Keine der zukünftigen Zuweisungen zu `p` ändern den Wert der von `GetContactInformation` zurückgegebenen Variable.</span><span class="sxs-lookup"><span data-stu-id="f9e08-146">Any future assignments to `p` will not change the value of the variable returned by `GetContactInformation`.</span></span> <span data-ttu-id="f9e08-147">Die Variable `p` fungiert nicht mehr als Alias für die zurückgegebene Variable.</span><span class="sxs-lookup"><span data-stu-id="f9e08-147">The variable `p` is no longer an alias to the variable returned.</span></span>

<span data-ttu-id="f9e08-148">Sie deklarieren eine *lokale Verweisvariable*, um den Alias in den ursprünglichen Wert zu kopieren.</span><span class="sxs-lookup"><span data-stu-id="f9e08-148">You declare a *ref local* variable to copy the alias to the original value.</span></span> <span data-ttu-id="f9e08-149">In der folgenden Zuweisung ist `p` ein Alias für die von `GetContactInformation` zurückgegebene Variable.</span><span class="sxs-lookup"><span data-stu-id="f9e08-149">In the following assignment, `p` is an alias to the variable returned from `GetContactInformation`.</span></span>

```csharp
ref Person p = ref contacts.GetContactInformation("Brandie", "Best");
```

<span data-ttu-id="f9e08-150">Die nachfolgende Verwendung von `p` ist mit der Verwendung der von `GetContactInformation` zurückgegebenen Variable identisch, da `p` ein Alias für diese Variable darstellt.</span><span class="sxs-lookup"><span data-stu-id="f9e08-150">Subsequent usage of `p` is the same as using the variable returned by `GetContactInformation` because `p` is an alias for that variable.</span></span> <span data-ttu-id="f9e08-151">Durch Änderungen an `p` wird auch die von `GetContactInformation` zurückgegebene Variable geändert.</span><span class="sxs-lookup"><span data-stu-id="f9e08-151">Changes to `p` also change the variable returned from `GetContactInformation`.</span></span>

<span data-ttu-id="f9e08-152">Beachten Sie, dass das Schlüsselwort `ref` sowohl vor der Deklaration lokaler Variablen *als auch* vor dem Methodenaufruf verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="f9e08-152">Note that the `ref` keyword is used both before the local variable declaration *and* before the method call.</span></span> <span data-ttu-id="f9e08-153">Wenn nicht beide `ref`-Schlüsselwörter in den Ergebnissen der Variablendeklaration und der Zuweisung enthalten sind, tritt der Compilerfehler CS8172 „Eine by-reference-Variable kann nicht mit einem Wert initialisiert werden.“ auf.</span><span class="sxs-lookup"><span data-stu-id="f9e08-153">Failure to include both `ref` keywords in the variable declaration and assignment results in compiler error CS8172, "Cannot initialize a by-reference variable with a value."</span></span> 
 
## <a name="ref-returns-and-ref-locals-an-example"></a><span data-ttu-id="f9e08-154">Ref-Rückgaben und lokale ref-Variablen: ein Beispiel</span><span class="sxs-lookup"><span data-stu-id="f9e08-154">Ref returns and ref locals: an example</span></span>

<span data-ttu-id="f9e08-155">Das folgende Beispiel definiert eine `NumberStore`-Klasse, die ein Array von Integer-Werten speichert.</span><span class="sxs-lookup"><span data-stu-id="f9e08-155">The following example defines a `NumberStore` class that stores an array of integer values.</span></span> <span data-ttu-id="f9e08-156">Die `FindNumber`-Methode gibt die erste Anzahl, die größer als oder gleich der Anzahl ist, die als Argument übergeben wurde, als Verweis zurück.</span><span class="sxs-lookup"><span data-stu-id="f9e08-156">The `FindNumber` method returns by reference the first number that is greater than or equal to the number passed as an argument.</span></span> <span data-ttu-id="f9e08-157">Wenn keine Anzahl größer als oder gleich dem Argument ist, gibt die Methode die Anzahl im Index 0 zurück.</span><span class="sxs-lookup"><span data-stu-id="f9e08-157">If no number is greater than or equal to the argument, the method returns the number in index 0.</span></span> 

[!code-csharp[ref-returns](../../../../samples/snippets/csharp/programming-guide/ref-returns/ref-returns1.cs#1)]

<span data-ttu-id="f9e08-158">Im folgenden Beispiel wird die `NumberStore.FindNumber`-Methode aufgerufen, um den ersten Wert abzurufen, der größer als oder gleich 16 ist.</span><span class="sxs-lookup"><span data-stu-id="f9e08-158">The following example calls the `NumberStore.FindNumber` method to retrieve the first value that is greater than or equal to 16.</span></span> <span data-ttu-id="f9e08-159">Die aufrufende Funktion verdoppelt dann den von der Methode zurückgegebenen Wert.</span><span class="sxs-lookup"><span data-stu-id="f9e08-159">The caller then doubles the value returned by the method.</span></span> <span data-ttu-id="f9e08-160">Wie die Ausgabe aus dem Beispiel zeigt, wird diese Änderung im Wert der Arrayelemente der `NumberStore`-Instanz wiedergegeben.</span><span class="sxs-lookup"><span data-stu-id="f9e08-160">As the output from the example shows, this change is reflected in the value of the array elements of the `NumberStore` instance.</span></span>

[!code-csharp[ref-returns](../../../../samples/snippets/csharp/programming-guide/ref-returns/ref-returns1.cs#2)]

<span data-ttu-id="f9e08-161">Ohne Unterstützung für Verweisrückgabewerte wird ein solcher Vorgang in der Regel durchgeführt, indem der Index des Arrayelements zusammen mit seinem Wert zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="f9e08-161">Without support for reference return values, such an operation is usually performed by returning the index of the array element along with its value.</span></span> <span data-ttu-id="f9e08-162">Die aufrufende Funktion kann diesen Index dann dazu verwenden, den Wert in einem separaten Methodenaufruf zu ändern.</span><span class="sxs-lookup"><span data-stu-id="f9e08-162">The caller can then use this index to modify the value in a separate method call.</span></span> <span data-ttu-id="f9e08-163">Die aufrufende Funktion kann den Index jedoch auch ändern, um auf andere Arraywerte zuzugreifen und diese zu bearbeiten.</span><span class="sxs-lookup"><span data-stu-id="f9e08-163">However, the caller can also modify the index to access and possibly modify other array values.</span></span>  
 
## <a name="see-also"></a><span data-ttu-id="f9e08-164">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="f9e08-164">See also</span></span>

[<span data-ttu-id="f9e08-165">ref (C#-Referenz)</span><span class="sxs-lookup"><span data-stu-id="f9e08-165">ref keyword</span></span>](../../language-reference/keywords/ref.md)
