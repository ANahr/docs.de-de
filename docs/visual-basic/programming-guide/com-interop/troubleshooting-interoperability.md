---
title: "Problembehandlung bei Interoperabilität (Visual Basic) | Microsoft-Dokumentation"
ms.custom: 
ms.date: 2015-07-20
ms.prod: .net
ms.reviewer: 
ms.suite: 
ms.technology:
- devlang-visual-basic
ms.topic: article
dev_langs:
- VB
helpviewer_keywords:
- interop, deploying assemblies
- assemblies [Visual Basic]
- interop, installing assemblies that share components
- COM objects, troubleshooting
- interop, sharing components
- troubleshooting interoperability
- interoperability, troubleshooting
- COM interop, troubleshooting
- assemblies [Visual Basic], deploying
- troubleshooting Visual Basic, interoperability
- interop assemblies
- interoperability, sharing components
- shared components, using with assemblies
ms.assetid: b324cc1e-b03c-4f39-aea6-6a6d5bfd0e37
caps.latest.revision: 21
author: dotnet-bot
ms.author: dotnetcontent
translation.priority.ht:
- cs-cz
- de-de
- es-es
- fr-fr
- it-it
- ja-jp
- ko-kr
- pl-pl
- pt-br
- ru-ru
- tr-tr
- zh-cn
- zh-tw
ms.translationtype: Machine Translation
ms.sourcegitcommit: 9f5b8ebb69c9206ff90b05e748c64d29d82f7a16
ms.openlocfilehash: f4a906b685ac02e89eb1dd94d538be3288b03ca1
ms.contentlocale: de-de
ms.lasthandoff: 04/12/2017

---
# <a name="troubleshooting-interoperability-visual-basic"></a><span data-ttu-id="be975-102">Problembehandlung bei Interoperabilität (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="be975-102">Troubleshooting Interoperability (Visual Basic)</span></span>
<span data-ttu-id="be975-103">Wenn Sie Interoperabilität zwischen COM und verwaltetem Code von der [!INCLUDE[dnprdnshort](../../../csharp/getting-started/includes/dnprdnshort_md.md)], eine oder mehrere der folgenden Probleme auftreten können.</span><span class="sxs-lookup"><span data-stu-id="be975-103">When you interoperate between COM and the managed code of the [!INCLUDE[dnprdnshort](../../../csharp/getting-started/includes/dnprdnshort_md.md)], you may encounter one or more of the following common issues.</span></span>  
  
##  <span data-ttu-id="be975-104"><a name="vbconinteroperabilitymarshalinganchor1"></a>Interop-Marshalling</span><span class="sxs-lookup"><span data-stu-id="be975-104"><a name="vbconinteroperabilitymarshalinganchor1"></a> Interop Marshaling</span></span>  
 <span data-ttu-id="be975-105">Von Zeit zu Zeit müssen unter Umständen Datentypen verwenden, die nicht Teil der [!INCLUDE[dnprdnshort](../../../csharp/getting-started/includes/dnprdnshort_md.md)].</span><span class="sxs-lookup"><span data-stu-id="be975-105">At times, you may have to use data types that are not part of the [!INCLUDE[dnprdnshort](../../../csharp/getting-started/includes/dnprdnshort_md.md)].</span></span> <span data-ttu-id="be975-106">Interop-Assemblys behandeln die meisten Aufgaben für COM-Objekte, jedoch müssen Sie möglicherweise die Daten steuern, die verwendet werden, wenn verwaltete Objekte für COM verfügbar gemacht werden</span><span class="sxs-lookup"><span data-stu-id="be975-106">Interop assemblies handle most of the work for COM objects, but you may have to control the data types that are used when managed objects are exposed to COM.</span></span> <span data-ttu-id="be975-107">Strukturen in Klassenbibliotheken müssen z. B. Angeben der `BStr` nicht verwalteten Typ auf Zeichenfolgen, die von Visual Basic 6.0 und früheren Versionen erstellte COM-Objekte gesendet.</span><span class="sxs-lookup"><span data-stu-id="be975-107">For example, structures in class libraries must specify the `BStr` unmanaged type on strings sent to COM objects created by Visual Basic 6.0 and earlier versions.</span></span> <span data-ttu-id="be975-108">In solchen Fällen können Sie die <xref:System.Runtime.InteropServices.MarshalAsAttribute>Attribut, damit verwaltete Typen als nicht verwaltete Typen verfügbar gemacht werden.</xref:System.Runtime.InteropServices.MarshalAsAttribute></span><span class="sxs-lookup"><span data-stu-id="be975-108">In such cases, you can use the <xref:System.Runtime.InteropServices.MarshalAsAttribute> attribute to cause managed types to be exposed as unmanaged types.</span></span>  
  
##  <span data-ttu-id="be975-109"><a name="vbconinteroperabilitymarshalinganchor2"></a>Exportieren von Zeichenfolgen fester Länge in nicht verwaltetem Code</span><span class="sxs-lookup"><span data-stu-id="be975-109"><a name="vbconinteroperabilitymarshalinganchor2"></a> Exporting Fixed-Length Strings to Unmanaged Code</span></span>  
 <span data-ttu-id="be975-110">In Visual Basic 6.0 und früheren Versionen werden Zeichenfolgen als Bytefolgen ohne abschließendes null-Zeichen in COM-Objekte exportiert.</span><span class="sxs-lookup"><span data-stu-id="be975-110">In Visual Basic 6.0 and earlier versions, strings are exported to COM objects as sequences of bytes without a null termination character.</span></span> <span data-ttu-id="be975-111">Für die Kompatibilität mit anderen Sprachen [!INCLUDE[vbprvblong](../../../visual-basic/developing-apps/customizing-extending-my/includes/vbprvblong_md.md)] Fügt ein abschließendes Zeichen beim Exportieren von Zeichenfolgen.</span><span class="sxs-lookup"><span data-stu-id="be975-111">For compatibility with other languages, [!INCLUDE[vbprvblong](../../../visual-basic/developing-apps/customizing-extending-my/includes/vbprvblong_md.md)] includes a termination character when exporting strings.</span></span> <span data-ttu-id="be975-112">Die beste Möglichkeit, diese Inkompatibilität zu beheben ist, Zeichenfolgen, können exportieren das Endzeichen der als Arrays von `Byte` oder `Char`.</span><span class="sxs-lookup"><span data-stu-id="be975-112">The best way to address this incompatibility is to export strings that lack the termination character as arrays of `Byte` or `Char`.</span></span>  
  
##  <span data-ttu-id="be975-113"><a name="vbconinteroperabilitymarshalinganchor3"></a>Exportieren von Vererbungshierarchien</span><span class="sxs-lookup"><span data-stu-id="be975-113"><a name="vbconinteroperabilitymarshalinganchor3"></a> Exporting Inheritance Hierarchies</span></span>  
 <span data-ttu-id="be975-114">Verwalteter Klassen Hierarchien gehen beim Offenlegen als COM-Objekte verfügbar gemacht.</span><span class="sxs-lookup"><span data-stu-id="be975-114">Managed class hierarchies flatten out when exposed as COM objects.</span></span> <span data-ttu-id="be975-115">Z. B. Wenn Sie eine Basisklasse mit einem Member definieren und dann erben die Basisklasse in einer abgeleiteten Klasse, die als COM-Objekt verfügbar gemacht wird, werden Clients, die im COM-Objekt die abgeleitete Klasse verwenden nicht die geerbten Member verwenden können.</span><span class="sxs-lookup"><span data-stu-id="be975-115">For example, if you define a base class with a member, and then inherit the base class in a derived class that is exposed as a COM object, clients that use the derived class in the COM object will not be able to use the inherited members.</span></span> <span data-ttu-id="be975-116">Member der Basisklasse können von COM-Objekten nur als Instanzen einer Basisklasse zugegriffen werden, und klicken Sie dann nur, wenn die Basisklasse ebenfalls als COM-Objekt erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="be975-116">Base class members can be accessed from COM objects only as instances of a base class, and then only if the base class is also created as a COM object.</span></span>  
  
## <a name="overloaded-methods"></a><span data-ttu-id="be975-117">Überladene Methoden</span><span class="sxs-lookup"><span data-stu-id="be975-117">Overloaded Methods</span></span>  
 <span data-ttu-id="be975-118">Sie können jedoch überladene Methoden mit [!INCLUDE[vbprvb](../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)], werden sie von COM nicht unterstützt</span><span class="sxs-lookup"><span data-stu-id="be975-118">Although you can create overloaded methods with [!INCLUDE[vbprvb](../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)], they are not supported by COM.</span></span> <span data-ttu-id="be975-119">Wenn eine Klasse, die überladene Methoden enthält, die als COM-Objekt verfügbar ist, werden für die überladenen Methoden neue Methodennamen generiert.</span><span class="sxs-lookup"><span data-stu-id="be975-119">When a class that contains overloaded methods is exposed as a COM object, new method names are generated for the overloaded methods.</span></span>  
  
 <span data-ttu-id="be975-120">Betrachten Sie beispielsweise eine Klasse mit zwei Überladungen der `Synch` Methode.</span><span class="sxs-lookup"><span data-stu-id="be975-120">For example, consider a class that has two overloads of the `Synch` method.</span></span> <span data-ttu-id="be975-121">Wenn die Klasse als COM-Objekt verfügbar gemacht wird, kann die neu generierten Methodennamen `Synch` und `Synch_2`.</span><span class="sxs-lookup"><span data-stu-id="be975-121">When the class is exposed as a COM object, the new generated method names could be `Synch` and `Synch_2`.</span></span>  
  
 <span data-ttu-id="be975-122">Die Umbenennung kann dazu führen, dass zwei Probleme für Consumer des COM-Objekts.</span><span class="sxs-lookup"><span data-stu-id="be975-122">The renaming can cause two problems for consumers of the COM object.</span></span>  
  
1.  <span data-ttu-id="be975-123">Clients können die generierten Methodennamen nicht erwarten.</span><span class="sxs-lookup"><span data-stu-id="be975-123">Clients might not expect the generated method names.</span></span>  
  
2.  <span data-ttu-id="be975-124">Die generierten Methodennamen in der Klasse als COM-Objekt verfügbar gemacht können ändern, wenn neue Überladungen der Klasse oder der Basisklasse hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="be975-124">The generated method names in the class exposed as a COM object can change when new overloads are added to the class or its base class.</span></span> <span data-ttu-id="be975-125">Dies kann Versionsprobleme verursachen.</span><span class="sxs-lookup"><span data-stu-id="be975-125">This can cause versioning problems.</span></span>  
  
 <span data-ttu-id="be975-126">Um beide Probleme zu beheben, geben Sie jeder Methode einen eindeutigen Namen, anstatt Sie mithilfe der Überladung, wenn Sie Objekte entwickeln, die als COM-Objekte verfügbar gemacht werden.</span><span class="sxs-lookup"><span data-stu-id="be975-126">To solve both problems, give each method a unique name, instead of using overloading, when you develop objects that will be exposed as COM objects.</span></span>  
  
##  <span data-ttu-id="be975-127"><a name="vbconinteroperabilitymarshalinganchor4"></a>Verwenden von COM-Objekten über Interop-Assemblys</span><span class="sxs-lookup"><span data-stu-id="be975-127"><a name="vbconinteroperabilitymarshalinganchor4"></a> Use of COM Objects Through Interop Assemblies</span></span>  
 <span data-ttu-id="be975-128">Verwenden Sie Interop-Assemblys, fast so, als ob sie verwalteten Code als Ersatz für die COM-Objekte sind, die sie darstellen.</span><span class="sxs-lookup"><span data-stu-id="be975-128">You use interop assemblies almost as if they are managed code replacements for the COM objects they represent.</span></span> <span data-ttu-id="be975-129">Da sie Wrapper und keine eigentlichen COM-Objekte sind, bestehen jedoch einige Unterschiede zwischen der Verwendung von Interop-Assemblys und Standardassemblys.</span><span class="sxs-lookup"><span data-stu-id="be975-129">However, because they are wrappers and not actual COM objects, there are some differences between using interop assemblies and standard assemblies.</span></span> <span data-ttu-id="be975-130">Diese betreffen der Offenlegung von Klassen und Datentypen für Parameter und Rückgabewerte.</span><span class="sxs-lookup"><span data-stu-id="be975-130">These areas of difference include the exposure of classes, and data types for parameters and return values.</span></span>  
  
##  <span data-ttu-id="be975-131"><a name="vbconinteroperabilitymarshalinganchor5"></a>Klassen, die verfügbar gemacht werden, als beide Schnittstellen und Klassen</span><span class="sxs-lookup"><span data-stu-id="be975-131"><a name="vbconinteroperabilitymarshalinganchor5"></a> Classes Exposed as Both Interfaces and Classes</span></span>  
 <span data-ttu-id="be975-132">Im Gegensatz zu Klassen in Standardassemblys werden COM-Klassen verfügbar gemacht, in Interop-Assemblys als eine Schnittstelle und eine Klasse, die COM-Klasse darstellt.</span><span class="sxs-lookup"><span data-stu-id="be975-132">Unlike classes in standard assemblies, COM classes are exposed in interop assemblies as both an interface and a class that represents the COM class.</span></span> <span data-ttu-id="be975-133">Der Name der Schnittstelle ist identisch mit dem der COM-Klasse.</span><span class="sxs-lookup"><span data-stu-id="be975-133">The interface's name is identical to that of the COM class.</span></span> <span data-ttu-id="be975-134">Der Name der Interop-Klasse ist identisch mit der ursprünglichen COM-Klasse mit dem Wort "Class" angefügt.</span><span class="sxs-lookup"><span data-stu-id="be975-134">The name of the interop class is the same as that of the original COM class, but with the word "Class" appended.</span></span> <span data-ttu-id="be975-135">Nehmen wir beispielsweise an, dass Sie ein Projekt mit einem Verweis auf eine Interop-Assembly für COM-Objekt verfügen.</span><span class="sxs-lookup"><span data-stu-id="be975-135">For example, suppose you have a project with a reference to an interop assembly for a COM object.</span></span> <span data-ttu-id="be975-136">Wenn die COM-Klasse heißt `MyComClass`, IntelliSense und im Objektkatalog Anzeigen eine Schnittstelle namens `MyComClass` und eine Klasse namens `MyComClassClass`.</span><span class="sxs-lookup"><span data-stu-id="be975-136">If the COM class is named `MyComClass`, IntelliSense and the Object Browser show an interface named `MyComClass` and a class named `MyComClassClass`.</span></span>  
  
##  <span data-ttu-id="be975-137"><a name="vbconinteroperabilitymarshalinganchor6"></a>Erstellen von Instanzen einer .NET Framework-Klasse</span><span class="sxs-lookup"><span data-stu-id="be975-137"><a name="vbconinteroperabilitymarshalinganchor6"></a> Creating Instances of a .NET Framework Class</span></span>  
 <span data-ttu-id="be975-138">Im Allgemeinen erstellen Sie eine Instanz von einer [!INCLUDE[dnprdnshort](../../../csharp/getting-started/includes/dnprdnshort_md.md)] -Klasse unter Verwendung der `New` -Anweisung mit einem Namen.</span><span class="sxs-lookup"><span data-stu-id="be975-138">Generally, you create an instance of a [!INCLUDE[dnprdnshort](../../../csharp/getting-started/includes/dnprdnshort_md.md)] class using the `New` statement with a class name.</span></span> <span data-ttu-id="be975-139">Eine durch eine Interop-Assembly dargestellte COM-Klasse ist, verwenden Sie die `New` -Anweisung mit einer Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="be975-139">Having a COM class represented by an interop assembly is the one case in which you can use the `New` statement with an interface.</span></span> <span data-ttu-id="be975-140">Nur beim verwenden die COM-Klasse mit einer `Inherits` -Anweisung können Sie die Schnittstelle wie eine Klasse verwenden.</span><span class="sxs-lookup"><span data-stu-id="be975-140">Unless you are using the COM class with an `Inherits` statement, you can use the interface just as you would a class.</span></span> <span data-ttu-id="be975-141">Der folgende Code veranschaulicht, wie ein `Command` Objekt in ein Projekt, das einen Verweis auf die Microsoft ActiveX Data Objekte 2.8-Bibliothek COM-Objekt hat:</span><span class="sxs-lookup"><span data-stu-id="be975-141">The following code demonstrates how to create a `Command` object in a project that has a reference to the Microsoft ActiveX Data Objects 2.8 Library COM object:</span></span>  
  
 <span data-ttu-id="be975-142">[!code-vb[VbVbalrInterop&20;](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_1.vb)]</span><span class="sxs-lookup"><span data-stu-id="be975-142">[!code-vb[VbVbalrInterop#20](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_1.vb)]</span></span>  
  
 <span data-ttu-id="be975-143">Wenn Sie die COM-Klasse als Basis für eine abgeleitete Klasse verwenden, müssen Sie die Interop-Klasse verwenden, die für die COM-Klasse, wie im folgenden Code:</span><span class="sxs-lookup"><span data-stu-id="be975-143">However, if you are using the COM class as the base for a derived class, you must use the interop class that represents the COM class, as in the following code:</span></span>  
  
 <span data-ttu-id="be975-144">[!code-vb[VbVbalrInterop&21;](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_2.vb)]</span><span class="sxs-lookup"><span data-stu-id="be975-144">[!code-vb[VbVbalrInterop#21](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_2.vb)]</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="be975-145">Interop-Assemblys implementieren implizit Schnittstellen, die COM-Klassen darstellen.</span><span class="sxs-lookup"><span data-stu-id="be975-145">Interop assemblies implicitly implement interfaces that represent COM classes.</span></span> <span data-ttu-id="be975-146">Sie sollten nicht versuchen, verwenden Sie die `Implements` Anweisung zum Implementieren dieser Schnittstellen führt.</span><span class="sxs-lookup"><span data-stu-id="be975-146">You should not try to use the `Implements` statement to implement these interfaces or an error will result.</span></span>  
  
##  <span data-ttu-id="be975-147"><a name="vbconinteroperabilitymarshalinganchor7"></a>Datentypen für Parameter und Rückgabewerte</span><span class="sxs-lookup"><span data-stu-id="be975-147"><a name="vbconinteroperabilitymarshalinganchor7"></a> Data Types for Parameters and Return Values</span></span>  
 <span data-ttu-id="be975-148">Im Gegensatz zu Membern von Standardassemblys möglicherweise Interop-Assemblies-Datentypen, die von denen in der ursprünglichen Deklaration des Objekts abweichen.</span><span class="sxs-lookup"><span data-stu-id="be975-148">Unlike members of standard assemblies, interop assembly members may have data types that differ from those used in the  original object declaration.</span></span> <span data-ttu-id="be975-149">Zwar Interop-Assemblys für COM-Typen implizit in mit der common Language Runtime kompatible Typen konvertiert, achten Sie besonders auf die Datentypen, die von beiden Seiten verwendet werden, um Laufzeitfehler zu vermeiden.</span><span class="sxs-lookup"><span data-stu-id="be975-149">Although interop assemblies implicitly convert COM types to compatible common language runtime types, you should pay attention to the data types that are used by both sides to prevent runtime errors.</span></span> <span data-ttu-id="be975-150">Z. B. in COM-Objekte, die in Visual Basic 6.0 und früheren Versionen, die Werte des Typs erstellt `Integer` nehmen Sie an der [!INCLUDE[dnprdnshort](../../../csharp/getting-started/includes/dnprdnshort_md.md)] entsprechenden Typ `Short`.</span><span class="sxs-lookup"><span data-stu-id="be975-150">For example, in COM objects created in Visual Basic 6.0 and earlier versions, values of type `Integer` assume the [!INCLUDE[dnprdnshort](../../../csharp/getting-started/includes/dnprdnshort_md.md)] equivalent type, `Short`.</span></span> <span data-ttu-id="be975-151">Es wird empfohlen, dass Sie den Objektkatalog verwenden, um die Merkmale importierter Member zu untersuchen, bevor Sie sie verwenden.</span><span class="sxs-lookup"><span data-stu-id="be975-151">It is recommended that you use the Object Browser to examine the characteristics of imported members before you use them.</span></span>  
  
##  <span data-ttu-id="be975-152"><a name="vbconinteroperabilitymarshalinganchor8"></a>COM Methoden auf Modulebene</span><span class="sxs-lookup"><span data-stu-id="be975-152"><a name="vbconinteroperabilitymarshalinganchor8"></a> Module level COM methods</span></span>  
 <span data-ttu-id="be975-153">Die meisten COM-Objekte wird durch Erstellen einer Instanz eines COM-Klasse mit dem `New` -Schlüsselwort und dem anschließenden Aufrufen der Methoden des Objekts.</span><span class="sxs-lookup"><span data-stu-id="be975-153">Most COM objects are used by creating an instance of a COM class using the `New` keyword and then calling methods of the object.</span></span> <span data-ttu-id="be975-154">Eine Ausnahme dieser Regel betrifft COM-Objekte, die enthalten `AppObj` oder `GlobalMultiUse` COM-Klassen.</span><span class="sxs-lookup"><span data-stu-id="be975-154">One exception to this rule involves COM objects that contain `AppObj` or `GlobalMultiUse` COM classes.</span></span> <span data-ttu-id="be975-155">Solche Klassen entsprechen den Methoden auf Modulebene in [!INCLUDE[vbprvblong](../../../visual-basic/developing-apps/customizing-extending-my/includes/vbprvblong_md.md)] Klassen.</span><span class="sxs-lookup"><span data-stu-id="be975-155">Such classes resemble module level methods in [!INCLUDE[vbprvblong](../../../visual-basic/developing-apps/customizing-extending-my/includes/vbprvblong_md.md)] classes.</span></span> <span data-ttu-id="be975-156">Visual Basic 6.0 und früheren Versionen erstellen implizit Instanzen solcher Objekte zur ersten, die eine ihrer Methoden aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="be975-156">Visual Basic 6.0 and earlier versions implicitly create instances of such objects for you the first time that you call one of their methods.</span></span> <span data-ttu-id="be975-157">Fügen Sie z. B. in Visual Basic 6.0 einen Verweis auf die Microsoft DAO 3.6-Objektbibliothek und rufen Sie die `DBEngine` Methode ohne zunächst eine Instanz erstellt:</span><span class="sxs-lookup"><span data-stu-id="be975-157">For example, in Visual Basic 6.0 you can add a reference to the Microsoft DAO 3.6 Object Library and call the `DBEngine` method without first creating an instance:</span></span>  
  
```  
Dim db As DAO.Database  
' Open the database.  
Set db = DBEngine.OpenDatabase("C:\nwind.mdb")  
' Use the database object.  
```  
  
 [!INCLUDE[vbprvblong](../../../visual-basic/developing-apps/customizing-extending-my/includes/vbprvblong_md.md)]<span data-ttu-id="be975-158">erfordert, dass Sie immer Instanzen von COM-Objekten erstellen, bevor Sie deren Methoden verwenden können.</span><span class="sxs-lookup"><span data-stu-id="be975-158"> requires that you always create instances of COM objects before you can use their methods.</span></span> <span data-ttu-id="be975-159">Diese Methoden in [!INCLUDE[vbprvblong](../../../visual-basic/developing-apps/customizing-extending-my/includes/vbprvblong_md.md)], deklarieren Sie eine Variable der gewünschten Klasse, und verwenden Sie das new-Schlüsselwort, das Objekt der Objektvariablen zuzuweisen.</span><span class="sxs-lookup"><span data-stu-id="be975-159">To use these methods in [!INCLUDE[vbprvblong](../../../visual-basic/developing-apps/customizing-extending-my/includes/vbprvblong_md.md)], declare a variable of the desired class and use the new keyword to assign the object to the object variable.</span></span> <span data-ttu-id="be975-160">Das `Shared` -Schlüsselwort kann verwendet werden, wenn Sie sicherstellen möchten, dass nur eine Instanz der Klasse erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="be975-160">The `Shared` keyword can be used when you want to make sure that only one instance of the class is created.</span></span>  
  
 <span data-ttu-id="be975-161">[!code-vb[VbVbalrInterop&23;](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_3.vb)]</span><span class="sxs-lookup"><span data-stu-id="be975-161">[!code-vb[VbVbalrInterop#23](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_3.vb)]</span></span>  
  
##  <span data-ttu-id="be975-162"><a name="vbconinteroperabilitymarshalinganchor9"></a>Nicht behandelte Fehler im Ereignishandler</span><span class="sxs-lookup"><span data-stu-id="be975-162"><a name="vbconinteroperabilitymarshalinganchor9"></a> Unhandled Errors in Event Handlers</span></span>  
 <span data-ttu-id="be975-163">Ein häufiges Interop-Problem umfasst die Fehler im Ereignishandler, die von COM-Objekten ausgelöste Ereignisse behandeln.</span><span class="sxs-lookup"><span data-stu-id="be975-163">One common interop problem involves errors in event handlers that handle events raised by COM objects.</span></span> <span data-ttu-id="be975-164">Solche Fehler werden ignoriert, es sei denn, Sie prüfen Sie insbesondere für Fehler bei der Verwendung `On Error` oder `Try...Catch...Finally` Anweisungen.</span><span class="sxs-lookup"><span data-stu-id="be975-164">Such errors are ignored unless you specifically check for errors using `On Error` or `Try...Catch...Finally` statements.</span></span> <span data-ttu-id="be975-165">Z. B. das folgende Beispiel stammt aus einer [!INCLUDE[vbprvblong](../../../visual-basic/developing-apps/customizing-extending-my/includes/vbprvblong_md.md)] -Projekt, das einen Verweis auf das Microsoft ActiveX Data Objekte 2.8-Bibliothek COM-Objekt enthält.</span><span class="sxs-lookup"><span data-stu-id="be975-165">For example, the following example is from a [!INCLUDE[vbprvblong](../../../visual-basic/developing-apps/customizing-extending-my/includes/vbprvblong_md.md)] project that has a reference to the Microsoft ActiveX Data Objects 2.8 Library COM object.</span></span>  
  
 <span data-ttu-id="be975-166">[!code-vb[VbVbalrInterop&#24;](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_4.vb)]</span><span class="sxs-lookup"><span data-stu-id="be975-166">[!code-vb[VbVbalrInterop#24](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_4.vb)]</span></span>  
  
 <span data-ttu-id="be975-167">In diesem Beispiel löst einen Fehler aus, wie erwartet.</span><span class="sxs-lookup"><span data-stu-id="be975-167">This example raises an error as expected.</span></span> <span data-ttu-id="be975-168">Jedoch wenn Sie, dasselbe Beispiel ohne versuchen den `Try...Catch...Finally` Block, der Fehler wird ignoriert, wie wenn Sie die `OnError Resume Next` Anweisung.</span><span class="sxs-lookup"><span data-stu-id="be975-168">However, if you try the same example without the `Try...Catch...Finally` block, the error is ignored as if you used the `OnError Resume Next` statement.</span></span> <span data-ttu-id="be975-169">Ohne Fehlerbehandlung schlägt die Division durch&0; (null) im Hintergrund fehl.</span><span class="sxs-lookup"><span data-stu-id="be975-169">Without error handling, the division by zero silently fails.</span></span> <span data-ttu-id="be975-170">Da solche Fehler niemals Fehler nicht behandelte Ausnahme auslöst, ist es wichtig, dass Sie eine Form der Ausnahmebehandlung in Ereignishandler für die Behandlung von Ereignissen COM-Objekte verwenden.</span><span class="sxs-lookup"><span data-stu-id="be975-170">Because such errors never raise unhandled exception errors, it is important that you use some form of exception handling in event handlers that handle events from COM objects.</span></span>  
  
### <a name="understanding-com-interop-errors"></a><span data-ttu-id="be975-171">Grundlegendes zu COM-Interop-Fehler</span><span class="sxs-lookup"><span data-stu-id="be975-171">Understanding COM interop errors</span></span>  
 <span data-ttu-id="be975-172">Ohne Fehlerbehandlung generieren Interop-Aufrufe häufig Fehler, die wenig Informationen liefern.</span><span class="sxs-lookup"><span data-stu-id="be975-172">Without error handling, interop calls often generate errors that provide little information.</span></span> <span data-ttu-id="be975-173">Verwenden Sie nach Möglichkeit strukturierte Fehlerbehandlung bieten weitere Informationen zu Problemen, bei deren auftreten.</span><span class="sxs-lookup"><span data-stu-id="be975-173">Whenever possible, use structured error handling to provide more information about problems when they occur.</span></span> <span data-ttu-id="be975-174">Dies kann besonders hilfreich sein, beim Debuggen von ASP.NET-Webanwendungen.</span><span class="sxs-lookup"><span data-stu-id="be975-174">This can be especially helpful when you debug applications.</span></span> <span data-ttu-id="be975-175">Zum Beispiel:</span><span class="sxs-lookup"><span data-stu-id="be975-175">For example:</span></span>  
  
 <span data-ttu-id="be975-176">[!code-vb[VbVbalrInterop&#25;](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_5.vb)]</span><span class="sxs-lookup"><span data-stu-id="be975-176">[!code-vb[VbVbalrInterop#25](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_5.vb)]</span></span>  
  
 <span data-ttu-id="be975-177">Erhalten Sie Informationen wie die Beschreibung, HRESULT und die Quelle der COM-Fehler durch den Inhalt des Ausnahmeobjekts untersuchen.</span><span class="sxs-lookup"><span data-stu-id="be975-177">You can find information such as the error description, HRESULT, and the source of COM errors by examining the contents of the exception object.</span></span>  
  
##  <span data-ttu-id="be975-178"><a name="vbconinteroperabilitymarshalinganchor10"></a>ActiveX-Steuerelement-Probleme</span><span class="sxs-lookup"><span data-stu-id="be975-178"><a name="vbconinteroperabilitymarshalinganchor10"></a> ActiveX Control Issues</span></span>  
 <span data-ttu-id="be975-179">Die meisten ActiveX-Steuerelemente, die mit Visual Basic 6.0 arbeiten mit [!INCLUDE[vbprvblong](../../../visual-basic/developing-apps/customizing-extending-my/includes/vbprvblong_md.md)] problemlos.</span><span class="sxs-lookup"><span data-stu-id="be975-179">Most ActiveX controls that work with Visual Basic 6.0 work with [!INCLUDE[vbprvblong](../../../visual-basic/developing-apps/customizing-extending-my/includes/vbprvblong_md.md)] without trouble.</span></span> <span data-ttu-id="be975-180">Die wichtigsten Ausnahmen sind Container oder Steuerelemente, die visuell andere Steuerelemente enthalten.</span><span class="sxs-lookup"><span data-stu-id="be975-180">The main exceptions are container controls, or controls that visually contain other controls.</span></span> <span data-ttu-id="be975-181">Einige Beispiele für ältere Steuerelemente, die in nicht ordnungsgemäß funktionieren [!INCLUDE[vsprvs](../../../csharp/includes/vsprvs_md.md)] lauten wie folgt:</span><span class="sxs-lookup"><span data-stu-id="be975-181">Some examples of older controls that do not work correctly with [!INCLUDE[vsprvs](../../../csharp/includes/vsprvs_md.md)] are as follows:</span></span>  
  
-   <span data-ttu-id="be975-182">Microsoft Forms 2.0-Frame-Steuerelement</span><span class="sxs-lookup"><span data-stu-id="be975-182">Microsoft Forms 2.0 Frame control</span></span>  
  
-   <span data-ttu-id="be975-183">Auf-ab-Steuerelement, auch bekannt als das Drehfeld-Steuerelement</span><span class="sxs-lookup"><span data-stu-id="be975-183">Up-Down control, also known as the spin control</span></span>  
  
-   <span data-ttu-id="be975-184">Schreiber Registerkarten-Steuerelement</span><span class="sxs-lookup"><span data-stu-id="be975-184">Sheridan Tab Control</span></span>  
  
 <span data-ttu-id="be975-185">Es gibt nur wenige Lösungsmöglichkeiten für nicht unterstützte ActiveX-Steuerelement-Probleme.</span><span class="sxs-lookup"><span data-stu-id="be975-185">There are only a few workarounds for unsupported ActiveX control problems.</span></span> <span data-ttu-id="be975-186">Sie können vorhandene Steuerelemente migrieren [!INCLUDE[vsprvs](../../../csharp/includes/vsprvs_md.md)] Wenn Sie den ursprünglichen Quellcode besitzen.</span><span class="sxs-lookup"><span data-stu-id="be975-186">You can migrate existing controls to [!INCLUDE[vsprvs](../../../csharp/includes/vsprvs_md.md)] if you own the original source code.</span></span> <span data-ttu-id="be975-187">Überprüfen Sie andernfalls können Sie mit Software-Anbietern für aktualisiert. NET-kompatiblen Versionen von Steuerelementen ersetzen nicht die ActiveX-Steuerelemente unterstützt.</span><span class="sxs-lookup"><span data-stu-id="be975-187">Otherwise, you can check with software vendors for updated .NET-compatible versions of controls to replace unsupported ActiveX controls.</span></span>  
  
##  <span data-ttu-id="be975-188"><a name="vbconinteroperabilitymarshalinganchor11"></a>Die ReadOnly-Eigenschaften der Steuerelemente ByRef übergeben</span><span class="sxs-lookup"><span data-stu-id="be975-188"><a name="vbconinteroperabilitymarshalinganchor11"></a> Passing ReadOnly Properties of Controls ByRef</span></span>  
 [!INCLUDE[vbprvblong](../../../visual-basic/developing-apps/customizing-extending-my/includes/vbprvblong_md.md)]<span data-ttu-id="be975-189">Löst manchmal COM-Fehler, z. B. "Error 0x800A017F CTL_E_SETNOTSUPPORTED" aus, wenn Sie übergeben `ReadOnly` Eigenschaften älterer ActiveX-Steuerelemente als `ByRef` Parameter an andere Prozeduren.</span><span class="sxs-lookup"><span data-stu-id="be975-189"> sometimes raises COM errors such as "Error 0x800A017F CTL_E_SETNOTSUPPORTED" when you pass `ReadOnly` properties of some older ActiveX controls as `ByRef` parameters to other procedures.</span></span> <span data-ttu-id="be975-190">Ähnliche Prozeduraufrufe aus Visual Basic 6.0 lösen keinen Fehler, und die Parameter werden behandelt, als ob Sie sie nach Wert übergeben.</span><span class="sxs-lookup"><span data-stu-id="be975-190">Similar procedure calls from Visual Basic 6.0 do not raise an error, and the parameters are treated as if you passed them by value.</span></span> <span data-ttu-id="be975-191">Die Fehlermeldung finden Sie unter in [!INCLUDE[vbprvblong](../../../visual-basic/developing-apps/customizing-extending-my/includes/vbprvblong_md.md)] ist das COM-Objekt, das meldet, dass Sie versuchen, eine Eigenschaft zu ändern, die nicht über eine Eigenschaft verfügt `Set` Verfahren.</span><span class="sxs-lookup"><span data-stu-id="be975-191">The error message you see in [!INCLUDE[vbprvblong](../../../visual-basic/developing-apps/customizing-extending-my/includes/vbprvblong_md.md)] is the COM object reporting that you are trying to change a property that does not have a property `Set` procedure.</span></span>  
  
 <span data-ttu-id="be975-192">Wenn Sie die aufgerufene Prozedur können zugreifen, können Sie diesen Fehler verhindern, mithilfe der `ByVal` Schlüsselwort Parameter zu deklarieren, akzeptieren `ReadOnly` Eigenschaften.</span><span class="sxs-lookup"><span data-stu-id="be975-192">If you have access to the procedure being called, you can prevent this error by using the `ByVal` keyword to declare parameters that accept `ReadOnly` properties.</span></span> <span data-ttu-id="be975-193">Beispiel:</span><span class="sxs-lookup"><span data-stu-id="be975-193">For example:</span></span>  
  
 <span data-ttu-id="be975-194">[!code-vb[VbVbalrInterop&#26;](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_6.vb)]</span><span class="sxs-lookup"><span data-stu-id="be975-194">[!code-vb[VbVbalrInterop#26](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_6.vb)]</span></span>  
  
 <span data-ttu-id="be975-195">Wenn Sie keinen Zugriff auf den Quellcode für die aufgerufene Prozedur können Sie die Eigenschaft als Wert übergeben wird, durch hinzufügen einen zusätzlichen Satz von Klammern die aufrufende Prozedur erzwingen.</span><span class="sxs-lookup"><span data-stu-id="be975-195">If you do not have access to the source code for the procedure being called, you can force the property to be passed by value by adding an extra set of brackets around the calling procedure.</span></span> <span data-ttu-id="be975-196">Z. B. in einem Projekt, das einen Verweis auf die Microsoft ActiveX Data Objekte 2.8-Bibliothek COM-Objekt verfügt, können Sie:</span><span class="sxs-lookup"><span data-stu-id="be975-196">For example, in a project that has a reference to the Microsoft ActiveX Data Objects 2.8 Library COM object, you can use:</span></span>  
  
 <span data-ttu-id="be975-197">[!code-vb[VbVbalrInterop&#27;](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_7.vb)]</span><span class="sxs-lookup"><span data-stu-id="be975-197">[!code-vb[VbVbalrInterop#27](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_7.vb)]</span></span>  
  
##  <span data-ttu-id="be975-198"><a name="vbconinteroperabilitymarshalinganchor12"></a>Bereitstellen von Assemblys, die Interop verfügbar machen</span><span class="sxs-lookup"><span data-stu-id="be975-198"><a name="vbconinteroperabilitymarshalinganchor12"></a> Deploying Assemblies That Expose Interop</span></span>  
 <span data-ttu-id="be975-199">Bereitstellen von Assemblys, die COM-Schnittstellen verfügbar machen, stellt einige eindeutige Herausforderung dar.</span><span class="sxs-lookup"><span data-stu-id="be975-199">Deploying assemblies that expose COM interfaces presents some unique challenges.</span></span> <span data-ttu-id="be975-200">Beispielsweise tritt ein potenzielles Problem beim separaten Anwendung derselben COM-Assembly verweisen.</span><span class="sxs-lookup"><span data-stu-id="be975-200">For example, a potential problem occurs when separate applications reference the same COM assembly.</span></span> <span data-ttu-id="be975-201">Dies ist üblich, wenn eine neue Version einer Assembly installiert ist und von einer anderen Anwendung ist immer noch die alte Version der Assembly.</span><span class="sxs-lookup"><span data-stu-id="be975-201">This situation is common when a new version of an assembly is installed and another application is still using the old version of the assembly.</span></span> <span data-ttu-id="be975-202">Wenn Sie eine Assembly, die gemeinsam eine DLL deinstallieren, können Sie versehentlich es nicht verfügbar an anderen Assemblys vornehmen.</span><span class="sxs-lookup"><span data-stu-id="be975-202">If you uninstall an assembly that shares a DLL, you can unintentionally make it unavailable to the other assemblies.</span></span>  
  
 <span data-ttu-id="be975-203">Um dieses Problem zu vermeiden, sollten Sie freigegebene Assemblys zum globalen Assemblycache (GAC) installieren und verwenden ein Mergemodul für die Komponente.</span><span class="sxs-lookup"><span data-stu-id="be975-203">To avoid this problem, you should install shared assemblies to the Global Assembly Cache (GAC) and use a MergeModule for the component.</span></span> <span data-ttu-id="be975-204">Wenn Sie die Anwendung im GAC installieren können, sollten sie in einem versionsspezifischen Unterverzeichnis des CommonFilesFolder installiert.</span><span class="sxs-lookup"><span data-stu-id="be975-204">If you cannot install the application in the GAC, it should be installed to CommonFilesFolder in a version-specific subdirectory.</span></span>  
  
 <span data-ttu-id="be975-205">Assemblys, die nicht gemeinsam genutzt werden, sollten im Verzeichnis mit der aufrufenden Anwendung nebeneinander befinden.</span><span class="sxs-lookup"><span data-stu-id="be975-205">Assemblies that are not shared should be located side by side in the directory with the calling application.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="be975-206">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="be975-206">See Also</span></span>  
 <span data-ttu-id="be975-207"><xref:System.Runtime.InteropServices.MarshalAsAttribute></xref:System.Runtime.InteropServices.MarshalAsAttribute></span><span class="sxs-lookup"><span data-stu-id="be975-207"><xref:System.Runtime.InteropServices.MarshalAsAttribute></span></span>   
<span data-ttu-id="be975-208"> [COM-Interop](../../../visual-basic/programming-guide/com-interop/index.md) </span><span class="sxs-lookup"><span data-stu-id="be975-208"> [COM Interop](../../../visual-basic/programming-guide/com-interop/index.md) </span></span>  
<span data-ttu-id="be975-209"> [Tlbimp.exe (Type Library Importer-Tool)](http://msdn.microsoft.com/library/ec0a8d63-11b3-4acd-b398-da1e37e97382) </span><span class="sxs-lookup"><span data-stu-id="be975-209"> [Tlbimp.exe (Type Library Importer)](http://msdn.microsoft.com/library/ec0a8d63-11b3-4acd-b398-da1e37e97382) </span></span>  
<span data-ttu-id="be975-210"> [Tlbexp.exe (Type Library Exporter-Tool)](http://msdn.microsoft.com/library/a487d61b-d166-467b-a7ca-d8b52fbff42d) </span><span class="sxs-lookup"><span data-stu-id="be975-210"> [Tlbexp.exe (Type Library Exporter)](http://msdn.microsoft.com/library/a487d61b-d166-467b-a7ca-d8b52fbff42d) </span></span>  
<span data-ttu-id="be975-211"> [Exemplarische Vorgehensweise: Implementieren der Vererbung mit COM-Objekten](../../../visual-basic/programming-guide/com-interop/walkthrough-implementing-inheritance-with-com-objects.md) </span><span class="sxs-lookup"><span data-stu-id="be975-211"> [Walkthrough: Implementing Inheritance with COM Objects](../../../visual-basic/programming-guide/com-interop/walkthrough-implementing-inheritance-with-com-objects.md) </span></span>  
<span data-ttu-id="be975-212"> [Inherits-Anweisung](../../../visual-basic/language-reference/statements/inherits-statement.md) </span><span class="sxs-lookup"><span data-stu-id="be975-212"> [Inherits Statement](../../../visual-basic/language-reference/statements/inherits-statement.md) </span></span>  
<span data-ttu-id="be975-213"> [Globaler Assemblycache](http://msdn.microsoft.com/library/cf5eacd0-d3ec-4879-b6da-5fd5e4372202)</span><span class="sxs-lookup"><span data-stu-id="be975-213"> [Global Assembly Cache](http://msdn.microsoft.com/library/cf5eacd0-d3ec-4879-b6da-5fd5e4372202)</span></span>
