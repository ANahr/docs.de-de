---
title: Anonyme Typen (Visual Basic)
ms.custom: 
ms.date: 07/20/2015
ms.prod: .net
ms.reviewer: 
ms.suite: 
ms.technology: devlang-visual-basic
ms.topic: article
f1_keywords: vb.AnonymousType
helpviewer_keywords:
- anonymous types [Visual Basic], about anonymous types
- anonymous types [Visual Basic]
- types [Visual Basic], anonymous
ms.assetid: 7b87532c-4b3e-4398-8503-6ea9d67574a4
caps.latest.revision: "46"
author: dotnet-bot
ms.author: dotnetcontent
ms.openlocfilehash: 530e21e1595f9bbc3436280418287413e2a48111
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 11/21/2017
---
# <a name="anonymous-types-visual-basic"></a><span data-ttu-id="99fb5-102">Anonyme Typen (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="99fb5-102">Anonymous Types (Visual Basic)</span></span>
<span data-ttu-id="99fb5-103">Visual Basic unterstützt anonyme Typen, die Ihnen ermöglichen, Objekte zu erstellen, ohne eine Klassendefinition für den Datentyp zu schreiben.</span><span class="sxs-lookup"><span data-stu-id="99fb5-103">Visual Basic supports anonymous types, which enable you to create objects without writing a class definition for the data type.</span></span> <span data-ttu-id="99fb5-104">Stattdessen erzeugt der Compiler eine Klasse.</span><span class="sxs-lookup"><span data-stu-id="99fb5-104">Instead, the compiler generates a class for you.</span></span> <span data-ttu-id="99fb5-105">Die Klasse hat keinen verwendbaren Namen, erbt direkt von <xref:System.Object>, und enthält die Eigenschaften, die Sie in der Deklaration des Objekts angeben.</span><span class="sxs-lookup"><span data-stu-id="99fb5-105">The class has no usable name, inherits directly from <xref:System.Object>, and contains the properties you specify in declaring the object.</span></span> <span data-ttu-id="99fb5-106">Da der Name des Datentyps nicht angegeben ist, wird bezeichnet als ein *anonymen Typ*.</span><span class="sxs-lookup"><span data-stu-id="99fb5-106">Because the name of the data type is not specified, it is referred to as an *anonymous type*.</span></span>  
  
 <span data-ttu-id="99fb5-107">Im folgende Beispiel Variable deklariert und erstellt `product` als eine Instanz eines anonymen Typs, das zwei Eigenschaften `Name` und `Price`.</span><span class="sxs-lookup"><span data-stu-id="99fb5-107">The following example declares and creates variable `product` as an instance of an anonymous type that has two properties, `Name` and `Price`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#1](../../../../visual-basic/language-reference/modifiers/codesnippet/VisualBasic/anonymous-types_1.vb)]  
  
 <span data-ttu-id="99fb5-108">Ein *-Abfrageausdruck* anonyme Typen verwendet, um Spalten mit Daten ausgewählt, die von einer Abfrage zu kombinieren.</span><span class="sxs-lookup"><span data-stu-id="99fb5-108">A *query expression* uses anonymous types to combine columns of data selected by a query.</span></span> <span data-ttu-id="99fb5-109">Den Typ des Ergebnisses kann nicht im Voraus definiert werden, da die Spalten jedoch nicht vorhersehbar ist, die eine bestimmte Abfrage auswählen kann.</span><span class="sxs-lookup"><span data-stu-id="99fb5-109">You cannot define the type of the result in advance, because you cannot predict the columns a particular query might select.</span></span> <span data-ttu-id="99fb5-110">Anonyme Typen können Sie eine Abfrage schreiben, die eine beliebige Anzahl von Spalten, in beliebiger Reihenfolge auswählt.</span><span class="sxs-lookup"><span data-stu-id="99fb5-110">Anonymous types enable you to write a query that selects any number of columns, in any order.</span></span> <span data-ttu-id="99fb5-111">Der Compiler erstellt einen Datentyp, der die angegebenen Eigenschaften und der angegebenen Reihenfolge entspricht.</span><span class="sxs-lookup"><span data-stu-id="99fb5-111">The compiler creates a data type that matches the specified properties and the specified order.</span></span>  
  
 <span data-ttu-id="99fb5-112">In den folgenden Beispielen `products` ist eine Liste von Product-Objekte, von denen jedes über viele Eigenschaften verfügt.</span><span class="sxs-lookup"><span data-stu-id="99fb5-112">In the following examples, `products` is a list of product objects, each of which has many properties.</span></span> <span data-ttu-id="99fb5-113">Variable `namePriceQuery` enthält die Definition einer Abfrage, die bei der Ausführung, eine Auflistung von Instanzen eines anonymen Typs zurückgibt, das zwei Eigenschaften `Name` und `Price`.</span><span class="sxs-lookup"><span data-stu-id="99fb5-113">Variable `namePriceQuery` holds the definition of a query that, when it is executed, returns a collection of instances of an anonymous type that has two properties, `Name` and `Price`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#2](../../../../visual-basic/language-reference/modifiers/codesnippet/VisualBasic/anonymous-types_2.vb)]  
  
 <span data-ttu-id="99fb5-114">Variable `nameQuantityQuery` enthält die Definition einer Abfrage, die bei der Ausführung, eine Auflistung von Instanzen eines anonymen Typs zurückgibt, das zwei Eigenschaften `Name` und `OnHand`.</span><span class="sxs-lookup"><span data-stu-id="99fb5-114">Variable `nameQuantityQuery` holds the definition of a query that, when it is executed, returns a collection of instances of an anonymous type that has two properties, `Name` and `OnHand`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#3](../../../../visual-basic/language-reference/modifiers/codesnippet/VisualBasic/anonymous-types_3.vb)]  
  
 <span data-ttu-id="99fb5-115">Weitere Informationen zu den Code, der vom Compiler für einen anonymen Typ erstellt wird, finden Sie unter [anonymen Typdefinition](../../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-type-definition.md).</span><span class="sxs-lookup"><span data-stu-id="99fb5-115">For more information about the code created by the compiler for an anonymous type, see [Anonymous Type Definition](../../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-type-definition.md).</span></span>  
  
> [!CAUTION]
>  <span data-ttu-id="99fb5-116">Der Name des anonymen Typs ist Compiler generiert und kann von Kompilierungen variieren.</span><span class="sxs-lookup"><span data-stu-id="99fb5-116">The name of the anonymous type is compiler generated and may vary from compilation to compilation.</span></span> <span data-ttu-id="99fb5-117">Der Code sollte nicht verwenden oder basieren auf den Namen eines anonymen Typs, da Sie der Namen ändern kann, wenn ein Projekt erneut kompiliert wird.</span><span class="sxs-lookup"><span data-stu-id="99fb5-117">Your code should not use or rely on the name of an anonymous type because the name might change when a project is recompiled.</span></span>  
  
## <a name="declaring-an-anonymous-type"></a><span data-ttu-id="99fb5-118">Deklaration eines anonymen Typs</span><span class="sxs-lookup"><span data-stu-id="99fb5-118">Declaring an Anonymous Type</span></span>  
 <span data-ttu-id="99fb5-119">Die Deklaration einer Instanz eines anonymen Typs wird mit einer Initialisiererliste die Eigenschaften des Typs angegeben.</span><span class="sxs-lookup"><span data-stu-id="99fb5-119">The declaration of an instance of an anonymous type uses an initializer list to specify the properties of the type.</span></span> <span data-ttu-id="99fb5-120">Sie können nur Eigenschaften angeben, wenn Sie einen anonymen Typ, der keine anderen Klassenelemente wie Methoden oder Ereignisse deklarieren.</span><span class="sxs-lookup"><span data-stu-id="99fb5-120">You can specify only properties when you declare an anonymous type, not other class elements such as methods or events.</span></span> <span data-ttu-id="99fb5-121">Im folgenden Beispiel `product1` ist eine Instanz eines anonymen Typs, die über zwei Eigenschaften verfügt: `Name` und `Price`.</span><span class="sxs-lookup"><span data-stu-id="99fb5-121">In the following example, `product1` is an instance of an anonymous type that has two properties: `Name` and `Price`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#4](../../../../visual-basic/language-reference/modifiers/codesnippet/VisualBasic/anonymous-types_4.vb)]  
  
 <span data-ttu-id="99fb5-122">Wenn Sie Eigenschaften als Schlüsseleigenschaften festlegen, können sie Sie zwei anonymen Typs-Instanzen auf Gleichheit verglichen werden soll.</span><span class="sxs-lookup"><span data-stu-id="99fb5-122">If you designate properties as key properties, you can use them to compare two anonymous type instances for equality.</span></span> <span data-ttu-id="99fb5-123">Allerdings können die Werte der Eigenschaften geändert werden.</span><span class="sxs-lookup"><span data-stu-id="99fb5-123">However, the values of key properties cannot be changed.</span></span> <span data-ttu-id="99fb5-124">Siehe Abschnitt Schlüsseleigenschaften weiter unten in diesem Thema für Weitere Informationen.</span><span class="sxs-lookup"><span data-stu-id="99fb5-124">See the Key Properties section later in this topic for more information.</span></span>  
  
 <span data-ttu-id="99fb5-125">Beachten Sie, dass eine Instanz eines anonymen Typs deklarieren z. B. eine Instanz eines benannten Typs mithilfe eines Objektinitialisierers deklarieren:</span><span class="sxs-lookup"><span data-stu-id="99fb5-125">Notice that declaring an instance of an anonymous type is like declaring an instance of a named type by using an object initializer:</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#5](../../../../visual-basic/language-reference/modifiers/codesnippet/VisualBasic/anonymous-types_5.vb)]  
  
 <span data-ttu-id="99fb5-126">Weitere Informationen zu anderen Möglichkeiten zum Angeben von Eigenschaften des anonymen Typs, finden Sie unter [wie: Ableiten von Eigenschaftennamen und Typen in Deklarationen von anonymen Typen](../../../../visual-basic/programming-guide/language-features/objects-and-classes/how-to-infer-property-names-and-types-in-anonymous-type-declarations.md).</span><span class="sxs-lookup"><span data-stu-id="99fb5-126">For more information about other ways to specify anonymous type properties, see [How to: Infer Property Names and Types in Anonymous Type Declarations](../../../../visual-basic/programming-guide/language-features/objects-and-classes/how-to-infer-property-names-and-types-in-anonymous-type-declarations.md).</span></span>  
  
## <a name="key-properties"></a><span data-ttu-id="99fb5-127">Wichtige Eigenschaften</span><span class="sxs-lookup"><span data-stu-id="99fb5-127">Key Properties</span></span>  
 <span data-ttu-id="99fb5-128">Wichtige Eigenschaften unterscheiden sich einige grundlegende Arten von nicht schlüsselbezogene Eigenschaften:</span><span class="sxs-lookup"><span data-stu-id="99fb5-128">Key properties differ from non-key properties in several fundamental ways:</span></span>  
  
-   <span data-ttu-id="99fb5-129">Um zu bestimmen, ob zwei Instanzen gleich sind, werden nur die Werte von Schlüsseleigenschaften verglichen.</span><span class="sxs-lookup"><span data-stu-id="99fb5-129">Only the values of key properties are compared in order to determine whether two instances are equal.</span></span>  
  
-   <span data-ttu-id="99fb5-130">Die Werte der Eigenschaften sind schreibgeschützt und können nicht geändert werden.</span><span class="sxs-lookup"><span data-stu-id="99fb5-130">The values of key properties are read-only and cannot be changed.</span></span>  
  
-   <span data-ttu-id="99fb5-131">Eigenschaftenwerte sind nur in der vom Compiler generierte Code Hashalgorithmus für einen anonymen Typ enthalten.</span><span class="sxs-lookup"><span data-stu-id="99fb5-131">Only key property values are included in the compiler-generated hash code algorithm for an anonymous type.</span></span>  
  
### <a name="equality"></a><span data-ttu-id="99fb5-132">Gleichheit</span><span class="sxs-lookup"><span data-stu-id="99fb5-132">Equality</span></span>  
 <span data-ttu-id="99fb5-133">Instanzen von anonymen Typen können nur dann, wenn sie Instanzen desselben anonymen Typs sind gleich sein.</span><span class="sxs-lookup"><span data-stu-id="99fb5-133">Instances of anonymous types can be equal only if they are instances of the same anonymous type.</span></span> <span data-ttu-id="99fb5-134">Der Compiler behandelt zwei Instanzen als Instanzen desselben Typs, wenn sie die folgenden Bedingungen erfüllen:</span><span class="sxs-lookup"><span data-stu-id="99fb5-134">The compiler treats two instances as instances of the same type if they meet the following conditions:</span></span>  
  
-   <span data-ttu-id="99fb5-135">In der gleichen Assembly deklariert werden.</span><span class="sxs-lookup"><span data-stu-id="99fb5-135">They are declared in the same assembly.</span></span>  
  
-   <span data-ttu-id="99fb5-136">Ihre Eigenschaften haben die gleichen Namen, die gleichen hergeleiteten Typen, und in der gleichen Reihenfolge deklariert werden.</span><span class="sxs-lookup"><span data-stu-id="99fb5-136">Their properties have the same names, the same inferred types, and are declared in the same order.</span></span> <span data-ttu-id="99fb5-137">Vergleichen des wird die Groß-und Kleinschreibung nicht berücksichtigt.</span><span class="sxs-lookup"><span data-stu-id="99fb5-137">Name comparisons are not case-sensitive.</span></span>  
  
-   <span data-ttu-id="99fb5-138">Die gleichen Eigenschaften in den einzelnen sind als Schlüsseleigenschaften gekennzeichnet.</span><span class="sxs-lookup"><span data-stu-id="99fb5-138">The same properties in each are marked as key properties.</span></span>  
  
-   <span data-ttu-id="99fb5-139">Mindestens eine Eigenschaft in jeder Deklaration ist eine Schlüsseleigenschaft.</span><span class="sxs-lookup"><span data-stu-id="99fb5-139">At least one property in each declaration is a key property.</span></span>  
  
 <span data-ttu-id="99fb5-140">Eine Instanz eines anonymen Typs, die keine Schlüsseleigenschaften verfügt ist ungleich sich selbst.</span><span class="sxs-lookup"><span data-stu-id="99fb5-140">An instance of an anonymous types that has no key properties is equal only to itself.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#6](../../../../visual-basic/language-reference/modifiers/codesnippet/VisualBasic/anonymous-types_6.vb)]  
  
 <span data-ttu-id="99fb5-141">Zwei Instanzen desselben anonymen Typs sind gleich, wenn die Werte ihrer Schlüssel Eigenschaften gleich sind.</span><span class="sxs-lookup"><span data-stu-id="99fb5-141">Two instances of the same anonymous type are equal if the values of their key properties are equal.</span></span> <span data-ttu-id="99fb5-142">Die folgenden Beispiele veranschaulichen, wie auf Gleichheit getestet wird.</span><span class="sxs-lookup"><span data-stu-id="99fb5-142">The following examples illustrate how equality is tested.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#7](../../../../visual-basic/language-reference/modifiers/codesnippet/VisualBasic/anonymous-types_7.vb)]  
  
### <a name="read-only-values"></a><span data-ttu-id="99fb5-143">Schreibgeschützte Werte</span><span class="sxs-lookup"><span data-stu-id="99fb5-143">Read-Only Values</span></span>  
 <span data-ttu-id="99fb5-144">Die Werte von Schlüsseleigenschaften können nicht geändert werden.</span><span class="sxs-lookup"><span data-stu-id="99fb5-144">The values of key properties cannot be changed.</span></span> <span data-ttu-id="99fb5-145">Beispielsweise ist in `prod8` im vorherigen Beispiel der `Name` und `Price` Felder sind `read-only`, aber `OnHand` kann geändert werden.</span><span class="sxs-lookup"><span data-stu-id="99fb5-145">For example, in `prod8` in the previous example, the `Name` and `Price` fields are `read-only`, but `OnHand` can be changed.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#8](../../../../visual-basic/language-reference/modifiers/codesnippet/VisualBasic/anonymous-types_8.vb)]  
  
## <a name="anonymous-types-from-query-expressions"></a><span data-ttu-id="99fb5-146">Anonyme Typen von Abfrageausdrücken</span><span class="sxs-lookup"><span data-stu-id="99fb5-146">Anonymous Types from Query Expressions</span></span>  
 <span data-ttu-id="99fb5-147">Abfrageausdrücke müssen nicht immer die Erstellung von anonymen Typen aufweisen.</span><span class="sxs-lookup"><span data-stu-id="99fb5-147">Query expressions do not always require the creation of anonymous types.</span></span> <span data-ttu-id="99fb5-148">Wenn möglich, verwenden sie einen vorhandenen Typ zum Speichern der Spaltendaten an.</span><span class="sxs-lookup"><span data-stu-id="99fb5-148">When possible, they use an existing type to hold the column data.</span></span> <span data-ttu-id="99fb5-149">Dies tritt auf, wenn die Abfrage entweder ganze Datensätze aus der Datenquelle oder nur ein Feld aus jedem Datensatz zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="99fb5-149">This occurs when the query returns either whole records from the data source, or only one field from each record.</span></span> <span data-ttu-id="99fb5-150">In den folgenden Codebeispielen `customers` ist eine Auflistung von Objekten von einem `Customer` Klasse.</span><span class="sxs-lookup"><span data-stu-id="99fb5-150">In the following code examples, `customers` is a collection of objects of a `Customer` class.</span></span> <span data-ttu-id="99fb5-151">Die Klasse verfügt über zahlreiche Eigenschaften, und Sie können eine oder mehrere dieser Servertypen im Abfrageergebnis in beliebiger Reihenfolge enthalten.</span><span class="sxs-lookup"><span data-stu-id="99fb5-151">The class has many properties, and you can include one or more of them in the query result, in any order.</span></span> <span data-ttu-id="99fb5-152">In den ersten beiden Beispielen werden keine anonymen Typen erforderlich, da die Abfragen Elemente von benannten Typen auswählen:</span><span class="sxs-lookup"><span data-stu-id="99fb5-152">In the first two examples, no anonymous types are required because the queries select elements of named types:</span></span>  
  
-   <span data-ttu-id="99fb5-153">`custs1`enthält eine Auflistung von Zeichenfolgen, da `cust.Name` ist eine Zeichenfolge.</span><span class="sxs-lookup"><span data-stu-id="99fb5-153">`custs1` contains a collection of strings, because `cust.Name` is a string.</span></span>  
  
     [!code-vb[VbVbalrAnonymousTypes#30](../../../../visual-basic/language-reference/modifiers/codesnippet/VisualBasic/anonymous-types_9.vb)]  
  
-   <span data-ttu-id="99fb5-154">`custs2`enthält eine Auflistung von `Customer` Objekten, da jedes Element der `customers` ist ein `Customer` Objekt und das ganze Element von der Abfrage ausgewählt ist.</span><span class="sxs-lookup"><span data-stu-id="99fb5-154">`custs2` contains a collection of `Customer` objects, because each element of `customers` is a `Customer` object, and the whole element is selected by the query.</span></span>  
  
     [!code-vb[VbVbalrAnonymousTypes#31](../../../../visual-basic/language-reference/modifiers/codesnippet/VisualBasic/anonymous-types_10.vb)]  
  
 <span data-ttu-id="99fb5-155">Entsprechende benannte Typen sind jedoch nicht immer verfügbar.</span><span class="sxs-lookup"><span data-stu-id="99fb5-155">However, appropriate named types are not always available.</span></span> <span data-ttu-id="99fb5-156">Möglicherweise möchten Kundennamen und Adressen für einen bestimmten Zweck, Kunden-ID-Nummern und Speicherorte für eine andere und Kundennamen, Adressen und Reihenfolge Verlaufseinträge für eine dritte auswählen.</span><span class="sxs-lookup"><span data-stu-id="99fb5-156">You might want to select customer names and addresses for one purpose, customer ID numbers and locations for another, and customer names, addresses, and order histories for a third.</span></span> <span data-ttu-id="99fb5-157">Anonyme Typen können Sie jede beliebige Kombination von Eigenschaften dar, in beliebiger Reihenfolge zu aktivieren, ohne zuerst deklariert einen neuen benannten Typ, um das Ergebnis aufzunehmen.</span><span class="sxs-lookup"><span data-stu-id="99fb5-157">Anonymous types enable you to select any combination of properties, in any order, without first declaring a new named type to hold the result.</span></span> <span data-ttu-id="99fb5-158">Stattdessen erstellt der Compiler einen anonymen Typ für jede Zusammenstellung von Eigenschaften.</span><span class="sxs-lookup"><span data-stu-id="99fb5-158">Instead, the compiler creates an anonymous type for each compilation of properties.</span></span> <span data-ttu-id="99fb5-159">Die folgende Abfrage wählt nur die Customer Name und ID-Nummer aus allen `Customer` -Objekt in `customers`.</span><span class="sxs-lookup"><span data-stu-id="99fb5-159">The following query selects only the customer's name and ID number from each `Customer` object in `customers`.</span></span> <span data-ttu-id="99fb5-160">Aus diesem Grund erstellt der Compiler einen anonymen Typ, der nur diese zwei Eigenschaften enthält.</span><span class="sxs-lookup"><span data-stu-id="99fb5-160">Therefore, the compiler creates an anonymous type that contains only those two properties.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTYpes#32](../../../../visual-basic/language-reference/modifiers/codesnippet/VisualBasic/anonymous-types_11.vb)]  
  
 <span data-ttu-id="99fb5-161">Die Namen und die Datentypen der Eigenschaften des anonymen Typs stammen aus den Argumenten um `Select`, `cust.Name` und `cust.ID`.</span><span class="sxs-lookup"><span data-stu-id="99fb5-161">Both the names and the data types of the properties in the anonymous type are taken from the arguments to `Select`, `cust.Name` and `cust.ID`.</span></span> <span data-ttu-id="99fb5-162">Die Eigenschaften in einem anonymen Typ, der von einer Abfrage erstellt wird, sind immer Schlüsseleigenschaften.</span><span class="sxs-lookup"><span data-stu-id="99fb5-162">The properties in an anonymous type that is created by a query are always key properties.</span></span> <span data-ttu-id="99fb5-163">Wenn `custs3` ausgeführt wird, in der folgenden `For Each` Schleife, das Ergebnis ist eine Auflistung von Instanzen eines anonymen Typs mit zwei Schlüsseleigenschaften `Name` und `ID`.</span><span class="sxs-lookup"><span data-stu-id="99fb5-163">When `custs3` is executed in the following `For Each` loop, the result is a collection of instances of an anonymous type with two key properties, `Name` and `ID`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#33](../../../../visual-basic/language-reference/modifiers/codesnippet/VisualBasic/anonymous-types_12.vb)]  
  
 <span data-ttu-id="99fb5-164">Die Elemente in der Auflistung dargestellte `custs3` sind stark typisiert, und Sie können IntelliSense verwenden, zum Navigieren durch die verfügbaren Eigenschaften und ihre Typen zu überprüfen.</span><span class="sxs-lookup"><span data-stu-id="99fb5-164">The elements in the collection represented by `custs3` are strongly typed, and you can use IntelliSense to navigate through the available properties and to verify their types.</span></span>  
  
 <span data-ttu-id="99fb5-165">Weitere Informationen finden Sie unter [Einführung in LINQ in Visual Basic](../../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md).</span><span class="sxs-lookup"><span data-stu-id="99fb5-165">For more information, see [Introduction to LINQ in Visual Basic](../../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md).</span></span>  
  
## <a name="deciding-whether-to-use-anonymous-types"></a><span data-ttu-id="99fb5-166">Die Entscheidung, ob anonyme Typen verwenden.</span><span class="sxs-lookup"><span data-stu-id="99fb5-166">Deciding Whether to Use Anonymous Types</span></span>  
 <span data-ttu-id="99fb5-167">Bevor Sie ein Objekt als eine Instanz einer anonymen Klasse erstellen, erwägen Sie, ob dies die beste Option ist.</span><span class="sxs-lookup"><span data-stu-id="99fb5-167">Before you create an object as an instance of an anonymous class, consider whether that is the best option.</span></span> <span data-ttu-id="99fb5-168">Wenn verknüpfte Daten enthalten ein temporäres Objekt erstellt werden soll, und Sie benötigen keine weiteren Felder und Methoden, die möglicherweise eine vollständige Klasse enthalten, ist ein anonymer Typ eine gute Lösung.</span><span class="sxs-lookup"><span data-stu-id="99fb5-168">For example, if you want to create a temporary object to contain related data, and you have no need for other fields and methods that a complete class might contain, an anonymous type is a good solution.</span></span> <span data-ttu-id="99fb5-169">Anonyme Typen stellen auch praktisch, wenn Sie eine andere Auswahl von Eigenschaften für jede Deklaration möchten oder wenn Sie die Reihenfolge der Eigenschaften ändern möchten.</span><span class="sxs-lookup"><span data-stu-id="99fb5-169">Anonymous types are also convenient if you want a different selection of properties for each declaration, or if you want to change the order of the properties.</span></span> <span data-ttu-id="99fb5-170">Jedoch, wenn Ihr Projekt mehrere Objekte, die die gleichen Eigenschaften in einer festen Reihenfolge aufweisen enthält, können Sie sie leichter deklarieren mithilfe eines benannten Typs mit einem Klassenkonstruktor.</span><span class="sxs-lookup"><span data-stu-id="99fb5-170">However, if your project includes several objects that have the same properties, in a fixed order, you can declare them more easily by using a named type with a class constructor.</span></span> <span data-ttu-id="99fb5-171">Z. B. mit einem geeigneten Konstruktor, es ist einfacher, mehrere Instanzen von Deklarieren einer `Product` Klasse als es ist, mehrere Instanzen eines anonymen Typs deklarieren.</span><span class="sxs-lookup"><span data-stu-id="99fb5-171">For example, with an appropriate constructor, it is easier to declare several instances of a `Product` class than it is to declare several instances of an anonymous type.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#9](../../../../visual-basic/language-reference/modifiers/codesnippet/VisualBasic/anonymous-types_13.vb)]  
  
 <span data-ttu-id="99fb5-172">Ein weiterer Vorteil von benannten Typen ist, dass der Compiler eine versehentliche Tippfehler neben einem Eigenschaftennamen erfasst werden kann.</span><span class="sxs-lookup"><span data-stu-id="99fb5-172">Another advantage of named types is that the compiler can catch an accidental mistyping of a property name.</span></span> <span data-ttu-id="99fb5-173">In den vorherigen Beispielen `firstProd2`, `secondProd2`, und `thirdProd2` sollten Instanzen desselben anonymen Typs verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="99fb5-173">In the previous examples, `firstProd2`, `secondProd2`, and `thirdProd2` are intended to be instances of the same anonymous type.</span></span> <span data-ttu-id="99fb5-174">Wenn Sie unbeabsichtigt jedoch deklarieren `thirdProd2` in einem der folgenden Methoden, dessen Typ wären unterschiedlich aus, die von `firstProd2` und `secondProd2`.</span><span class="sxs-lookup"><span data-stu-id="99fb5-174">However, if you were to accidentally declare `thirdProd2` in one of the following ways, its type would be different from that of `firstProd2` and `secondProd2`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#10](../../../../visual-basic/language-reference/modifiers/codesnippet/VisualBasic/anonymous-types_14.vb)]  
  
 <span data-ttu-id="99fb5-175">Es gibt vor allem Einschränkungen bei der Verwendung von anonymen Typen, die auf Instanzen von benannten Typen nicht anwendbar sind.</span><span class="sxs-lookup"><span data-stu-id="99fb5-175">More importantly, there are limitations on the use of anonymous types that do not apply to instances of named types.</span></span> <span data-ttu-id="99fb5-176">`firstProd2`, `secondProd2`, und `thirdProd2` Instanzen desselben anonymen Typs sind.</span><span class="sxs-lookup"><span data-stu-id="99fb5-176">`firstProd2`, `secondProd2`, and `thirdProd2` are instances of the same anonymous type.</span></span> <span data-ttu-id="99fb5-177">Allerdings wird der Name für den freigegebenen anonymen Typ ist nicht verfügbar und kann nicht verwendet werden, wo ein Typname in Ihrem Code erwartet wird.</span><span class="sxs-lookup"><span data-stu-id="99fb5-177">However, the name for the shared anonymous type is not available and cannot appear where a type name is expected in your code.</span></span> <span data-ttu-id="99fb5-178">Z. B. kann kein anonymes Typs verwendet werden, definieren Sie die Signatur einer Methode um eine andere Variable Felds oder in der Typdeklaration einer deklarieren.</span><span class="sxs-lookup"><span data-stu-id="99fb5-178">For example, an anonymous type cannot be used to define a method signature, to declare another variable or field, or in any type declaration.</span></span> <span data-ttu-id="99fb5-179">Daher sind anonyme Typen nicht geeignet, wenn Sie die Freigabe von Informationen über Methoden verfügen.</span><span class="sxs-lookup"><span data-stu-id="99fb5-179">As a result, anonymous types are not appropriate when you have to share information across methods.</span></span>  
  
## <a name="an-anonymous-type-definition"></a><span data-ttu-id="99fb5-180">Eine Definition von anonymen Typen</span><span class="sxs-lookup"><span data-stu-id="99fb5-180">An Anonymous Type Definition</span></span>  
 <span data-ttu-id="99fb5-181">Als Antwort auf die Deklaration einer Instanz eines anonymen Typs erstellt der Compiler eine neue Klassendefinition, die die angegebenen Eigenschaften enthält.</span><span class="sxs-lookup"><span data-stu-id="99fb5-181">In response to the declaration of an instance of an anonymous type, the compiler creates a new class definition that contains the specified properties.</span></span>  
  
 <span data-ttu-id="99fb5-182">Wenn der anonyme Typ mindestens eine Schlüsseleigenschaft enthält, überschreibt die Definition drei von geerbte Member <xref:System.Object>: <xref:System.Object.Equals%2A>, <xref:System.Object.GetHashCode%2A>, und <xref:System.Object.ToString%2A>.</span><span class="sxs-lookup"><span data-stu-id="99fb5-182">If the anonymous type contains at least one key property, the definition overrides three members inherited from <xref:System.Object>: <xref:System.Object.Equals%2A>, <xref:System.Object.GetHashCode%2A>, and <xref:System.Object.ToString%2A>.</span></span> <span data-ttu-id="99fb5-183">Der Code erzeugt zum Testen der Übereinstimmung und ermittelt, auf der Hashcodewert nur die Schlüsseleigenschaften betrachtet.</span><span class="sxs-lookup"><span data-stu-id="99fb5-183">The code produced for testing equality and determining the hash code value considers only the key properties.</span></span> <span data-ttu-id="99fb5-184">Wenn des anonymen Typs nur keine Schlüsseleigenschaften enthält <xref:System.Object.ToString%2A> überschrieben wird.</span><span class="sxs-lookup"><span data-stu-id="99fb5-184">If the anonymous type contains no key properties, only <xref:System.Object.ToString%2A> is overridden.</span></span> <span data-ttu-id="99fb5-185">Explizit benannte Eigenschaften eines anonymen Typs können nicht mit diesen generierten Methoden in Konflikt stehen.</span><span class="sxs-lookup"><span data-stu-id="99fb5-185">Explicitly named properties of an anonymous type cannot conflict with these generated methods.</span></span> <span data-ttu-id="99fb5-186">D. h., Sie können keine `.Equals`, `.GetHashCode`, oder `.ToString` um eine Eigenschaft zu benennen.</span><span class="sxs-lookup"><span data-stu-id="99fb5-186">That is, you cannot use `.Equals`, `.GetHashCode`, or `.ToString` to name a property.</span></span>  
  
 <span data-ttu-id="99fb5-187">Anonyme Typdefinitionen, bei denen mindestens einer Schlüsseleigenschaft auch implementieren die <xref:System.IEquatable%601?displayProperty=nameWithType> -Schnittstelle, in denen `T` ist der Typ des anonymen Typs.</span><span class="sxs-lookup"><span data-stu-id="99fb5-187">Anonymous type definitions that have at least one key property also implement the <xref:System.IEquatable%601?displayProperty=nameWithType> interface, where `T` is the type of the anonymous type.</span></span>  
  
 <span data-ttu-id="99fb5-188">Weitere Informationen zu den Code durch den Compiler und die Funktionalität der überschriebenen Methoden erstellt wird, finden Sie unter [anonymen Typdefinition](../../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-type-definition.md).</span><span class="sxs-lookup"><span data-stu-id="99fb5-188">For more information about the code created by the compiler and the functionality of the overridden methods, see [Anonymous Type Definition](../../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-type-definition.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="99fb5-189">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="99fb5-189">See Also</span></span>  
 [<span data-ttu-id="99fb5-190">Objektinitialisierer: Benannte und anonyme Typen</span><span class="sxs-lookup"><span data-stu-id="99fb5-190">Object Initializers: Named and Anonymous Types</span></span>](../../../../visual-basic/programming-guide/language-features/objects-and-classes/object-initializers-named-and-anonymous-types.md)  
 [<span data-ttu-id="99fb5-191">Lokaler Typrückschluss</span><span class="sxs-lookup"><span data-stu-id="99fb5-191">Local Type Inference</span></span>](../../../../visual-basic/programming-guide/language-features/variables/local-type-inference.md)  
 [<span data-ttu-id="99fb5-192">Einführung in LINQ in Visual Basic</span><span class="sxs-lookup"><span data-stu-id="99fb5-192">Introduction to LINQ in Visual Basic</span></span>](../../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md)  
 [<span data-ttu-id="99fb5-193">Gewusst wie: Ableiten von Eigenschaftennamen und Typen in Deklarationen von anonymen Typen</span><span class="sxs-lookup"><span data-stu-id="99fb5-193">How to: Infer Property Names and Types in Anonymous Type Declarations</span></span>](../../../../visual-basic/programming-guide/language-features/objects-and-classes/how-to-infer-property-names-and-types-in-anonymous-type-declarations.md)  
 [<span data-ttu-id="99fb5-194">Definition von anonymen Typen</span><span class="sxs-lookup"><span data-stu-id="99fb5-194">Anonymous Type Definition</span></span>](../../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-type-definition.md)  
 [<span data-ttu-id="99fb5-195">Key</span><span class="sxs-lookup"><span data-stu-id="99fb5-195">Key</span></span>](../../../../visual-basic/language-reference/modifiers/key.md)
