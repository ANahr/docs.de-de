---
title: REF-Rückgabewerte (Visual Basic)
ms.custom: ''
ms.date: 04/28/2017
ms.prod: .net
ms.reviewer: ''
ms.suite: ''
ms.technology:
- devlang-visual-basic
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- variables [Visual Basic]
- ref return values [Visual Basic]
- ref returns [Visual Basic]
ms.assetid: 5ef0cc69-eb3a-4a67-92a2-78585f223cb5
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: 6055028ac92016cbc4b6f7bffa7f483e5ea76608
ms.sourcegitcommit: 86adcc06e35390f13c1e372c36d2e044f1fc31ef
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/26/2018
---
# <a name="support-for-reference-return-values-visual-basic"></a><span data-ttu-id="6242b-102">Unterstützung für Rückgabewerte, Referenz (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="6242b-102">Support for reference return values (Visual Basic)</span></span>

<span data-ttu-id="6242b-103">C#-7.0 ab, die C#-Sprache unterstützt *verweisen Rückgabewerte*.</span><span class="sxs-lookup"><span data-stu-id="6242b-103">Starting with C# 7.0, the C# language supports *reference return values*.</span></span> <span data-ttu-id="6242b-104">Eine Möglichkeit, Rückgabewerte Verweis zu verstehen ist, sind das Gegenteil von Argumenten, die als Verweis an eine Methode übergeben werden.</span><span class="sxs-lookup"><span data-stu-id="6242b-104">One way to understand reference return values is that they are the opposite of arguments that are passed by reference to a method.</span></span> <span data-ttu-id="6242b-105">Wenn ein als Verweis übergebenes Argument geändert wird, werden die Änderungen im Wert der Variablen für den Aufrufer berücksichtigt.</span><span class="sxs-lookup"><span data-stu-id="6242b-105">When an argument passed by reference is modified, the changes are reflected in value of the variable on the caller.</span></span> <span data-ttu-id="6242b-106">Wenn eine Methode einen Rückgabewert Verweis an einem Aufrufer bereitstellt, sind Änderungen an den der Rückgabewert der Verweis vom Aufrufer in der aufgerufenen Methode Daten widergespiegelt.</span><span class="sxs-lookup"><span data-stu-id="6242b-106">When an method provides a reference return value to a caller, modifications made to the reference return value by the caller are reflected in the called method's data.</span></span>

<span data-ttu-id="6242b-107">Visual Basic lässt nicht zu, Sie auf Autor Methoden mit Verweis Rückgabewerte, aber ermöglicht es Ihnen, Reference-Rückgabewerte zu nutzen.</span><span class="sxs-lookup"><span data-stu-id="6242b-107">Visual Basic does not allow you to author methods with reference return values, but it does allow you to consume reference return values.</span></span> <span data-ttu-id="6242b-108">Das heißt, können Sie eine Methode mit einem Rückgabewert Verweis aufrufen und ändern Sie diesen Rückgabewert und Änderungen an der Rückgabewert der Verweis in der aufgerufenen Methode Daten wiedergegeben werden.</span><span class="sxs-lookup"><span data-stu-id="6242b-108">In other words, you can call a method with a reference return value and modify that return value, and changes to the reference return value are reflected in the called method's data.</span></span>

## <a name="modifying-the-ref-return-value-directly"></a><span data-ttu-id="6242b-109">Ändern Sie direkt von der Ref-Rückgabewert</span><span class="sxs-lookup"><span data-stu-id="6242b-109">Modifying the ref return value directly</span></span>

<span data-ttu-id="6242b-110">Für Methoden, die immer erfolgreich sein und verfügen über keine `ByRef` Parameter, Sie können den Rückgabewert Verweis direkt ändern.</span><span class="sxs-lookup"><span data-stu-id="6242b-110">For methods that always succeed and have no `ByRef` parameters, you can modify the reference return value directly.</span></span> <span data-ttu-id="6242b-111">Dazu müssen Sie die Ausdrücke, die den Rückgabewert Verweis gibt den neuen Wert zuweisen.</span><span class="sxs-lookup"><span data-stu-id="6242b-111">You do this by assigning the new value to the expressions that returns the reference return value.</span></span> 

<span data-ttu-id="6242b-112">Im folgenden C#-Beispiel definiert eine `NumericValue.IncrementValue` Rückgabewert der Methode, die einen internen Wert inkrementiert und wird als Verweis zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="6242b-112">The following C# example defines a `NumericValue.IncrementValue` method that increments an internal value and returns it as a reference return value.</span></span> 

[!code-csharp[Ref-Return](../../../../../samples/snippets/visualbasic/programming-guide/language-features/procedures/ref-returns1.cs)]

<span data-ttu-id="6242b-113">Der Verweis zurückzugeben Wert anschließend geändert wird, von dem Aufrufer in der folgenden Visual Basic-Beispiel.</span><span class="sxs-lookup"><span data-stu-id="6242b-113">The reference return value is then modified by the caller in the following Visual Basic example.</span></span> <span data-ttu-id="6242b-114">Beachten Sie, dass die Zeile mit der `NumericValue.IncrementValue` Methodenaufruf kein an die Methode einen Wert zugewiesen.</span><span class="sxs-lookup"><span data-stu-id="6242b-114">Note that the line with the `NumericValue.IncrementValue` method call does not assign a value to the method.</span></span> <span data-ttu-id="6242b-115">Stattdessen weist er einen Wert auf den Rückgabewert Verweis, der von der Methode zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="6242b-115">Instead, it assigns a value to the reference return value returned by the method.</span></span>

[!code-vb[Ref-Return](../../../../../samples/snippets/visualbasic/programming-guide/language-features/procedures/use-ref-returns1.vb)]

## <a name="using-a-helper-method"></a><span data-ttu-id="6242b-116">Verwenden eine Hilfsmethode</span><span class="sxs-lookup"><span data-stu-id="6242b-116">Using a helper method</span></span>

<span data-ttu-id="6242b-117">In anderen Fällen kann den Rückgabewert der Verweis eines Methodenaufrufs direkt ändern immer unerwünscht sein.</span><span class="sxs-lookup"><span data-stu-id="6242b-117">In other cases, modifying the reference return value of a method call directly may not always be desirable.</span></span> <span data-ttu-id="6242b-118">Beispielsweise kann eine Search-Methode, die eine Zeichenfolge zurückgibt, nicht immer eine Übereinstimmung gefunden werden.</span><span class="sxs-lookup"><span data-stu-id="6242b-118">For example, a search method that returns a string may not always find a match.</span></span> <span data-ttu-id="6242b-119">In diesem Fall möchten Sie den Rückgabewert der Verweis nur ändern, wenn die Suche erfolgreich ist.</span><span class="sxs-lookup"><span data-stu-id="6242b-119">In that case, you want to modify the reference return value only if the search is successful.</span></span>

<span data-ttu-id="6242b-120">Im folgenden C#-Beispiel wird dieses Szenario veranschaulicht.</span><span class="sxs-lookup"><span data-stu-id="6242b-120">The following C# example illustrates this scenario.</span></span> <span data-ttu-id="6242b-121">Definiert eine `Sentence` in c# geschriebene Klasse enthält eine `FindNext` Methode, die das nächste Wort im Satz gefunden werden, die mit einer angegebenen Teilzeichenfolge beginnt.</span><span class="sxs-lookup"><span data-stu-id="6242b-121">It defines a `Sentence` class written in C# includes a `FindNext` method that finds the next word in a sentence that begins with a specified substring.</span></span> <span data-ttu-id="6242b-122">Die Zeichenfolge wird als Verweisrückgabewert zurückgegeben, und eine vom Verweis an die Methode übergebene `Boolean`-Variable gibt an, ob die Suche Erfolg hatte.</span><span class="sxs-lookup"><span data-stu-id="6242b-122">The string is returned as a reference return value, and a `Boolean` variable passed by reference to the method indicates whether the search was successful.</span></span> <span data-ttu-id="6242b-123">Der Verweis-Rückgabewert gibt an, dass der Aufrufer nicht den zurückgegebenen Wert schreibgeschützt kann; er oder sie können auch ändern und diese Änderung wirkt sich intern in enthaltenen Daten die `Sentence` Klasse.</span><span class="sxs-lookup"><span data-stu-id="6242b-123">The reference return value indicates that the caller can not only read the returned value; he or she can also modify it, and that modification is reflected in the data contained internally in the `Sentence` class.</span></span>

[!code-csharp[Ref-Return](../../../../../samples/snippets/visualbasic/getting-started/ref-returns.cs)]

<span data-ttu-id="6242b-124">Direktes Ändern des Verweis ist der Rückgabewert in diesem Fall nicht zuverlässig ist und seit dem Aufruf der Methode fehlschlagen, um eine Übereinstimmung gefunden, und geben Sie das erste Wort im Satz zurück.</span><span class="sxs-lookup"><span data-stu-id="6242b-124">Directly modifying the reference return value in this case is not reliable, since the method call may fail to find a match and return the first word in the sentence.</span></span> <span data-ttu-id="6242b-125">In diesem Fall wird der Aufrufer versehentlich das erste Wort des Satzes ändern.</span><span class="sxs-lookup"><span data-stu-id="6242b-125">In that case, the caller will inadvertently modify the first word of the sentence.</span></span> <span data-ttu-id="6242b-126">Das kann verhindert werden, durch den Aufrufer zurückgeben einer `null` (oder `Nothing` in Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="6242b-126">This could be prevented by the caller returning a `null` (or `Nothing` in Visual Basic).</span></span> <span data-ttu-id="6242b-127">Aber in diesem Fall versuchen, eine Zeichenfolge zu ändern, deren Wert `Nothing` löst eine <xref:System.NullReferenceException>.</span><span class="sxs-lookup"><span data-stu-id="6242b-127">But in that case, attempting to modify a string whose value is `Nothing` throws a <xref:System.NullReferenceException>.</span></span> <span data-ttu-id="6242b-128">Wenn auch durch den Aufrufer zurückgeben verhindert werden könnte <xref:System.String.Empty?displayProperty=nameWithType>, aber dies erfordert, dass der Aufrufer eine Zeichenfolgenvariable definieren, deren Wert <xref:System.String.Empty?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="6242b-128">If could also be prevented by the caller returning <xref:System.String.Empty?displayProperty=nameWithType>, but this requires that the caller define a string variable whose value is <xref:System.String.Empty?displayProperty=nameWithType>.</span></span> <span data-ttu-id="6242b-129">Während der Aufrufer diese Zeichenfolge ändern kann, dient die Änderung selbst keinen Zweck, da die geänderte Zeichenfolge keine Beziehung zu den Wörtern des Satzes von gespeichert hat die `Sentence` Klasse.</span><span class="sxs-lookup"><span data-stu-id="6242b-129">While the caller can modify that string, the modification itself serves no purpose, since the modified string has no relationship to the words in the sentence stored by the `Sentence` class.</span></span>

<span data-ttu-id="6242b-130">Die beste Möglichkeit, dieses Szenario zu behandeln ist den Rückgabewert der Verweis als Verweis an eine Hilfsmethode zu übergeben.</span><span class="sxs-lookup"><span data-stu-id="6242b-130">The best way to handle this scenario is to pass the reference return value by reference to a helper method.</span></span> <span data-ttu-id="6242b-131">Die Hilfsmethode enthält die Logik, um zu bestimmen, ob der Methodenaufruf erfolgreich war, und wenn dem so wäre, zum Ändern der Verweis Wert zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="6242b-131">The helper method then contains the logic to determine whether the method call succeeded and, if it did, to modify the reference return value.</span></span> <span data-ttu-id="6242b-132">Das folgende Beispiel veranschaulicht eine mögliche Implementierung.</span><span class="sxs-lookup"><span data-stu-id="6242b-132">The following example provides a possible implementation.</span></span>

[!code-vb[Ref-Return](../../../../../samples/snippets/visualbasic/getting-started/ref-return-helper.vb#1)]

## <a name="see-also"></a><span data-ttu-id="6242b-133">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="6242b-133">See also</span></span>

<span data-ttu-id="6242b-134">[Übergeben von Argumenten als Wert und als Verweis](passing-arguments-by-value-and-by-reference.md) </span><span class="sxs-lookup"><span data-stu-id="6242b-134">[Passing arguments by value and by reference](passing-arguments-by-value-and-by-reference.md) </span></span>  
[<span data-ttu-id="6242b-135">Prozeduren in Visual Basic</span><span class="sxs-lookup"><span data-stu-id="6242b-135">Procedures in Visual Basic</span></span>](index.md)   


