---
title: "Kanalfactory und Zwischenspeichern | Microsoft Docs"
ms.custom: ""
ms.date: "03/30/2017"
ms.prod: ".net-framework"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "dotnet-clr"
ms.tgt_pltfrm: ""
ms.topic: "article"
ms.assetid: 954f030e-091c-4c0e-a7a2-10f9a6b1f529
caps.latest.revision: 3
author: "Erikre"
ms.author: "erikre"
manager: "erikre"
caps.handback.revision: 3
---
# Kanalfactory und Zwischenspeichern
WCF\-Clientanwendungen verwenden die <xref:System.ServiceModel.ChannelFactory%601>\-Klasse, um einen Kommunikationskanal mit einem WCF\-Dienst zu erstellen.Das Erstellen von <xref:System.ServiceModel.ChannelFactory%601>\-Instanzen verursacht einigen Mehraufwand, da er die folgenden Vorgänge umfasst:  
  
-   Erstellen der <xref:System.ServiceModel.Description.ContractDescription>\-Struktur  
  
-   Reflektieren aller erforderlichen CLR\-Typen  
  
-   Erstellen des Kanalstapels  
  
-   Freigeben von Ressourcen  
  
 Um den Mehraufwand minimieren, kann WCF Kanalfactorys zwischenspeichern, wenn Sie einen WCF\-Clientproxy verwenden.  
  
> [!TIP]
>  Sie können die Erstellung von Kanalfactorys direkt steuern, wenn Sie die <xref:System.ServiceModel.ChannelFactory%601>\-Klasse direkt verwenden.  
  
 Die mit [ServiceModel Metadata Utility\-Tool \(Svcutil.exe\)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md) generierten WCF\-Clientproxys werden von <xref:System.ServiceModel.ClientBase%601> abgeleitet.<xref:System.ServiceModel.ClientBase%601> definiert eine statische <xref:System.ServiceModel.ClientBase%601.CacheSetting%2A>\-Eigenschaft, die das Cachingverhalten der Kanalfactory definiert.Cacheeinstellungen gelten für einen bestimmten Typ.Wenn `ClientBase<ITest>.CacheSettings` beispielsweise auf einen der unten definierten Werte festgelegt wird, wirkt sich das nur auf die Proxy\/ClientBase vom Typ `ITest` aus.Der Cacheeinstellung für eine bestimmte <xref:System.ServiceModel.ClientBase%601> ist unveränderlich, sobald die erste Proxy\/ClientBase\-Instanz erstellt wurde.  
  
## Angeben des Cachingverhaltens  
 Das Cachingverhalten wird angegeben, indem die <xref:System.ServiceModel.ClientBase%601.CacheSetting>\-Eigenschaft auf einen der folgenden Werte festgelegt wird.  
  
|Wert der Cacheeinstellung|Beschreibung|  
|-------------------------------|------------------|  
|<xref:System.ServiceModel.CacheSetting.AlwaysOn>|Alle Instanzen von <xref:System.ServiceModel.ClientBase%601> innerhalb der Anwendungsdomäne können am Caching teilnehmen.Der Entwickler hat ermittelt, dass das Caching keine negativen Auswirkungen auf die Sicherheit hat.Das Caching wird nicht deaktiviert, auch wenn auf "sicherheitsrelevante" Eigenschaften für <xref:System.ServiceModel.ClientBase%601> zugegriffen wird.Die "sicherheitsrelevanten" Eigenschaften von <xref:System.ServiceModel.ClientBase%601> sind <xref:System.ServiceModel.ClientBase%601.ClientCredentials%2A>, <xref:System.ServiceModel.ClientBase%601.Endpoint%2A> und <xref:System.ServiceModel.ClientBase%601.ChannelFactory%2A>.|  
|<xref:System.ServiceModel.CacheSetting.Default>|Nur Instanzen von <xref:System.ServiceModel.ClientBase%601>, die aus in den Konfigurationsdateien definierten Endpunkten erstellt wurden, nehmen am Caching innerhalb der Anwendungsdomäne teil.Alle Instanzen von <xref:System.ServiceModel.ClientBase%601>, die innerhalb dieser Anwendungsdomäne programmgesteuert erstellt wurden, nehmen nicht am Caching teil.Außerdem wird das Caching für eine Instanz von <xref:System.ServiceModel.ClientBase%601> deaktiviert, sobald auf eine der zugehörigen "sicherheitsrelevanten" Eigenschaften zugegriffen wird.|  
|<xref:System.ServiceModel.CacheSetting.AlwaysOff>|Das Caching wird für alle <xref:System.ServiceModel.ClientBase%601>\-Instanzen eines bestimmten Typs innerhalb der betreffenden Anwendungsdomäne deaktiviert.|  
  
 In den folgenden Codeausschnitten wird die Verwendung der <xref:System.ServiceModel.ClientBase%601.CacheSetting%2A>\-Eigenschaft veranschaulicht.  
  
```  
class Program   
{   
   static void Main(string[] args)   
   {   
      ClientBase<ITest>.CacheSettings = CacheSettings.AlwaysOn;   
      foreach (string msg in messages)   
      {   
         using (TestClient proxy = new TestClient (new BasicHttpBinding(), new EndpointAddress(address)))   
         {   
            // ...  
            proxy.Test(msg);   
            // ...  
         }   
      }   
   }   
}  
// Generated by SvcUtil.exe     
public partial class TestClient : System.ServiceModel.ClientBase, ITest { }  
  
```  
  
 Im obigen Code verwenden alle Instanzen von `TestClient` die gleiche Kanalfactory.  
  
```  
class Program   
{   
   static void Main(string[] args)   
   {   
      ClientBase.CacheSettings = CacheSettings.Default;   
      int i = 1;   
      foreach (string msg in messages)   
      {   
         using (TestClient proxy = new TestClient (“MyEndpoint”, new EndpointAddress(address)))   
         {   
            if (i == 4)   
            {   
               ServiceEndpoint endpoint = proxy.Endpoint;   
               ... // use endpoint in some way   
            }   
            proxy.Test(msg);   
         }   
         i++;   
   }   
}   
  
// Generated by SvcUtil.exe     
public partial class TestClient : System.ServiceModel.ClientBase, ITest {}  
```  
  
 Im obigen Beispiel würden alle Instanzen von `TestClient` die gleiche Kanalfactory verwenden, mit Ausnahme von \#4.Instanz \#4 würde eine Kanalfactory verwenden, die speziell für diesen Zweck erstellt wird.Diese Einstellung funktioniert für Szenarien, in denen ein bestimmter Endpunkt unterschiedliche Sicherheitseinstellungen anderer Endpunkte desselben Kanalfactorytyps \(in diesem Fall `ITest`\) benötigt.  
  
```  
class Program   
{   
   static void Main(string[] args)   
   {   
      ClientBase.CacheSettings = CacheSettings.AlwaysOff;   
      foreach (string msg in messages)   
      {   
         using (TestClient proxy = new TestClient (“MyEndpoint”, new EndpointAddress(address)))   
         {   
            proxy.Test(msg);   
         }           
      }   
   }  
}  
  
// Generated by SvcUtil.exe   
public partial class TestClient : System.ServiceModel.ClientBase, ITest {}  
```  
  
 Im obigen Beispiel würden alle Instanzen von `TestClient` verschiedene Kanalfactorys verwenden.Dies ist nützlich, wenn jeder Endpunkt verschiedene Sicherheitsanforderungen hat, und das Caching keinen Sinn macht.  
  
## Siehe auch  
 <xref:System.ServiceModel.ClientBase%601>   
 [Erstellen von Clients](../../../../docs/framework/wcf/building-clients.md)   
 [Clients](../../../../docs/framework/wcf/feature-details/clients.md)   
 [Zugreifen auf Dienste mithilfe eines WCF\-Clients](../../../../docs/framework/wcf/accessing-services-using-a-wcf-client.md)   
 [Vorgehensweise: Verwenden der ChannelFactory](../../../../docs/framework/wcf/feature-details/how-to-use-the-channelfactory.md)