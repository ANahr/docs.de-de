---
title: "Empfehlungen für eine teilweise vertrauenswürdige Umgebung"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 0d052bc0-5b98-4c50-8bb5-270cc8a8b145
caps.latest.revision: "17"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.workload: dotnet
ms.openlocfilehash: 817f7aeeb7adece1c375bb8b0cc455a17fb54185
ms.sourcegitcommit: 16186c34a957fdd52e5db7294f291f7530ac9d24
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 12/22/2017
---
# <a name="partial-trust-best-practices"></a><span data-ttu-id="0a5b2-102">Empfehlungen für eine teilweise vertrauenswürdige Umgebung</span><span class="sxs-lookup"><span data-stu-id="0a5b2-102">Partial Trust Best Practices</span></span>
<span data-ttu-id="0a5b2-103">In diesem Thema werden empfohlene Vorgehensweisen für die Ausführung von [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] in einer teilweise vertrauenswürdigen Umgebung beschrieben.</span><span class="sxs-lookup"><span data-stu-id="0a5b2-103">This topic describes best practices when running [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] in a partial trust environment.</span></span>  
  
## <a name="serialization"></a><span data-ttu-id="0a5b2-104">Serialisierung</span><span class="sxs-lookup"><span data-stu-id="0a5b2-104">Serialization</span></span>  
 <span data-ttu-id="0a5b2-105">Gehen Sie wie nachfolgend beschrieben vor, wenn Sie den <xref:System.Runtime.Serialization.DataContractSerializer> in einer teilweise vertrauenswürdigen Anwendung verwenden.</span><span class="sxs-lookup"><span data-stu-id="0a5b2-105">Apply the following practices when using the <xref:System.Runtime.Serialization.DataContractSerializer> in a partially-trusted application.</span></span>  
  
-   <span data-ttu-id="0a5b2-106">Alle serialisierbaren Typen müssen explizit mit dem `[DataContract]`-Attribut gekennzeichnet werden.</span><span class="sxs-lookup"><span data-stu-id="0a5b2-106">All serializable types must be explicitly marked with the `[DataContract]` attribute.</span></span> <span data-ttu-id="0a5b2-107">Die folgenden Techniken werden in einer teilweise vertrauenswürdigen Umgebung nicht unterstützt:</span><span class="sxs-lookup"><span data-stu-id="0a5b2-107">The following techniques are not supported in a partial trust environment:</span></span>  
  
-   <span data-ttu-id="0a5b2-108">Das Markieren von Klassen, die serialisiert werden sollen, mit <xref:System.SerializableAttribute></span><span class="sxs-lookup"><span data-stu-id="0a5b2-108">Marking classes to be serialized with the <xref:System.SerializableAttribute>.</span></span>  
  
-   <span data-ttu-id="0a5b2-109">Das Implementieren der <xref:System.Runtime.Serialization.ISerializable>-Schnittstelle, damit eine Klasse ihren Serialisierungsprozess steuern kann</span><span class="sxs-lookup"><span data-stu-id="0a5b2-109">Implementing the <xref:System.Runtime.Serialization.ISerializable> interface to allow a class to control its serialization process.</span></span>  
  
### <a name="using-datacontractserializer"></a><span data-ttu-id="0a5b2-110">Verwenden von DataContractSerializer</span><span class="sxs-lookup"><span data-stu-id="0a5b2-110">Using DataContractSerializer</span></span>  
  
-   <span data-ttu-id="0a5b2-111">Alle mit dem `[DataContract]`-Attribut gekennzeichneten Typen müssen öffentlich sein.</span><span class="sxs-lookup"><span data-stu-id="0a5b2-111">All types marked with the `[DataContract]` attribute must be public.</span></span> <span data-ttu-id="0a5b2-112">Nicht öffentliche Typen können in einer teilweise vertrauenswürdigen Umgebung nicht serialisiert werden.</span><span class="sxs-lookup"><span data-stu-id="0a5b2-112">Non-public types cannot be serialized in a partial trust environment.</span></span>  
  
-   <span data-ttu-id="0a5b2-113">Alle `[DataContract]`-Member in einem serialisierbaren `[DataContract]`-Typ müssen öffentlich sein.</span><span class="sxs-lookup"><span data-stu-id="0a5b2-113">All `[DataContract]` members in a serializable `[DataContract]` type must be public.</span></span> <span data-ttu-id="0a5b2-114">Ein Typ mit einem nicht öffentlichen `[DataMember]` kann in einer teilweise vertrauenswürdigen Umgebung nicht serialisiert werden.</span><span class="sxs-lookup"><span data-stu-id="0a5b2-114">A type with a non-public `[DataMember]` cannot be serialized in a partial trust environment.</span></span>  
  
-   <span data-ttu-id="0a5b2-115">Methoden, die Serialisierungsereignisse verarbeiten (z.&#160;B. `OnSerializing`, `OnSerialized`, `OnDeserializing` und `OnDeserialized`), müssen als öffentlich deklariert werden.</span><span class="sxs-lookup"><span data-stu-id="0a5b2-115">Methods that handle serialization events (such as `OnSerializing`, `OnSerialized`, `OnDeserializing`, and `OnDeserialized`) must be declared as public.</span></span> <span data-ttu-id="0a5b2-116">Jedoch werden sowohl explizite als auch implizite Implementierungen von <xref:System.Runtime.Serialization.IDeserializationCallback.OnDeserialization%28System.Object%29> unterstützt.</span><span class="sxs-lookup"><span data-stu-id="0a5b2-116">However, both explicit and implicit implementations of <xref:System.Runtime.Serialization.IDeserializationCallback.OnDeserialization%28System.Object%29> are supported.</span></span>  
  
-   <span data-ttu-id="0a5b2-117">`[DataContract]`-Typen, die in Assemblys implementiert und mit <xref:System.Security.AllowPartiallyTrustedCallersAttribute> gekennzeichnet sind, dürfen keine sicherheitsbezogenen Aktionen im Typenkonstruktor ausführen, da der <xref:System.Runtime.Serialization.DataContractSerializer> den Konstruktor des neu instanziierten Objekts während der Deserialisierung aufruft.</span><span class="sxs-lookup"><span data-stu-id="0a5b2-117">`[DataContract]` types implemented in assemblies marked with the <xref:System.Security.AllowPartiallyTrustedCallersAttribute> must not perform security-related actions in the type constructor, as the <xref:System.Runtime.Serialization.DataContractSerializer> does not call the constructor of the newly-instantiated object during deserialization.</span></span> <span data-ttu-id="0a5b2-118">Die folgenden allgemeinen Sicherheitstechniken müssen für `[DataContract]`-Typen vermieden werden:</span><span class="sxs-lookup"><span data-stu-id="0a5b2-118">Specifically, the following common security techniques must be avoided for `[DataContract]` types:</span></span>  
  
-   <span data-ttu-id="0a5b2-119">Der Versuch, den teilweise vertrauenswürdigen Zugriff durch Definieren des Konstruktors für den Typ als intern oder privat zu beschränken</span><span class="sxs-lookup"><span data-stu-id="0a5b2-119">Attempting to restrict partial trust access by making the type's constructor internal or private.</span></span>  
  
-   <span data-ttu-id="0a5b2-120">Einschränken des Zugriffs auf den Typ durch Hinzufügen von `[LinkDemand]` zum Konstruktor des Typs</span><span class="sxs-lookup"><span data-stu-id="0a5b2-120">Restricting access to the type by adding a `[LinkDemand]` to the type's constructor.</span></span>  
  
-   <span data-ttu-id="0a5b2-121">Da das Objekt erfolgreich instanziiert wurde, wird davon ausgegangen, dass eventuelle vom Konstruktor erzwungene Validierungsüberprüfungen erfolgreich bestanden wurden.</span><span class="sxs-lookup"><span data-stu-id="0a5b2-121">Assuming that because the object has been successfully instantiated, any validation checks enforced by the constructor have passed successfully.</span></span>  
  
### <a name="using-ixmlserializable"></a><span data-ttu-id="0a5b2-122">Verwenden von IXmlSerializable</span><span class="sxs-lookup"><span data-stu-id="0a5b2-122">Using IXmlSerializable</span></span>  
 <span data-ttu-id="0a5b2-123">Die folgenden empfohlenen Vorgehensweisen gelten für Typen, die <xref:System.Xml.Serialization.IXmlSerializable> implementieren und mit <xref:System.Runtime.Serialization.DataContractSerializer> serialisiert werden:</span><span class="sxs-lookup"><span data-stu-id="0a5b2-123">The following best practices apply for types that implement <xref:System.Xml.Serialization.IXmlSerializable> and are serialized using the <xref:System.Runtime.Serialization.DataContractSerializer>:</span></span>  
  
-   <span data-ttu-id="0a5b2-124">Die statischen <xref:System.Xml.Serialization.IXmlSerializable.GetSchema%2A>-Methodenimplementierungen müssen `public` sein.</span><span class="sxs-lookup"><span data-stu-id="0a5b2-124">The <xref:System.Xml.Serialization.IXmlSerializable.GetSchema%2A> static method implementations must be `public`.</span></span>  
  
-   <span data-ttu-id="0a5b2-125">Die Instanzmethoden, die die <xref:System.Xml.Serialization.IXmlSerializable>-Schnittstelle implementieren, müssen `public` sein.</span><span class="sxs-lookup"><span data-stu-id="0a5b2-125">The instance methods that implement the <xref:System.Xml.Serialization.IXmlSerializable> interface must be `public`.</span></span>  
  
## <a name="using-wcf-from-fully-trusted-platform-code-that-allows-calls-from-partially-trusted-callers"></a><span data-ttu-id="0a5b2-126">Verwenden von WCF aus vollständig vertrauenswürdigem Plattformcode, der Aufrufe teilweise vertrauenswürdiger Aufrufer zulässt</span><span class="sxs-lookup"><span data-stu-id="0a5b2-126">Using WCF from Fully-Trusted Platform Code that Allows Calls from Partially Trusted Callers</span></span>  
 <span data-ttu-id="0a5b2-127">Das teilweise vertrauenswürdige [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]-Sicherheitsmodell geht davon aus, dass jeder Aufrufer einer öffentlichen [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]-Methode oder -Eigenschaft im Codezugriffssicherheits-Kontext (Code Access Security, CAS) der Hostanwendung ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="0a5b2-127">The [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] partial trust security model assumes that any caller of a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] public method or property is running in the code access security (CAS) context of the hosting application.</span></span> [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]<span data-ttu-id="0a5b2-128"> geht weiter davon aus, dass nur ein Anwendungssicherheitskontext für jede <xref:System.AppDomain> vorhanden ist und dass dieser Kontext zum Zeitpunkt der <xref:System.AppDomain>-Erstellung durch einen vertrauenswürdigen Host eingerichtet wird (beispielsweise durch einen Aufruf von <xref:System.AppDomain.CreateDomain%2A> oder des ASP.NET-Anwendungs-Managers).</span><span class="sxs-lookup"><span data-stu-id="0a5b2-128"> also assumes that only one application security context exists for each <xref:System.AppDomain>, and that this context is established at <xref:System.AppDomain> creation time by a trusted host (for example, by a call to <xref:System.AppDomain.CreateDomain%2A> or by the ASP.NET Application Manager).</span></span>  
  
 <span data-ttu-id="0a5b2-129">Dieses Sicherheitsmodell gilt für Anwendungen, die vom Benutzer verfasst wurden und keine zusätzlichen CAS-Berechtigungen gewähren können, wie z.&#160;B. Benutzercode, der in einer ASP.NET-Anwendung mittlerer Vertrauenswürdigkeit ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="0a5b2-129">This security model applies to user-written applications that cannot assert additional CAS permissions, such as user code running in a Medium Trust ASP.NET application.</span></span> <span data-ttu-id="0a5b2-130">Bei vollständig vertrauenswürdigem Plattformcode (beispielsweise eine von Dritten erstellte Assembly, die im globalen Assemblycache installiert wird und Aufrufe von teilweise vertrauenswürdigem Code akzeptiert) ist jedoch eine vorsichtige Vorgehensweise erforderlich, wenn [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] im Auftrag einer teilweise vertrauenswürdigen Anwendung aufgerufen wird, um das Entstehen von Sicherheitsrisiken auf Anwendungsebene zu vermeiden.</span><span class="sxs-lookup"><span data-stu-id="0a5b2-130">However, fully-trusted platform code (for example, a third-party assembly that is installed in the global assembly cache and accepts calls from partially-trusted code) must take explicit care when calling into [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] on behalf of a partially-trusted application to avoid introducing application-level security vulnerabilities.</span></span>  
  
 <span data-ttu-id="0a5b2-131">Vollständig vertrauenswürdiger Code sollte es vermeiden, den CAS-Berechtigungsatz des aktuellen Threads zu verändern (durch Aufrufen von <xref:System.Security.PermissionSet.Assert%2A>, <xref:System.Security.PermissionSet.PermitOnly%2A> oder <xref:System.Security.PermissionSet.Deny%2A>), bevor er [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]-APIs für teilweise vertrauenswürdigen Code aufruft.</span><span class="sxs-lookup"><span data-stu-id="0a5b2-131">Full-trust code should avoid altering the CAS permission set of the current thread (by calling <xref:System.Security.PermissionSet.Assert%2A>, <xref:System.Security.PermissionSet.PermitOnly%2A>, or <xref:System.Security.PermissionSet.Deny%2A>) prior to calling [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] APIs on behalf of partially-trusted code.</span></span> <span data-ttu-id="0a5b2-132">Das Gewähren, Abweisen oder anderweitige Erstellen von threadspezifischem Berechtigungskontext, der unabhängig vom Sicherheitskontext der Anwendungsebene ist, kann zu unerwartetem Verhalten führen.</span><span class="sxs-lookup"><span data-stu-id="0a5b2-132">Asserting, denying, or otherwise creating a thread-specific permission context that is independent of the application-level security context can result in unexpected behavior.</span></span> <span data-ttu-id="0a5b2-133">Je nach Anwendung kann dieses Verhalten zu Sicherheitslücken auf Anwendungsebene führen.</span><span class="sxs-lookup"><span data-stu-id="0a5b2-133">Depending on the application, this behavior may result in application-level security vulnerabilities.</span></span>  
  
 <span data-ttu-id="0a5b2-134">Code, der [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] mithilfe eines threadspezifischen Berechtigungskontexts aufruft, muss auf die Bewältigung der folgenden, möglicherweise eintretenden Situationen vorbereitet werden:</span><span class="sxs-lookup"><span data-stu-id="0a5b2-134">Code that calls into [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] using a thread-specific permission context must be prepared to handle the following situations that may arise:</span></span>  
  
-   <span data-ttu-id="0a5b2-135">Der threadspezifische Sicherheitskontext kann möglicherweise nicht für die Dauer des Vorgangs aufrechterhalten werden, was zu potenziellen Sicherheitsausnahmen führt.</span><span class="sxs-lookup"><span data-stu-id="0a5b2-135">The thread-specific security context may not be maintained for the duration of the operation, which results in potential security exceptions.</span></span>  
  
-   <span data-ttu-id="0a5b2-136">Interner [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]-Code sowie vom Benutzer bereitgestellte Rückrufe können in einem anderen Sicherheitskontext ausgeführt werden als dem, in dem der Aufruf ursprünglich initiiert wurde.</span><span class="sxs-lookup"><span data-stu-id="0a5b2-136">Internal [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] code as well as any user-provided callbacks may run in a different security context than the one under which the call was originally initiated.</span></span> <span data-ttu-id="0a5b2-137">Zu diesen Kontexten gehören:</span><span class="sxs-lookup"><span data-stu-id="0a5b2-137">These contexts include:</span></span>  
  
    -   <span data-ttu-id="0a5b2-138">Der Berechtigungskontext der Anwendung</span><span class="sxs-lookup"><span data-stu-id="0a5b2-138">The application permission context.</span></span>  
  
    -   <span data-ttu-id="0a5b2-139">Threadspezifischer Berechtigungskontext, der zuvor von anderen Benutzerthreads verwendet wurde, um [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] während der Lebensdauer der aktuell ausführenden <xref:System.AppDomain> aufzurufen</span><span class="sxs-lookup"><span data-stu-id="0a5b2-139">Any thread-specific permission context previously created by other user threads used to call into [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] during the lifetime of the currently running <xref:System.AppDomain>.</span></span>  
  
 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]<span data-ttu-id="0a5b2-140"> stellt sicher, dass teilweise vertrauenswürdiger Code voll vertrauenswürdige Berechtigungen nur dann erhalten kann, wenn die Berechtigungen vor dem Aufrufen der öffentlichen [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]-APIs von einer voll vertrauenswürdigen Komponente gewährt werden.</span><span class="sxs-lookup"><span data-stu-id="0a5b2-140"> guarantees that partially-trusted code cannot obtain full-trust permissions unless such permissions are asserted by a fully-trusted component prior to calling into [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] public APIs.</span></span> <span data-ttu-id="0a5b2-141">Jedoch besteht dabei nicht die Garantie, dass die Gewährung voller Vertrauenswürdigkeit auf einen bestimmten Thread, Vorgang oder eine bestimmte Benutzeraktion beschränkt ist.</span><span class="sxs-lookup"><span data-stu-id="0a5b2-141">However, it does not guarantee that the effects of asserting full trust is isolated to a particular thread, operation, or user action.</span></span>  
  
 <span data-ttu-id="0a5b2-142">Es empfiehlt sich daher, die Erstellung von threadspezifischem Berechtigungskontext durch Aufrufen von <xref:System.Security.PermissionSet.Assert%2A>, <xref:System.Security.PermissionSet.PermitOnly%2A> oder <xref:System.Security.PermissionSet.Deny%2A> zu vermeiden.</span><span class="sxs-lookup"><span data-stu-id="0a5b2-142">As a best practice, avoid creating thread-specific permission context by calling <xref:System.Security.PermissionSet.Assert%2A>, <xref:System.Security.PermissionSet.PermitOnly%2A>, or <xref:System.Security.PermissionSet.Deny%2A>.</span></span> <span data-ttu-id="0a5b2-143">Gewähren oder verweigern Sie stattdessen der Anwendung selbst die Berechtigung, damit <xref:System.Security.PermissionSet.Assert%2A>, <xref:System.Security.PermissionSet.Deny%2A> oder <xref:System.Security.PermissionSet.PermitOnly%2A> nicht erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="0a5b2-143">Instead, grant or deny the privilege to the application itself, so that no <xref:System.Security.PermissionSet.Assert%2A>, <xref:System.Security.PermissionSet.Deny%2A>, or <xref:System.Security.PermissionSet.PermitOnly%2A> is required.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="0a5b2-144">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="0a5b2-144">See Also</span></span>  
 <xref:System.Runtime.Serialization.DataContractSerializer>  
 <xref:System.Xml.Serialization.IXmlSerializable>
