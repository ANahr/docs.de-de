---
title: Verwenden von Zertifikaten
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- certificates [WCF]
ms.assetid: 6ffb8682-8f07-4a45-afbb-8d2487e9dbc3
ms.openlocfilehash: 62bf3ce4bc7a0ff8109ec34fba77dd854c7679b8
ms.sourcegitcommit: 3540f614fc94f77ca4ab58df66db2d0f4d52dfee
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 06/01/2018
ms.locfileid: "34697117"
---
# <a name="working-with-certificates"></a><span data-ttu-id="706d1-102">Verwenden von Zertifikaten</span><span class="sxs-lookup"><span data-stu-id="706d1-102">Working with Certificates</span></span>
<span data-ttu-id="706d1-103">Um die Sicherheit von Windows Communication Foundation (WCF) zu programmieren, werden digitale x. 509-Zertifikate häufig zum Authentifizieren von Clients und Servern, verschlüsseln und digitalen Signieren von Nachrichten verwendet.</span><span class="sxs-lookup"><span data-stu-id="706d1-103">To program Windows Communication Foundation (WCF) security, X.509 digital certificates are commonly used to authenticate clients and servers, encrypt, and digitally sign messages.</span></span> <span data-ttu-id="706d1-104">In diesem Thema wird erläutert, x. 509-Zertifikat-Features und Ihre Verwendung in WCF kurz und enthält Links zu Themen, die diese Konzepte näher erläutern oder die Ausführung allgemeiner Aufgaben mithilfe von WCF und Zertifikate.</span><span class="sxs-lookup"><span data-stu-id="706d1-104">This topic briefly explains X.509 digital certificate features and how to use them in WCF, and includes links to topics that explain these concepts further or that show how to accomplish common tasks using WCF and certificates.</span></span>  
  
 <span data-ttu-id="706d1-105">Kurz gesagt, ein digitales Zertifikat ist ein Teil einer *public Key-Infrastruktur* (PKI), dabei handelt es sich um ein System aus digitalen Zertifikaten, Zertifizierungsstellen und anderen Registrierungsstellen, die Überprüfung und Authentifizierung die Gültigkeit beteiligten Parteien in einer elektronischen Transaktion unter Verwendung der Kryptografie mit öffentlichem Schlüssel.</span><span class="sxs-lookup"><span data-stu-id="706d1-105">In brief, a digital certificate is a part of a *public key infrastructure* (PKI), which is a system of digital certificates, certificate authorities, and other registration authorities that verify and authenticate the validity of each party involved in an electronic transaction through the use of public key cryptography.</span></span> <span data-ttu-id="706d1-106">Eine Zertifizierungsstelle Zertifikate ausstellt, und jedes Zertifikat enthält einen Satz von Feldern, die Daten, z. B. enthalten *Betreff* (die Entität für die das Zertifikat ausgestellt wird), Gültigkeitsdatum (wenn das Zertifikat gültig ist), Aussteller (die Entität, die das Zertifikat ausgestellt wurde), und einem öffentlichen Schlüssel.</span><span class="sxs-lookup"><span data-stu-id="706d1-106">A certification authority issues certificates and each certificate has a set of fields that contain data, such as *subject* (the entity to which the certificate is issued), validity dates (when the certificate is valid), issuer (the entity that issued the certificate), and a public key.</span></span> <span data-ttu-id="706d1-107">In WCF ist jede dieser Eigenschaften als verarbeitet eine <xref:System.IdentityModel.Claims.Claim>, und jeder Anspruch wird weiter in zwei Typen unterteilt: Identität und Recht.</span><span class="sxs-lookup"><span data-stu-id="706d1-107">In WCF, each of these properties is processed as a <xref:System.IdentityModel.Claims.Claim>, and each claim is further divided into two types: identity and right.</span></span> <span data-ttu-id="706d1-108">Weitere Informationen zum x. 509-Zertifikate, finden Sie unter [x. 509-Zertifikate für öffentliche Schlüssel](http://go.microsoft.com/fwlink/?LinkId=209952).</span><span class="sxs-lookup"><span data-stu-id="706d1-108">For more information about X.509 certificates see [X.509 Public Key Certificates](http://go.microsoft.com/fwlink/?LinkId=209952).</span></span> <span data-ttu-id="706d1-109">Weitere Informationen zu Ansprüchen und Autorisierung in WCF finden Sie unter [Verwalten von Ansprüchen und Autorisierung mit dem Identitätsmodell](../../../../docs/framework/wcf/feature-details/managing-claims-and-authorization-with-the-identity-model.md).</span><span class="sxs-lookup"><span data-stu-id="706d1-109">For more information about Claims and Authorization in WCF see [Managing Claims and Authorization with the Identity Model](../../../../docs/framework/wcf/feature-details/managing-claims-and-authorization-with-the-identity-model.md).</span></span> <span data-ttu-id="706d1-110">Weitere Informationen zur Implementierung einer PKI finden Sie unter [Windows Server 2008 R2 - Zertifikatdienste](http://go.microsoft.com/fwlink/?LinkId=209949).</span><span class="sxs-lookup"><span data-stu-id="706d1-110">For more information about implementing a PKI, see [Windows Server 2008 R2 - Certificate Services](http://go.microsoft.com/fwlink/?LinkId=209949).</span></span>  
  
 <span data-ttu-id="706d1-111">Die primäre Funktion eines Zertifikats wird zum Authentifizieren der Identität des Besitzers des Zertifikats gegenüber anderen.</span><span class="sxs-lookup"><span data-stu-id="706d1-111">The primary function of a certificate is to authenticate the identity of the owner of the certificate to others.</span></span> <span data-ttu-id="706d1-112">Ein Zertifikat enthält die *öffentlichen Schlüssel* des Besitzers, während der Besitzer den privaten Schlüssel behält.</span><span class="sxs-lookup"><span data-stu-id="706d1-112">A certificate contains the *public key* of the owner, while the owner retains the private key.</span></span> <span data-ttu-id="706d1-113">Der öffentliche Schlüssel kann zum Verschlüsseln von Nachrichten verwendet werden, die an den Besitzer des Zertifikats gesendet werden.</span><span class="sxs-lookup"><span data-stu-id="706d1-113">The public key can be used to encrypt messages sent to the owner of the certificate.</span></span> <span data-ttu-id="706d1-114">Nur der Besitzer hat Zugriff auf den privaten Schlüssel, sodass niemand anders diese Nachrichten entschlüsseln kann.</span><span class="sxs-lookup"><span data-stu-id="706d1-114">Only the owner has access to the private key, so only the owner can decrypt those messages.</span></span>  
  
 <span data-ttu-id="706d1-115">Zertifikate müssen von einer Zertifizierungsstelle ausgestellt werden, bei der es sich oft um einen Drittanbieter-Zertifikataussteller handelt.</span><span class="sxs-lookup"><span data-stu-id="706d1-115">Certificates must be issued by a certification authority, which is often a third-party  issuer of certificates.</span></span> <span data-ttu-id="706d1-116">Windows-Domänen verfügen über eine Zertifizierungsstelle, von der Zertifikate für Computer in der Domäne ausgestellt werden können.</span><span class="sxs-lookup"><span data-stu-id="706d1-116">On a Windows domain, a certification authority is included that can be used to issue certificates to computers on the domain.</span></span>  
  
## <a name="viewing-certificates"></a><span data-ttu-id="706d1-117">Anzeigen von Zertifikaten</span><span class="sxs-lookup"><span data-stu-id="706d1-117">Viewing Certificates</span></span>  
 <span data-ttu-id="706d1-118">Bei der Verwendung von Zertifikaten ist es oft erforderlich, die Zertifikate anzuzeigen und ihre Eigenschaften zu überprüfen.</span><span class="sxs-lookup"><span data-stu-id="706d1-118">To work with certificates, it is often necessary to view them and examine their properties.</span></span> <span data-ttu-id="706d1-119">Die einfachste Methode dazu ist das MMC (Microsoft Management Console)-Snap-In-Tool.</span><span class="sxs-lookup"><span data-stu-id="706d1-119">This is easily done with the Microsoft Management Console (MMC) snap-in tool.</span></span> <span data-ttu-id="706d1-120">Weitere Informationen finden Sie unter [Vorgehensweise: Anzeigen von Zertifikaten mit dem MMC-Snap-in](../../../../docs/framework/wcf/feature-details/how-to-view-certificates-with-the-mmc-snap-in.md).</span><span class="sxs-lookup"><span data-stu-id="706d1-120">For more information, see [How to: View Certificates with the MMC Snap-in](../../../../docs/framework/wcf/feature-details/how-to-view-certificates-with-the-mmc-snap-in.md).</span></span>  
  
## <a name="certificate-stores"></a><span data-ttu-id="706d1-121">Zertifikatspeicher</span><span class="sxs-lookup"><span data-stu-id="706d1-121">Certificate Stores</span></span>  
 <span data-ttu-id="706d1-122">Zertifikate werden in Speichern abgelegt.</span><span class="sxs-lookup"><span data-stu-id="706d1-122">Certificates are found in stores.</span></span> <span data-ttu-id="706d1-123">Die zwei Hauptspeicherorte sind in weitere Unterspeicher unterteilt.</span><span class="sxs-lookup"><span data-stu-id="706d1-123">Two major store locations exist that are further divided into sub-stores.</span></span> <span data-ttu-id="706d1-124">Administratoren können beide Hauptspeicher mit dem MMC-Snap-In-Tool anzeigen.</span><span class="sxs-lookup"><span data-stu-id="706d1-124">If you are the administrator on a computer, you can view both major stores by using the MMC snap-in tool.</span></span> <span data-ttu-id="706d1-125">Alle anderen Benutzer können lediglich den Speicher des aktuellen Benutzers anzeigen.</span><span class="sxs-lookup"><span data-stu-id="706d1-125">Non-administrators can view only the current user store.</span></span>  
  
-   <span data-ttu-id="706d1-126">**Im lokalen Computerspeicher**.</span><span class="sxs-lookup"><span data-stu-id="706d1-126">**The local machine store**.</span></span> <span data-ttu-id="706d1-127">Dieser enthält die Zertifikate, die von den Prozessen des Computers verwendet werden, z. B. [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)].</span><span class="sxs-lookup"><span data-stu-id="706d1-127">This contains the certificates accessed by machine processes, such as [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)].</span></span> <span data-ttu-id="706d1-128">Speichern Sie die Zertifikate zur Authentifizierung des Servers gegenüber Clients im lokalen Computerspeicher.</span><span class="sxs-lookup"><span data-stu-id="706d1-128">Use this location to store certificates that authenticate the server to clients.</span></span>  
  
-   <span data-ttu-id="706d1-129">**Speicher des aktuellen Benutzers**.</span><span class="sxs-lookup"><span data-stu-id="706d1-129">**The current user store**.</span></span> <span data-ttu-id="706d1-130">Interaktive Anwendungen legen Zertifikate für den aktuellen Benutzer des Computers normalerweise im aktuellen Benutzerspeicher ab.</span><span class="sxs-lookup"><span data-stu-id="706d1-130">Interactive applications typically place certificates here for the computer's current user.</span></span> <span data-ttu-id="706d1-131">Beim Erstellen einer Clientanwendung werden die Zertifikate zur Authentifizierung eines Benutzers gegenüber einem Dienst normalerweise hier abgelegt.</span><span class="sxs-lookup"><span data-stu-id="706d1-131">If you are creating a client application, this is where you typically place certificates that authenticate a user to a service.</span></span>  
  
 <span data-ttu-id="706d1-132">Diese beiden Speicher teilen sich in weitere Unterspeicher auf.</span><span class="sxs-lookup"><span data-stu-id="706d1-132">These two stores are further divided into sub-stores.</span></span> <span data-ttu-id="706d1-133">Der wichtigste bei der Programmierung mit WCF enthalten:</span><span class="sxs-lookup"><span data-stu-id="706d1-133">The most important of these when programming with WCF include:</span></span>  
  
-   <span data-ttu-id="706d1-134">**Vertrauenswürdige Stammzertifizierungsstellen**.</span><span class="sxs-lookup"><span data-stu-id="706d1-134">**Trusted Root Certification Authorities**.</span></span> <span data-ttu-id="706d1-135">Mit den Zertifikaten in diesem Speicher können Sie eine Zertifikatkette erstellen, die zum Zertifikat einer Zertifizierungsstelle in diesem Speicher zurückverfolgt werden kann.</span><span class="sxs-lookup"><span data-stu-id="706d1-135">You can use the certificates in this store to create a chain of certificates, which can be traced back to a certification authority certificate in this store.</span></span>  
  
    > [!IMPORTANT]
    >  <span data-ttu-id="706d1-136">Der lokale Computer stuft alle Zertifikate in diesem Speicher als implizit vertrauenswürdig ein; dies gilt auch, wenn das Zertifikat im Speicher nicht von einer vertrauenswürdigen Zertifizierungsstelle eines Drittanbieters stammt.</span><span class="sxs-lookup"><span data-stu-id="706d1-136">The local computer implicitly trusts any certificate placed in this store, even if the certificate does not come from a trusted third-party certification authority.</span></span> <span data-ttu-id="706d1-137">Aus diesem Grund sollten Sie in diesem Speicher nur Zertifikate ablegen, wenn Sie dem Aussteller uneingeschränkt vertrauen und sich der möglichen Folgen bewusst sind.</span><span class="sxs-lookup"><span data-stu-id="706d1-137">For this reason, do not place any certificate into this store unless you fully trust the issuer and understand the consequences.</span></span>  
  
-   <span data-ttu-id="706d1-138">**Persönliche**.</span><span class="sxs-lookup"><span data-stu-id="706d1-138">**Personal**.</span></span> <span data-ttu-id="706d1-139">Dieser Speicher wird für Zertifikate verwendet, die dem Benutzer eines Computers zugeordnet sind.</span><span class="sxs-lookup"><span data-stu-id="706d1-139">This store is used for certificates associated with a user of a computer.</span></span> <span data-ttu-id="706d1-140">Dieser Speicher wird normalerweise für Zertifikate verwendet, die von einem der Zertifikate der Zertifizierungsstelle im Speicher vertrauenswürdiger Stammzertifizierungsstellen stammen.</span><span class="sxs-lookup"><span data-stu-id="706d1-140">Typically this store is used for certificates issued by one of the certification authority certificates found in the Trusted Root Certification Authorities store.</span></span> <span data-ttu-id="706d1-141">Darüber hinaus können in diesem Speicher auch selbst ausgestellte Zertifikate abgelegt werden, die von einer Anwendung als vertrauenswürdig eingestuft werden.</span><span class="sxs-lookup"><span data-stu-id="706d1-141">Alternatively, a certificate found here may be self-issued and trusted by an application.</span></span>  
  
 <span data-ttu-id="706d1-142">Weitere Informationen zu Zertifikatsspeichern finden Sie unter [Zertifikatspeichern](http://go.microsoft.com/fwlink/?LinkId=88912).</span><span class="sxs-lookup"><span data-stu-id="706d1-142">For more information about certificate stores, see [Certificate Stores](http://go.microsoft.com/fwlink/?LinkId=88912).</span></span>  
  
### <a name="selecting-a-store"></a><span data-ttu-id="706d1-143">Auswählen eines Speichers</span><span class="sxs-lookup"><span data-stu-id="706d1-143">Selecting a Store</span></span>  
 <span data-ttu-id="706d1-144">Die Auswahl des Speichers für ein Zertifikat hängt davon ab, wie und wann der Dienst oder Client ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="706d1-144">Selecting where to store a certificate depends how and when the service or client runs.</span></span> <span data-ttu-id="706d1-145">Dabei gelten folgende allgemeine Regeln:</span><span class="sxs-lookup"><span data-stu-id="706d1-145">The following general rules apply:</span></span>  
  
-   <span data-ttu-id="706d1-146">Wenn der WCF-Dienst, in einem Windows-Dienst verwenden gehostet wird das **lokalen** speichern.</span><span class="sxs-lookup"><span data-stu-id="706d1-146">If the WCF service is hosted in a Windows service use the **local machine** store.</span></span> <span data-ttu-id="706d1-147">Sie benötigen Administratorrechte, wenn Sie Zertifikate im lokalen Computerspeicher installieren möchten.</span><span class="sxs-lookup"><span data-stu-id="706d1-147">Note that administrator privileges are required to install certificates into the local machine store.</span></span>  
  
-   <span data-ttu-id="706d1-148">Wenn Sie den Dienst oder Client eine Anwendung, die unter einem Benutzerkonto ausgeführt wird ist, verwenden Sie die **Aktueller Benutzer** zu speichern.</span><span class="sxs-lookup"><span data-stu-id="706d1-148">If the service or client is an application that runs under a user account, then use the **current user** store.</span></span>  
  
### <a name="accessing-stores"></a><span data-ttu-id="706d1-149">Zugreifen auf Speicher</span><span class="sxs-lookup"><span data-stu-id="706d1-149">Accessing Stores</span></span>  
 <span data-ttu-id="706d1-150">Speicher werden analog zu Ordnern auf einem Computer durch Zugriffssteuerungslisten (ACLs) geschützt.</span><span class="sxs-lookup"><span data-stu-id="706d1-150">Stores are protected by access control lists (ACLs), just like folders on a computer.</span></span> <span data-ttu-id="706d1-151">Beim Erstellen eines Diensts, der von Internet Information Services (IIS) gehostet wird, wird der [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)]-Prozess unter dem [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)]-Konto ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="706d1-151">When creating a service hosted by Internet Information Services (IIS), the [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] process runs under the [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] account.</span></span> <span data-ttu-id="706d1-152">Dieses Konto muss über Zugriff auf den Speicher mit den Zertifikaten verfügen, die von einem Dienst verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="706d1-152">That account must have access to the store that contains the certificates a service uses.</span></span> <span data-ttu-id="706d1-153">Die zentralen Speicher werden durch eine Standardzugriffssteuerungsliste geschützt, eine Änderung der Listen ist jedoch möglich.</span><span class="sxs-lookup"><span data-stu-id="706d1-153">Each of the major stores is protected with a default access list, but the lists can be modified.</span></span> <span data-ttu-id="706d1-154">Wenn Sie eine separate Rolle für den Speicherzugriff erstellen, muss diese über die entsprechende Zugriffsberechtigung verfügen.</span><span class="sxs-lookup"><span data-stu-id="706d1-154">If you create a separate role to access a store, you must grant that role access permission.</span></span> <span data-ttu-id="706d1-155">Informationen zum Ändern der mit dem Tool WinHttpCertConfig.exe Publication Access List, finden Sie unter [Vorgehensweise: Erstellen von temporären Zertifikaten für die Verwendung während der Entwicklung](../../../../docs/framework/wcf/feature-details/how-to-create-temporary-certificates-for-use-during-development.md).</span><span class="sxs-lookup"><span data-stu-id="706d1-155">To learn how to modify the access list using the WinHttpCertConfig.exe tool, see [How to: Create Temporary Certificates for Use During Development](../../../../docs/framework/wcf/feature-details/how-to-create-temporary-certificates-for-use-during-development.md).</span></span> <span data-ttu-id="706d1-156">Weitere Informationen zur Verwendung von Clientzertifikaten in IIS finden Sie unter [wie einen Webdienst aufgerufen wird, werden mithilfe von Clientzertifikaten für die Authentifizierung in einer ASP.NET-Webanwendung](http://go.microsoft.com/fwlink/?LinkId=88914).</span><span class="sxs-lookup"><span data-stu-id="706d1-156">For more information about using client certificates with IIS, see [How to call a Web service by using a client certificate for authentication in an ASP.NET Web application](http://go.microsoft.com/fwlink/?LinkId=88914).</span></span>  
  
## <a name="chain-trust-and-certificate-authorities"></a><span data-ttu-id="706d1-157">Vertrauensketten und Zertifizierungsstellen</span><span class="sxs-lookup"><span data-stu-id="706d1-157">Chain Trust and Certificate Authorities</span></span>  
 <span data-ttu-id="706d1-158">Zertifikate werden in einer Hierarchie erstellt, in der jedes einzelne Zertifikat mit der Zertifizierungsstelle verknüpft ist, von der es ausgestellt wurde.</span><span class="sxs-lookup"><span data-stu-id="706d1-158">Certificates are created in a hierarchy where each individual certificate is linked to the CA that issued the certificate.</span></span> <span data-ttu-id="706d1-159">Dieser Link verweist auf das Zertifikat der Zertifizierungsstelle.</span><span class="sxs-lookup"><span data-stu-id="706d1-159">This link is to the CA’s certificate.</span></span> <span data-ttu-id="706d1-160">Das Zertifikat der Zertifizierungsstelle wird dann mit der Zertifizierungsstelle verknüpft, von der das ursprüngliche Zertifikat der Zertifizierungsstelle ausgestellt wurde.</span><span class="sxs-lookup"><span data-stu-id="706d1-160">The CA’s certificate then links to the CA that issued the orginal CA’s certificate.</span></span> <span data-ttu-id="706d1-161">Dieser Prozess wird wiederholt, bis das Zertifikat der Stammzertifizierungsstelle erreicht wird.</span><span class="sxs-lookup"><span data-stu-id="706d1-161">This process is repeated up until the Root CA’s certificate is reached.</span></span> <span data-ttu-id="706d1-162">Das Zertifikat der Stammzertifizierungsstelle ist grundsätzlich vertrauenswürdig.</span><span class="sxs-lookup"><span data-stu-id="706d1-162">The Root CA’s certificate is inherently trusted.</span></span>  
  
 <span data-ttu-id="706d1-163">Digitale Zertifikate werden verwendet, um eine Entität zu authentifizieren, indem Sie auf diese Hierarchie, die so genannte eine *Vertrauenskette*.</span><span class="sxs-lookup"><span data-stu-id="706d1-163">Digital certificates are used to authenticate an entity by relying on this hierarchy, also called a *chain of trust*.</span></span> <span data-ttu-id="706d1-164">Sie können die Kette eines beliebigen Zertifikats, die über das MMC-Snap-in, indem auf das Zertifikat doppelklicken und anschließend auf Anzeigen der **Zertifikatpfad** Registerkarte. Weitere Informationen zum Importieren von Zertifikatketten für eine Zertifizierungsstelle finden Sie unter [Vorgehensweise: Geben Sie das Zertifikat Autorität Zertifikatkette zum Überprüfen von Signaturen](../../../../docs/framework/wcf/feature-details/specify-the-certificate-authority-chain-verify-signatures-wcf.md).</span><span class="sxs-lookup"><span data-stu-id="706d1-164">You can view any certificate's chain using the MMC snap-in by double-clicking any certificate, then clicking the **Certificate Path** tab. For more information about importing certificate chains for a Certification authority, see [How to: Specify the Certificate Authority Certificate Chain Used to Verify Signatures](../../../../docs/framework/wcf/feature-details/specify-the-certificate-authority-chain-verify-signatures-wcf.md).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="706d1-165">Sie können jeden Aussteller zu einer vertrauenswürdigen Stammzertifizierungsstelle machen, indem Sie das Zertifikat des Ausstellers im Zertifikatspeicher der Stammzertifizierungsstelle ablegen.</span><span class="sxs-lookup"><span data-stu-id="706d1-165">Any issuer can be designated a trusted root authority by placing the issuer's certificate in the trusted root authority certificate store.</span></span>  
  
### <a name="disabling-chain-trust"></a><span data-ttu-id="706d1-166">Deaktivieren von Vertrauensketten</span><span class="sxs-lookup"><span data-stu-id="706d1-166">Disabling Chain Trust</span></span>  
 <span data-ttu-id="706d1-167">Wenn Sie einen neuen Dienst erstellen, verwenden Sie möglicherweise ein Zertifikat, das nicht von einer vertrauenswürdigen Stammzertifizierungsstelle ausgegeben wurde, oder das ausstellende Zertifikat befindet sich nicht im Speicher vertrauenswürdiger Stammzertifizierungsstellen.</span><span class="sxs-lookup"><span data-stu-id="706d1-167">When creating a new service, you may be using a certificate that is not issued by a trusted root certificate, or the issuing certificate itself may not be in the Trusted Root Certification Authorities store.</span></span> <span data-ttu-id="706d1-168">Sie können die Überprüfung der Kette von Vertrauensstellungen für ein Zertifikat in Entwicklungsumgebungen vorübergehend deaktivieren.</span><span class="sxs-lookup"><span data-stu-id="706d1-168">For development purposes only, you can temporarily disable the mechanism that checks the chain of trust for a certificate.</span></span> <span data-ttu-id="706d1-169">Legen Sie dazu die `CertificateValidationMode`-Eigenschaft auf entweder `PeerTrust` oder `PeerOrChainTrust` fest.</span><span class="sxs-lookup"><span data-stu-id="706d1-169">To do this, set the `CertificateValidationMode` property to either `PeerTrust` or `PeerOrChainTrust`.</span></span> <span data-ttu-id="706d1-170">Durch den jeweiligen Modus wird angegeben, dass das Zertifikat entweder selbst ausgegeben (Peervertrauenszertifikat) oder Teil einer Kette von Vertrauensstellungen ist.</span><span class="sxs-lookup"><span data-stu-id="706d1-170">Either mode specifies that the certificate can either be self-issued (peer trust) or part of a chain of trust.</span></span> <span data-ttu-id="706d1-171">Die Eigenschaft kann auf eine der folgenden Klassen festgelegt werden:</span><span class="sxs-lookup"><span data-stu-id="706d1-171">You can set the property on any of the following classes.</span></span>  
  
|<span data-ttu-id="706d1-172">Klasse</span><span class="sxs-lookup"><span data-stu-id="706d1-172">Class</span></span>|<span data-ttu-id="706d1-173">Eigenschaft</span><span class="sxs-lookup"><span data-stu-id="706d1-173">Property</span></span>|  
|-----------|--------------|  
|<xref:System.ServiceModel.Security.X509ClientCertificateAuthentication>|<xref:System.ServiceModel.Security.X509ClientCertificateAuthentication.CertificateValidationMode%2A?displayProperty=nameWithType>|  
|<xref:System.ServiceModel.Security.X509PeerCertificateAuthentication>|<xref:System.ServiceModel.Security.X509PeerCertificateAuthentication.CertificateValidationMode%2A?displayProperty=nameWithType>|  
|<xref:System.ServiceModel.Security.X509ServiceCertificateAuthentication>|<xref:System.ServiceModel.Security.X509ServiceCertificateAuthentication.CertificateValidationMode%2A?displayProperty=nameWithType>|  
|<xref:System.ServiceModel.Security.IssuedTokenServiceCredential>|<xref:System.ServiceModel.Security.IssuedTokenServiceCredential.CertificateValidationMode%2A?displayProperty=nameWithType>|  
  
 <span data-ttu-id="706d1-174">Sie können die Eigenschaft auch in der Konfiguration festlegen.</span><span class="sxs-lookup"><span data-stu-id="706d1-174">You can also set the property using configuration.</span></span> <span data-ttu-id="706d1-175">Folgende Elemente werden verwendet, um den Validierungsmodus anzugeben:</span><span class="sxs-lookup"><span data-stu-id="706d1-175">The following elements are used to specify the validation mode:</span></span>  
  
-   [<span data-ttu-id="706d1-176">\<Authentifizierung ></span><span class="sxs-lookup"><span data-stu-id="706d1-176">\<authentication></span></span>](../../../../docs/framework/configure-apps/file-schema/wcf/authentication-of-servicecertificate-element.md)  
  
-   [<span data-ttu-id="706d1-177">\<peerAuthentication></span><span class="sxs-lookup"><span data-stu-id="706d1-177">\<peerAuthentication></span></span>](../../../../docs/framework/configure-apps/file-schema/wcf/peerauthentication-element.md)  
  
-   [<span data-ttu-id="706d1-178">\<messageSenderAuthentication></span><span class="sxs-lookup"><span data-stu-id="706d1-178">\<messageSenderAuthentication></span></span>](../../../../docs/framework/configure-apps/file-schema/wcf/messagesenderauthentication-element.md)  
  
## <a name="custom-authentication"></a><span data-ttu-id="706d1-179">Benutzerdefinierte Authentifizierung</span><span class="sxs-lookup"><span data-stu-id="706d1-179">Custom Authentication</span></span>  
 <span data-ttu-id="706d1-180">Die `CertificateValidationMode`-Eigenschaft ermöglicht es auch, die Authentifizierung von Zertifikaten anzupassen.</span><span class="sxs-lookup"><span data-stu-id="706d1-180">The `CertificateValidationMode` property also enables you to customize how certificates are authenticated.</span></span> <span data-ttu-id="706d1-181">Die Standardvertrauensebene ist `ChainTrust`.</span><span class="sxs-lookup"><span data-stu-id="706d1-181">By default, the level is set to `ChainTrust`.</span></span> <span data-ttu-id="706d1-182">Wenn Sie den <xref:System.ServiceModel.Security.X509CertificateValidationMode.Custom>-Wert verwenden möchten, müssen Sie auch das `CustomCertificateValidatorType`-Attribut auf eine Assembly und einen Typ festlegen, die zur Validierung des Zertifikats verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="706d1-182">To use the <xref:System.ServiceModel.Security.X509CertificateValidationMode.Custom> value, you must also set the `CustomCertificateValidatorType` attribute to an assembly and type used to validate the certificate.</span></span> <span data-ttu-id="706d1-183">Wenn Sie eine benutzerdefinierte Überprüfung erstellen möchten, müssen Sie die abstrakte <xref:System.IdentityModel.Selectors.X509CertificateValidator>-Klasse vererben.</span><span class="sxs-lookup"><span data-stu-id="706d1-183">To create a custom validator, you must inherit from the abstract <xref:System.IdentityModel.Selectors.X509CertificateValidator> class.</span></span>  
  
 <span data-ttu-id="706d1-184">Wenn Sie eine benutzerdefinierte Authentifizierung erstellen, müssen Sie auf jeden Fall die <xref:System.IdentityModel.Selectors.X509CertificateValidator.Validate%2A>-Methode überschreiben.</span><span class="sxs-lookup"><span data-stu-id="706d1-184">When creating a custom authenticator, the most important method to override is the <xref:System.IdentityModel.Selectors.X509CertificateValidator.Validate%2A> method.</span></span> <span data-ttu-id="706d1-185">Ein Beispiel der benutzerdefinierten Authentifizierung finden Sie unter der [x. 509-Zertifikats-Validierungssteuerelement](../../../../docs/framework/wcf/samples/x-509-certificate-validator.md) Beispiel.</span><span class="sxs-lookup"><span data-stu-id="706d1-185">For an example of custom authentication, see the [X.509 Certificate Validator](../../../../docs/framework/wcf/samples/x-509-certificate-validator.md) sample.</span></span> <span data-ttu-id="706d1-186">Weitere Informationen finden Sie unter [benutzerdefinierte Anmeldeinformationen und Validierung der Anmeldeinformationen](../../../../docs/framework/wcf/extending/custom-credential-and-credential-validation.md).</span><span class="sxs-lookup"><span data-stu-id="706d1-186">For more information, see [Custom Credential and Credential Validation](../../../../docs/framework/wcf/extending/custom-credential-and-credential-validation.md).</span></span>  
  
## <a name="using-makecertexe-to-build-a-certificate-chain"></a><span data-ttu-id="706d1-187">Verwenden von Makecert.exe zum Erstellen einer Zertifikatkette</span><span class="sxs-lookup"><span data-stu-id="706d1-187">Using Makecert.exe to Build a Certificate Chain</span></span>  
 <span data-ttu-id="706d1-188">Mit dem Certificate Creation-Tool (Makecert.exe) werden X.509-Zertifikate sowie Paare aus privaten und öffentlichen Schlüsseln erstellt.</span><span class="sxs-lookup"><span data-stu-id="706d1-188">The Certificate Creation Tool (Makecert.exe) creates X.509 certificates and private key/public key pairs.</span></span> <span data-ttu-id="706d1-189">Sie können den privaten Schlüssel speichern und zum Ausstellen und Signieren neuer Zertifikate verwenden, um eine Hierarchie von Zertifikaten in einer Kette zu simulieren.</span><span class="sxs-lookup"><span data-stu-id="706d1-189">You can save the private key to disk and then use it to issue and sign new certificates, thus simulating a hierarchy of chained certificates.</span></span> <span data-ttu-id="706d1-190">Dieses Tool ist lediglich als Unterstützung bei der Entwicklung von Diensten gedacht und sollte niemals zur Erstellung von Zertifikaten für tatsächliche Bereitstellungen verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="706d1-190">The tool is intended for use only as an aid when developing services and should never be used to create certificates for actual deployment.</span></span> <span data-ttu-id="706d1-191">Wenn Sie einen WCF-Dienst zu entwickeln, gehen Sie folgendermaßen vor, um eine Kette von Vertrauensstellungen mit Makecert.exe erstellen.</span><span class="sxs-lookup"><span data-stu-id="706d1-191">When developing an WCF service, use the following steps to build a chain of trust with Makecert.exe.</span></span>  
  
#### <a name="to-build-a-chain-of-trust-with-makecertexe"></a><span data-ttu-id="706d1-192">So erstellen Sie eine Kette von Vertrauensstellungen mit Makecert.exe</span><span class="sxs-lookup"><span data-stu-id="706d1-192">To build a chain of trust with Makecert.exe</span></span>  
  
1.  <span data-ttu-id="706d1-193">Erstellen Sie ein (selbst signiertes) temporäres Zertifikat für eine Stammzertifizierungsstelle mit MakeCert.exe.</span><span class="sxs-lookup"><span data-stu-id="706d1-193">Create a temporary root authority (self-signed) certificate using the MakeCert.exe tool.</span></span> <span data-ttu-id="706d1-194">Speichern Sie den privaten Schlüssel.</span><span class="sxs-lookup"><span data-stu-id="706d1-194">Save the private key to the disk.</span></span>  
  
2.  <span data-ttu-id="706d1-195">Verwenden Sie das neue Zertifikat, um ein anderes Zertifikat auszustellen, das den öffentlichen Schlüssel enthält.</span><span class="sxs-lookup"><span data-stu-id="706d1-195">Use the new certificate to issue another certificate that contains the public key.</span></span>  
  
3.  <span data-ttu-id="706d1-196">Importieren Sie das Zertifikat der Stammzertifizierungsstelle in den Speicher vertrauenswürdiger Stammzertifizierungsstellen.</span><span class="sxs-lookup"><span data-stu-id="706d1-196">Import the root authority certificate into the Trusted Root Certification Authorities store.</span></span>  
  
4.  <span data-ttu-id="706d1-197">Schrittweise Anweisungen finden Sie unter [Vorgehensweise: Erstellen von temporären Zertifikaten für die Verwendung während der Entwicklung](../../../../docs/framework/wcf/feature-details/how-to-create-temporary-certificates-for-use-during-development.md).</span><span class="sxs-lookup"><span data-stu-id="706d1-197">For step-by-step instructions, see [How to: Create Temporary Certificates for Use During Development](../../../../docs/framework/wcf/feature-details/how-to-create-temporary-certificates-for-use-during-development.md).</span></span>  
  
## <a name="which-certificate-to-use"></a><span data-ttu-id="706d1-198">Welches Zertifikat soll verwendet werden?</span><span class="sxs-lookup"><span data-stu-id="706d1-198">Which Certificate to Use?</span></span>  
 <span data-ttu-id="706d1-199">Im Zusammenhang mit Zertifikaten wird häufig danach gefragt, welches Zertifikat und warum dieses verwendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="706d1-199">Common questions about certificates are which certificate to use, and why.</span></span> <span data-ttu-id="706d1-200">Die Antwort hängt davon ab, ob Sie einen Client oder einen Dienst programmieren.</span><span class="sxs-lookup"><span data-stu-id="706d1-200">The answer depends on whether you are programming a client or service.</span></span> <span data-ttu-id="706d1-201">Die folgenden Informationen bieten eine allgemeine Orientierung und stellen keine erschöpfende Antwort auf diese Fragen dar.</span><span class="sxs-lookup"><span data-stu-id="706d1-201">The following information provides a general guideline and is not an exhaustive answer to these questions.</span></span>  
  
### <a name="service-certificates"></a><span data-ttu-id="706d1-202">Dienstzertifikate</span><span class="sxs-lookup"><span data-stu-id="706d1-202">Service Certificates</span></span>  
 <span data-ttu-id="706d1-203">Dienstzertifikate werden in erster Linie zur Authentifizierung von Servern gegenüber Clients verwendet.</span><span class="sxs-lookup"><span data-stu-id="706d1-203">Service certificates have the primary task of authenticating the server to clients.</span></span> <span data-ttu-id="706d1-204">Eine zunächst überprüft, ob bei der Authentifizierung eines Clients eines Servers ist beim Vergleichen des Werts, der die **Betreff** Feld auf den Uniform Resource Identifier (URI) Verbindung mit dem Dienst verwendet: das DNS von übereinstimmen.</span><span class="sxs-lookup"><span data-stu-id="706d1-204">One of the initial checks when a client authenticates a server is to compare the value of the **Subject** field to the Uniform Resource Identifier (URI) used to contact the service: the DNS of both must match.</span></span> <span data-ttu-id="706d1-205">Angenommen, wenn der URI des Diensts ist "http://www.contoso.com/endpoint/" und dann die **Betreff** Feld muss auch den Wert "www.contoso.com" enthalten.</span><span class="sxs-lookup"><span data-stu-id="706d1-205">For example, if the URI of the service is "http://www.contoso.com/endpoint/" then the **Subject** field must also contain the value "www.contoso.com".</span></span>  
  
 <span data-ttu-id="706d1-206">Das Feld kann mehrere Werte enthalten, denen jeweils eine Initialisierung zur Angabe des Werts vorangeht.</span><span class="sxs-lookup"><span data-stu-id="706d1-206">Note that the field can contain several values, each prefixed with an initialization to indicate the value.</span></span> <span data-ttu-id="706d1-207">Die am häufigsten verwendete Initialisierung lautet "CN" (Common Name), z. B. "CN = www.contoso.com".</span><span class="sxs-lookup"><span data-stu-id="706d1-207">Most commonly, the initialization is "CN" for common name, for example, "CN = www.contoso.com".</span></span> <span data-ttu-id="706d1-208">Es ist auch möglich, für die **Betreff** Feld leer ist, in diesem Fall werden die **Alternativer Antragstellername** Feld darf die **DNS-Namen** Wert.</span><span class="sxs-lookup"><span data-stu-id="706d1-208">It is also possible for the **Subject** field to be blank, in which case the **Subject Alternative Name** field can contain the **DNS Name** value.</span></span>  
  
 <span data-ttu-id="706d1-209">Beachten Sie außerdem den Wert der **Beabsichtigte Zwecke** Feld des Zertifikats sollte einen entsprechenden Wert ein, z. B. "Serverauthentifizierung" oder "Clientauthentifizierung" enthalten.</span><span class="sxs-lookup"><span data-stu-id="706d1-209">Also note the value of the **Intended Purposes** field of the certificate should include an appropriate value, such as "Server Authentication" or "Client Authentication".</span></span>  
  
### <a name="client-certificates"></a><span data-ttu-id="706d1-210">Clientzertifikate</span><span class="sxs-lookup"><span data-stu-id="706d1-210">Client Certificates</span></span>  
 <span data-ttu-id="706d1-211">Clientzertifikate werden normalerweise nicht von der Zertifizierungsstelle eines Drittanbieters ausgegeben.</span><span class="sxs-lookup"><span data-stu-id="706d1-211">Client certificates are not typically issued by a third-party certification authority.</span></span> <span data-ttu-id="706d1-212">Stattdessen enthält der persönliche Speicher des aktuellen Benutzers für gewöhnlich Zertifikate, die von einer Stammzertifizierungsstelle dort abgelegt wurden und deren beabsichtigter Zweck die "Clientauthentifizierung" ist.</span><span class="sxs-lookup"><span data-stu-id="706d1-212">Instead, the Personal store of the current user location typically contains certificates placed there by a root authority, with an intended purpose of "Client Authentication".</span></span> <span data-ttu-id="706d1-213">Diese Zertifikate können vom Client verwendet werden, wenn eine wechselseitige Authentifizierung erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="706d1-213">The client can use such a certificate when mutual authentication is required.</span></span>  
  
## <a name="online-revocation-and-offline-revocation"></a><span data-ttu-id="706d1-214">Online-Sperrüberprüfung und Offline-Sperrüberprüfung</span><span class="sxs-lookup"><span data-stu-id="706d1-214">Online Revocation and Offline Revocation</span></span>  
  
### <a name="certificate-validity"></a><span data-ttu-id="706d1-215">Zertifikatsgültigkeit</span><span class="sxs-lookup"><span data-stu-id="706d1-215">Certificate Validity</span></span>  
 <span data-ttu-id="706d1-216">Jedes Zertifikat gilt nur für einen bestimmten Zeitraum, bezeichnet der *Gültigkeitsdauer*.</span><span class="sxs-lookup"><span data-stu-id="706d1-216">Every certificate is valid only for a given period of time, called the *validity period*.</span></span> <span data-ttu-id="706d1-217">Die Gültigkeitsdauer wird definiert, indem die **gültig von** und **gültig bis** Felder eines x. 509-Zertifikats.</span><span class="sxs-lookup"><span data-stu-id="706d1-217">The validity period is defined by the **Valid from** and **Valid to** fields of an X.509 certificate.</span></span> <span data-ttu-id="706d1-218">Während der Authentifizierung wird überprüft, ob das Zertifikat eine entsprechende Gültigkeitsdauer aufweist.</span><span class="sxs-lookup"><span data-stu-id="706d1-218">During authentication, the certificate is checked to determine whether the certificate is still within the validity period.</span></span>  
  
### <a name="certificate-revocation-list"></a><span data-ttu-id="706d1-219">Zertifikatsperrliste</span><span class="sxs-lookup"><span data-stu-id="706d1-219">Certificate Revocation List</span></span>  
 <span data-ttu-id="706d1-220">Zertifikate können innerhalb der Gültigkeitsdauer jederzeit von der Zertifizierungsstelle widerrufen werden.</span><span class="sxs-lookup"><span data-stu-id="706d1-220">At any time during the validity period, the certification authority can revoke a certificate.</span></span> <span data-ttu-id="706d1-221">Dafür kann es viele Gründe geben, beispielsweise kann die Sicherheit des privaten Schlüssels eines Zertifikats gefährdet sein.</span><span class="sxs-lookup"><span data-stu-id="706d1-221">This can occur for many reasons, such as a compromise of the private key of the certificate.</span></span>  
  
 <span data-ttu-id="706d1-222">In diesem Fall werden auch alle untergeordneten Zertifikate des widerrufenen Zertifikats ungültig und im Rahmen des Authentifizierungsprozesses als nicht vertrauenswürdig eingestuft.</span><span class="sxs-lookup"><span data-stu-id="706d1-222">When this occurs, any chains that descend from the revoked certificate are also invalid, and are not trusted during authentication procedures.</span></span> <span data-ttu-id="706d1-223">Um herauszufinden, welche Zertifikate gesperrt werden, jeder Aussteller veröffentlicht ein und Date-Zeitstempel *Zertifikatsperrliste* (CRL).</span><span class="sxs-lookup"><span data-stu-id="706d1-223">To find out which certificates are revoked, each issuer publishes a time- and date-stamped *certificate revocation list* (CRL).</span></span> <span data-ttu-id="706d1-224">Diese Liste kann mit einer Online-Sperrüberprüfung oder mit einer Offline-Sperrüberprüfung überprüft werden, indem die `RevocationMode`-Eigenschaft oder die `DefaultRevocationMode`-Eigenschaft der folgenden Klassen einschließlich der <xref:System.Security.Cryptography.X509Certificates.X509RevocationMode>-Klassen auf einen der <xref:System.ServiceModel.Security.X509ClientCertificateAuthentication>-Enumerationswerte festgelegt wird: <xref:System.ServiceModel.Security.X509PeerCertificateAuthentication>, <xref:System.ServiceModel.Security.X509ServiceCertificateAuthentication>, <xref:System.ServiceModel.Security.IssuedTokenServiceCredential>.</span><span class="sxs-lookup"><span data-stu-id="706d1-224">The list can be checked using either online revocation or offline revocation by setting the `RevocationMode` or `DefaultRevocationMode` property of the following classes to one of the <xref:System.Security.Cryptography.X509Certificates.X509RevocationMode> enumeration values: <xref:System.ServiceModel.Security.X509ClientCertificateAuthentication>, <xref:System.ServiceModel.Security.X509PeerCertificateAuthentication>, <xref:System.ServiceModel.Security.X509ServiceCertificateAuthentication>, and the <xref:System.ServiceModel.Security.IssuedTokenServiceCredential> classes.</span></span> <span data-ttu-id="706d1-225">Der Standardwert aller Eigenschaften lautet `Online`.</span><span class="sxs-lookup"><span data-stu-id="706d1-225">The default value for all properties is `Online`.</span></span>  
  
 <span data-ttu-id="706d1-226">Sie können den Modus auch festlegen, in der Konfiguration mit der `revocationMode` Attribut beider der [ \<Authentifizierung >](../../../../docs/framework/configure-apps/file-schema/wcf/authentication-of-clientcertificate-element.md) (von der [ \<ServiceBehaviors >](../../../../docs/framework/configure-apps/file-schema/wcf/servicebehaviors.md)) und die [ \<Authentifizierung >](../../../../docs/framework/configure-apps/file-schema/wcf/authentication-of-clientcertificate-element.md) (von der [ \<EndpointBehaviors >](../../../../docs/framework/configure-apps/file-schema/wcf/endpointbehaviors.md)).</span><span class="sxs-lookup"><span data-stu-id="706d1-226">You can also set the mode in configuration using the `revocationMode` attribute of both the [\<authentication>](../../../../docs/framework/configure-apps/file-schema/wcf/authentication-of-clientcertificate-element.md) (of the [\<serviceBehaviors>](../../../../docs/framework/configure-apps/file-schema/wcf/servicebehaviors.md)) and the [\<authentication>](../../../../docs/framework/configure-apps/file-schema/wcf/authentication-of-clientcertificate-element.md) (of the [\<endpointBehaviors>](../../../../docs/framework/configure-apps/file-schema/wcf/endpointbehaviors.md)).</span></span>  
  
## <a name="the-setcertificate-method"></a><span data-ttu-id="706d1-227">SetCertificate-Methode</span><span class="sxs-lookup"><span data-stu-id="706d1-227">The SetCertificate Method</span></span>  
 <span data-ttu-id="706d1-228">In WCF müssen häufig geben Sie ein Zertifikat oder der Zertifikate einen Dienst oder Client zu authentifizieren, verschlüsseln oder digitalen Signieren von Nachrichten verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="706d1-228">In WCF, you must often specify a certificate or set of certificates a service or client is to use to authenticate, encrypt, or digitally sign a message.</span></span> <span data-ttu-id="706d1-229">Dies kann programmgesteuert mit der `SetCertificate`-Methode verschiedener Klassen geschehen, die X.509-Zertifikate darstellen.</span><span class="sxs-lookup"><span data-stu-id="706d1-229">You can do this programmatically by using the `SetCertificate` method of various classes that represent X.509 certificates.</span></span> <span data-ttu-id="706d1-230">Folgende Klassen geben mit der `SetCertificate`-Methode ein Zertifikat an.</span><span class="sxs-lookup"><span data-stu-id="706d1-230">The following classes use the `SetCertificate` method to specify a certificate.</span></span>  
  
|<span data-ttu-id="706d1-231">Klasse</span><span class="sxs-lookup"><span data-stu-id="706d1-231">Class</span></span>|<span data-ttu-id="706d1-232">Methode</span><span class="sxs-lookup"><span data-stu-id="706d1-232">Method</span></span>|  
|-----------|------------|  
|<xref:System.ServiceModel.Security.PeerCredential>|<xref:System.ServiceModel.Security.PeerCredential.SetCertificate%2A>|  
|<xref:System.ServiceModel.Security.X509CertificateInitiatorClientCredential>|<xref:System.ServiceModel.Security.X509CertificateInitiatorClientCredential.SetCertificate%2A>|  
|<xref:System.ServiceModel.Security.X509CertificateRecipientServiceCredential>|<xref:System.ServiceModel.Security.X509CertificateRecipientServiceCredential.SetCertificate%2A>|  
|<xref:System.ServiceModel.Security.X509CertificateInitiatorServiceCredential>|  
|<xref:System.ServiceModel.Security.X509CertificateInitiatorServiceCredential.SetCertificate%2A>|  
  
 <span data-ttu-id="706d1-233">Bei der `SetCertificate`-Methode werden ein Speicherort und ein Speicher angegeben sowie ein Suchtyp (`x509FindType`-Parameter), der ein Feld des Zertifikats bestimmt, und ein Wert, der im Feld gefunden werden soll.</span><span class="sxs-lookup"><span data-stu-id="706d1-233">The `SetCertificate` method works by designating a store location and store, a "find" type (`x509FindType` parameter) that specifies a field of the certificate, and a value to find in the field.</span></span> <span data-ttu-id="706d1-234">Der folgende Code erstellt z. B. eine <xref:System.ServiceModel.ServiceHost> Instanz, und legt das Dienstzertifikat zum Authentifizieren des Dienstes für Clients mit der `SetCertificate` Methode.</span><span class="sxs-lookup"><span data-stu-id="706d1-234">For example, the following code creates a <xref:System.ServiceModel.ServiceHost> instance and sets the service certificate used to authenticate the service to clients with the `SetCertificate` method.</span></span>  
  
 [!code-csharp[c_WorkingWithCertificates#1](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_workingwithcertificates/cs/source.cs#1)]
 [!code-vb[c_WorkingWithCertificates#1](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_workingwithcertificates/vb/source.vb#1)]  
  
### <a name="multiple-certificates-with-the-same-value"></a><span data-ttu-id="706d1-235">Mehrere Zertifikate mit dem gleichen Wert</span><span class="sxs-lookup"><span data-stu-id="706d1-235">Multiple Certificates with the Same Value</span></span>  
 <span data-ttu-id="706d1-236">Ein Speicher kann mehrere Zertifikate mit dem gleichen Antragstellernamen enthalten.</span><span class="sxs-lookup"><span data-stu-id="706d1-236">A store may contain multiple certificates with the same subject name.</span></span> <span data-ttu-id="706d1-237">Dies bedeutet, dass, wenn Sie, dass angeben die `x509FindType` ist <xref:System.Security.Cryptography.X509Certificates.X509FindType.FindBySubjectName> oder <xref:System.Security.Cryptography.X509Certificates.X509FindType.FindBySubjectDistinguishedName>, und mehr als ein Zertifikat hat den gleichen Wert, eine Ausnahme wird ausgelöst, da es keine Möglichkeit, zu unterscheiden, welches Zertifikat erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="706d1-237">This means that if you specify that the `x509FindType` is <xref:System.Security.Cryptography.X509Certificates.X509FindType.FindBySubjectName> or <xref:System.Security.Cryptography.X509Certificates.X509FindType.FindBySubjectDistinguishedName>, and more than one certificate has the same value, an exception is thrown because there is no way to distinguish which certificate is required.</span></span> <span data-ttu-id="706d1-238">Legen Sie den `x509FindType` auf <xref:System.Security.Cryptography.X509Certificates.X509FindType.FindByThumbprint> fest, um dem entgegenzuwirken.</span><span class="sxs-lookup"><span data-stu-id="706d1-238">You can mitigate this by setting the `x509FindType` to <xref:System.Security.Cryptography.X509Certificates.X509FindType.FindByThumbprint>.</span></span> <span data-ttu-id="706d1-239">Das Fingerabdruckfeld enthält einen eindeutigen Wert, mit dem ein bestimmtes Zertifikat in einem Speicher gefunden werden kann.</span><span class="sxs-lookup"><span data-stu-id="706d1-239">The thumbprint field contains a unique value that can be used to find a specific certificate in a store.</span></span> <span data-ttu-id="706d1-240">Dies hat jedoch einen Nachteil: Wenn das Zertifikat widerrufen oder erneuert wird, schlägt die `SetCertificate`-Methode fehl, da der Fingerabdruck ebenfalls nicht mehr verfügbar ist.</span><span class="sxs-lookup"><span data-stu-id="706d1-240">However, this has its own disadvantage: if the certificate is revoked or renewed, the `SetCertificate` method fails because the thumbprint is also gone.</span></span> <span data-ttu-id="706d1-241">Ist das Zertifikat nicht mehr gültig ist, schlägt die Authentifizierung fehl.</span><span class="sxs-lookup"><span data-stu-id="706d1-241">Or, if the certificate is no longer valid, authentication fails.</span></span> <span data-ttu-id="706d1-242">Legen Sie den `x590FindType`-Parameter auf <xref:System.Security.Cryptography.X509Certificates.X509FindType.FindByIssuerName> fest, und geben Sie den Namen des Ausstellers an, um dem entgegenzuwirken.</span><span class="sxs-lookup"><span data-stu-id="706d1-242">The way to mitigate this is to set the `x590FindType` parameter to <xref:System.Security.Cryptography.X509Certificates.X509FindType.FindByIssuerName> and specify the issuer's name.</span></span> <span data-ttu-id="706d1-243">Wenn kein bestimmter Aussteller angegeben werden muss, können Sie auch einen der anderen <xref:System.Security.Cryptography.X509Certificates.X509FindType>-Enumerationswerte wie <xref:System.Security.Cryptography.X509Certificates.X509FindType.FindByTimeValid> festlegen.</span><span class="sxs-lookup"><span data-stu-id="706d1-243">If no particular issuer is required, you can also set one of the other <xref:System.Security.Cryptography.X509Certificates.X509FindType> enumeration values, such as <xref:System.Security.Cryptography.X509Certificates.X509FindType.FindByTimeValid>.</span></span>  
  
## <a name="certificates-in-configuration"></a><span data-ttu-id="706d1-244">Zertifikate in der Konfiguration</span><span class="sxs-lookup"><span data-stu-id="706d1-244">Certificates in Configuration</span></span>  
 <span data-ttu-id="706d1-245">Sie können Zertifikate auch in der Konfiguration festlegen.</span><span class="sxs-lookup"><span data-stu-id="706d1-245">You can also set certificates by using configuration.</span></span> <span data-ttu-id="706d1-246">Wenn Sie einen Dienst erstellen, werden Anmeldeinformationen, Zertifikate, einschließlich angegeben, unter der [ \<ServiceBehaviors >](../../../../docs/framework/configure-apps/file-schema/wcf/servicebehaviors.md).</span><span class="sxs-lookup"><span data-stu-id="706d1-246">If you are creating a service, credentials, including certificates, are specified under the [\<serviceBehaviors>](../../../../docs/framework/configure-apps/file-schema/wcf/servicebehaviors.md).</span></span> <span data-ttu-id="706d1-247">Wenn Sie einen Client programmieren, werden Zertifikate angegeben, unter der [ \<EndpointBehaviors >](../../../../docs/framework/configure-apps/file-schema/wcf/endpointbehaviors.md).</span><span class="sxs-lookup"><span data-stu-id="706d1-247">When you are programming a client, certificates are specified under the [\<endpointBehaviors>](../../../../docs/framework/configure-apps/file-schema/wcf/endpointbehaviors.md).</span></span>  
  
## <a name="mapping-a-certificate-to-a-user-account"></a><span data-ttu-id="706d1-248">Zuordnen eines Zertifikats zu einem Benutzerkonto</span><span class="sxs-lookup"><span data-stu-id="706d1-248">Mapping a Certificate to a User Account</span></span>  
 <span data-ttu-id="706d1-249">IIS und Active Directory bieten u. a. die Möglichkeit, ein Zertifikat einem Windows-Benutzerkonto zuzuordnen.</span><span class="sxs-lookup"><span data-stu-id="706d1-249">A feature of IIS and Active Directory is the ability to map a certificate to a Windows user account.</span></span> <span data-ttu-id="706d1-250">Weitere Informationen zur Funktion finden Sie unter [Zuordnen von Zertifikaten zu Benutzerkonten](http://go.microsoft.com/fwlink/?LinkId=88917).</span><span class="sxs-lookup"><span data-stu-id="706d1-250">For more information about the feature, see [Map certificates to user accounts](http://go.microsoft.com/fwlink/?LinkId=88917).</span></span>  
  
 <span data-ttu-id="706d1-251">Weitere Informationen zur Verwendung von Active Directory-Zuordnung finden Sie unter [Zuordnung von Clientzertifikaten mithilfe der Zuordnung von Directory Service](http://go.microsoft.com/fwlink/?LinkId=88918).</span><span class="sxs-lookup"><span data-stu-id="706d1-251">For more information about using Active Directory mapping, see [Mapping Client Certificates with Directory Service Mapping](http://go.microsoft.com/fwlink/?LinkId=88918).</span></span>  
  
 <span data-ttu-id="706d1-252">Wenn diese Funktion aktiviert ist, können Sie die <xref:System.ServiceModel.Security.X509ClientCertificateAuthentication.MapClientCertificateToWindowsAccount%2A>-Eigenschaft der <xref:System.ServiceModel.Security.X509ClientCertificateAuthentication>-Klasse auf `true` festlegen.</span><span class="sxs-lookup"><span data-stu-id="706d1-252">With this capability enabled, you can set the <xref:System.ServiceModel.Security.X509ClientCertificateAuthentication.MapClientCertificateToWindowsAccount%2A> property of the <xref:System.ServiceModel.Security.X509ClientCertificateAuthentication> class to `true`.</span></span> <span data-ttu-id="706d1-253">In der Konfiguration können Sie festlegen der `mapClientCertificateToWindowsAccount` Attribut von der [ \<Authentifizierung >](../../../../docs/framework/configure-apps/file-schema/wcf/authentication-of-servicecertificate-element.md) Element `true`, wie im folgenden Code gezeigt.</span><span class="sxs-lookup"><span data-stu-id="706d1-253">In configuration, you can set the `mapClientCertificateToWindowsAccount` attribute of the [\<authentication>](../../../../docs/framework/configure-apps/file-schema/wcf/authentication-of-servicecertificate-element.md) element to `true`, as shown in the following code.</span></span>  
  
```xml  
<serviceBehaviors>  
 <behavior name="MappingBehavior">  
  <serviceCredentials>  
   <clientCertificate>  
    <authentication certificateValidationMode="None" mapClientCertificateToWindowsAccount="true" />  
   </clientCertificate>  
  </serviceCredentials>  
 </behavior>  
</serviceBehaviors>  
```  
  
 <span data-ttu-id="706d1-254">Die Zuordnung eines X.509-Zertifikats zu einem Token, das ein Windows-Benutzerkonto darstellt, wird als Erweiterung der Berechtigungen angesehen, da das Windows-Token nach der Zuordnung Zugriff auf geschützte Ressourcen ermöglicht.</span><span class="sxs-lookup"><span data-stu-id="706d1-254">Mapping an X.509 certificate to the token that represents a Windows user account is considered an elevation of privilege because, once mapped, the Windows token can be used to gain access to protected resources.</span></span> <span data-ttu-id="706d1-255">Das X.509-Zertifikat muss daher vor der Zuordnung die entsprechenden Anforderungen der Domänenrichtlinie erfüllen.</span><span class="sxs-lookup"><span data-stu-id="706d1-255">Therefore, domain policy requires the X.509 certificate to comply with its policy prior to mapping.</span></span> <span data-ttu-id="706d1-256">Die *SChannel* Sicherheitspaket erzwingt diese Anforderung.</span><span class="sxs-lookup"><span data-stu-id="706d1-256">The *SChannel* security package enforces this requirement.</span></span>  
  
 <span data-ttu-id="706d1-257">Bei Verwendung [!INCLUDE[netfx35_long](../../../../includes/netfx35-long-md.md)] oder später WCF gewährleistet das Zertifikat Domänenrichtlinie entspricht, bevor sie ein Windows-Konto zugeordnet ist.</span><span class="sxs-lookup"><span data-stu-id="706d1-257">When using [!INCLUDE[netfx35_long](../../../../includes/netfx35-long-md.md)] or later, WCF ensures the certificate conforms to domain policy before it is mapped to a Windows account.</span></span>  
  
 <span data-ttu-id="706d1-258">In der ersten Version von WCF erfolgt die Zuordnung ohne auf die Domänenrichtlinie zurückzugreifen.</span><span class="sxs-lookup"><span data-stu-id="706d1-258">In the first release of WCF, mapping is done without consulting the domain policy.</span></span> <span data-ttu-id="706d1-259">Möglicherweise tritt daher bei älteren Anwendungen, die mit dem ersten Release ausgeführt werden konnten, ein Fehler auf, wenn die Zuordnung aktiviert ist und die Anforderungen der Domänenrichtlinie vom X.509-Zertifikat nicht erfüllt werden.</span><span class="sxs-lookup"><span data-stu-id="706d1-259">Therefore it is possible that older applications that used to work when running under the first release, fails if the mapping is enabled and the X.509 certificate does not satisfy the domain policy.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="706d1-260">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="706d1-260">See Also</span></span>  
 <xref:System.ServiceModel.Channels>  
 <xref:System.ServiceModel.Security>  
 <xref:System.ServiceModel>  
 <xref:System.Security.Cryptography.X509Certificates.X509FindType>  
 [<span data-ttu-id="706d1-261">Sichern von Diensten und Clients</span><span class="sxs-lookup"><span data-stu-id="706d1-261">Securing Services and Clients</span></span>](../../../../docs/framework/wcf/feature-details/securing-services-and-clients.md)
