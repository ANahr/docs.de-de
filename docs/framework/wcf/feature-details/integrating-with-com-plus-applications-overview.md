---
title: Übersicht über die Integration von COM+-Anwendungen
ms.custom: ''
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: ''
ms.suite: ''
ms.technology:
- dotnet-clr
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- Windows Communication Foundation, COM+ integration
- WCF, COM+ integration
ms.assetid: e481e48f-7096-40eb-9f20-7f0098412941
caps.latest.revision: 29
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.workload:
- dotnet
ms.openlocfilehash: 3c723bda93feac3eef18f302ab0c8ec7c702eb7a
ms.sourcegitcommit: 94d33cadc5ff81d2ac389bf5f26422c227832052
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/30/2018
---
# <a name="integrating-with-com-applications-overview"></a><span data-ttu-id="8419d-102">Übersicht über die Integration von COM+-Anwendungen</span><span class="sxs-lookup"><span data-stu-id="8419d-102">Integrating with COM+ Applications Overview</span></span>
[!INCLUDE[indigo1](../../../../includes/indigo1-md.md)]<span data-ttu-id="8419d-103"> stellt eine umfangreiche Umgebung zum Erstellen von verteilten Anwendungen bereit.</span><span class="sxs-lookup"><span data-stu-id="8419d-103"> provides a rich environment for creating distributed applications.</span></span> <span data-ttu-id="8419d-104">Wenn Sie bereits komponentenbasierte Anwendungslogik verwenden, die in COM+ gehostet wird, können Sie [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] zum Erweitern der vorhandenen Logik verwenden, anstatt sie neu zu schreiben.</span><span class="sxs-lookup"><span data-stu-id="8419d-104">If you are already using component-based application logic hosted in COM+, you can use [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] to extend your existing logic rather than having to rewrite it.</span></span> <span data-ttu-id="8419d-105">Ein häufiges Szenario ist das Verfügbarmachen vorhandener COM+- oder Enterprise Services-Geschäftslogik über Webdienste.</span><span class="sxs-lookup"><span data-stu-id="8419d-105">A common scenario is when you want to expose existing COM+ or Enterprise Services business logic through Web Services.</span></span>  
  
 <span data-ttu-id="8419d-106">Wenn eine Schnittstelle auf einer COM+-Komponente als Webdienst verfügbar gemacht wird, werden die Spezifikation und der Vertrag dieser Dienste von einer automatischen Zuordnung bestimmt, die zur Anwendungsinitialisierungszeit ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="8419d-106">When an interface on a COM+ component is exposed as a Web service, the specification and contract of these services are determined by an automatic mapping that is performed at application initialization time.</span></span> <span data-ttu-id="8419d-107">In der folgenden Liste wird das Modell für diese Zuordnung gezeigt:</span><span class="sxs-lookup"><span data-stu-id="8419d-107">The following list shows the conceptual model for this mapping:</span></span>  
  
-   <span data-ttu-id="8419d-108">Ein Dienst wird für jede verfügbar gemachte COM-Klasse definiert.</span><span class="sxs-lookup"><span data-stu-id="8419d-108">One service is defined for each exposed COM class.</span></span>  
  
-   <span data-ttu-id="8419d-109">Der Vertrag für den Dienst wird direkt von der Schnittstellendefinition der ausgewählten Komponente abgeleitet, wobei die Möglichkeit des Methodenausschlusses in der Konfiguration definiert wird.</span><span class="sxs-lookup"><span data-stu-id="8419d-109">The contract for the service is derived directly from the selected component's interface definition with the possibility of method exclusion defined in configuration.</span></span>  
  
-   <span data-ttu-id="8419d-110">Die Vorgänge in diesem Vertrag werden direkt von den Methoden in der Schnittstellendefinition der Komponente abgeleitet.</span><span class="sxs-lookup"><span data-stu-id="8419d-110">The operations in that contract are derived directly from the methods on the component's interface definition.</span></span>  
  
-   <span data-ttu-id="8419d-111">Die Parameter für diese Vorgänge werden direkt von dem COM-Interoperabilitätstyp abgeleitet, der den Methodenparametern der Komponente entspricht.</span><span class="sxs-lookup"><span data-stu-id="8419d-111">The parameters for those operations are derived directly from the COM interoperability type that corresponds to the component's method parameters.</span></span>  
  
 <span data-ttu-id="8419d-112">Standardadressen und Transportbindungen für den Dienst werden in einer Dienstkonfigurationsdatei bereitgestellt, sie können jedoch ggf. neu konfiguriert werden.</span><span class="sxs-lookup"><span data-stu-id="8419d-112">Default addresses and transport bindings for the service are provided in a service configuration file, but these can be reconfigured as required.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="8419d-113">Die Verträge für die verfügbar gemachten Webdienste bleiben konstant, solange die COM+-Schnittstellen und die Konfiguration unverändert bleiben.</span><span class="sxs-lookup"><span data-stu-id="8419d-113">The contracts for the exposed Web services remain constant as long as the COM+ interfaces and configuration remain unchanged.</span></span> <span data-ttu-id="8419d-114">Bei einer Änderung mehrerer Schnittstellen werden die verfügbaren Dienste nicht automatisch aktualisiert; das COM+ Service Model Configuration-Tool (ComSvcConfig.exe) muss jedoch erneut ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="8419d-114">A modification to several interfaces does not automatically update the available services and requires re-running the COM+ Service Model Configuration tool (ComSvcConfig.exe).</span></span>  
  
 <span data-ttu-id="8419d-115">Die Authentifizierungs- und Autorisierungsanforderungen der COM+-Anwendung und ihrer Komponenten werden bei der Verwendung als Webdienst weiterhin erzwungen.</span><span class="sxs-lookup"><span data-stu-id="8419d-115">The authentication and authorization requirements of the COM+ application and its components continue to be enforced when used as a Web service.</span></span>  
  
 <span data-ttu-id="8419d-116">Initiiert der Aufrufer eine Webdiensttransaktion, werden als transaktionsfähig markierte Komponenten innerhalb dieses Transaktionsbereichs aufgeführt.</span><span class="sxs-lookup"><span data-stu-id="8419d-116">If the caller initiates a Web service transaction, components marked as transactional enlist within that transaction scope.</span></span>  
  
 <span data-ttu-id="8419d-117">Die folgenden Schritte sind erforderlich, um die Schnittstelle einer COM+-Komponente ohne Änderung der Komponente als Webdienst verfügbar zu machen:</span><span class="sxs-lookup"><span data-stu-id="8419d-117">The following steps are required to expose a COM+ component's interface as a Web service without modifying the component:</span></span>  
  
1.  <span data-ttu-id="8419d-118">Legen Sie fest, ob die Schnittstelle der COM+-Komponente als Webdienst verfügbar gemacht werden kann.</span><span class="sxs-lookup"><span data-stu-id="8419d-118">Determine whether the COM+ component's interface can be exposed as a Web service.</span></span>  
  
2.  <span data-ttu-id="8419d-119">Wählen Sie einen entsprechenden Hostingmodus aus.</span><span class="sxs-lookup"><span data-stu-id="8419d-119">Select an appropriate hosting mode.</span></span>  
  
3.  <span data-ttu-id="8419d-120">Verwenden Sie das COM+ Service Model Configuration-Tool (ComSvcConfig.exe) zum Hinzufügen eines Webdiensts für die Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="8419d-120">Use the COM+ Service Model Configuration tool (ComSvcConfig.exe) to add a Web service for the interface.</span></span> <span data-ttu-id="8419d-121">Weitere Informationen zur Verwendung von ComSvcConfig.exe finden Sie unter [Vorgehensweise: Verwenden Sie das COM+ Service Model Configuration-Tool](../../../../docs/framework/wcf/feature-details/how-to-use-the-com-service-model-configuration-tool.md).</span><span class="sxs-lookup"><span data-stu-id="8419d-121">For more information about how to use ComSvcConfig.exe, see [How to: Use the COM+ Service Model Configuration Tool](../../../../docs/framework/wcf/feature-details/how-to-use-the-com-service-model-configuration-tool.md).</span></span>  
  
4.  <span data-ttu-id="8419d-122">Konfigurieren Sie zusätzliche Diensteinstellungen in der Anwendungskonfigurationsdatei.</span><span class="sxs-lookup"><span data-stu-id="8419d-122">Configure any additional service settings in the application configuration file.</span></span> <span data-ttu-id="8419d-123">Weitere Informationen zum Konfigurieren einer Komponente, finden Sie unter [Vorgehensweise: Konfigurieren von COM+-Diensteinstellungen](../../../../docs/framework/wcf/feature-details/how-to-configure-com-service-settings.md).</span><span class="sxs-lookup"><span data-stu-id="8419d-123">For more information about how to configure a component, see [How to: Configure COM+ Service Settings](../../../../docs/framework/wcf/feature-details/how-to-configure-com-service-settings.md).</span></span>  
  
## <a name="supported-interfaces"></a><span data-ttu-id="8419d-124">Unterstützte Schnittstellen</span><span class="sxs-lookup"><span data-stu-id="8419d-124">Supported Interfaces</span></span>  
 <span data-ttu-id="8419d-125">Es gibt einige Beschränkungen beim Typ von Schnittstellen, die als Webdienst verfügbar gemacht werden können.</span><span class="sxs-lookup"><span data-stu-id="8419d-125">There are some restrictions on the type of interfaces that can be exposed as a Web service.</span></span> <span data-ttu-id="8419d-126">Die folgenden Typen von Schnittstellen werden nicht unterstützt:</span><span class="sxs-lookup"><span data-stu-id="8419d-126">The following types of interfaces are not supported:</span></span>  
  
-   <span data-ttu-id="8419d-127">Schnittstellen, die Objektverweise als Parameter übergeben; der folgende beschränkte Objektverweisansatz wird im Abschnitt "Beschränkte Objektverweisunterstützung" beschrieben.</span><span class="sxs-lookup"><span data-stu-id="8419d-127">Interfaces that pass object references as parameters - the following limited object reference approach is described in the Limited Object Reference Support section.</span></span>  
  
-   <span data-ttu-id="8419d-128">Schnittstellen, die Typen übergeben, die mit den [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]-COM-Interoperabilitätskonvertierungen nicht kompatibel sind.</span><span class="sxs-lookup"><span data-stu-id="8419d-128">Interfaces that pass types that are not compatible with the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] COM interoperability conversions.</span></span>  
  
-   <span data-ttu-id="8419d-129">Schnittstellen für Anwendungen, in denen beim Hosten durch COM+ das Anwendungspooling aktiviert ist.</span><span class="sxs-lookup"><span data-stu-id="8419d-129">Interfaces for applications that have application pooling enabled when hosted by COM+.</span></span>  
  
-   <span data-ttu-id="8419d-130">Schnittstellen von Komponenten, die für die Anwendung als privat markiert sind.</span><span class="sxs-lookup"><span data-stu-id="8419d-130">Interfaces of components that are marked as private to the application.</span></span>  
  
-   <span data-ttu-id="8419d-131">COM+-Infrastrukturschnittstellen.</span><span class="sxs-lookup"><span data-stu-id="8419d-131">COM+ infrastructure interfaces.</span></span>  
  
-   <span data-ttu-id="8419d-132">Schnittstellen aus der Systemanwendung.</span><span class="sxs-lookup"><span data-stu-id="8419d-132">Interfaces from the system application.</span></span>  
  
-   <span data-ttu-id="8419d-133">Schnittstellen aus Enterprise Services-Komponenten, die dem globalen Assemblycache nicht hinzugefügt wurden.</span><span class="sxs-lookup"><span data-stu-id="8419d-133">Interfaces from Enterprise Services components that have not been added to the global assembly cache.</span></span>  
  
### <a name="limited-object-reference-support"></a><span data-ttu-id="8419d-134">Beschränkte Objektverweisunterstützung</span><span class="sxs-lookup"><span data-stu-id="8419d-134">Limited Object Reference Support</span></span>  
 <span data-ttu-id="8419d-135">Da einige bereitgestellte COM+-Komponenten Objekte als Verweisparameter verwenden, wie Rückgabe eines ADO-Recordset-Objekts, schließt die COM+-Integration beschränkte Unterstützung für Objektverweisparameter ein.</span><span class="sxs-lookup"><span data-stu-id="8419d-135">Because a number of deployed COM+ components do use objects by reference parameters, such as returning an ADO Recordset object, COM+ integration includes limited support for object reference parameters.</span></span> <span data-ttu-id="8419d-136">Die Unterstützung ist auf Objekte beschränkt, die die `IPersistStream`-COM-Schnittstelle implementieren.</span><span class="sxs-lookup"><span data-stu-id="8419d-136">The support is limited to objects that implement the `IPersistStream` COM interface.</span></span> <span data-ttu-id="8419d-137">Sie schließt ADO-Recordset-Objekte ein und kann für anwendungsspezifische COM-Objekte implementiert werden.</span><span class="sxs-lookup"><span data-stu-id="8419d-137">This includes ADO Recordset objects and can be implemented for application specific COM objects.</span></span>  
  
 <span data-ttu-id="8419d-138">Zum Aktivieren dieser Unterstützung des Tools ComSvcConfig.exe bietet die **Allowreferences** Schalter an, der den regulären Signatur Methodenparameter deaktiviert und stellt sicher, dass das Tool ausgeführt wird, um sicherzustellen, dass Objektverweisparameter nicht verwendet werden .</span><span class="sxs-lookup"><span data-stu-id="8419d-138">To enable this support, the ComSvcConfig.exe tool provides the **allowreferences** switch that disables the regular method signature parameter and checks that the tool runs to ensure that object reference parameters are not being used.</span></span> <span data-ttu-id="8419d-139">Darüber hinaus müssen die übergebenen Objekttypen benannt und innerhalb des <`persistableTypes`>-Konfigurationselements identifiziert werden, das ein untergeordnetes Elements des <`comContract`>-Elements ist.</span><span class="sxs-lookup"><span data-stu-id="8419d-139">In addition, the object types that you pass as parameters must be named and identified within the <`persistableTypes`> configuration element that is a child of the <`comContract`> element.</span></span>  
  
 <span data-ttu-id="8419d-140">Wenn diese Funktion verwendet wird, nutzt der COM+-Integrationsdienst die `IPersistStream`-Schnittstelle zum Serialisieren oder Deserialisieren der Objektinstanz.</span><span class="sxs-lookup"><span data-stu-id="8419d-140">When this feature is used, the COM+ integration service uses the `IPersistStream` interface to serialize or deserialize the object instance.</span></span> <span data-ttu-id="8419d-141">Wenn die Objektinstanz `IPersistStream` nicht unterstützt, wird eine Ausnahme ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="8419d-141">If the object instance does not support `IPersistStream`, an exception is thrown.</span></span>  
  
 <span data-ttu-id="8419d-142">In einer Clientanwendung können die Methoden im <xref:System.ServiceModel.ComIntegration.PersistStreamTypeWrapper>-Objekt zum Übergeben eines Objekt an einen Dienst und entsprechend zum Abrufen eines Objekts verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="8419d-142">Within a client application, the methods on the <xref:System.ServiceModel.ComIntegration.PersistStreamTypeWrapper> object can be used to pass an object in to a service and similarly to retrieve an object.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="8419d-143">Auf Grund der benutzerdefinierten und plattformspezifischen Art des Serialisierungsansatzes ist er am besten für die Verwendung zwischen [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]-Clients und [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]-Diensten geeignet.</span><span class="sxs-lookup"><span data-stu-id="8419d-143">Due to the custom and platform-specific nature of the serialization approach, this is best suited for use between [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] clients and [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] services.</span></span>  
  
## <a name="selecting-the-hosting-mode"></a><span data-ttu-id="8419d-144">Auswählen des Hostingmodus</span><span class="sxs-lookup"><span data-stu-id="8419d-144">Selecting the Hosting Mode</span></span>  
 <span data-ttu-id="8419d-145">COM+ macht Webdienste in einem der folgenden Hostingmodi verfügbar:</span><span class="sxs-lookup"><span data-stu-id="8419d-145">COM+ exposes Web services in one of the following hosting modes:</span></span>  
  
-   <span data-ttu-id="8419d-146">COM+-gehostet</span><span class="sxs-lookup"><span data-stu-id="8419d-146">COM+-hosted</span></span>  
  
     <span data-ttu-id="8419d-147">Der Webdienst wird im dedizierten COM+-Serverprozess (Dllhost.exe) der Anwendung gehostet.</span><span class="sxs-lookup"><span data-stu-id="8419d-147">The Web service is hosted within the application's dedicated COM+ server process (Dllhost.exe).</span></span> <span data-ttu-id="8419d-148">Dieser Modus erfordert, dass die Anwendung explizit gestartet wird, bevor sie Webdienstanforderungen erhalten kann.</span><span class="sxs-lookup"><span data-stu-id="8419d-148">This mode requires the application to be explicitly started before it can receive Web service requests.</span></span> <span data-ttu-id="8419d-149">Mit den COM+-Optionen "Als NT-Dienst ausführen" oder "Bei Leerlauf nicht herunterfahren" kann das Herunterfahren der Anwendung und ihrer Dienste bei Leerlauf verhindert werden.</span><span class="sxs-lookup"><span data-stu-id="8419d-149">The COM+ options "Run as an NT Service" or "Leave running when idle" can be used to prevent idle shutdown of the application and its services.</span></span> <span data-ttu-id="8419d-150">Dieser Modus bietet Webdiensten und DCOM Zugriff auf die Serveranwendung.</span><span class="sxs-lookup"><span data-stu-id="8419d-150">This mode provides both Web service and DCOM access to the server application.</span></span>  
  
-   <span data-ttu-id="8419d-151">Im Internet gehostet</span><span class="sxs-lookup"><span data-stu-id="8419d-151">Web-hosted</span></span>  
  
     <span data-ttu-id="8419d-152">Der Webdienst wird in einem Webserver-Arbeitsprozess gehostet.</span><span class="sxs-lookup"><span data-stu-id="8419d-152">The Web service is hosted within a Web server worker process.</span></span> <span data-ttu-id="8419d-153">In diesem Modus muss COM+ nicht aktiv sein, wenn die ursprüngliche Anforderung empfangen wird.</span><span class="sxs-lookup"><span data-stu-id="8419d-153">This mode does not require COM+ to be active when the initial request is received.</span></span> <span data-ttu-id="8419d-154">Wenn die Anwendung beim Empfangen dieser Anforderung nicht aktiv ist, wird sie automatisch vor dem Verarbeiten der Anforderung aktiviert.</span><span class="sxs-lookup"><span data-stu-id="8419d-154">If the application is not active when this request is received, it is automatically activated prior to processing the request.</span></span> <span data-ttu-id="8419d-155">Dieser Modus bietet ebenfalls Webdiensten und DCOM Zugriff auf die Serveranwendung, er bewirkt jedoch einen Prozesshop für Webdienstanforderungen.</span><span class="sxs-lookup"><span data-stu-id="8419d-155">This mode also provides both Web service and DCOM access to the server application, but causes a process hop for Web service requests.</span></span> <span data-ttu-id="8419d-156">Dies erfordert in der Regel, dass der Client den Identitätswechsel aktiviert.</span><span class="sxs-lookup"><span data-stu-id="8419d-156">This typically requires the client to enable impersonation.</span></span> <span data-ttu-id="8419d-157">In [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] kann dazu die <xref:System.ServiceModel.Security.WindowsClientCredential.AllowedImpersonationLevel%2A>-Eigenschaft der <xref:System.ServiceModel.Security.WindowsClientCredential>-Klasse verwendet werden, auf die als Eigenschaft der generischen <xref:System.ServiceModel.ChannelFactory%601>-Klasse zugegriffen wird, sowie der <xref:System.Security.Principal.TokenImpersonationLevel.Impersonation>-Enumerationswert.</span><span class="sxs-lookup"><span data-stu-id="8419d-157">In [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], this can be done with the <xref:System.ServiceModel.Security.WindowsClientCredential.AllowedImpersonationLevel%2A> property of the <xref:System.ServiceModel.Security.WindowsClientCredential> class, which is accessed as a property of the generic <xref:System.ServiceModel.ChannelFactory%601> class, as well as the <xref:System.Security.Principal.TokenImpersonationLevel.Impersonation> enumeration value.</span></span>  
  
-   <span data-ttu-id="8419d-158">Prozessintern im Internet gehostet</span><span class="sxs-lookup"><span data-stu-id="8419d-158">Web-hosted in-process</span></span>  
  
     <span data-ttu-id="8419d-159">Der Webdienst und die COM+-Anwendungslogik werden im Webserver-Arbeitsprozess gehostet.</span><span class="sxs-lookup"><span data-stu-id="8419d-159">The Web service and the COM+ application logic are hosted within the Web server worker process.</span></span> <span data-ttu-id="8419d-160">Dieser bietet die automatische Aktivierung des Modus "Im Internet gehostet", ohne einen Prozesshop für Webdienstanforderungen zu bewirken.</span><span class="sxs-lookup"><span data-stu-id="8419d-160">This provides automatic activation of the Web-hosted mode without causing a process hop for Web service requests.</span></span> <span data-ttu-id="8419d-161">Der Nachteil besteht darin, dass der Zugriff auf die Serveranwendung über DCOM nicht möglich ist.</span><span class="sxs-lookup"><span data-stu-id="8419d-161">The disadvantage is that the server application cannot be accessed through DCOM.</span></span>  
  
### <a name="security-considerations"></a><span data-ttu-id="8419d-162">Sicherheitsüberlegungen</span><span class="sxs-lookup"><span data-stu-id="8419d-162">Security Considerations</span></span>  
 <span data-ttu-id="8419d-163">Wie bei anderen [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]-Diensten werden die Sicherheitseinstellungen für den verfügbar gemachten Dienst über die Konfigurationseinstellungen für den [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]-Kanal verwaltet.</span><span class="sxs-lookup"><span data-stu-id="8419d-163">Like other [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] services, the security settings for the exposed service are administered through configuration settings for the [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] channel.</span></span> <span data-ttu-id="8419d-164">Herkömmliche DCOM-Sicherheitseinstellungen wie die computerweiten DCOM-Berechtigungseinstellungen werden nicht erzwungen.</span><span class="sxs-lookup"><span data-stu-id="8419d-164">Traditional DCOM security settings such as the DCOM machine-wide permissions settings are not enforced.</span></span> <span data-ttu-id="8419d-165">Zum Erzwingen von COM+-Anwendungsrollen muss die Autorisierung "Zugriffsüberprüfungen auf der Komponentenebene" für die Komponente aktiviert werden.</span><span class="sxs-lookup"><span data-stu-id="8419d-165">To enforce COM+ application roles, "component-level access checks" authorization must be enabled for the component.</span></span>  
  
 <span data-ttu-id="8419d-166">Bei Verwendung einer nicht gesicherten Bindung kann für die Kommunikation die Gefahr von Manipulationen oder der Offenlegung von Informationen bestehen.</span><span class="sxs-lookup"><span data-stu-id="8419d-166">The use of a non-secured binding can leave communication open to tampering or information disclosure.</span></span> <span data-ttu-id="8419d-167">Verwenden Sie eine gesicherte Bindung, um dies zu verhindern.</span><span class="sxs-lookup"><span data-stu-id="8419d-167">To prevent this, it is recommended that you use a secured binding.</span></span>  
  
 <span data-ttu-id="8419d-168">Für die Modi "COM+-gehostet" und "Im Internet gehostet" müssen die Clientanwendungen dem Serverprozess den Identitätswechsel für den Clientbenutzer gestatten.</span><span class="sxs-lookup"><span data-stu-id="8419d-168">For the COM+-hosted and Web-hosted modes, client applications must permit the server process to impersonate the client user.</span></span> <span data-ttu-id="8419d-169">Dieser Schritt kann in [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]-Clients durch Festlegen der Identitätswechselebene auf <xref:System.Security.Principal.TokenImpersonationLevel.Impersonation> erfolgen.</span><span class="sxs-lookup"><span data-stu-id="8419d-169">This can be done in [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] clients by setting the impersonation level to <xref:System.Security.Principal.TokenImpersonationLevel.Impersonation>.</span></span>  
  
 <span data-ttu-id="8419d-170">Wenn Internetinformationsdienste (IIS) oder Windows Process Activation Service (WAS) den HTTP-Transport verwenden, kann mit dem Tool Httpcfg.exe eine Transportendpunktadresse reserviert werden.</span><span class="sxs-lookup"><span data-stu-id="8419d-170">With Internet Information Services (IIS) or Windows Process Activation Service (WAS) using the HTTP transport, the Httpcfg.exe tool can be used to reserve a transport endpoint address.</span></span> <span data-ttu-id="8419d-171">In anderen Konfigurationen ist der Schutz vor nicht autorisierten Diensten wichtig, die als der gewünschte Dienst fungieren.</span><span class="sxs-lookup"><span data-stu-id="8419d-171">In other configurations, it is important to protect against rogue services that act as the intended service.</span></span> <span data-ttu-id="8419d-172">Um den Start eines nicht autorisierten Dienstes am gewünschten Endpunkt zu verhindern, kann der legitime Dienst so konfiguriert werden, dass er als NT Dienst-ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="8419d-172">To prevent a rogue service from starting at the desired endpoint, the legitimate service can be configured to run as an NT service.</span></span> <span data-ttu-id="8419d-173">Dadurch hat der legitime Dienst vor jedem nicht autorisierten Dienst Anspruch auf die Endpunktadresse.</span><span class="sxs-lookup"><span data-stu-id="8419d-173">This enables the legitimate service to claim the endpoint address prior to any rogue services.</span></span>  
  
 <span data-ttu-id="8419d-174">Wenn Sie eine COM+-Anwendung mit konfigurierten COM+-Rollen als im Internet gehosteten Dienst verfügbar machen, muss der "Starten Sie IIS-Prozesskonto" einer der Rollen der Anwendung hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="8419d-174">When exposing a COM+ application with configured COM+ roles as a Web-hosted service, the "Launch IIS Process Account" must be added to one of the application’s roles.</span></span> <span data-ttu-id="8419d-175">Dieses Konto, in der Regel mit der Bezeichnung IWAM_computername, muss hinzugefügt werden, um das saubere Herunterfahren von Objekten nach der Verwendung zu ermöglichen.</span><span class="sxs-lookup"><span data-stu-id="8419d-175">This account, typically with the name IWAM_machinename, must be added to enable clean shutdown of objects after use.</span></span> <span data-ttu-id="8419d-176">Dem Konto sollten keine weiteren Berechtigungen gewährt werden.</span><span class="sxs-lookup"><span data-stu-id="8419d-176">The account should not be granted any additional permissions.</span></span>  
  
 <span data-ttu-id="8419d-177">Die COM+-Funktionen zur Prozesswiederverwendung können für integrierte Anwendungen nicht verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="8419d-177">The COM+ process recycling features cannot be used on integrated applications.</span></span> <span data-ttu-id="8419d-178">Wenn die Anwendung für die Verwendung der Prozesswiederverwendung konfiguriert ist und die Komponenten in einem COM+-gehosteten Prozess ausgeführt werden, tritt beim Start des Dienstes ein Fehler auf.</span><span class="sxs-lookup"><span data-stu-id="8419d-178">If the application is configured to use process recycling and the components are running in a COM+ hosted process, the service fails to start.</span></span> <span data-ttu-id="8419d-179">Diese Anforderung schließt Dienste nicht ein, die den Modus „Prozessintern im Internet gehostet“ verwenden, da die Einstellungen für die Prozesswiederverwendung nicht angewendet werden.</span><span class="sxs-lookup"><span data-stu-id="8419d-179">This requirement does not include services using the Web-hosted in-process mode because the process recycling settings are not applied.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="8419d-180">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="8419d-180">See Also</span></span>  
 [<span data-ttu-id="8419d-181">Übersicht über die Integration von COM-Anwendungen</span><span class="sxs-lookup"><span data-stu-id="8419d-181">Integrating with COM Applications Overview</span></span>](../../../../docs/framework/wcf/feature-details/integrating-with-com-applications-overview.md)
