---
title: Übersicht über WPF-Add-Ins
ms.date: 03/30/2017
helpviewer_keywords:
- add-ins and XAML browser applications [WPF]
- add-ins overview [WPF]
- add-ins [WPF], performance
- add-ins [WPF], benefits
- .NET Framework add-in model [WPF]
- add-ins [WPF], user interface
- add-ins and the user interface [WPF]
- add-ins [WPF], architecture
- add-ins [WPF], limitations
ms.assetid: 00b4c776-29a8-4dba-b603-280a0cdc2ade
ms.openlocfilehash: 2e5d133a4744124723c0373e3d5974b505936190
ms.sourcegitcommit: efff8f331fd9467f093f8ab8d23a203d6ecb5b60
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 09/01/2018
ms.locfileid: "43402100"
---
# <a name="wpf-add-ins-overview"></a><span data-ttu-id="58c2e-102">Übersicht über WPF-Add-Ins</span><span class="sxs-lookup"><span data-stu-id="58c2e-102">WPF Add-Ins Overview</span></span>
<a name="Introduction"></a> <span data-ttu-id="58c2e-103">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] beinhaltet ein Add-In-Modell, mit dem Entwickler Anwendungen erstellen können, die Add-In-Erweiterbarkeit unterstützen.</span><span class="sxs-lookup"><span data-stu-id="58c2e-103">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] includes an add-in model that developers can use to create applications that support add-in extensibility.</span></span> <span data-ttu-id="58c2e-104">Dieses Add-In-Modell ermöglicht die Erstellung von Add-Ins, die in die Anwendungsfunktionalität integriert werden und diese erweitern.</span><span class="sxs-lookup"><span data-stu-id="58c2e-104">This add-in model allows the creation of add-ins that integrate with and extend application functionality.</span></span> <span data-ttu-id="58c2e-105">In einigen Szenarien müssen Anwendungen auch [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)]s anzeigen, die von Add-Ins bereitgestellt werden. In diesem Thema wird gezeigt, wie durch [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] das Add-In-Modell von [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] erweitert wird, um diese Szenarien sowie die zugrunde liegende Architektur, die Vorteile und die Einschränkungen zu ermöglichen.</span><span class="sxs-lookup"><span data-stu-id="58c2e-105">In some scenarios, applications also need to display [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] that are provided by add-ins. This topic shows how [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] augments the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model to enable these scenarios, the architecture behind it, its benefits, and its limitations.</span></span>  
  

  
<a name="Requirements"></a>   
## <a name="prerequisites"></a><span data-ttu-id="58c2e-106">Erforderliche Komponenten</span><span class="sxs-lookup"><span data-stu-id="58c2e-106">Prerequisites</span></span>  
 <span data-ttu-id="58c2e-107">Kenntnisse des Add-In-Modells von [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] sind erforderlich.</span><span class="sxs-lookup"><span data-stu-id="58c2e-107">Familiarity with the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model is required.</span></span> <span data-ttu-id="58c2e-108">Weitere Informationen finden Sie unter [Add-Ins und Erweiterbarkeit](../../../../docs/framework/add-ins/index.md).</span><span class="sxs-lookup"><span data-stu-id="58c2e-108">For more information, see [Add-ins and Extensibility](../../../../docs/framework/add-ins/index.md).</span></span>  
  
<a name="AddInsOverview"></a>   
## <a name="add-ins-overview"></a><span data-ttu-id="58c2e-109">Übersicht über Add-Ins</span><span class="sxs-lookup"><span data-stu-id="58c2e-109">Add-Ins Overview</span></span>  
 <span data-ttu-id="58c2e-110">Um das mit dem Integrieren neuer Funktionen verbundene erneute Kompilieren und Bereitstellen von Anwendungen zu vermeiden, da diese Vorgänge sehr komplex sind, sind Anwendungen mit Erweiterbarkeitsmechanismen ausgestattet. Diese ermöglichen Entwicklern (sowohl Erst- als auch Drittanbieter) das Erstellen anderer Anwendungen, die integriert werden können.</span><span class="sxs-lookup"><span data-stu-id="58c2e-110">In order to avoid the complexities of application recompilation and redeployment to incorporate new functionality, applications implement extensibility mechanisms that allow developers (both first-party and third-party) to create other applications that integrate with them.</span></span> <span data-ttu-id="58c2e-111">Diese Art von Erweiterbarkeit wird in der Regel durch die Verwendung von Add-Ins (auch als „Add-Ons“ oder „Plug-Ins“ bezeichnet) unterstützt.</span><span class="sxs-lookup"><span data-stu-id="58c2e-111">The most common way to support this type of extensibility is through the use of add-ins (also known as "add-ons" and "plug-ins").</span></span> <span data-ttu-id="58c2e-112">Es folgen Beispiele für reale Anwendungen, die eine Erweiterbarkeit mit Add-Ins verfügbar machen:</span><span class="sxs-lookup"><span data-stu-id="58c2e-112">Examples of real-world applications that expose extensibility with add-ins include:</span></span>  
  
-   <span data-ttu-id="58c2e-113">Internet Explorer-Add-Ons</span><span class="sxs-lookup"><span data-stu-id="58c2e-113">Internet Explorer add-ons.</span></span>  
  
-   <span data-ttu-id="58c2e-114">Windows Media Player-Plug-Ins</span><span class="sxs-lookup"><span data-stu-id="58c2e-114">Windows Media Player plug-ins.</span></span>  
  
-   <span data-ttu-id="58c2e-115">Visual Studio-Add-Ins</span><span class="sxs-lookup"><span data-stu-id="58c2e-115">Visual Studio add-ins.</span></span>  
  
 <span data-ttu-id="58c2e-116">Beispielsweise können Drittanbieterentwickler mithilfe des Add-In-Modells von Windows Media Player „Plug-Ins“ implementieren, durch die der Windows Media Player auf vielfältige Weise erweitert wird. Dazu zählen das Erstellen von Decodern und Encodern für Medienformate, für die keine systemeigene Unterstützung durch Windows Media Player besteht (z. B. DVD, MP3), Audioeffekte und Skins.</span><span class="sxs-lookup"><span data-stu-id="58c2e-116">For example, the Windows Media Player add-in model allows third-party developers to implement "plug-ins" that extend Windows Media Player in a variety of ways, including creating decoders and encoders for media formats that are not supported natively by Windows Media Player (for example, DVD, MP3), audio effects, and skins.</span></span> <span data-ttu-id="58c2e-117">Jedes Add-In-Modell ist so aufgebaut, dass es die zu einer Anwendung gehörenden Funktionen verfügbar macht, obwohl verschiedene Entitäten und Verhaltensweisen für alle Add-In-Modelle gelten.</span><span class="sxs-lookup"><span data-stu-id="58c2e-117">Each add-in model is built to expose the functionality that is unique to an application, although there are several entities and behaviors that are common to all add-in models.</span></span>  
  
 <span data-ttu-id="58c2e-118">Die drei Hauptentitäten typischer Add-In-Erweiterbarkeitslösungen sind *Verträge*, *Add-Ins* und *Hostanwendungen*.</span><span class="sxs-lookup"><span data-stu-id="58c2e-118">The three main entities of typical add-in extensibility solutions are *contracts*, *add-ins*, and *host applications*.</span></span> <span data-ttu-id="58c2e-119">Mit Verträgen wird auf zwei Arten definiert, wie Add-Ins mit Hostanwendungen integriert sind:</span><span class="sxs-lookup"><span data-stu-id="58c2e-119">Contracts define how add-ins integrate with host applications in two ways:</span></span>  
  
-   <span data-ttu-id="58c2e-120">Add-Ins sind in Funktionen integriert, die von Hostanwendungen implementiert werden.</span><span class="sxs-lookup"><span data-stu-id="58c2e-120">Add-ins integrate with functionality that is implemented by host applications.</span></span>  
  
-   <span data-ttu-id="58c2e-121">Hostanwendungen machen Funktionen verfügbar, in die Add-Ins integriert werden.</span><span class="sxs-lookup"><span data-stu-id="58c2e-121">Host applications expose functionality for add-ins to integrate with.</span></span>  
  
 <span data-ttu-id="58c2e-122">Damit Add-Ins verwendet werden können, müssen sie von Hostanwendungen gefunden und zur Laufzeit geladen werden.</span><span class="sxs-lookup"><span data-stu-id="58c2e-122">In order for add-ins to be used, host applications need to find them and load them at run time.</span></span> <span data-ttu-id="58c2e-123">Daher sind Anwendungen, die Add-Ins unterstützen, zusätzlich für folgende Aufgaben verantwortlich:</span><span class="sxs-lookup"><span data-stu-id="58c2e-123">Consequently, applications that support add-ins have the following additional responsibilities:</span></span>  
  
-   <span data-ttu-id="58c2e-124">**Ermittlung**: Suchen nach Add-Ins, die von Hostanwendungen unterstützte Verträge einhalten.</span><span class="sxs-lookup"><span data-stu-id="58c2e-124">**Discovery**: Finding add-ins that adhere to contracts supported by host applications.</span></span>  
  
-   <span data-ttu-id="58c2e-125">**Aktivierung**: Laden, Ausführen und Herstellen der Kommunikation mit Add-Ins.</span><span class="sxs-lookup"><span data-stu-id="58c2e-125">**Activation**: Loading, running, and establishing communication with add-ins.</span></span>  
  
-   <span data-ttu-id="58c2e-126">**Isolation**: Verwenden von Anwendungsdomänen oder Prozessen zum Einrichten von Isolationsgrenzen, die Anwendungen vor möglichen Sicherheitsproblemen und Problemen bei der Ausführung von Add-Ins schützen.</span><span class="sxs-lookup"><span data-stu-id="58c2e-126">**Isolation**: Using either application domains or processes to establish isolation boundaries that protect applications from potential security and execution problems with add-ins.</span></span>  
  
-   <span data-ttu-id="58c2e-127">**Kommunikation**: Durch das Aufrufen von Methoden und Übergeben von Daten können Add-Ins und Hostanwendungen über Isolationsgrenzen hinweg miteinander kommunizieren.</span><span class="sxs-lookup"><span data-stu-id="58c2e-127">**Communication**: Allowing add-ins and host applications to communicate with each other across isolation boundaries by calling methods and passing data.</span></span>  
  
-   <span data-ttu-id="58c2e-128">**Verwaltung der Lebensdauer**: Laden und Entladen von Anwendungsdomänen und -prozessen auf eine klare, vorhersehbare Weise (siehe [Anwendungsdomänen](../../../../docs/framework/app-domains/application-domains.md)).</span><span class="sxs-lookup"><span data-stu-id="58c2e-128">**Lifetime Management**: Loading and unloading application domains and processes in a clean, predictable manner (see [Application Domains](../../../../docs/framework/app-domains/application-domains.md)).</span></span>  
  
-   <span data-ttu-id="58c2e-129">**Versionsverwaltung**: Sicherstellen, dass Hostanwendungen und Add-Ins auch dann noch kommunizieren können, wenn neue Versionen erstellt wurden.</span><span class="sxs-lookup"><span data-stu-id="58c2e-129">**Versioning**: Ensuring that host applications and add-ins can still communicate when new versions of either are created.</span></span>  
  
 <span data-ttu-id="58c2e-130">Letztlich ist es eine wichtige Aufgabe, ein stabiles Add-In-Modell zu entwickeln.</span><span class="sxs-lookup"><span data-stu-id="58c2e-130">Ultimately, developing a robust add-in model is a non-trivial undertaking.</span></span> <span data-ttu-id="58c2e-131">Aus diesem Grund stellt [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] eine Infrastruktur zum Erstellen von Add-In-Modellen bereit.</span><span class="sxs-lookup"><span data-stu-id="58c2e-131">For this reason, the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] provides an infrastructure for building add-in models.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="58c2e-132">Weitere Informationen zu Add-Ins finden Sie unter [Add-Ins und Erweiterbarkeit](../../../../docs/framework/add-ins/index.md).</span><span class="sxs-lookup"><span data-stu-id="58c2e-132">For more detailed information on add-ins, see [Add-ins and Extensibility](../../../../docs/framework/add-ins/index.md).</span></span>  
  
<a name="NETFrameworkAddInModelOverview"></a>   
## <a name="net-framework-add-in-model-overview"></a><span data-ttu-id="58c2e-133">Übersicht über das Add-In-Modell von .NET Framework</span><span class="sxs-lookup"><span data-stu-id="58c2e-133">.NET Framework Add-In Model Overview</span></span>  
 <span data-ttu-id="58c2e-134">Die [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Add-In-Modell finden Sie in der <xref:System.AddIn> -Namespace enthält eine Reihe von Typen, die zur Vereinfachung der Entwicklung der Add-in-Erweiterbarkeit entworfen wurden.</span><span class="sxs-lookup"><span data-stu-id="58c2e-134">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model, found in the <xref:System.AddIn> namespace, contains a set of types that are designed to simplify the development of add-in extensibility.</span></span> <span data-ttu-id="58c2e-135">Das Fundament des Add-In-Modells von [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] stellt der *Vertrag* dar. Dort ist festgelegt, wie eine Hostanwendung und ein Add-In miteinander kommunizieren.</span><span class="sxs-lookup"><span data-stu-id="58c2e-135">The fundamental unit of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model is the *contract*, which defines how a host application and an add-in communicate with each other.</span></span> <span data-ttu-id="58c2e-136">Ein Vertrag wird mit einer für Hostanwendungen spezifischen *Ansicht* des Vertrags für eine Hostanwendung verfügbar gemacht.</span><span class="sxs-lookup"><span data-stu-id="58c2e-136">A contract is exposed to a host application using a host-application-specific *view* of the contract.</span></span> <span data-ttu-id="58c2e-137">Auf ähnliche Weise wird eine für Add-Ins spezifische *Ansicht* des Vertrags für das Add-In verfügbar gemacht.</span><span class="sxs-lookup"><span data-stu-id="58c2e-137">Likewise, an add-in-specific *view* of the contract is exposed to the add-in.</span></span> <span data-ttu-id="58c2e-138">Ein *Adapter* ermöglicht es einer Hostanwendung und einem Add-In, zwischen ihren jeweiligen Ansichten des Vertrags miteinander zu kommunizieren.</span><span class="sxs-lookup"><span data-stu-id="58c2e-138">An *adapter* is used to allow a host application and an add-in to communicate between their respective views of the contract.</span></span> <span data-ttu-id="58c2e-139">Verträge, Ansichten und Adapter werden als Segmente bezeichnet, und mehrere miteinander verbundene Segmente stellen eine *Pipeline* dar.</span><span class="sxs-lookup"><span data-stu-id="58c2e-139">Contracts, views, and adapters are referred to as segments, and a set of related segments constitutes a *pipeline*.</span></span> <span data-ttu-id="58c2e-140">Pipelines sind die Grundlage, wenn es für das Add-In-Modell von [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] darum geht, Aufgaben wie Ermittlung, Aktivierung, Sicherheitsisolation, Ausführungsisolation (unter Verwendung von Anwendungsdomänen und -prozessen), Kommunikation, Verwaltung der Lebensdauer und Versionsverwaltung zu unterstützen.</span><span class="sxs-lookup"><span data-stu-id="58c2e-140">Pipelines are the foundation upon which the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model supports discovery, activation, security isolation, execution isolation (using both application domains and processes), communication, lifetime management, and versioning.</span></span>  
  
 <span data-ttu-id="58c2e-141">Mit dieser Unterstützung können Entwickler Add-Ins erstellen, die mit den Funktionen einer Hostanwendung integriert werden.</span><span class="sxs-lookup"><span data-stu-id="58c2e-141">The sum of this support allows developers to build add-ins that integrate with the functionality of a host application.</span></span> <span data-ttu-id="58c2e-142">In einigen Szenarien müssen Hostanwendungen die von Add-Ins bereitgestellten [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)]s anzeigen. Da jede Präsentationstechnologie in [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] über ein eigenes Modell zum Implementieren von [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)]s verfügt, unterstützt das Add-In-Modell von [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] keine bestimmte Präsentationstechnologie.</span><span class="sxs-lookup"><span data-stu-id="58c2e-142">However, some scenarios require host applications to display [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] provided by add-ins. Because each presentation technology in the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] has its own model for implementing [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)], the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model does not support any particular presentation technology.</span></span> <span data-ttu-id="58c2e-143">Stattdessen erweitert [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] das Add-In-Modell von [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] um [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]-Unterstützung für Add-Ins.</span><span class="sxs-lookup"><span data-stu-id="58c2e-143">Instead, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] extends the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model with [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] support for add-ins.</span></span>  
  
<a name="WPFAddInModel"></a>   
## <a name="wpf-add-ins"></a><span data-ttu-id="58c2e-144">WPF-Add-Ins</span><span class="sxs-lookup"><span data-stu-id="58c2e-144">WPF Add-Ins</span></span>  
 <span data-ttu-id="58c2e-145">Wenn Sie [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] in Verbindung mit dem Add-In-Modell von [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] verwenden, können Sie den unterschiedlichsten Szenarien gerecht werden, in denen Hostanwendungen [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)]s aus Add-Ins anzeigen müssen. Für diese Szenarien eignet sich insbesondere [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] mit den folgenden zwei Programmiermodellen:</span><span class="sxs-lookup"><span data-stu-id="58c2e-145">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], in conjunction with the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model, allows you to address a wide variety of scenarios that require host applications to display [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] from add-ins. In particular, these scenarios are addressed by [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] with the following two programming models:</span></span>  
  
1.  <span data-ttu-id="58c2e-146">**Das Add-In gibt eine Benutzeroberfläche zurück**.</span><span class="sxs-lookup"><span data-stu-id="58c2e-146">**The add-in returns a UI**.</span></span> <span data-ttu-id="58c2e-147">Wie im Vertrag definiert, gibt ein Add-In über einen Methodenaufruf eine [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] an die Hostanwendung zurück.</span><span class="sxs-lookup"><span data-stu-id="58c2e-147">An add-in returns a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] to the host application via a method call, as defined by the contract.</span></span> <span data-ttu-id="58c2e-148">Das Szenario wird in den folgenden Fällen verwendet:</span><span class="sxs-lookup"><span data-stu-id="58c2e-148">This scenario is used in the following cases:</span></span>  
  
    -   <span data-ttu-id="58c2e-149">Die Darstellung einer vom Add-In zurückgegebenen [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] hängt von den zur Laufzeit vorhandenen Daten oder Bedingungen ab, z. B. von dynamisch generierten Berichten.</span><span class="sxs-lookup"><span data-stu-id="58c2e-149">The appearance of a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that is returned by an add-in is dependent on either data or conditions that exist only at run time, such as dynamically generated reports.</span></span>  
  
    -   <span data-ttu-id="58c2e-150">Die [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] für durch ein Add-In bereitgestellte Dienste unterscheidet sich von der [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] der Hostanwendungen, die das Add-In verwenden können.</span><span class="sxs-lookup"><span data-stu-id="58c2e-150">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] for services provided by an add-in differs from the [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] of the host applications that can use the add-in.</span></span>  
  
    -   <span data-ttu-id="58c2e-151">Das Add-In führt in erster Linie einen Dienst für die Hostanwendung aus und meldet den Status an die Hostanwendung mit einer [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span><span class="sxs-lookup"><span data-stu-id="58c2e-151">The add-in primarily performs a service for the host application, and reports status to the host application with a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span>  
  
2.  <span data-ttu-id="58c2e-152">**Das Add-In ist eine Benutzeroberfläche**.</span><span class="sxs-lookup"><span data-stu-id="58c2e-152">**The add-in is a UI**.</span></span> <span data-ttu-id="58c2e-153">Ein Add-In ist eine [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], wie im Vertrag definiert.</span><span class="sxs-lookup"><span data-stu-id="58c2e-153">An add-in is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], as defined by the contract.</span></span> <span data-ttu-id="58c2e-154">Das Szenario wird in den folgenden Fällen verwendet:</span><span class="sxs-lookup"><span data-stu-id="58c2e-154">This scenario is used in the following cases:</span></span>  
  
    -   <span data-ttu-id="58c2e-155">Ein Add-In stellt ausschließlich die angezeigten Dienste bereit, z. B. eine Werbung.</span><span class="sxs-lookup"><span data-stu-id="58c2e-155">An add-in doesn't provide services other than being displayed, such as an advertisement.</span></span>  
  
    -   <span data-ttu-id="58c2e-156">Die [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] für von einem Add-In bereitgestellte Dienste wird von allen Hostanwendungen genutzt, die das Add-In verwenden können, z. B. Rechner oder Farbauswahl.</span><span class="sxs-lookup"><span data-stu-id="58c2e-156">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] for services provided by an add-in is common to all host applications that can use that add-in, such as a calculator or color picker.</span></span>  
  
 <span data-ttu-id="58c2e-157">In diesen Szenarien ist es erforderlich, dass [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]-Objekte zwischen den Domänen der Hostanwendung und der Add-In-Anwendung übergeben werden können.</span><span class="sxs-lookup"><span data-stu-id="58c2e-157">These scenarios require that [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] objects can be passed between host application and add-in application domains.</span></span> <span data-ttu-id="58c2e-158">Da beim Add-In-Modell von [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] für die Kommunikation zwischen Anwendungsdomänen Remoting erforderlich ist, müssen die übergebenen Objekte remotefähig sein.</span><span class="sxs-lookup"><span data-stu-id="58c2e-158">Since the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model relies on remoting to communicate between application domains, the objects that are passed between them must be remotable.</span></span>  
  
 <span data-ttu-id="58c2e-159">Ein remotefähiges Objekt stellt die Instanz einer Klasse dar, für die eine oder mehrere der folgenden Aussagen gelten:</span><span class="sxs-lookup"><span data-stu-id="58c2e-159">A remotable object is an instance of a class that does one or more of the following:</span></span>  
  
-   <span data-ttu-id="58c2e-160">Leitet sich von der <xref:System.MarshalByRefObject> Klasse.</span><span class="sxs-lookup"><span data-stu-id="58c2e-160">Derives from the <xref:System.MarshalByRefObject> class.</span></span>  
  
-   <span data-ttu-id="58c2e-161">Implementiert die <xref:System.Runtime.Serialization.ISerializable>-Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="58c2e-161">Implements the <xref:System.Runtime.Serialization.ISerializable> interface.</span></span>  
  
-   <span data-ttu-id="58c2e-162">Hat die <xref:System.SerializableAttribute> -Attribut.</span><span class="sxs-lookup"><span data-stu-id="58c2e-162">Has the <xref:System.SerializableAttribute> attribute applied.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="58c2e-163">Weitere Informationen über das Erstellen von remotefähigen [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]-Objekten finden Sie unter [Erstellen remotefähiger Objekte](https://msdn.microsoft.com/library/01197253-3f13-43b7-894d-9683e431192a).</span><span class="sxs-lookup"><span data-stu-id="58c2e-163">For more information regarding the creation of remotable [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] objects, see [Making Objects Remotable](https://msdn.microsoft.com/library/01197253-3f13-43b7-894d-9683e431192a).</span></span>  
  
 <span data-ttu-id="58c2e-164">Die [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]-Typen von [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] sind nicht remotefähig.</span><span class="sxs-lookup"><span data-stu-id="58c2e-164">The [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] types are not remotable.</span></span> <span data-ttu-id="58c2e-165">Um das Problem zu beheben, erweitert [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] das Add-In-Modell von [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)], damit die durch Add-Ins erstellte [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]-[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] von Hostanwendungen angezeigt werden kann.</span><span class="sxs-lookup"><span data-stu-id="58c2e-165">To solve the problem, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] extends the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model to enable [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] created by add-ins to be displayed from host applications.</span></span> <span data-ttu-id="58c2e-166">Diese Unterstützung erfolgt über [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] durch zwei Arten: die <xref:System.AddIn.Contract.INativeHandleContract> Schnittstelle und zwei statische Methoden implementiert, indem die <xref:System.AddIn.Pipeline.FrameworkElementAdapters> Klasse: <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> und <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="58c2e-166">This support is provided by [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] by two types: the <xref:System.AddIn.Contract.INativeHandleContract> interface and two static methods implemented by the <xref:System.AddIn.Pipeline.FrameworkElementAdapters> class: <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span></span> <span data-ttu-id="58c2e-167">Im Allgemeinen werden diese Typen und Methoden wie folgt verwendet:</span><span class="sxs-lookup"><span data-stu-id="58c2e-167">At a high level, these types and methods are used in the following manner:</span></span>  
  
1.  [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]<span data-ttu-id="58c2e-168"> erfordert, dass [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] gebotenen-add-ins sind Klassen, die direkt oder indirekt abgeleitet <xref:System.Windows.FrameworkElement>, z. B. Formen, Steuerelemente, Benutzersteuerelemente, Layoutbereiche und Seiten.</span><span class="sxs-lookup"><span data-stu-id="58c2e-168"> requires that [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] provided by add-ins are classes that derive directly or indirectly from <xref:System.Windows.FrameworkElement>, such as shapes, controls, user controls, layout panels, and pages.</span></span>  
  
2.  <span data-ttu-id="58c2e-169">Wenn der Vertrag deklariert, dass eine Benutzeroberfläche zwischen den Add-in und der hostanwendung übergeben wird, muss es als deklariert werden ein <xref:System.AddIn.Contract.INativeHandleContract> (keinen <xref:System.Windows.FrameworkElement>); <xref:System.AddIn.Contract.INativeHandleContract> ist eine remotefähige Darstellung des Add-Ins [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] , die über Isolationsgrenzen hinweg übergeben werden kann.</span><span class="sxs-lookup"><span data-stu-id="58c2e-169">Wherever the contract declares that a UI will be passed between the add-in and the host application, it must be declared as an <xref:System.AddIn.Contract.INativeHandleContract> (not a <xref:System.Windows.FrameworkElement>); <xref:System.AddIn.Contract.INativeHandleContract> is a remotable representation of the add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that can be passed across isolation boundaries.</span></span>  
  
3.  <span data-ttu-id="58c2e-170">Vor der Weitergabe von das Add-in die Anwendungsdomäne, einem <xref:System.Windows.FrameworkElement> als gepackt ein <xref:System.AddIn.Contract.INativeHandleContract> durch Aufrufen von <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="58c2e-170">Before being passed from the add-in's application domain, a <xref:System.Windows.FrameworkElement> is packaged as an <xref:System.AddIn.Contract.INativeHandleContract> by calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span></span>  
  
4.  <span data-ttu-id="58c2e-171">Nach dem übergeben an die Anwendungsdomäne der hostanwendung, die <xref:System.AddIn.Contract.INativeHandleContract> neu verpackt werden müssen, als eine <xref:System.Windows.FrameworkElement> durch Aufrufen von <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="58c2e-171">After being passed to the host application's application domain, the <xref:System.AddIn.Contract.INativeHandleContract> must be repackaged as a <xref:System.Windows.FrameworkElement> by calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>.</span></span>  
  
 <span data-ttu-id="58c2e-172">Wie <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>, und <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> werden verwendet, nach dem jeweiligen Szenario abhängt.</span><span class="sxs-lookup"><span data-stu-id="58c2e-172">How <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>, and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> are used depends on the specific scenario.</span></span> <span data-ttu-id="58c2e-173">Die folgenden Abschnitte bieten ausführliche Informationen zu den Programmiermodellen.</span><span class="sxs-lookup"><span data-stu-id="58c2e-173">The following sections provide details for each programming model.</span></span>  
  
<a name="ReturnUIFromAddInContract"></a>   
## <a name="add-in-returns-a-user-interface"></a><span data-ttu-id="58c2e-174">Add-In gibt eine Benutzeroberfläche zurück</span><span class="sxs-lookup"><span data-stu-id="58c2e-174">Add-In Returns a User Interface</span></span>  
 <span data-ttu-id="58c2e-175">Damit ein Add-In eine [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] an eine Hostanwendung zurückgeben kann, müssen folgende Voraussetzungen erfüllt sein:</span><span class="sxs-lookup"><span data-stu-id="58c2e-175">For an add-in to return a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] to a host application, the following are required:</span></span>  
  
1.  <span data-ttu-id="58c2e-176">Hostanwendung, Add-In und Pipeline müssen erstellt worden sein, wie in der [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]-Dokumentation unter [Add-Ins und Erweiterbarkeit](../../../../docs/framework/add-ins/index.md) beschrieben.</span><span class="sxs-lookup"><span data-stu-id="58c2e-176">The host application, add-in, and pipeline must be created, as described by the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] [Add-ins and Extensibility](../../../../docs/framework/add-ins/index.md) documentation.</span></span>  
  
2.  <span data-ttu-id="58c2e-177">Der Vertrag implementieren muss <xref:System.AddIn.Contract.IContract> zum Zurückgeben einer [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], der Vertrag muss eine Methode mit einem Rückgabewert vom Typ deklarieren <xref:System.AddIn.Contract.INativeHandleContract>.</span><span class="sxs-lookup"><span data-stu-id="58c2e-177">The contract must implement <xref:System.AddIn.Contract.IContract> and, to return a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], the contract must declare a method with a return value of type <xref:System.AddIn.Contract.INativeHandleContract>.</span></span>  
  
3.  <span data-ttu-id="58c2e-178">Die [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] übergebene zwischen das Add-in und dem Host Anwendung muss direkt oder indirekt von abgeleitet werden <xref:System.Windows.FrameworkElement>.</span><span class="sxs-lookup"><span data-stu-id="58c2e-178">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that is passed between the add-in and the host application must directly or indirectly derive from <xref:System.Windows.FrameworkElement>.</span></span>  
  
4.  <span data-ttu-id="58c2e-179">Die [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] von zurückgegebenen des Add-Ins muss von konvertiert werden eine <xref:System.Windows.FrameworkElement> auf eine <xref:System.AddIn.Contract.INativeHandleContract> vor dem Überschreiten der Isolationsgrenze.</span><span class="sxs-lookup"><span data-stu-id="58c2e-179">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that is returned by the add-in must be converted from a <xref:System.Windows.FrameworkElement> to an <xref:System.AddIn.Contract.INativeHandleContract> before crossing the isolation boundary.</span></span>  
  
5.  <span data-ttu-id="58c2e-180">Die [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] zurückgegeben wird, muss eine Konvertierung von einer <xref:System.AddIn.Contract.INativeHandleContract> auf eine <xref:System.Windows.FrameworkElement> nach dem Überschreiten der Isolationsgrenze.</span><span class="sxs-lookup"><span data-stu-id="58c2e-180">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that is returned must be converted from an <xref:System.AddIn.Contract.INativeHandleContract> to a <xref:System.Windows.FrameworkElement> after crossing the isolation boundary.</span></span>  
  
6.  <span data-ttu-id="58c2e-181">Die hostanwendung zeigt das zurückgegebene <xref:System.Windows.FrameworkElement>.</span><span class="sxs-lookup"><span data-stu-id="58c2e-181">The host application displays the returned <xref:System.Windows.FrameworkElement>.</span></span>  
  
 <span data-ttu-id="58c2e-182">Ein Beispiel dafür, wie ein Add-In, das eine [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] zurückgibt, implementiert wird, finden Sie unter [Gewusst wie: Erstellen eines Add-Ins, das eine Benutzeroberfläche zurückgibt](../../../../docs/framework/wpf/app-development/how-to-create-an-add-in-that-returns-a-ui.md).</span><span class="sxs-lookup"><span data-stu-id="58c2e-182">For an example that demonstrates how to implement an add-in that returns a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], see [Create an Add-In That Returns a UI](../../../../docs/framework/wpf/app-development/how-to-create-an-add-in-that-returns-a-ui.md).</span></span>  
  
<a name="AddInIsAUI"></a>   
## <a name="add-in-is-a-user-interface"></a><span data-ttu-id="58c2e-183">Add-In ist eine Benutzeroberfläche</span><span class="sxs-lookup"><span data-stu-id="58c2e-183">Add-In Is a User Interface</span></span>  
 <span data-ttu-id="58c2e-184">Wenn ein Add-In eine [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] ist, gelten die folgenden Voraussetzungen:</span><span class="sxs-lookup"><span data-stu-id="58c2e-184">When an add-in is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], the following are required:</span></span>  
  
1.  <span data-ttu-id="58c2e-185">Hostanwendung, Add-In und Pipeline müssen erstellt worden sein, wie in der [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]-Dokumentation unter [Add-Ins und Erweiterbarkeit](../../../../docs/framework/add-ins/index.md) beschrieben.</span><span class="sxs-lookup"><span data-stu-id="58c2e-185">The host application, add-in, and pipeline must be created, as described by the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] [Add-ins and Extensibility](../../../../docs/framework/add-ins/index.md) documentation.</span></span>  
  
2.  <span data-ttu-id="58c2e-186">Die Vertragsschnittstelle für das Add-in muss implementieren <xref:System.AddIn.Contract.INativeHandleContract>.</span><span class="sxs-lookup"><span data-stu-id="58c2e-186">The contract interface for the add-in must implement <xref:System.AddIn.Contract.INativeHandleContract>.</span></span>  
  
3.  <span data-ttu-id="58c2e-187">Das Add-in, das an die hostanwendung übergeben wird muss direkt oder indirekt von abgeleitet werden <xref:System.Windows.FrameworkElement>.</span><span class="sxs-lookup"><span data-stu-id="58c2e-187">The add-in that is passed to the host application must directly or indirectly derive from <xref:System.Windows.FrameworkElement>.</span></span>  
  
4.  <span data-ttu-id="58c2e-188">Das Add-in muss konvertiert werden, aus einer <xref:System.Windows.FrameworkElement> zu ein <xref:System.AddIn.Contract.INativeHandleContract> vor dem Überschreiten der Isolationsgrenze.</span><span class="sxs-lookup"><span data-stu-id="58c2e-188">The add-in must be converted from a <xref:System.Windows.FrameworkElement> to an <xref:System.AddIn.Contract.INativeHandleContract> before crossing the isolation boundary.</span></span>  
  
5.  <span data-ttu-id="58c2e-189">Das Add-in muss von konvertiert werden ein <xref:System.AddIn.Contract.INativeHandleContract> auf eine <xref:System.Windows.FrameworkElement> nach dem Überschreiten der Isolationsgrenze.</span><span class="sxs-lookup"><span data-stu-id="58c2e-189">The add-in must be converted from an <xref:System.AddIn.Contract.INativeHandleContract> to a <xref:System.Windows.FrameworkElement> after crossing the isolation boundary.</span></span>  
  
6.  <span data-ttu-id="58c2e-190">Die hostanwendung zeigt das zurückgegebene <xref:System.Windows.FrameworkElement>.</span><span class="sxs-lookup"><span data-stu-id="58c2e-190">The host application displays the returned <xref:System.Windows.FrameworkElement>.</span></span>  
  
 <span data-ttu-id="58c2e-191">Ein Beispiel, in dem das Implementieren eines Add-Ins veranschaulicht wird, bei dem es sich um eine [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] handelt, finden Sie unter [Gewusst wie: Erstellen eines Add-Ins, das eine Benutzeroberfläche ist](../../../../docs/framework/wpf/app-development/how-to-create-an-add-in-that-is-a-ui.md).</span><span class="sxs-lookup"><span data-stu-id="58c2e-191">For an example that demonstrates how to implement an add-in that is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], see [Create an Add-In That Is a UI](../../../../docs/framework/wpf/app-development/how-to-create-an-add-in-that-is-a-ui.md).</span></span>  
  
<a name="ReturningMultipleUIsFromAnAddIn"></a>   
## <a name="returning-multiple-uis-from-an-add-in"></a><span data-ttu-id="58c2e-192">Zurückgeben mehrerer Benutzeroberflächen durch ein Add-In</span><span class="sxs-lookup"><span data-stu-id="58c2e-192">Returning Multiple UIs from an Add-In</span></span>  
 <span data-ttu-id="58c2e-193">Add-Ins stellen oft mehrere [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)]s zur Verfügung, die Hostanwendungen anzeigen können.</span><span class="sxs-lookup"><span data-stu-id="58c2e-193">Add-ins often provide multiple [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] for host applications to display.</span></span> <span data-ttu-id="58c2e-194">Betrachten Sie beispielsweise ein Add-In, das eine [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] ist, die auch Statusinformationen für die Hostanwendung bereitstellt, gleichzeitig als eine [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span><span class="sxs-lookup"><span data-stu-id="58c2e-194">For example, consider an add-in that is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that also provides status information to the host application, also as a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span> <span data-ttu-id="58c2e-195">Sie können ein Add-In dieser Art implementieren, indem Sie eine Kombination der Verfahren aus den Modellen [Add-In gibt eine Benutzeroberfläche zurück](#ReturnUIFromAddInContract) und [Add-In ist eine Benutzeroberfläche](#AddInIsAUI) verwenden.</span><span class="sxs-lookup"><span data-stu-id="58c2e-195">An add-in like this can be implemented by using a combination of techniques from both the [Add-In Returns a User Interface](#ReturnUIFromAddInContract) and [Add-In Is a User Interface](#AddInIsAUI) models.</span></span>  
  
<a name="AddInsAndXBAPs"></a>   
## <a name="add-ins-and-xaml-browser-applications"></a><span data-ttu-id="58c2e-196">Add-Ins und XAML-Browseranwendungen</span><span class="sxs-lookup"><span data-stu-id="58c2e-196">Add-Ins and XAML Browser Applications</span></span>  
 <span data-ttu-id="58c2e-197">In den bisherigen Beispielen wurde die Hostanwendung als eigenständige Anwendung installiert.</span><span class="sxs-lookup"><span data-stu-id="58c2e-197">In the examples so far, the host application has been an installed standalone application.</span></span> <span data-ttu-id="58c2e-198">[!INCLUDE[TLA#tla_xbap#plural](../../../../includes/tlasharptla-xbapsharpplural-md.md)]-Browseranwendungen können jedoch auch Add-Ins hosten, wobei allerdings die folgenden zusätzlichen Erstellungs- und Implementierungsanforderungen gelten:</span><span class="sxs-lookup"><span data-stu-id="58c2e-198">But [!INCLUDE[TLA#tla_xbap#plural](../../../../includes/tlasharptla-xbapsharpplural-md.md)] can also host add-ins, albeit with the following additional build and implementation requirements:</span></span>  
  
-   <span data-ttu-id="58c2e-199">Das [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)]-Anwendungsmanifest muss so konfiguriert sein, dass Pipeline- (Ordner und Assemblys) und Add-In-Assembly in den [!INCLUDE[TLA#tla_clickonce](../../../../includes/tlasharptla-clickonce-md.md)]-Anwendungscache auf dem Clientcomputer heruntergeladen werden, und zwar in denselben Ordner wie [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)].</span><span class="sxs-lookup"><span data-stu-id="58c2e-199">The [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] application manifest must be configured specially to download the pipeline (folders and assemblies) and add-in assembly to the [!INCLUDE[TLA#tla_clickonce](../../../../includes/tlasharptla-clickonce-md.md)] application cache on the client machine, in the same folder as the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)].</span></span>  
  
-   <span data-ttu-id="58c2e-200">Der [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)]-Code zum Ermitteln und Laden von Add-Ins muss den [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)]-Anwendungscache für [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] als Speicherort für Pipeline und Add-In verwenden.</span><span class="sxs-lookup"><span data-stu-id="58c2e-200">The [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] code to discover and load add-ins must use the [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] application cache for the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] as the pipeline and add-in location.</span></span>  
  
-   <span data-ttu-id="58c2e-201">[!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] muss das Add-In in einen speziellen Sicherheitskontext laden, wenn das Add-In auf lose Dateien verweist, die sich auf der Ursprungssite befinden. Wenn sie von [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)]s gehostet werden, können Add-Ins nur auf lose Dateien verweisen, die auf der Ursprungssite der Hostanwendung gespeichert sind.</span><span class="sxs-lookup"><span data-stu-id="58c2e-201">The [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] must load the add-in into a special security context if the add-in references loose files that are located at the site of origin; when hosted by [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)], add-ins can only reference loose files that are located at the host application's site of origin.</span></span>  
  
 <span data-ttu-id="58c2e-202">In den folgenden Unterabschnitten werden diese Aufgaben ausführlich beschrieben.</span><span class="sxs-lookup"><span data-stu-id="58c2e-202">These tasks are described in detail in the following subsections.</span></span>  
  
### <a name="configuring-the-pipeline-and-add-in-for-clickonce-deployment"></a><span data-ttu-id="58c2e-203">Konfigurieren der Pipeline und des Add-Ins für die ClickOnce-Bereitstellung</span><span class="sxs-lookup"><span data-stu-id="58c2e-203">Configuring the Pipeline and Add-In for ClickOnce Deployment</span></span>  
 [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)]<span data-ttu-id="58c2e-204">s werden in einen sicheren Ordner heruntergeladen und von dort aus im [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)]-Bereitstellungscache ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="58c2e-204"> are downloaded to and run from a safe folder in the [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] deployment cache.</span></span> <span data-ttu-id="58c2e-205">Damit eine [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] ein Add-In hosten kann, müssen auch Pipeline- und Add-In-Assembly in den sicheren Ordner heruntergeladen werden.</span><span class="sxs-lookup"><span data-stu-id="58c2e-205">In order for an [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] to host an add-in, the pipeline and add-in assembly must also be downloaded to the safe folder.</span></span> <span data-ttu-id="58c2e-206">Um dies zu erreichen, müssen Sie das Anwendungsmanifest so konfigurieren, dass sowohl die Pipeline- als auch die Add-In-Assembly heruntergeladen wird.</span><span class="sxs-lookup"><span data-stu-id="58c2e-206">To achieve this, you need to configure the application manifest to include both the pipeline and add-in assembly for download.</span></span> <span data-ttu-id="58c2e-207">Diese Aufgabe lässt sich am einfachsten in [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] ausführen, obwohl Pipeline- und Add-In-Assembly im Stammordner des [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)]-Hostprojekts gespeichert sein müssen, damit [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] die Pipelineassemblys ermitteln kann.</span><span class="sxs-lookup"><span data-stu-id="58c2e-207">This is most easily done in [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)], although the pipeline and add-in assembly needs to be in the host [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project's root folder in order for [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] to detect the pipeline assemblies.</span></span>  
  
 <span data-ttu-id="58c2e-208">Folglich muss der erste Schritt darin bestehen, die Pipeline- und Add-In-Assembly im Stammverzeichnis des [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)]-Projekts zu erstellen. Dazu wird die Buildausgabe der einzelnen Pipelineassembly- und Add-In-Assemblyprojekte festgelegt.</span><span class="sxs-lookup"><span data-stu-id="58c2e-208">Consequently, the first step is to build the pipeline and add-in assembly to the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project's root by setting the build output of each pipeline assembly and add-in assembly projects.</span></span> <span data-ttu-id="58c2e-209">Die folgende Tabelle zeigt die Buildausgabepfade für die Pipelineassemblyprojekte und das Add-In-Assemblyprojekt, die sich in demselben Projektmappen- und Stammordner befinden wie das [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)]-Hostprojekt.</span><span class="sxs-lookup"><span data-stu-id="58c2e-209">The following table shows the build output paths for pipeline assembly projects and add-in assembly project that are in the same solution and root folder as the host [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project.</span></span>  
  
 <span data-ttu-id="58c2e-210">Tabelle 1: Buildausgabepfade für die Pipelineassemblys, die von einer XBAP gehostet werden</span><span class="sxs-lookup"><span data-stu-id="58c2e-210">Table 1: Build Output Paths for the Pipeline Assemblies That Are Hosted by an XBAP</span></span>  
  
|<span data-ttu-id="58c2e-211">Pipelineassemblyprojekt</span><span class="sxs-lookup"><span data-stu-id="58c2e-211">Pipeline assembly project</span></span>|<span data-ttu-id="58c2e-212">Ausgabepfad erstellen</span><span class="sxs-lookup"><span data-stu-id="58c2e-212">Build output path</span></span>|  
|-------------------------------|-----------------------|  
|<span data-ttu-id="58c2e-213">Vertrag</span><span class="sxs-lookup"><span data-stu-id="58c2e-213">Contract</span></span>|`..\HostXBAP\Contracts\`|  
|<span data-ttu-id="58c2e-214">Add-In-Ansicht</span><span class="sxs-lookup"><span data-stu-id="58c2e-214">Add-In View</span></span>|`..\HostXBAP\AddInViews\`|  
|<span data-ttu-id="58c2e-215">Add-In-seitiger Adapter</span><span class="sxs-lookup"><span data-stu-id="58c2e-215">Add-In-Side Adapter</span></span>|`..\HostXBAP\AddInSideAdapters\`|  
|<span data-ttu-id="58c2e-216">Hostseitiger Adapter</span><span class="sxs-lookup"><span data-stu-id="58c2e-216">Host-Side Adapter</span></span>|`..\HostXBAP\HostSideAdapters\`|  
|<span data-ttu-id="58c2e-217">Add-In</span><span class="sxs-lookup"><span data-stu-id="58c2e-217">Add-In</span></span>|`..\HostXBAP\AddIns\WPFAddIn1`|  
  
 <span data-ttu-id="58c2e-218">Der nächste Schritt besteht darin, die Pipelineassemblys und die Add-In-Assembly als die Inhaltsdateien der [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)]s in [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] anzugeben. Dazu werden folgende Schritte ausgeführt:</span><span class="sxs-lookup"><span data-stu-id="58c2e-218">The next step is to specify the pipeline assemblies and add-in assembly as the [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)] content files in [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] by doing the following:</span></span>  
  
1.  <span data-ttu-id="58c2e-219">Hinzufügen der Pipeline- und Add-In-Assembly zum Projekt, indem Sie im Projektmappen-Explorer mit der rechten Maustaste auf die einzelnen Pipelineordner klicken und die Option **Zu Projekt hinzufügen** auswählen.</span><span class="sxs-lookup"><span data-stu-id="58c2e-219">Including the pipeline and add-in assembly in the project by right-clicking each pipeline folder in Solution Explorer and choosing **Include In Project**.</span></span>  
  
2.  <span data-ttu-id="58c2e-220">Festlegen des **Buildvorgangs** jeder Pipelineassembly und jeder Add-In-Assembly im **Eigenschaftenfenster** auf **Inhalt**.</span><span class="sxs-lookup"><span data-stu-id="58c2e-220">Setting the **Build Action** of each pipeline assembly and add-in assembly to **Content** from the **Properties** window.</span></span>  
  
 <span data-ttu-id="58c2e-221">Im letzten Schritt muss das Anwendungsmanifest so konfiguriert werden, dass sowohl die Pipelineassemblydateien als auch die Add-In-Assemblydatei heruntergeladen werden.</span><span class="sxs-lookup"><span data-stu-id="58c2e-221">The final step is to configure the application manifest to include the pipeline assembly files and add-in assembly file for download.</span></span> <span data-ttu-id="58c2e-222">Die Dateien sollten in Ordnern im Stammverzeichnis des Ordners in dem [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)]-Cache gespeichert sein, den die [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)]-Anwendung belegt.</span><span class="sxs-lookup"><span data-stu-id="58c2e-222">The files should be located in folders at the root of the folder in the [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] cache that the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] application occupies.</span></span> <span data-ttu-id="58c2e-223">Die Konfiguration richten Sie in [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] durch folgende Schritte ein:</span><span class="sxs-lookup"><span data-stu-id="58c2e-223">The configuration can be achieved in [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] by doing the following:</span></span>  
  
1.  <span data-ttu-id="58c2e-224">Klicken Sie mit der rechten Maustaste auf das [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)]-Projekt, klicken Sie auf **Eigenschaften**, auf **Veröffentlichen** und dann auf die Schaltfläche **Anwendungsdateien**.</span><span class="sxs-lookup"><span data-stu-id="58c2e-224">Right-click the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project, click **Properties**, click **Publish**, and then click the **Application Files** button.</span></span>  
  
2.  <span data-ttu-id="58c2e-225">Legen Sie im Dialogfeld **Anwendungsdateien** den **Veröffentlichungsstatus** der einzelnen Pipeline- und Add-In-DLLs auf **Einschließen (Auto)** und die **Downloadgruppe** für die Pipeline- und Add-In-DLLs auf **(Erforderlich)** fest.</span><span class="sxs-lookup"><span data-stu-id="58c2e-225">In the **Application Files** dialog, set the **Publish Status** of each pipeline and add-in DLL to **Include (Auto)**, and set the **Download Group** for each pipeline and add-in DLL to **(Required)**.</span></span>  
  
### <a name="using-the-pipeline-and-add-in-from-the-application-base"></a><span data-ttu-id="58c2e-226">Verwenden der Pipeline und des Add-Ins von der Anwendungsbasis</span><span class="sxs-lookup"><span data-stu-id="58c2e-226">Using the Pipeline and Add-In from the Application Base</span></span>  
 <span data-ttu-id="58c2e-227">Sind Pipeline und Add-In für die [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)]-Bereitstellung konfiguriert, werden sie in denselben [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)]-Cacheordner heruntergeladen wie die [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)].</span><span class="sxs-lookup"><span data-stu-id="58c2e-227">When the pipeline and add-in are configured for [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] deployment, they are downloaded to the same [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] cache folder as the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)].</span></span> <span data-ttu-id="58c2e-228">Damit Pipeline und Add-In aus der [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] verwendet werden können, müssen sie vom [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)]-Code aus der Anwendungsbasis abgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="58c2e-228">To use the pipeline and add-in from the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)], the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] code must get them from the application base.</span></span> <span data-ttu-id="58c2e-229">Die unterschiedlichen Typen und Member des Add-In-Modells von [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)], die zum Verwenden von Pipelines und Add-Ins verfügbar sind, bieten spezielle Unterstützung für dieses Szenario.</span><span class="sxs-lookup"><span data-stu-id="58c2e-229">The various types and members of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model for using pipelines and add-ins provide special support for this scenario.</span></span> <span data-ttu-id="58c2e-230">Zuerst wird durch der Pfad identifiziert die <xref:System.AddIn.Hosting.PipelineStoreLocation.ApplicationBase> Enumerationswert.</span><span class="sxs-lookup"><span data-stu-id="58c2e-230">Firstly, the path is identified by the <xref:System.AddIn.Hosting.PipelineStoreLocation.ApplicationBase> enumeration value.</span></span> <span data-ttu-id="58c2e-231">Diesen Wert verwenden Sie mit Überladungen der relevanten Add-In-Member, wenn Pipelines verwendet werden sollen, die Folgendes enthalten:</span><span class="sxs-lookup"><span data-stu-id="58c2e-231">You use this value with overloads of the pertinent add-in members for using pipelines that include the following:</span></span>  
  
-   <xref:System.AddIn.Hosting.AddInStore.FindAddIns%28System.Type%2CSystem.AddIn.Hosting.PipelineStoreLocation%29?displayProperty=nameWithType>  
  
-   <xref:System.AddIn.Hosting.AddInStore.FindAddIns%28System.Type%2CSystem.AddIn.Hosting.PipelineStoreLocation%2CSystem.String%5B%5D%29?displayProperty=nameWithType>  
  
-   <xref:System.AddIn.Hosting.AddInStore.Rebuild%28System.AddIn.Hosting.PipelineStoreLocation%29?displayProperty=nameWithType>  
  
-   <xref:System.AddIn.Hosting.AddInStore.Update%28System.AddIn.Hosting.PipelineStoreLocation%29?displayProperty=nameWithType>  
  
### <a name="accessing-the-hosts-site-of-origin"></a><span data-ttu-id="58c2e-232">Zugreifen auf die Ursprungssite des Hosts</span><span class="sxs-lookup"><span data-stu-id="58c2e-232">Accessing the Host's Site of Origin</span></span>  
 <span data-ttu-id="58c2e-233">Damit ein Add-In auf Dateien von der Ursprungssite verweisen kann, muss das Add-In mit einer Sicherheitsisolation geladen werden, die der Hostanwendung entspricht.</span><span class="sxs-lookup"><span data-stu-id="58c2e-233">To ensure that an add-in can reference files from the site of origin, the add-in must be loaded with security isolation that is equivalent to the host application.</span></span> <span data-ttu-id="58c2e-234">Diese Sicherheitsebene wird durch identifiziert die <xref:System.AddIn.Hosting.AddInSecurityLevel.Host?displayProperty=nameWithType> -Enumerationswert, und übergeben die <xref:System.AddIn.Hosting.AddInToken.Activate%2A> Methode, wenn ein Add-in aktiviert ist.</span><span class="sxs-lookup"><span data-stu-id="58c2e-234">This security level is identified by the <xref:System.AddIn.Hosting.AddInSecurityLevel.Host?displayProperty=nameWithType> enumeration value, and passed to the <xref:System.AddIn.Hosting.AddInToken.Activate%2A> method when an add-in is activated.</span></span>  
  
<a name="WPFAddInModelArchitecture"></a>   
## <a name="wpf-add-in-architecture"></a><span data-ttu-id="58c2e-235">Architektur des WPF-Add-Ins</span><span class="sxs-lookup"><span data-stu-id="58c2e-235">WPF Add-In Architecture</span></span>  
 <span data-ttu-id="58c2e-236">Auf der höchsten Ebene wie wir gesehen haben, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] ermöglicht [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] -add-ins implementieren [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] (ableiten, die direkt oder indirekt von <xref:System.Windows.FrameworkElement>) mit <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> und <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="58c2e-236">At the highest level, as we've seen, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] enables [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-ins to implement [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] (that derive directly or indirectly from <xref:System.Windows.FrameworkElement>) using <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>.</span></span> <span data-ttu-id="58c2e-237">Das Ergebnis ist, dass die hostanwendung zurückgegeben wird ein <xref:System.Windows.FrameworkElement> , angezeigt wird, von [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] in der hostanwendung.</span><span class="sxs-lookup"><span data-stu-id="58c2e-237">The result is that the host application is returned a <xref:System.Windows.FrameworkElement> that is displayed from [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] in the host application.</span></span>  
  
 <span data-ttu-id="58c2e-238">Für einfache [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]-Add-In-Szenarien reichen diese Informationen für Entwickler aus.</span><span class="sxs-lookup"><span data-stu-id="58c2e-238">For simple [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] add-in scenarios, this is as much detail as a developer needs.</span></span> <span data-ttu-id="58c2e-239">Für komplexere Szenarien, insbesondere solche, bei denen weitere [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]-Dienste wie Layout, Ressourcen und Datenbindung zum Einsatz kommen, sind umfassendere Kenntnisse darüber erforderlich, wie [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] das Add-In-Modell von [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] um [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]-Unterstützung erweitert. Andernfalls können Sie die Vorteile und Einschränkungen nicht verstehen.</span><span class="sxs-lookup"><span data-stu-id="58c2e-239">For more complex scenarios, particularly those that try to utilize additional [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] services such as layout, resources, and data binding, more detailed knowledge of how [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] extends the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model with [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] support is required to understand its benefits and limitations.</span></span>  
  
 <span data-ttu-id="58c2e-240">Im Wesentlichen ist es so, dass [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] keine [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] von einem Add-In an eine Hostanwendung übergibt, sondern dass [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] das Win32-Fensterhandle für die [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] übergibt, und zwar unter Verwendung der [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]-Interoperabilität.</span><span class="sxs-lookup"><span data-stu-id="58c2e-240">Fundamentally, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] doesn't pass a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] from an add-in to a host application; instead, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] passes the Win32 window handle for the [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] by using [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] interoperability.</span></span> <span data-ttu-id="58c2e-241">Daher geschieht Folgendes, wenn eine [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] von einem Add-In an eine Hostanwendung übergeben wird:</span><span class="sxs-lookup"><span data-stu-id="58c2e-241">As such, when a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] from an add-in is passed to a host application, the following occurs:</span></span>  
  
-   <span data-ttu-id="58c2e-242">Auf der Seite des Add-Ins ruft [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] ein Fensterhandle für die [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] ab, die von der Hostanwendung angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="58c2e-242">On the add-in side, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] acquires a window handle for the [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that will be displayed by the host application.</span></span> <span data-ttu-id="58c2e-243">Das Fensterhandle wird von einer internen gekapselt [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] abgeleitete Klasse <xref:System.Windows.Interop.HwndSource> und implementiert <xref:System.AddIn.Contract.INativeHandleContract>.</span><span class="sxs-lookup"><span data-stu-id="58c2e-243">The window handle is encapsulated by an internal [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] class that derives from <xref:System.Windows.Interop.HwndSource> and implements <xref:System.AddIn.Contract.INativeHandleContract>.</span></span> <span data-ttu-id="58c2e-244">Eine Instanz dieser Klasse wird zurückgegeben, durch <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> und, die das Add-in die Anwendungsdomäne zu Anwendungsdomäne der hostanwendung gemarshallt wird.</span><span class="sxs-lookup"><span data-stu-id="58c2e-244">An instance of this class is returned by <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> and is marshaled from the add-in's application domain to the host application's application domain.</span></span>  
  
-   <span data-ttu-id="58c2e-245">Klicken Sie auf der Seite der hostanwendung [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] packt neu die <xref:System.Windows.Interop.HwndSource> als interne [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] abgeleitete Klasse <xref:System.Windows.Interop.HwndHost> und nutzt <xref:System.AddIn.Contract.INativeHandleContract>.</span><span class="sxs-lookup"><span data-stu-id="58c2e-245">On the host application side, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] repackages the <xref:System.Windows.Interop.HwndSource> as an internal [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] class that derives from <xref:System.Windows.Interop.HwndHost> and consumes <xref:System.AddIn.Contract.INativeHandleContract>.</span></span> <span data-ttu-id="58c2e-246">Eine Instanz dieser Klasse wird zurückgegeben, durch <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> an die hostanwendung.</span><span class="sxs-lookup"><span data-stu-id="58c2e-246">An instance of this class is returned by <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> to the host application.</span></span>  
  
 <span data-ttu-id="58c2e-247"><xref:System.Windows.Interop.HwndHost> zum Anzeigen vorhanden [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)], identifiziert durch Fensterhandles aus [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)].</span><span class="sxs-lookup"><span data-stu-id="58c2e-247"><xref:System.Windows.Interop.HwndHost> exists to display [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)], identified by window handles, from [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)].</span></span> <span data-ttu-id="58c2e-248">Weitere Informationen finden Sie unter [Interaktion zwischen WPF und Win32](../../../../docs/framework/wpf/advanced/wpf-and-win32-interoperation.md).</span><span class="sxs-lookup"><span data-stu-id="58c2e-248">For more information, see [WPF and Win32 Interoperation](../../../../docs/framework/wpf/advanced/wpf-and-win32-interoperation.md).</span></span>  
  
 <span data-ttu-id="58c2e-249">Zusammenfassend <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>, und <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> vorhanden sein, damit das Fensterhandle für ein [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] aus einem Add-in an eine hostanwendung übergeben werden, in dem sie durch gekapselt ist eine <xref:System.Windows.Interop.HwndHost> und den Host angezeigt Anwendung [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span><span class="sxs-lookup"><span data-stu-id="58c2e-249">In summary, <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>, and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> exist to allow the window handle for a [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] to be passed from an add-in to a host application, where it is encapsulated by a <xref:System.Windows.Interop.HwndHost> and displayed the host application's [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="58c2e-250">Da die hostanwendung Ruft eine <xref:System.Windows.Interop.HwndHost>, die hostanwendung das Objekt, das von zurückgegebene kann nicht konvertiert werden <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> in den Typ auf, die sie als durch das Add-in implementiert wird (z. B. eine <xref:System.Windows.Controls.UserControl>).</span><span class="sxs-lookup"><span data-stu-id="58c2e-250">Because the host application gets an <xref:System.Windows.Interop.HwndHost>, the host application cannot convert the object that is returned by <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> to the type it is implemented as by the add-in (for example, a <xref:System.Windows.Controls.UserControl>).</span></span>  
  
 <span data-ttu-id="58c2e-251">Naturgemäß <xref:System.Windows.Interop.HwndHost> unterliegt bestimmten Einschränkungen, die beeinflussen, wie Sie Hosten von Anwendungen verwendet werden können.</span><span class="sxs-lookup"><span data-stu-id="58c2e-251">By its nature, <xref:System.Windows.Interop.HwndHost> has certain limitations that affect how host applications can use them.</span></span> <span data-ttu-id="58c2e-252">Allerdings [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] erweitert <xref:System.Windows.Interop.HwndHost> mehrere Funktionen für Add-in-Szenarien.</span><span class="sxs-lookup"><span data-stu-id="58c2e-252">However, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] extends <xref:System.Windows.Interop.HwndHost> with several capabilities for add-in scenarios.</span></span> <span data-ttu-id="58c2e-253">Diese Vorteile und die Einschränkungen werden nachstehend beschrieben.</span><span class="sxs-lookup"><span data-stu-id="58c2e-253">These benefits and limitations are described below.</span></span>  
  
<a name="WPFAddInModelBenefits"></a>   
## <a name="wpf-add-in-benefits"></a><span data-ttu-id="58c2e-254">Vorteile des WPF-Add-Ins</span><span class="sxs-lookup"><span data-stu-id="58c2e-254">WPF Add-In Benefits</span></span>  
 <span data-ttu-id="58c2e-255">Da [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] -add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] werden angezeigt, von hostanwendungen, die mithilfe einer internen Klasse, die von abgeleitet <xref:System.Windows.Interop.HwndHost>, die [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] sind eingeschränkt, durch die Funktionen der <xref:System.Windows.Interop.HwndHost> in Bezug auf [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] Dienste wie Layout, Rendering, Datenbindung, Stile, Vorlagen und Ressourcen.</span><span class="sxs-lookup"><span data-stu-id="58c2e-255">Because [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] are displayed from host applications using an internal class that derives from <xref:System.Windows.Interop.HwndHost>, those [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] are constrained by the capabilities of <xref:System.Windows.Interop.HwndHost> with respect to [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] services such as layout, rendering, data binding, styles, templates, and resources.</span></span> <span data-ttu-id="58c2e-256">Allerdings [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] erweitert die internen <xref:System.Windows.Interop.HwndHost> -Unterklasse um zusätzliche Funktionen, die Folgendes umfassen:</span><span class="sxs-lookup"><span data-stu-id="58c2e-256">However, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] augments its internal <xref:System.Windows.Interop.HwndHost> subclass with additional capabilities that include the following:</span></span>  
  
-   <span data-ttu-id="58c2e-257">Wechseln mit der TAB-TASTE zwischen der [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] einer Hostanwendung und der [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] eines Add-Ins.</span><span class="sxs-lookup"><span data-stu-id="58c2e-257">Tabbing between a host application's [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] and an add-in's [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span> <span data-ttu-id="58c2e-258">Beachten Sie, dass die "Add-in ist eine [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]" Programmiermodell erforderlich, dass den Add-In-seitige Adapter überschreibt <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> , ob das Add-in ist voll vertrauenswürdige als auch teilweise vertrauenswürdigen aktivieren TAB-Taste.</span><span class="sxs-lookup"><span data-stu-id="58c2e-258">Note that the "add-in is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]" programming model requires the add-in-side adapter to override <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> to enable tabbing, whether the add-in is fully trusted or partially trusted.</span></span>  
  
-   <span data-ttu-id="58c2e-259">Berücksichtigen der Anforderungen an Barrierefreiheit für Add-In-[!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)]s, die von [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)]s für Hostanwendungen angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="58c2e-259">Honoring accessibility requirements for add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] that are displayed from host application [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)].</span></span>  
  
-   <span data-ttu-id="58c2e-260">Ermöglichen, dass [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]-Anwendungen in Szenarien mit mehreren Anwendungsdomänen sicher ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="58c2e-260">Enabling [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] applications to run safely in multiple application domain scenarios.</span></span>  
  
-   <span data-ttu-id="58c2e-261">Verhindern von unberechtigten Zugriffen auf Add-In-[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]n-Fensterhandles, wenn Add-Ins mit Sicherheitsisolation ausgeführt werden (d. h. in einem teilweise vertrauenswürdigen Sicherheitsbereich (Sandbox)).</span><span class="sxs-lookup"><span data-stu-id="58c2e-261">Preventing illegal access to add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] window handles when add-ins run with security isolation (that is, a partial-trust security sandbox).</span></span> <span data-ttu-id="58c2e-262">Aufrufen von <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> gewährleistet diese Sicherheit:</span><span class="sxs-lookup"><span data-stu-id="58c2e-262">Calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> ensures this security:</span></span>  
  
    -   <span data-ttu-id="58c2e-263">Für die "Add-Ins gibt eine [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]" Programmiermodell, das die einzige Möglichkeit, die das Fensterhandle für ein Add-in zu übergeben [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] über die Isolationsgrenze hinweg werden, dass Aufrufen <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="58c2e-263">For the "add-in returns a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]" programming model, the only way to pass the window handle for an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] across the isolation boundary is to call <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span></span>  
  
    -   <span data-ttu-id="58c2e-264">Für die "Add-in ist eine [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]" Programmierung überschreiben <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> auf dem Add-In-seitige Adapter und der Aufruf <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> (wie in den vorherigen Beispielen gezeigt) ist es erforderlich, die Add-In-seitige Adapter aufgerufen `QueryContract` Implementierung vom hostseitigen Adapter.</span><span class="sxs-lookup"><span data-stu-id="58c2e-264">For the "add-in is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]" programming model, overriding <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> on the add-in-side adapter and calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> (as shown in the preceding examples) is required, as is calling the add-in-side adapter's `QueryContract` implementation from the host-side adapter.</span></span>  
  
-   <span data-ttu-id="58c2e-265">Bereitstellen von Ausführungsschutz für mehrere Anwendungsdomänen.</span><span class="sxs-lookup"><span data-stu-id="58c2e-265">Providing multiple application domain execution protection.</span></span> <span data-ttu-id="58c2e-266">Aufgrund von Einschränkungen bei Anwendungsdomänen führen unbehandelte Ausnahmen, die in Add-In-Anwendungsdomänen ausgelöst werden, zum Absturz der gesamten Anwendung, auch wenn eine Isolationsgrenze eingerichtet ist.</span><span class="sxs-lookup"><span data-stu-id="58c2e-266">Due to limitations with application domains, unhandled exceptions that are thrown in add-in application domains cause the entire application to crash, even though the isolation boundary exists.</span></span> <span data-ttu-id="58c2e-267">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] und das Add-In-Modell von [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] bieten jedoch eine einfache Möglichkeit, das Problem zu umgehen und die Anwendungsstabilität zu verbessern.</span><span class="sxs-lookup"><span data-stu-id="58c2e-267">However, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] and the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model provide a simple way to work around this problem and improve application stability.</span></span> <span data-ttu-id="58c2e-268">Ein [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] -add-in, das zeigt eine [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] erstellt eine <xref:System.Windows.Threading.Dispatcher> für den Thread, der die Anwendungsdomäne ausgeführt wird, wenn die hostanwendung ist eine [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] Anwendung.</span><span class="sxs-lookup"><span data-stu-id="58c2e-268">A [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] add-in that displays a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] creates a <xref:System.Windows.Threading.Dispatcher> for the thread that the application domain runs on, if the host application is a [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] application.</span></span> <span data-ttu-id="58c2e-269">Sie können erkennen, dass alle nicht behandelte Ausnahmen, die in der Anwendungsdomäne, durch Behandeln auftreten der <xref:System.Windows.Threading.Dispatcher.UnhandledException> Ereignis die [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] -add-Ins <xref:System.Windows.Threading.Dispatcher>.</span><span class="sxs-lookup"><span data-stu-id="58c2e-269">You can detect all unhandled exceptions that occur in the application domain by handling the <xref:System.Windows.Threading.Dispatcher.UnhandledException> event of the [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] add-in's <xref:System.Windows.Threading.Dispatcher>.</span></span> <span data-ttu-id="58c2e-270">Sie erhalten die <xref:System.Windows.Threading.Dispatcher> aus der <xref:System.Windows.Threading.Dispatcher.CurrentDispatcher%2A> Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="58c2e-270">You can get the <xref:System.Windows.Threading.Dispatcher> from the <xref:System.Windows.Threading.Dispatcher.CurrentDispatcher%2A> property.</span></span>  
  
<a name="WPFAddInModelLimitations"></a>   
## <a name="wpf-add-in-limitations"></a><span data-ttu-id="58c2e-271">Einschränkungen des WPF-Add-Ins</span><span class="sxs-lookup"><span data-stu-id="58c2e-271">WPF Add-In Limitations</span></span>  
 <span data-ttu-id="58c2e-272">Über die Vorteile, die [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] hinzugefügt, das vom Standardverhalten <xref:System.Windows.Interop.HwndSource>, <xref:System.Windows.Interop.HwndHost>, und Fensterhandles, es gibt auch Einschränkungen für add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] , die von hostanwendungen angezeigt werden:</span><span class="sxs-lookup"><span data-stu-id="58c2e-272">Beyond the benefits that [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] adds to the default behaviors supplied by <xref:System.Windows.Interop.HwndSource>, <xref:System.Windows.Interop.HwndHost>, and window handles, there are also limitations for add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] that are displayed from host applications:</span></span>  
  
-   <span data-ttu-id="58c2e-273">Das Ausschneideverhalten der Hostanwendung wird von den von einer Hostanwendung angezeigten Add-In-[!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)]s nicht berücksichtigt.</span><span class="sxs-lookup"><span data-stu-id="58c2e-273">Add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] displayed from a host application do not respect the host application's clipping behavior.</span></span>  
  
-   <span data-ttu-id="58c2e-274">Der Begriff *Airspace* in Interoperabilitätsszenarien gilt auch für Add-Ins (siehe [Übersicht über die Technologieregionen](../../../../docs/framework/wpf/advanced/technology-regions-overview.md)).</span><span class="sxs-lookup"><span data-stu-id="58c2e-274">The concept of *airspace* in interoperability scenarios also applies to add-ins (see [Technology Regions Overview](../../../../docs/framework/wpf/advanced/technology-regions-overview.md)).</span></span>  
  
-   <span data-ttu-id="58c2e-275">Die [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]-Dienste einer Hostanwendung, z. B. Ressourcenvererbung, Datenbindung und Befehle sind für Add-In-[!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)]s nicht automatisch verfügbar.</span><span class="sxs-lookup"><span data-stu-id="58c2e-275">A host application's [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] services, such as resource inheritance, data binding, and commanding, are not automatically available to add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)].</span></span> <span data-ttu-id="58c2e-276">Um diese Dienste für das Add-In bereitzustellen, müssen Sie die Pipeline aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="58c2e-276">To provide these services to the add-in, you need to update the pipeline.</span></span>  
  
-   <span data-ttu-id="58c2e-277">Die [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] eines Add-Ins kann nicht gedreht, skaliert, verzerrt oder auf andere Weise durch eine Transformation geändert werden (siehe [Übersicht über Transformationen](../../../../docs/framework/wpf/graphics-multimedia/transforms-overview.md)).</span><span class="sxs-lookup"><span data-stu-id="58c2e-277">An add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] cannot be rotated, scaled, skewed, or otherwise affected by a transformation (see [Transforms Overview](../../../../docs/framework/wpf/graphics-multimedia/transforms-overview.md)).</span></span>  
  
-   <span data-ttu-id="58c2e-278">Inhalte innerhalb von Add-in- [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] gerendert, die durch Zeichenvorgänge aus dem <xref:System.Drawing> Namespace kann Alphablending umfassen.</span><span class="sxs-lookup"><span data-stu-id="58c2e-278">Content inside add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] that is rendered by drawing operations from the <xref:System.Drawing> namespace can include alpha blending.</span></span> <span data-ttu-id="58c2e-279">Allerdings müssen sowohl die [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] eines Add-Ins als auch die sie enthaltende [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] der Hostanwendung zu 100 % deckend sein, d. h., die `Opacity`-Eigenschaft muss für beide auf 1 festgelegt sein.</span><span class="sxs-lookup"><span data-stu-id="58c2e-279">However, both an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] and the host application [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that contains it must be 100% opaque; in other words, the `Opacity` property on both must be set to 1.</span></span>  
  
-   <span data-ttu-id="58c2e-280">Wenn die <xref:System.Windows.Window.AllowsTransparency%2A> Eigenschaft eines Fensters in der hostanwendung, die ein Add-in enthält [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] nastaven NA hodnotu `true`, das Add-in nicht sichtbar ist.</span><span class="sxs-lookup"><span data-stu-id="58c2e-280">If the <xref:System.Windows.Window.AllowsTransparency%2A> property of a window in the host application that contains an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] is set to `true`, the add-in is invisible.</span></span> <span data-ttu-id="58c2e-281">Dies gilt auch, wenn die [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] des Add-Ins zu 100 % deckend ist (die `Opacity`-Eigenschaft also den Wert 1 hat).</span><span class="sxs-lookup"><span data-stu-id="58c2e-281">This is true even if the add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] is 100% opaque (that is, the `Opacity` property has a value of 1).</span></span>  
  
-   <span data-ttu-id="58c2e-282">Die [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] eines Add-Ins muss über anderen [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]-Elementen in demselben Fenster auf oberster Ebene angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="58c2e-282">An add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] must appear on top of other [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] elements in the same top-level window.</span></span>  
  
-   <span data-ttu-id="58c2e-283">Kein Teil über ein Add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] mit gerendert werden kann eine <xref:System.Windows.Media.VisualBrush>.</span><span class="sxs-lookup"><span data-stu-id="58c2e-283">No portion of an add-in's [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] can be rendered using a <xref:System.Windows.Media.VisualBrush>.</span></span> <span data-ttu-id="58c2e-284">Stattdessen kann das Add-In eine Momentaufnahme der generierten [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] erstellen, um eine Bitmap zu erstellen, die mit vertraglich definierten Methoden an die Hostanwendung übergeben werden kann.</span><span class="sxs-lookup"><span data-stu-id="58c2e-284">Instead, the add-in may take a snapshot of the generated [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] to create a bitmap that can be passed to the host application using methods defined by the contract.</span></span>  
  
-   <span data-ttu-id="58c2e-285">Mediendateien können nicht wiedergegeben werden, von einem <xref:System.Windows.Controls.MediaElement> in einem Add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span><span class="sxs-lookup"><span data-stu-id="58c2e-285">Media files cannot be played from a <xref:System.Windows.Controls.MediaElement> in an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span>  
  
-   <span data-ttu-id="58c2e-286">Für die Add-In-[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] generierte Mausereignisse werden von der Hostanwendung weder empfangen noch ausgelöst. Die `IsMouseOver`-Eigenschaft für die [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] der Hostanwendung hat den Wert `false`.</span><span class="sxs-lookup"><span data-stu-id="58c2e-286">Mouse events generated for the add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] are neither received nor raised by the host application, and the `IsMouseOver` property for host application [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] has a value of `false`.</span></span>  
  
-   <span data-ttu-id="58c2e-287">Wenn der Fokus zwischen Steuerelementen in einer Add-In-[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] wechselt, wird das `GotFocus`-Ereignis und das `LostFocus`-Ereignis von der Hostanwendung weder empfangen noch ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="58c2e-287">When focus shifts between controls in an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], the `GotFocus` and `LostFocus` events are neither received nor raised by the host application.</span></span>  
  
-   <span data-ttu-id="58c2e-288">Der Teil einer Hostanwendung, der eine Add-In-[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] enthält, wird beim Drucken weiß angezeigt.</span><span class="sxs-lookup"><span data-stu-id="58c2e-288">The portion of a host application that contains an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] appears white when printed.</span></span>  
  
-   <span data-ttu-id="58c2e-289">Alle Dispatcher (finden Sie unter <xref:System.Windows.Threading.Dispatcher>) durch das Add-in erstellt [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] müssen manuell beendet werden, bevor das Owner-Add-in entladen wird, wenn die hostanwendung die Ausführung wird fortgesetzt.</span><span class="sxs-lookup"><span data-stu-id="58c2e-289">All dispatchers (see <xref:System.Windows.Threading.Dispatcher>) created by the add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] must be shut down manually before the owner add-in is unloaded if the host application continues execution.</span></span> <span data-ttu-id="58c2e-290">Der Vertrag kann Methoden implementieren, die es der Hostanwendung ermöglichen, dem Add-In vor dem Entladen ein Signal zu übermitteln. Dadurch kann die Add-In-[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] die Dispatcher beenden.</span><span class="sxs-lookup"><span data-stu-id="58c2e-290">The contract can implement methods that allow the host application to signal the add-in before the add-in is unloaded, thereby allowing the add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] to shut down its dispatchers.</span></span>  
  
-   <span data-ttu-id="58c2e-291">Wenn ein Add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] ist ein <xref:System.Windows.Controls.InkCanvas> oder enthält ein <xref:System.Windows.Controls.InkCanvas>, Sie können nicht das Add-In entladen.</span><span class="sxs-lookup"><span data-stu-id="58c2e-291">If an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] is an <xref:System.Windows.Controls.InkCanvas> or contains an <xref:System.Windows.Controls.InkCanvas>, you cannot unload the add-in.</span></span>  
  
<a name="PerformanceOptimization"></a>   
## <a name="performance-optimization"></a><span data-ttu-id="58c2e-292">Leistungsoptimierung</span><span class="sxs-lookup"><span data-stu-id="58c2e-292">Performance Optimization</span></span>  
 <span data-ttu-id="58c2e-293">Werden mehrere Anwendungsdomänen verwendet, werden die von den einzelnen Anwendungen benötigten verschiedenen [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]-Assemblys standardmäßig alle in die Domäne dieser Anwendung geladen.</span><span class="sxs-lookup"><span data-stu-id="58c2e-293">By default, when multiple application domains are used, the various [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] assemblies required by each application are all loaded into that application's domain.</span></span> <span data-ttu-id="58c2e-294">Aufgrund der Zeit, die zum Erstellen neuer Anwendungsdomänen und für das Starten der darin enthaltenen Anwendungen erforderlich ist, kann die Leistung beeinträchtigt werden.</span><span class="sxs-lookup"><span data-stu-id="58c2e-294">As a result, the time required for creating new application domains and starting applications in them might affect performance.</span></span> <span data-ttu-id="58c2e-295">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] bietet allerdings die Möglichkeit, Startzeiten zu verkürzen. Dazu werden Anwendungen angewiesen, Assemblys in Anwendungsdomänen gemeinsam zu nutzen, wenn sie bereits geladen sind.</span><span class="sxs-lookup"><span data-stu-id="58c2e-295">However, the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] provides a way for you to reduce start times by instructing applications to share assemblies across application domains if they are already loaded.</span></span> <span data-ttu-id="58c2e-296">Verwenden Sie hierzu die <xref:System.LoaderOptimizationAttribute> -Attribut, das auf die Einstiegspunktmethode angewendet werden muss (`Main`).</span><span class="sxs-lookup"><span data-stu-id="58c2e-296">You do this by using the <xref:System.LoaderOptimizationAttribute> attribute, which must be applied to the entry point method (`Main`).</span></span> <span data-ttu-id="58c2e-297">In diesem Fall müssen Sie lediglich zum Implementieren Ihrer Anwendungsdefinition Code verwenden (siehe [Übersicht über die Anwendungsverwaltung](../../../../docs/framework/wpf/app-development/application-management-overview.md)).</span><span class="sxs-lookup"><span data-stu-id="58c2e-297">In this case, you must use only code to implement your application definition (see [Application Management Overview](../../../../docs/framework/wpf/app-development/application-management-overview.md)).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="58c2e-298">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="58c2e-298">See Also</span></span>  
 <xref:System.LoaderOptimizationAttribute>  
 [<span data-ttu-id="58c2e-299">Add-Ins und Erweiterbarkeit</span><span class="sxs-lookup"><span data-stu-id="58c2e-299">Add-ins and Extensibility</span></span>](../../../../docs/framework/add-ins/index.md)  
 [<span data-ttu-id="58c2e-300">Anwendungsdomänen</span><span class="sxs-lookup"><span data-stu-id="58c2e-300">Application Domains</span></span>](../../../../docs/framework/app-domains/application-domains.md)  
 [<span data-ttu-id="58c2e-301">Übersicht über .NET Framework-Remoting</span><span class="sxs-lookup"><span data-stu-id="58c2e-301">.NET Framework Remoting Overview</span></span>](https://msdn.microsoft.com/library/eccb1d31-0a22-417a-97fd-f4f1f3aa4462)  
 [<span data-ttu-id="58c2e-302">Erstellen Remotefähiger Objekte</span><span class="sxs-lookup"><span data-stu-id="58c2e-302">Making Objects Remotable</span></span>](https://msdn.microsoft.com/library/01197253-3f13-43b7-894d-9683e431192a)  
 [<span data-ttu-id="58c2e-303">Themen zu Vorgehensweisen</span><span class="sxs-lookup"><span data-stu-id="58c2e-303">How-to Topics</span></span>](../../../../docs/framework/wpf/app-development/how-to-topics.md)
