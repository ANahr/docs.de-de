---
title: "Übersicht über die Profilerstellung"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: reference
helpviewer_keywords:
- managed code, profiling API support
- unmanaged code, combining with managed code in profiling
- notification threads [.NET Framework profiling]
- unmanaged code, profiling
- profiling API [.NET Framework], and COM
- profiling API [.NET Framework], unmanaged code profiling
- profilers, writing
- profiling API [.NET Framework], call stacks
- code profilers, writing
- profiling API [.NET Framework], security considerations
- profiling API [.NET Framework], managed code support
- common language runtime, profiling
- profiling API [.NET Framework], notification threads
- call stacks [.NET Framework profiling]
- profiling API [.NET Framework], stack depth
- common language runtime, writing a profiler
- profiling API [.NET Framework], information retrieval interfaces
- shadow stacks [.NET Framework profiling]
- COM, using in the profiling API
- stack snapshots [.NET Framework profiling]
- profiling API [.NET Framework], supported features
- profiling API [.NET Framework], overview
- security, profiling API considerations
- stack depth [.NET Framework profiling]
ms.assetid: 864c2344-71dc-46f9-96b2-ed59fb6427a8
caps.latest.revision: "27"
author: mairaw
ms.author: mairaw
manager: wpickett
ms.workload: dotnet
ms.openlocfilehash: 84688ed80d0cb1b802290176400eb45998052a34
ms.sourcegitcommit: 16186c34a957fdd52e5db7294f291f7530ac9d24
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 12/22/2017
---
# <a name="profiling-overview"></a><span data-ttu-id="d4cab-102">Übersicht über die Profilerstellung</span><span class="sxs-lookup"><span data-stu-id="d4cab-102">Profiling Overview</span></span>
<a name="top"></a><span data-ttu-id="d4cab-103">Ein Profiler ist ein Tool, das die Ausführung einer anderen Anwendung überwacht.</span><span class="sxs-lookup"><span data-stu-id="d4cab-103">A profiler is a tool that monitors the execution of another application.</span></span> <span data-ttu-id="d4cab-104">Ein Common Language Runtime (CLR)-Profiler ist eine Dynamic Link Library (DLL), die aus Funktionen besteht, die mithilfe der Profilerstellungs-API Meldungen von der CLR empfangen und an diese senden.</span><span class="sxs-lookup"><span data-stu-id="d4cab-104">A common language runtime (CLR) profiler is a dynamic link library (DLL) that consists of functions that receive messages from, and send messages to, the CLR by using the profiling API.</span></span> <span data-ttu-id="d4cab-105">Die Profiler-DLL wird zur Laufzeit von der CLR geladen.</span><span class="sxs-lookup"><span data-stu-id="d4cab-105">The profiler DLL is loaded by the CLR at run time.</span></span>  
  
 <span data-ttu-id="d4cab-106">Herkömmliche Profilerstellungstools dienen vorwiegend dazu, die Ausführung der Anwendung zu messen.</span><span class="sxs-lookup"><span data-stu-id="d4cab-106">Traditional profiling tools focus on measuring the execution of the application.</span></span> <span data-ttu-id="d4cab-107">Das bedeutet, dass sie die für jede Funktion aufgebrachte Zeit und die Speicherauslastung der Anwendung über einen bestimmten Zeitraum messen.</span><span class="sxs-lookup"><span data-stu-id="d4cab-107">That is, they measure the time that is spent in each function or the memory usage of the application over time.</span></span> <span data-ttu-id="d4cab-108">Die Profilerstellungs-API zielt auf eine breitere Klasse von Diagnosetools ab, z. B. Dienstprogramme zur Codeabdeckung und sogar erweiterte Debughilfen.</span><span class="sxs-lookup"><span data-stu-id="d4cab-108">The profiling API targets a broader class of diagnostic tools such as code-coverage utilities and even advanced debugging aids.</span></span> <span data-ttu-id="d4cab-109">Diese Verwendungsmöglichkeiten sind ausnahmslos von diagnostischer Natur.</span><span class="sxs-lookup"><span data-stu-id="d4cab-109">These uses are all diagnostic in nature.</span></span> <span data-ttu-id="d4cab-110">Die Profilerstellungs-API misst nicht nur die Ausführung einer Anwendung, sondern überwacht sie auch.</span><span class="sxs-lookup"><span data-stu-id="d4cab-110">The profiling API not only measures but also monitors the execution of an application.</span></span> <span data-ttu-id="d4cab-111">Aus diesem Grund sollte die Profilerstellungs-API nie von der Anwendung selbst verwendet werden, und die Ausführung der Anwendung sollte nicht vom Profiler abhängen (oder davon beeinflusst werden).</span><span class="sxs-lookup"><span data-stu-id="d4cab-111">For this reason, the profiling API should never be used by the application itself, and the application’s execution should not depend on (or be affected by) the profiler.</span></span>  
  
 <span data-ttu-id="d4cab-112">Die Profilerstellung für eine CLR-Anwendung erfordert eine weiter reichende Unterstützung als die Profilerstellung für Computercode, der auf herkömmliche Weise kompiliert wurde.</span><span class="sxs-lookup"><span data-stu-id="d4cab-112">Profiling a CLR application requires more support than profiling conventionally compiled machine code.</span></span> <span data-ttu-id="d4cab-113">Dies liegt darin begründet, dass von der CLR Konzepte wie Anwendungsdomänen, Garbage Collection, verwaltete Ausnahmenbehandlung, Just-In-Time (JIT)-Kompilierung von Code (die Konvertierung von Microsoft Intermediate Language- bzw. MSIL-Code in systemeigenen Computercode) und ähnliche Features eingeführt werden.</span><span class="sxs-lookup"><span data-stu-id="d4cab-113">This is because the CLR introduces concepts such as application domains, garbage collection, managed exception handling, just-in-time (JIT) compilation of code (converting Microsoft intermediate language, or MSIL, code into native machine code), and similar features.</span></span> <span data-ttu-id="d4cab-114">Herkömmliche Profilerstellungsmechanismen können keine nützlichen Informationen über diese Features identifizieren oder bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="d4cab-114">Conventional profiling mechanisms cannot identify or provide useful information about these features.</span></span> <span data-ttu-id="d4cab-115">Die Profilerstellungs-API liefert diese fehlenden Informationen hingegen in effizienter Weise und mit minimalen Auswirkungen auf die Leistung der CLR und die Anwendung, für die das Profil erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="d4cab-115">The profiling API provides this missing information efficiently, with minimal effect on the performance of the CLR and the profiled application.</span></span>  
  
 <span data-ttu-id="d4cab-116">Die JIT-Kompilierung zur Laufzeit bietet hervorragende Möglichkeiten zur Profilerstellung.</span><span class="sxs-lookup"><span data-stu-id="d4cab-116">JIT compilation at run time provides good opportunities for profiling.</span></span> <span data-ttu-id="d4cab-117">Die Profilerstellungs-API ermöglicht einem Profiler, den speicherinternen MSIL-Codestream für eine Routine zu ändern, bevor er JIT-kompiliert wird.</span><span class="sxs-lookup"><span data-stu-id="d4cab-117">The profiling API enables a profiler to change the in-memory MSIL code stream for a routine before it is JIT-compiled.</span></span> <span data-ttu-id="d4cab-118">Auf diese Weise kann der Profiler bestimmten Routinen, die genauer überprüft werden müssen, Instrumentationscode dynamisch hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="d4cab-118">In this manner, the profiler can dynamically add instrumentation code to particular routines that need deeper investigation.</span></span> <span data-ttu-id="d4cab-119">Dieser Ansatz ist zwar auch in herkömmlichen Szenarios möglich, lässt sich aber für die CLR mit der Profilerstellungs-API wesentlich einfacher umsetzen.</span><span class="sxs-lookup"><span data-stu-id="d4cab-119">Although this approach is possible in conventional scenarios, it is much easier to implement for the CLR by using the profiling API.</span></span>  
  
 <span data-ttu-id="d4cab-120">Diese Übersicht enthält folgende Abschnitte:</span><span class="sxs-lookup"><span data-stu-id="d4cab-120">This overview consists of the following sections:</span></span>  
  
-   [<span data-ttu-id="d4cab-121">Die Profilerstellungs-API</span><span class="sxs-lookup"><span data-stu-id="d4cab-121">The Profiling API</span></span>](#profiling_api)  
  
-   [<span data-ttu-id="d4cab-122">Unterstützte Funktionen</span><span class="sxs-lookup"><span data-stu-id="d4cab-122">Supported Features</span></span>](#support)  
  
-   [<span data-ttu-id="d4cab-123">Benachrichtigungsthreads</span><span class="sxs-lookup"><span data-stu-id="d4cab-123">Notification Threads</span></span>](#notification_threads)  
  
-   [<span data-ttu-id="d4cab-124">Sicherheit</span><span class="sxs-lookup"><span data-stu-id="d4cab-124">Security</span></span>](#security)  
  
-   [<span data-ttu-id="d4cab-125">Kombination von verwaltetem und nicht verwaltetem Code in einem Codeprofiler</span><span class="sxs-lookup"><span data-stu-id="d4cab-125">Combining Managed and Unmanaged Code in a Code Profiler</span></span>](#combining_managed_unmanaged)  
  
-   [<span data-ttu-id="d4cab-126">Profilerstellung für nicht verwalteten Code</span><span class="sxs-lookup"><span data-stu-id="d4cab-126">Profiling Unmanaged Code</span></span>](#unmanaged)  
  
-   [<span data-ttu-id="d4cab-127">Verwenden von COM</span><span class="sxs-lookup"><span data-stu-id="d4cab-127">Using COM</span></span>](#com)  
  
-   [<span data-ttu-id="d4cab-128">Aufruflisten</span><span class="sxs-lookup"><span data-stu-id="d4cab-128">Call stacks</span></span>](#call_stacks)  
  
-   [<span data-ttu-id="d4cab-129">Rückrufe und Stapeltiefe</span><span class="sxs-lookup"><span data-stu-id="d4cab-129">Callbacks and Stack Depth</span></span>](#callbacks)  
  
-   [<span data-ttu-id="d4cab-130">Verwandte Themen</span><span class="sxs-lookup"><span data-stu-id="d4cab-130">Related Topics</span></span>](#related_topics)  
  
<a name="profiling_api"></a>   
## <a name="the-profiling-api"></a><span data-ttu-id="d4cab-131">Die Profilerstellungs-API</span><span class="sxs-lookup"><span data-stu-id="d4cab-131">The Profiling API</span></span>  
 <span data-ttu-id="d4cab-132">In der Regel wird die profilerstellungs-API verwendet, um das Schreiben einer *code Profiler*, dies ist ein Programm, das die Ausführung einer verwalteten Anwendung überwacht.</span><span class="sxs-lookup"><span data-stu-id="d4cab-132">Typically, the profiling API is used to write a *code profiler*, which is a program that monitors the execution of a managed application.</span></span>  
  
 <span data-ttu-id="d4cab-133">Die Profilerstellungs-API wird von einer Profiler-DLL verwendet, die in den gleichen Prozess geladen wird wie die Anwendung, für die ein Profil erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="d4cab-133">The profiling API is used by a profiler DLL, which is loaded into the same process as the application that is being profiled.</span></span> <span data-ttu-id="d4cab-134">Die Profiler-DLL implementiert eine Rückrufschnittstelle ([ICorProfilerCallback](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-interface.md) in .NET Framework, Version 1.0 und 1.1, [ICorProfilerCallback2](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback2-interface.md) in Version 2.0 oder höher).</span><span class="sxs-lookup"><span data-stu-id="d4cab-134">The profiler DLL implements a callback interface ([ICorProfilerCallback](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-interface.md) in the .NET Framework version 1.0 and 1.1, [ICorProfilerCallback2](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback2-interface.md) in version 2.0 and later).</span></span> <span data-ttu-id="d4cab-135">Die CLR ruft die Methoden in dieser Schnittstelle auf, um den Profiler über Ereignisse im profilierten Prozess zu benachrichtigen.</span><span class="sxs-lookup"><span data-stu-id="d4cab-135">The CLR calls the methods in that interface to notify the profiler of events in the profiled process.</span></span> <span data-ttu-id="d4cab-136">Der Profiler kann Rückruf in die Laufzeit mithilfe der Methoden in der [ICorProfilerInfo](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-interface.md) und [ICorProfilerInfo2](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-interface.md) Schnittstellen zum Abrufen von Informationen über den Status der profilierten Anwendung.</span><span class="sxs-lookup"><span data-stu-id="d4cab-136">The profiler can call back into the runtime by using the methods in the [ICorProfilerInfo](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-interface.md) and [ICorProfilerInfo2](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-interface.md) interfaces to obtain information about the state of the profiled application.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="d4cab-137">Lediglich der zur Datenerfassung verwendete Teil der Profilerlösung sollte im gleichen Prozess ausgeführt werden wie die Anwendung, für die ein Profil erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="d4cab-137">Only the data-gathering part of the profiler solution should be running in the same process as the profiled application.</span></span> <span data-ttu-id="d4cab-138">Alle Benutzeroberflächen- und Datenanalysevorgänge sollten in einem separaten Prozess ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="d4cab-138">All user interface and data analysis should be performed in a separate process.</span></span>  
  
 <span data-ttu-id="d4cab-139">Die folgende Abbildung zeigt, wie die Profiler-DLL mit der Anwendung, für die ein Profil erstellt wird, und der CLR interagiert.</span><span class="sxs-lookup"><span data-stu-id="d4cab-139">The following illustration shows how the profiler DLL interacts with the application that is being profiled and the CLR.</span></span>  
  
 <span data-ttu-id="d4cab-140">![Profilarchitektur](../../../../docs/framework/unmanaged-api/profiling/media/profilingarch.png "ProfilingArch")</span><span class="sxs-lookup"><span data-stu-id="d4cab-140">![Profiling Architecture](../../../../docs/framework/unmanaged-api/profiling/media/profilingarch.png "ProfilingArch")</span></span>  
<span data-ttu-id="d4cab-141">Profilerstellungsarchitektur</span><span class="sxs-lookup"><span data-stu-id="d4cab-141">Profiling architecture</span></span>  
  
### <a name="the-notification-interfaces"></a><span data-ttu-id="d4cab-142">Die Benachrichtigungsschnittstellen</span><span class="sxs-lookup"><span data-stu-id="d4cab-142">The Notification Interfaces</span></span>  
 <span data-ttu-id="d4cab-143">[ICorProfilerCallback](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-interface.md) und [ICorProfilerCallback2](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback2-interface.md) können als Benachrichtigungsschnittstellen betrachtet werden.</span><span class="sxs-lookup"><span data-stu-id="d4cab-143">[ICorProfilerCallback](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-interface.md) and [ICorProfilerCallback2](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback2-interface.md) can be considered notification interfaces.</span></span> <span data-ttu-id="d4cab-144">Diese Schnittstellen bestehen aus Methoden wie z. B. [ClassLoadStarted](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-classloadstarted-method.md), [ClassLoadFinished](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-classloadfinished-method.md), und [JITCompilationStarted](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-jitcompilationstarted-method.md).</span><span class="sxs-lookup"><span data-stu-id="d4cab-144">These interfaces consist of methods such as [ClassLoadStarted](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-classloadstarted-method.md), [ClassLoadFinished](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-classloadfinished-method.md), and [JITCompilationStarted](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-jitcompilationstarted-method.md).</span></span> <span data-ttu-id="d4cab-145">Jedes Mal, wenn die CLR eine Klasse lädt oder entlädt, eine Funktion kompiliert usw., ruft sie die entsprechende Methode in der `ICorProfilerCallback`-Schnittstelle oder in der `ICorProfilerCallback2`-Schnittstelle des Profilers auf.</span><span class="sxs-lookup"><span data-stu-id="d4cab-145">Each time the CLR loads or unloads a class, compiles a function, and so on, it calls the corresponding method in the profiler's `ICorProfilerCallback` or `ICorProfilerCallback2` interface.</span></span>  
  
 <span data-ttu-id="d4cab-146">Beispielsweise könnte ein Profiler codeleistung anhand von zwei Benachrichtigungsfunktionen messen: [FunctionEnter2](../../../../docs/framework/unmanaged-api/profiling/functionenter2-function.md) und [FunctionLeave2](../../../../docs/framework/unmanaged-api/profiling/functionleave2-function.md).</span><span class="sxs-lookup"><span data-stu-id="d4cab-146">For example, a profiler could measure code performance through two notification functions: [FunctionEnter2](../../../../docs/framework/unmanaged-api/profiling/functionenter2-function.md) and [FunctionLeave2](../../../../docs/framework/unmanaged-api/profiling/functionleave2-function.md).</span></span> <span data-ttu-id="d4cab-147">Dazu versieht er lediglich jede Benachrichtigung mit einem Zeitstempel, sammelt Ergebnisse und gibt eine Liste aus, aus der ersichtlich ist, welche Funktionen während der Anwendungsausführung die meiste CPU- oder Realzeit in Anspruch genommen haben.</span><span class="sxs-lookup"><span data-stu-id="d4cab-147">It just time-stamps each notification, accumulates results, and outputs a list that indicates which functions consumed the most CPU or wall-clock time during the execution of the application.</span></span>  
  
### <a name="the-information-retrieval-interfaces"></a><span data-ttu-id="d4cab-148">Die Datenabrufschnittstellen</span><span class="sxs-lookup"><span data-stu-id="d4cab-148">The Information Retrieval Interfaces</span></span>  
 <span data-ttu-id="d4cab-149">Die anderen Schnittstellen bei der profilerstellung sind [ICorProfilerInfo](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-interface.md) und [ICorProfilerInfo2](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-interface.md).</span><span class="sxs-lookup"><span data-stu-id="d4cab-149">The other main interfaces involved in profiling are [ICorProfilerInfo](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-interface.md) and [ICorProfilerInfo2](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-interface.md).</span></span> <span data-ttu-id="d4cab-150">Der Profiler ruft diese Schnittstellen nach Bedarf auf, um weitere Daten für seine Analysen abzurufen.</span><span class="sxs-lookup"><span data-stu-id="d4cab-150">The profiler calls these interfaces as required to obtain more information to help its analysis.</span></span> <span data-ttu-id="d4cab-151">Beispielsweise wenn die CLR ruft die [FunctionEnter2](../../../../docs/framework/unmanaged-api/profiling/functionenter2-function.md) Funktion stellt einen Funktionsbezeichner bereit.</span><span class="sxs-lookup"><span data-stu-id="d4cab-151">For example, whenever the CLR calls the [FunctionEnter2](../../../../docs/framework/unmanaged-api/profiling/functionenter2-function.md) function, it supplies a function identifier.</span></span> <span data-ttu-id="d4cab-152">Der Profiler erhalten weitere Informationen zu dieser Funktion durch Aufrufen der [ICorProfilerInfo2:: Getfunctioninfo2](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-getfunctioninfo2-method.md) Methode, um die übergeordnete Klasse der Funktion, Name und So weiter zu ermitteln.</span><span class="sxs-lookup"><span data-stu-id="d4cab-152">The profiler can get more information about that function by calling the [ICorProfilerInfo2::GetFunctionInfo2](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-getfunctioninfo2-method.md) method to discover the function's parent class, its name, and so on.</span></span>  
  
 [<span data-ttu-id="d4cab-153">Zurück zum Anfang</span><span class="sxs-lookup"><span data-stu-id="d4cab-153">Back to top</span></span>](#top)  
  
<a name="support"></a>   
## <a name="supported-features"></a><span data-ttu-id="d4cab-154">Unterstützte Funktionen</span><span class="sxs-lookup"><span data-stu-id="d4cab-154">Supported Features</span></span>  
 <span data-ttu-id="d4cab-155">Die Profilerstellungs-API bietet Informationen über verschiedene Ereignisse und Aktionen in der Common Language Runtime.</span><span class="sxs-lookup"><span data-stu-id="d4cab-155">The profiling API provides information about a variety of events and actions that occur in the common language runtime.</span></span> <span data-ttu-id="d4cab-156">Sie können diese Informationen zum Überwachen der internen Funktionsweise von Prozessen und zum Analysieren der Leistung Ihrer .NET Framework-Anwendung verwenden.</span><span class="sxs-lookup"><span data-stu-id="d4cab-156">You can use this information to monitor the inner workings of processes and to analyze the performance of your .NET Framework application.</span></span>  
  
 <span data-ttu-id="d4cab-157">Die Profilerstellungs-API ruft Informationen über die folgenden Aktionen und die Ereignisse ab, die in der CLR auftreten:</span><span class="sxs-lookup"><span data-stu-id="d4cab-157">The profiling API retrieves information about the following actions and events that occur in the CLR:</span></span>  
  
-   <span data-ttu-id="d4cab-158">CLR-Ereignisse beim Starten und Herunterfahren.</span><span class="sxs-lookup"><span data-stu-id="d4cab-158">CLR startup and shutdown events.</span></span>  
  
-   <span data-ttu-id="d4cab-159">Ereignisse bei der Anwendungsdomänenerstellung und beim Herunterfahren.</span><span class="sxs-lookup"><span data-stu-id="d4cab-159">Application domain creation and shutdown events.</span></span>  
  
-   <span data-ttu-id="d4cab-160">Ereignisse beim Laden und Entladen von Assemblys.</span><span class="sxs-lookup"><span data-stu-id="d4cab-160">Assembly loading and unloading events.</span></span>  
  
-   <span data-ttu-id="d4cab-161">Ereignisse beim Laden und Entladen von Ereignissen.</span><span class="sxs-lookup"><span data-stu-id="d4cab-161">Module loading and unloading events.</span></span>  
  
-   <span data-ttu-id="d4cab-162">Ereignisse beim Erstellen und Löschen von COM-vtable.</span><span class="sxs-lookup"><span data-stu-id="d4cab-162">COM vtable creation and destruction events.</span></span>  
  
-   <span data-ttu-id="d4cab-163">Ereignisse bei der JIT-Kompilierung (Just-In-Time) und beim Codepitching.</span><span class="sxs-lookup"><span data-stu-id="d4cab-163">Just-in-time (JIT) compilation and code-pitching events.</span></span>  
  
-   <span data-ttu-id="d4cab-164">Ereignisse beim Laden und Entladen von Klassen.</span><span class="sxs-lookup"><span data-stu-id="d4cab-164">Class loading and unloading events.</span></span>  
  
-   <span data-ttu-id="d4cab-165">Ereignisse beim Erstellen und Löschen von Threads.</span><span class="sxs-lookup"><span data-stu-id="d4cab-165">Thread creation and destruction events.</span></span>  
  
-   <span data-ttu-id="d4cab-166">Ereignisse beim Funktionseinstieg und Funktionsende.</span><span class="sxs-lookup"><span data-stu-id="d4cab-166">Function entry and exit events.</span></span>  
  
-   <span data-ttu-id="d4cab-167">Ausnahmen.</span><span class="sxs-lookup"><span data-stu-id="d4cab-167">Exceptions.</span></span>  
  
-   <span data-ttu-id="d4cab-168">Übergänge zwischen verwalteter und nicht verwalteter Codeausführung.</span><span class="sxs-lookup"><span data-stu-id="d4cab-168">Transitions between managed and unmanaged code execution.</span></span>  
  
-   <span data-ttu-id="d4cab-169">Übergänge zwischen verschiedenen Laufzeitkontexten.</span><span class="sxs-lookup"><span data-stu-id="d4cab-169">Transitions between different runtime contexts.</span></span>  
  
-   <span data-ttu-id="d4cab-170">Informationen über Laufzeitunterbrechungen.</span><span class="sxs-lookup"><span data-stu-id="d4cab-170">Information about runtime suspensions.</span></span>  
  
-   <span data-ttu-id="d4cab-171">Informationen über den Laufzeitspeicherheap und die Garbage Collection-Aktivität.</span><span class="sxs-lookup"><span data-stu-id="d4cab-171">Information about the runtime memory heap and garbage collection activity.</span></span>  
  
 <span data-ttu-id="d4cab-172">Die Profilerstellungs-API kann von jeder (nicht verwalteten) COM-kompatiblen Sprache aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="d4cab-172">The profiling API can be called from any (non-managed) COM-compatible language.</span></span>  
  
 <span data-ttu-id="d4cab-173">Die API ist im Hinblick auf die Prozessor- und Speicherauslastung effizient.</span><span class="sxs-lookup"><span data-stu-id="d4cab-173">The API is efficient with regard to CPU and memory consumption.</span></span> <span data-ttu-id="d4cab-174">Durch die Profilerstellung werden an der Anwendung mit Profil keine Änderungen durchgeführt, die so signifikant sind, dass es zu falschen Ergebnissen kommt.</span><span class="sxs-lookup"><span data-stu-id="d4cab-174">Profiling does not involve changes to the profiled application that are significant enough to cause misleading results.</span></span>  
  
 <span data-ttu-id="d4cab-175">Die Profilerstellungs-API ist sowohl für Samplingprofiler als auch für andere Profiler nützlich.</span><span class="sxs-lookup"><span data-stu-id="d4cab-175">The profiling API is useful to both sampling and non-sampling profilers.</span></span> <span data-ttu-id="d4cab-176">Ein *Sampling-Profiler* untersucht das das Profil in regelmäßigen Teilstrichen, z. B. auf 5 Millisekunden.</span><span class="sxs-lookup"><span data-stu-id="d4cab-176">A *sampling profiler* inspects the profile at regular clock ticks, say, at 5 milliseconds apart.</span></span> <span data-ttu-id="d4cab-177">Ein *nicht-Samplingprofiler* über ein Ereignis synchron mit dem Thread, der das Ereignis verursacht informiert wird.</span><span class="sxs-lookup"><span data-stu-id="d4cab-177">A *non-sampling profiler* is informed of an event synchronously with the thread that causes the event.</span></span>  
  
### <a name="unsupported-functionality"></a><span data-ttu-id="d4cab-178">Nicht unterstützte Funktionalität</span><span class="sxs-lookup"><span data-stu-id="d4cab-178">Unsupported Functionality</span></span>  
 <span data-ttu-id="d4cab-179">Die Profilerstellungs-API unterstützt die folgenden Funktionen nicht:</span><span class="sxs-lookup"><span data-stu-id="d4cab-179">The profiling API does not support the following functionality:</span></span>  
  
-   <span data-ttu-id="d4cab-180">Nicht verwalteter Code, der mit konventionellen Win32-Methoden profiliert werden muss.</span><span class="sxs-lookup"><span data-stu-id="d4cab-180">Unmanaged code, which must be profiled using conventional Win32 methods.</span></span> <span data-ttu-id="d4cab-181">Der CLR-Profiler umfasst jedoch Übergangsereignisse, um die Grenzen zwischen verwaltetem und nicht verwaltetem Code zu ermitteln.</span><span class="sxs-lookup"><span data-stu-id="d4cab-181">However, the CLR profiler includes transition events to determine the boundaries between managed and unmanaged code.</span></span>  
  
-   <span data-ttu-id="d4cab-182">Sich selbst ändernde Anwendungen, die ihren eigenen Code zu bestimmten Zwecken, beispielsweise bei der aspektorientierten Programmierung, selbsttätig ändern.</span><span class="sxs-lookup"><span data-stu-id="d4cab-182">Self-modifying applications that modify their own code for purposes such as aspect-oriented programming.</span></span>  
  
-   <span data-ttu-id="d4cab-183">Grenzüberprüfung, da die Profilerstellungs-API diese Informationen nicht bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="d4cab-183">Bounds checking, because the profiling API does not provide this information.</span></span> <span data-ttu-id="d4cab-184">Die CLR bietet systeminterne Unterstützung für die Überprüfung von Grenzen des gesamten verwalteten Codes.</span><span class="sxs-lookup"><span data-stu-id="d4cab-184">The CLR provides intrinsic support for bounds checking of all managed code.</span></span>  
  
-   <span data-ttu-id="d4cab-185">Remoteprofilerstellung, die aus den folgenden Gründen nicht unterstützt wird:</span><span class="sxs-lookup"><span data-stu-id="d4cab-185">Remote profiling, which is not supported for the following reasons:</span></span>  
  
    -   <span data-ttu-id="d4cab-186">Durch die Remoteprofilerstellung verlängert sich die Ausführungszeit.</span><span class="sxs-lookup"><span data-stu-id="d4cab-186">Remote profiling extends execution time.</span></span> <span data-ttu-id="d4cab-187">Bei der Verwendung der Profilerstellungsschnittstellen müssen Sie die Ausführungszeit minimieren, damit die Auswirkungen auf die Profilerstellungsergebnisse möglichst gering bleiben.</span><span class="sxs-lookup"><span data-stu-id="d4cab-187">When you use the profiling interfaces, you must minimize execution time so that profiling results will not be unduly affected.</span></span> <span data-ttu-id="d4cab-188">Dies trifft insbesondere dann zu, wenn die Ausführungsleistung überwacht wird.</span><span class="sxs-lookup"><span data-stu-id="d4cab-188">This is especially true when execution performance is being monitored.</span></span> <span data-ttu-id="d4cab-189">Dabei stellt die Remoteprofilerstellung jedoch keine Einschränkung dar, wenn Profilerstellungsschnittstellen zum Überwachen der Speicherauslastung oder zum Abrufen von Laufzeitinformationen über Stapelrahmen, Objekte usw. verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="d4cab-189">However, remote profiling is not a limitation when the profiling interfaces are used to monitor memory usage or to obtain run-time information about stack frames, objects, and so on.</span></span>  
  
    -   <span data-ttu-id="d4cab-190">Der CLR-Codeprofiler muss mindestens eine Rückrufschnittstelle bei der Laufzeit des lokalen Computers registrieren, auf dem die Anwendung mit Profil ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="d4cab-190">The CLR code profiler must register one or more callback interfaces with the runtime on the local computer on which the profiled application is running.</span></span> <span data-ttu-id="d4cab-191">Hierdurch wird die Möglichkeit eingeschränkt, einen Remotecodeprofiler zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="d4cab-191">This limits the ability to create a remote code profiler.</span></span>  
  
-   <span data-ttu-id="d4cab-192">Profilerstellung in Produktionsumgebungen, die eine hohe Verfügbarkeit erfordern.</span><span class="sxs-lookup"><span data-stu-id="d4cab-192">Profiling in production environments with high-availability requirements.</span></span> <span data-ttu-id="d4cab-193">Die Profilerstellungs-API wurde erstellt, um die Diagnose bei der Entwicklung zu unterstützen.</span><span class="sxs-lookup"><span data-stu-id="d4cab-193">The profiling API was created to support development-time diagnostics.</span></span> <span data-ttu-id="d4cab-194">Sie wurde nicht den strengen Tests unterzogen, die für die Unterstützung einer Produktionsumgebung erforderlich sind.</span><span class="sxs-lookup"><span data-stu-id="d4cab-194">It has not undergone the rigorous testing required to support production environments.</span></span>  
  
 [<span data-ttu-id="d4cab-195">Zurück zum Anfang</span><span class="sxs-lookup"><span data-stu-id="d4cab-195">Back to top</span></span>](#top)  
  
<a name="notification_threads"></a>   
## <a name="notification-threads"></a><span data-ttu-id="d4cab-196">Benachrichtigungsthreads</span><span class="sxs-lookup"><span data-stu-id="d4cab-196">Notification Threads</span></span>  
 <span data-ttu-id="d4cab-197">In den meisten Fällen führt der Thread, der ein Ereignis generiert, auch Benachrichtigungen aus.</span><span class="sxs-lookup"><span data-stu-id="d4cab-197">In most cases, the thread that generates an event also executes notifications.</span></span> <span data-ttu-id="d4cab-198">Diese e-Mail-Benachrichtigungen (z. B. [FunctionEnter](../../../../docs/framework/unmanaged-api/profiling/functionenter-function.md) und [FunctionLeave](../../../../docs/framework/unmanaged-api/profiling/functionleave-function.md)) müssen nicht den expliziten angeben `ThreadID`.</span><span class="sxs-lookup"><span data-stu-id="d4cab-198">Such notifications (for example, [FunctionEnter](../../../../docs/framework/unmanaged-api/profiling/functionenter-function.md) and [FunctionLeave](../../../../docs/framework/unmanaged-api/profiling/functionleave-function.md)) do not need to supply the explicit `ThreadID`.</span></span> <span data-ttu-id="d4cab-199">Zudem kann der Profiler basierend auf der `ThreadID` des jeweiligen Threads entscheiden, seine Analyseblöcke im lokalen Threadspeicher zu speichern und zu aktualisieren, anstatt die Analyseblöcke im globalen Speicher zu indizieren.</span><span class="sxs-lookup"><span data-stu-id="d4cab-199">Also, the profiler might decide to use thread-local storage to store and update its analysis blocks instead of indexing the analysis blocks in global storage, based on the `ThreadID` of the affected thread.</span></span>  
  
 <span data-ttu-id="d4cab-200">Beachten Sie, dass diese Rückrufe nicht serialisiert werden.</span><span class="sxs-lookup"><span data-stu-id="d4cab-200">Note that these callbacks are not serialized.</span></span> <span data-ttu-id="d4cab-201">Benutzer müssen ihren Code schützen, indem sie threadsichere Datenstrukturen erstellen und den Profilercode ggf. sperren, um zu verhindern, dass mehrere Threads parallel darauf zugreifen.</span><span class="sxs-lookup"><span data-stu-id="d4cab-201">Users must protect their code by creating thread-safe data structures and by locking the profiler code where necessary to prevent parallel access from multiple threads.</span></span> <span data-ttu-id="d4cab-202">Deshalb kann es in bestimmten Fällen passieren, dass Sie eine ungewöhnliche Sequenz von Rückrufen erhalten.</span><span class="sxs-lookup"><span data-stu-id="d4cab-202">Therefore, in certain cases you can receive an unusual sequence of callbacks.</span></span> <span data-ttu-id="d4cab-203">Nehmen Sie z. B. an, dass eine verwaltete Anwendung zwei Threads erzeugt, die identischen Code ausführen.</span><span class="sxs-lookup"><span data-stu-id="d4cab-203">For example, assume that a managed application is spawning two threads that are executing identical code.</span></span> <span data-ttu-id="d4cab-204">In diesem Fall ist es möglich, erhalten eine [ICorProfilerCallback:: JITCompilationStarted](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-jitcompilationstarted-method.md) -Ereignis für eine Funktion von einem Thread und einen `FunctionEnter` -Rückruf von dem anderen Thread empfangen, bevor die [ ICorProfilerCallback:: JITCompilationFinished](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-jitcompilationfinished-method.md) Rückruf.</span><span class="sxs-lookup"><span data-stu-id="d4cab-204">In this case, it is possible to receive a [ICorProfilerCallback::JITCompilationStarted](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-jitcompilationstarted-method.md) event for some function from one thread and a `FunctionEnter` callback from the other thread before receiving the [ICorProfilerCallback::JITCompilationFinished](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-jitcompilationfinished-method.md) callback.</span></span> <span data-ttu-id="d4cab-205">In diesem Fall erhält der Benutzer einen `FunctionEnter`-Rückruf für eine Funktion, für die möglicherweise noch keine vollständige JIT-Kompilierung (Just-In-Time) erfolgt ist.</span><span class="sxs-lookup"><span data-stu-id="d4cab-205">In this case, the user will receive a `FunctionEnter` callback for a function that may not have been fully just-in-time (JIT) compiled yet.</span></span>  
  
 [<span data-ttu-id="d4cab-206">Zurück zum Anfang</span><span class="sxs-lookup"><span data-stu-id="d4cab-206">Back to top</span></span>](#top)  
  
<a name="security"></a>   
## <a name="security"></a><span data-ttu-id="d4cab-207">Sicherheit</span><span class="sxs-lookup"><span data-stu-id="d4cab-207">Security</span></span>  
 <span data-ttu-id="d4cab-208">Eine Profilerstellungs-DLL ist eine nicht verwaltete DLL, die als Teil des Common Language Runtime-Ausführungsmoduls ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="d4cab-208">A profiler DLL is an unmanaged DLL that runs as part of the common language runtime execution engine.</span></span> <span data-ttu-id="d4cab-209">Daher gelten die Einschränkungen für die Sicherheit des Zugriffs auf verwalteten Code nicht für den Code in der Profilerstellungs-DLL.</span><span class="sxs-lookup"><span data-stu-id="d4cab-209">As a result, the code in the profiler DLL is not subject to the restrictions of managed code access security.</span></span> <span data-ttu-id="d4cab-210">Für die Profilerstellungs-DLL gelten nur die Einschränkungen, die das Betriebssystem für den Benutzer erzwingt, der die Anwendung mit Profil ausführt.</span><span class="sxs-lookup"><span data-stu-id="d4cab-210">The only limitations on the profiler DLL are those imposed by the operating system on the user who is running the profiled application.</span></span>  
  
 <span data-ttu-id="d4cab-211">Entwickler von Profilern sollten entsprechende Vorkehrungen treffen, um sicherheitsrelevante Probleme zu vermeiden.</span><span class="sxs-lookup"><span data-stu-id="d4cab-211">Profiler authors should take appropriate precautions to avoid security-related issues.</span></span> <span data-ttu-id="d4cab-212">So sollte beispielsweise eine Profilerstellungs-DLL während der Installation in eine Zugriffssteuerungsliste (ACL) aufgenommen werden, damit sie nicht durch böswillige Benutzer geändert werden kann.</span><span class="sxs-lookup"><span data-stu-id="d4cab-212">For example, during installation, a profiler DLL should be added to an access control list (ACL) so that a malicious user cannot modify it.</span></span>  
  
 [<span data-ttu-id="d4cab-213">Zurück zum Anfang</span><span class="sxs-lookup"><span data-stu-id="d4cab-213">Back to top</span></span>](#top)  
  
<a name="combining_managed_unmanaged"></a>   
## <a name="combining-managed-and-unmanaged-code-in-a-code-profiler"></a><span data-ttu-id="d4cab-214">Kombination von verwaltetem und nicht verwaltetem Code in einem Codeprofiler</span><span class="sxs-lookup"><span data-stu-id="d4cab-214">Combining Managed and Unmanaged Code in a Code Profiler</span></span>  
 <span data-ttu-id="d4cab-215">Ein falsch geschriebener Profiler kann zirkuläre Verweise auf sich selbst verursachen und zu unvorhersehbarem Verhalten führen.</span><span class="sxs-lookup"><span data-stu-id="d4cab-215">An incorrectly written profiler can cause circular references to itself, resulting in unpredictable behavior.</span></span>  
  
 <span data-ttu-id="d4cab-216">Bei näherer Betrachtung der Profilerstellungs-API kann der Eindruck entstehen, dass es möglich wäre, einen Profiler mit verwalteten und nicht verwalteten Komponenten zu schreiben, die sich gegenseitig über COM-Interop oder indirekte Aufrufe aufrufen.</span><span class="sxs-lookup"><span data-stu-id="d4cab-216">A review of the CLR profiling API may create the impression that you can write a profiler that contains managed and unmanaged components that call each other through COM interop or indirect calls.</span></span>  
  
 <span data-ttu-id="d4cab-217">Obwohl dies aus der Entwurfsperspektive möglich ist, unterstützt die Profilerstellungs-API keine verwalteten Komponenten.</span><span class="sxs-lookup"><span data-stu-id="d4cab-217">Although this is possible from a design perspective, the profiling API does not support managed components.</span></span> <span data-ttu-id="d4cab-218">Ein CLR-Profiler darf keinerlei verwaltete Komponenten enthalten.</span><span class="sxs-lookup"><span data-stu-id="d4cab-218">A CLR profiler must be completely unmanaged.</span></span> <span data-ttu-id="d4cab-219">Versuche, verwalteten und nicht verwalteten Code in einem CLR-Profiler zu kombinieren, können Regelverletzungen, Programmausfälle oder Deadlocks verursachen.</span><span class="sxs-lookup"><span data-stu-id="d4cab-219">Attempts to combine managed and unmanaged code in a CLR profiler may cause access violations, program failure, or deadlocks.</span></span> <span data-ttu-id="d4cab-220">Die verwalteten Komponenten des Profilers verweisen Ereignisse zurück an ihre nicht verwalteten Komponenten, die in der Folge erneut die verwalteten Komponenten aufrufen. Dies führt zu zirkulären Verweisen.</span><span class="sxs-lookup"><span data-stu-id="d4cab-220">The managed components of the profiler will fire events back to their unmanaged components, which would subsequently call the managed components again, resulting in circular references.</span></span>  
  
 <span data-ttu-id="d4cab-221">Der einzige Ort, an dem ein CLR-Profiler verwalteten Code sicher aufrufen kann, ist innerhalb des Texts einer Methode im MSIL-Code (Microsoft Intermediate Language).</span><span class="sxs-lookup"><span data-stu-id="d4cab-221">The only location where a CLR profiler can call managed code safely is in the Microsoft intermediate language (MSIL) body of a method.</span></span> <span data-ttu-id="d4cab-222">Die empfohlene Vorgehensweise zum Ändern von MSIL-Text ist die Verwendung der JIT-neukompilierungsmethoden in der [ICorProfilerCallback4](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback4-interface.md) Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="d4cab-222">The recommended practice for modifying the MSIL body is to use the  JIT recompilation methods in the [ICorProfilerCallback4](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback4-interface.md) interface.</span></span>  
  
 <span data-ttu-id="d4cab-223">Es können auch die älteren Instrumentierungsmethoden zum Ändern von MSIL verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="d4cab-223">It is also possible to use the older instrumentation methods to modify MSIL.</span></span> <span data-ttu-id="d4cab-224">Vor dem Abschluss der Just-in-Time (JIT)-Kompilierung einer Funktion kann der Profiler verwaltete Aufrufe einfügen, in MSIL-Texts einer Methode, und JIT-kompiliert es (finden Sie unter der [ICorProfilerInfo:: GetILFunctionBody](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-getilfunctionbody-method.md) Methode).</span><span class="sxs-lookup"><span data-stu-id="d4cab-224">Before the just-in-time (JIT) compilation of a function is completed, the profiler can insert managed calls in the MSIL body of a method and then JIT-compile it (see the [ICorProfilerInfo::GetILFunctionBody](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-getilfunctionbody-method.md) method).</span></span> <span data-ttu-id="d4cab-225">Diese Technik lässt sich erfolgreich für die selektive Instrumentierung von verwaltetem Code oder für die Erfassung von Statistik- und Leistungsdaten für JIT verwenden.</span><span class="sxs-lookup"><span data-stu-id="d4cab-225">This technique can successfully be used for selective instrumentation of managed code, or to gather statistics and performance data about the JIT.</span></span>  
  
 <span data-ttu-id="d4cab-226">Alternativ dazu kann ein Codeprofiler native Hooks in den MSIL-Text jeder verwalteten Funktion einfügen, die nicht verwalteten Code aufruft.</span><span class="sxs-lookup"><span data-stu-id="d4cab-226">Alternatively, a code profiler can insert native hooks in the MSIL body of every managed function that calls into unmanaged code.</span></span> <span data-ttu-id="d4cab-227">Diese Technik kann für Instrumentation und Abdeckung verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="d4cab-227">This technique can be used for instrumentation and coverage.</span></span> <span data-ttu-id="d4cab-228">So kann beispielsweise ein Codeprofiler Instrumentationshooks nach jedem MSIL-Block einfügen, um sicherzustellen, dass der Block ausgeführt wurde.</span><span class="sxs-lookup"><span data-stu-id="d4cab-228">For example, a code profiler could insert instrumentation hooks after every MSIL block to ensure that the block has been executed.</span></span> <span data-ttu-id="d4cab-229">Bei der Modifikation des MSIL-Texts einer Methode muss sehr sorgfältig vorgegangen werden, und eine Vielzahl von Faktoren muss berücksichtigt werden.</span><span class="sxs-lookup"><span data-stu-id="d4cab-229">The modification of the MSIL body of a method is a very delicate operation, and there are many factors that should be taken into consideration.</span></span>  
  
 [<span data-ttu-id="d4cab-230">Zurück zum Anfang</span><span class="sxs-lookup"><span data-stu-id="d4cab-230">Back to top</span></span>](#top)  
  
<a name="unmanaged"></a>   
## <a name="profiling-unmanaged-code"></a><span data-ttu-id="d4cab-231">Profilerstellung für nicht verwalteten Code</span><span class="sxs-lookup"><span data-stu-id="d4cab-231">Profiling Unmanaged Code</span></span>  
 <span data-ttu-id="d4cab-232">Die Profilerstellungs-API der Common Language Runtime (CLR) bietet minimale Unterstützung zur Profilerstellung für nicht verwalteten Code.</span><span class="sxs-lookup"><span data-stu-id="d4cab-232">The common language runtime (CLR) profiling API provides minimal support for profiling unmanaged code.</span></span> <span data-ttu-id="d4cab-233">Die folgende Funktionalität wird bereitgestellt:</span><span class="sxs-lookup"><span data-stu-id="d4cab-233">The following functionality is provided:</span></span>  
  
-   <span data-ttu-id="d4cab-234">Enumeration von Stapelketten.</span><span class="sxs-lookup"><span data-stu-id="d4cab-234">Enumeration of stack chains.</span></span> <span data-ttu-id="d4cab-235">Dieses Feature ermöglicht einem Codeprofiler, die Grenze zwischen verwaltetem und nicht verwaltetem Code zu bestimmen.</span><span class="sxs-lookup"><span data-stu-id="d4cab-235">This feature enables a code profiler to determine the boundary between managed code and unmanaged code.</span></span>  
  
-   <span data-ttu-id="d4cab-236">Feststellung, ob eine Stapelkette verwaltetem oder systemeigenem Code entspricht.</span><span class="sxs-lookup"><span data-stu-id="d4cab-236">Determination whether a stack chain corresponds to managed code or native code.</span></span>  
  
 <span data-ttu-id="d4cab-237">In .NET Framework, Version 1.0 und 1.1, sind diese Methoden über den prozessinternen Teil der Debug-API der CLR verfügbar.</span><span class="sxs-lookup"><span data-stu-id="d4cab-237">In the .NET Framework versions 1.0 and 1.1, these methods are available through the in-process subset of the CLR debugging API.</span></span> <span data-ttu-id="d4cab-238">Sie sind in der Datei "CorDebug.idl" definiert.</span><span class="sxs-lookup"><span data-stu-id="d4cab-238">They are defined in the CorDebug.idl file.</span></span>  
  
 <span data-ttu-id="d4cab-239">In .NET Framework 2.0 und höher können Sie die [ICorProfilerInfo2:: DoStackSnapshot](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-dostacksnapshot-method.md) Methode für diese Funktionalität.</span><span class="sxs-lookup"><span data-stu-id="d4cab-239">In the .NET Framework 2.0 and later, you can use the [ICorProfilerInfo2::DoStackSnapshot](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-dostacksnapshot-method.md) method for this functionality.</span></span>  
  
 [<span data-ttu-id="d4cab-240">Zurück zum Anfang</span><span class="sxs-lookup"><span data-stu-id="d4cab-240">Back to top</span></span>](#top)  
  
<a name="com"></a>   
## <a name="using-com"></a><span data-ttu-id="d4cab-241">Verwenden von COM</span><span class="sxs-lookup"><span data-stu-id="d4cab-241">Using COM</span></span>  
 <span data-ttu-id="d4cab-242">Obwohl die Profilerstellungsschnittstellen als COM-Schnittstellen definiert sind, initialisiert die Common Language Runtime (CLR) COM tatsächlich nicht zur Verwendung dieser Schnittstellen.</span><span class="sxs-lookup"><span data-stu-id="d4cab-242">Although the profiling interfaces are defined as COM interfaces, the common language runtime (CLR) does not actually initialize COM to use these interfaces.</span></span> <span data-ttu-id="d4cab-243">Der Grund besteht darin zu vermeiden, dass Festlegen des Threadingmodells durch Verwendung der [CoInitialize](http://msdn.microsoft.com/library/windows/desktop/ms678543\(v=vs.85\).aspx) Funktion, bevor die verwaltete Anwendung die Möglichkeit, die das gewünschte Threadingmodell festzulegen hatte.</span><span class="sxs-lookup"><span data-stu-id="d4cab-243">The reason is to avoid having to set the threading model by using the [CoInitialize](http://msdn.microsoft.com/library/windows/desktop/ms678543\(v=vs.85\).aspx) function before the managed application has had a chance to specify its desired threading model.</span></span> <span data-ttu-id="d4cab-244">Ähnlich sollte auch der Profiler selbst `CoInitialize`, nicht aufrufen, da sonst ein Threadingmodell ausgewählt werden könnte, das mit der Anwendung, für die ein Profil erstellt wird, nicht kompatibel ist und es daher zu einem Anwendungsfehler kommen kann.</span><span class="sxs-lookup"><span data-stu-id="d4cab-244">Similarly, the profiler itself should not call `CoInitialize`, because it may pick a threading model that is incompatible with the application being profiled and may cause the application to fail.</span></span>  
  
 [<span data-ttu-id="d4cab-245">Zurück zum Anfang</span><span class="sxs-lookup"><span data-stu-id="d4cab-245">Back to top</span></span>](#top)  
  
<a name="call_stacks"></a>   
## <a name="call-stacks"></a><span data-ttu-id="d4cab-246">Aufruflisten</span><span class="sxs-lookup"><span data-stu-id="d4cab-246">Call Stacks</span></span>  
 <span data-ttu-id="d4cab-247">Die Profilerstellungs-API bietet zwei Methoden zum Abrufen von Aufruflisten: eine Stapelmomentaufnahmemethode, mit der Anruflisten sporadisch überwacht werden können, und eine Schattenstapelmethode, mit der Anruflisten laufend überwacht werden können.</span><span class="sxs-lookup"><span data-stu-id="d4cab-247">The profiling API provides two ways to obtain call stacks: a stack snapshot method, which enables sparse gathering of call stacks, and a shadow stack method, which tracks the call stack at every instant.</span></span>  
  
### <a name="stack-snapshot"></a><span data-ttu-id="d4cab-248">Stapelmomentaufnahme</span><span class="sxs-lookup"><span data-stu-id="d4cab-248">Stack Snapshot</span></span>  
 <span data-ttu-id="d4cab-249">Unter einer Stapelmomentaufnahme versteht man die Überwachung eines Threadstapels zu einem bestimmten Zeitpunkt.</span><span class="sxs-lookup"><span data-stu-id="d4cab-249">A stack snapshot is a trace of the stack of a thread at an instant in time.</span></span> <span data-ttu-id="d4cab-250">Die Profilerstellungs-API unterstützt die Überwachung von verwalteten Funktionen im Stapel, überlässt jedoch die Überwachung nicht verwalteter Funktionen dem Stackwalker des Profilers.</span><span class="sxs-lookup"><span data-stu-id="d4cab-250">The profiling API supports the tracing of managed functions on the stack, but it leaves the tracing of unmanaged functions to the profiler's own stack walker.</span></span>  
  
 <span data-ttu-id="d4cab-251">Weitere Informationen dazu, wie Sie den Profiler zum Durchlaufen verwalteter Stapel programmieren, finden Sie unter der [ICorProfilerInfo2:: DoStackSnapshot](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-dostacksnapshot-method.md) Methode in dieser Dokumentationsreihe und [Profiler Stackwalk in .NET Framework 2.0: Grundlagen und mehr](http://go.microsoft.com/fwlink/?LinkId=73638).</span><span class="sxs-lookup"><span data-stu-id="d4cab-251">For more information about how to program the profiler to walk managed stacks, see the [ICorProfilerInfo2::DoStackSnapshot](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-dostacksnapshot-method.md) method in this documentation set, and [Profiler Stack Walking in the .NET Framework 2.0: Basics and Beyond](http://go.microsoft.com/fwlink/?LinkId=73638).</span></span>
  
### <a name="shadow-stack"></a><span data-ttu-id="d4cab-252">Schattenstapel</span><span class="sxs-lookup"><span data-stu-id="d4cab-252">Shadow Stack</span></span>  
 <span data-ttu-id="d4cab-253">Die allzu häufige Verwendung der Momentaufnahmemethode kann schnell zu Leistungseinbußen führen.</span><span class="sxs-lookup"><span data-stu-id="d4cab-253">Using the snapshot method too frequently can quickly create a performance issue.</span></span> <span data-ttu-id="d4cab-254">Wenn Sie häufig auftretenden Fehlern stapelverfolgungen nehmen möchten, der Profiler sollte stattdessen erstellt mit einem Schattenstapel mithilfe der [FunctionEnter2](../../../../docs/framework/unmanaged-api/profiling/functionenter2-function.md), [FunctionLeave2](../../../../docs/framework/unmanaged-api/profiling/functionleave2-function.md), [FunctionTailcall2](../../../../docs/framework/unmanaged-api/profiling/functiontailcall2-function.md), und [ICorProfilerCallback2](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback2-interface.md) ausnahmerückrufen.</span><span class="sxs-lookup"><span data-stu-id="d4cab-254">If you want to take stack traces frequently, your profiler should instead build a shadow stack by using the [FunctionEnter2](../../../../docs/framework/unmanaged-api/profiling/functionenter2-function.md), [FunctionLeave2](../../../../docs/framework/unmanaged-api/profiling/functionleave2-function.md), [FunctionTailcall2](../../../../docs/framework/unmanaged-api/profiling/functiontailcall2-function.md), and [ICorProfilerCallback2](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback2-interface.md) exception callbacks.</span></span> <span data-ttu-id="d4cab-255">Der Schattenstapel ist immer aktuell und kann schnell in den Speicher kopiert werden, wenn eine Stapelmomentaufnahme benötigt wird.</span><span class="sxs-lookup"><span data-stu-id="d4cab-255">The shadow stack is always current and can quickly be copied to storage whenever a stack snapshot is needed.</span></span>  
  
 <span data-ttu-id="d4cab-256">Mit einem Schattenstapel können Funktionsargumente, Rückgabewerte und Informationen über generische Instanziierungen abgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="d4cab-256">A shadow stack may obtain function arguments, return values, and information about generic instantiations.</span></span> <span data-ttu-id="d4cab-257">Diese Informationen sind nur über den Schattenstapel verfügbar und können abgerufen werden, wenn die Steuerung an eine Funktion übergeben wird.</span><span class="sxs-lookup"><span data-stu-id="d4cab-257">This information is available only through the shadow stack and may be obtained when control is handed to a function.</span></span> <span data-ttu-id="d4cab-258">Sobald die Funktion ausgeführt wird, sind diese Informationen u. U. jedoch nicht mehr verfügbar.</span><span class="sxs-lookup"><span data-stu-id="d4cab-258">However, this information may not be available later during the run of the function.</span></span>  
  
 [<span data-ttu-id="d4cab-259">Zurück zum Anfang</span><span class="sxs-lookup"><span data-stu-id="d4cab-259">Back to top</span></span>](#top)  
  
<a name="callbacks"></a>   
## <a name="callbacks-and-stack-depth"></a><span data-ttu-id="d4cab-260">Rückrufe und Stapeltiefe</span><span class="sxs-lookup"><span data-stu-id="d4cab-260">Callbacks and Stack Depth</span></span>  
 <span data-ttu-id="d4cab-261">Profilerrückrufe können ausgegeben werden, wenn der Stapel stark eingeschränkt ist, und ein Stapelüberlauf in einem Profilerrückruf führt zum sofortigen Prozessende.</span><span class="sxs-lookup"><span data-stu-id="d4cab-261">Profiler callbacks may be issued in very stack-constrained circumstances, and a stack overflow in a profiler callback will lead to an immediate process exit.</span></span> <span data-ttu-id="d4cab-262">Ein Profiler sollte bei der Reaktion auf Rückrufe möglichst wenige Stapel verwenden.</span><span class="sxs-lookup"><span data-stu-id="d4cab-262">A profiler should make sure to use as little stack as possible in response to callbacks.</span></span> <span data-ttu-id="d4cab-263">Wenn der Profiler für Prozesse verwendet werden soll, die vor Stapelüberlauf geschützt sind, sollte der Profiler selbst möglichst auch keinen Stapelüberlauf auslösen.</span><span class="sxs-lookup"><span data-stu-id="d4cab-263">If the profiler is intended for use against processes that are robust against stack overflow, the profiler itself should also avoid triggering stack overflow.</span></span>  
  
 [<span data-ttu-id="d4cab-264">Zurück zum Anfang</span><span class="sxs-lookup"><span data-stu-id="d4cab-264">Back to top</span></span>](#top)  
  
<a name="related_topics"></a>   
## <a name="related-topics"></a><span data-ttu-id="d4cab-265">Verwandte Themen</span><span class="sxs-lookup"><span data-stu-id="d4cab-265">Related Topics</span></span>  
  
|<span data-ttu-id="d4cab-266">Titel</span><span class="sxs-lookup"><span data-stu-id="d4cab-266">Title</span></span>|<span data-ttu-id="d4cab-267">Beschreibung</span><span class="sxs-lookup"><span data-stu-id="d4cab-267">Description</span></span>|  
|-----------|-----------------|  
|[<span data-ttu-id="d4cab-268">Einrichten einer Profilerstellungsumgebung</span><span class="sxs-lookup"><span data-stu-id="d4cab-268">Setting Up a Profiling Environment</span></span>](../../../../docs/framework/unmanaged-api/profiling/setting-up-a-profiling-environment.md)|<span data-ttu-id="d4cab-269">Erklärt, wie ein Profiler initialisiert, Ereignisbenachrichtigungen festgelegt und ein Profil für einen Windows-Dienst erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="d4cab-269">Explains how to initialize a profiler, set event notifications, and profile a Windows Service.</span></span>|  
|[<span data-ttu-id="d4cab-270">Profilerstellungsschnittstellen</span><span class="sxs-lookup"><span data-stu-id="d4cab-270">Profiling Interfaces</span></span>](../../../../docs/framework/unmanaged-api/profiling/profiling-interfaces.md)|<span data-ttu-id="d4cab-271">Beschreibt die nicht verwalteten Schnittstellen, die die Profilerstellungs-API verwendet.</span><span class="sxs-lookup"><span data-stu-id="d4cab-271">Describes the unmanaged interfaces that the profiling API uses.</span></span>|  
|[<span data-ttu-id="d4cab-272">Profilerstellung für globale statische Funktionen</span><span class="sxs-lookup"><span data-stu-id="d4cab-272">Profiling Global Static Functions</span></span>](../../../../docs/framework/unmanaged-api/profiling/profiling-global-static-functions.md)|<span data-ttu-id="d4cab-273">Beschreibt die nicht verwalteten globalen statischen Funktionen, die die Profilerstellungs-API verwendet.</span><span class="sxs-lookup"><span data-stu-id="d4cab-273">Describes the unmanaged global static functions that the profiling API uses.</span></span>|  
|[<span data-ttu-id="d4cab-274">Profilerstellungsenumerationen</span><span class="sxs-lookup"><span data-stu-id="d4cab-274">Profiling Enumerations</span></span>](../../../../docs/framework/unmanaged-api/profiling/profiling-enumerations.md)|<span data-ttu-id="d4cab-275">Beschreibt die nicht verwalteten Enumerationen, die die Profilerstellungs-API verwendet.</span><span class="sxs-lookup"><span data-stu-id="d4cab-275">Describes the unmanaged enumerations that the profiling API uses.</span></span>|  
|[<span data-ttu-id="d4cab-276">Profilerstellungsstrukturen</span><span class="sxs-lookup"><span data-stu-id="d4cab-276">Profiling Structures</span></span>](../../../../docs/framework/unmanaged-api/profiling/profiling-structures.md)|<span data-ttu-id="d4cab-277">Beschreibt die nicht verwalteten Strukturen, die die Profilerstellungs-API verwendet.</span><span class="sxs-lookup"><span data-stu-id="d4cab-277">Describes the unmanaged structures that the profiling API uses.</span></span>|
