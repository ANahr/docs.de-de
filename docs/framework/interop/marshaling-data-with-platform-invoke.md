---
title: Marshallen von Daten mit Plattformaufruf
ms.date: 03/30/2017
dev_langs:
- cpp
helpviewer_keywords:
- platform invoke, marshaling data
- data marshaling, platform invoke
- marshaling, platform invoke
ms.assetid: dc5c76cf-7b12-406f-b79c-d1a023ec245d
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: 2eb55d8490eae64e909ada68223983c570ef9afa
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 05/04/2018
ms.locfileid: "33391315"
---
# <a name="marshaling-data-with-platform-invoke"></a><span data-ttu-id="3e2c2-102">Marshallen von Daten mit Plattformaufruf</span><span class="sxs-lookup"><span data-stu-id="3e2c2-102">Marshaling Data with Platform Invoke</span></span>
<span data-ttu-id="3e2c2-103">Zum Aufrufen von Funktionen, die aus einer unverwalteten Bibliothek exportiert wurden, erfordert eine .NET Framework-Anwendung einen Funktionsprototypen im verwalteten Code, der die unverwaltete Funktion darstellt.</span><span class="sxs-lookup"><span data-stu-id="3e2c2-103">To call functions exported from an unmanaged library, a .NET Framework application requires a function prototype in managed code that represents the unmanaged function.</span></span> <span data-ttu-id="3e2c2-104">Gehen Sie zum Erstellen eines Prototypen, der den Aufruf der Plattform für das korrekte Marshalling von Daten ermöglicht, gehen Sie folgendermaßen vor:</span><span class="sxs-lookup"><span data-stu-id="3e2c2-104">To create a prototype that enables platform invoke to marshal data correctly, you must do the following:</span></span>  
  
-   <span data-ttu-id="3e2c2-105">Wenden Sie das <xref:System.Runtime.InteropServices.DllImportAttribute>-Attribut auf die statische Funktion oder Methode im verwalteten Code an.</span><span class="sxs-lookup"><span data-stu-id="3e2c2-105">Apply the <xref:System.Runtime.InteropServices.DllImportAttribute> attribute to the static function or method in managed code.</span></span>  
  
-   <span data-ttu-id="3e2c2-106">Ersetzen Sie verwaltete Datentypen durch unverwaltete Datentypen.</span><span class="sxs-lookup"><span data-stu-id="3e2c2-106">Substitute managed data types for unmanaged data types.</span></span>  
  
 <span data-ttu-id="3e2c2-107">Sie können die mit einer unverwalteten Funktion bereitgestellten Dokumentation verwendet, um einen äquivalenten verwalteten Prototypen zu erstellen, indem Sie das Attribut mit seinen optionalen Feldern anwenden und verwaltete Datentypen durch unverwaltete Datentypen ersetzen.</span><span class="sxs-lookup"><span data-stu-id="3e2c2-107">You can use the documentation supplied with an unmanaged function to construct an equivalent managed prototype by applying the attribute with its optional fields and substituting managed data types for unmanaged types.</span></span> <span data-ttu-id="3e2c2-108">Anweisungen zum Anwenden von **DllImportAttribute** finden Sie unter [Consuming Unmanaged DLL Functions (Verwenden nicht verwalteter DLL-Funktionen)](../../../docs/framework/interop/consuming-unmanaged-dll-functions.md).</span><span class="sxs-lookup"><span data-stu-id="3e2c2-108">For instructions about how to apply the **DllImportAttribute**, see [Consuming Unmanaged DLL Functions](../../../docs/framework/interop/consuming-unmanaged-dll-functions.md).</span></span>  
  
 <span data-ttu-id="3e2c2-109">Dieser Abschnitt enthält Beispiele, die zeigen, wie Prototypen für verwaltete Funktionen erstellt werden, an die Argumente übergeben und von denen Werte von Funktionen zurückgegeben werden, die aus unverwalteten Bibliotheken exportiert wurden.</span><span class="sxs-lookup"><span data-stu-id="3e2c2-109">This section provides samples that demonstrate how to create managed function prototypes for passing arguments to and receiving return values from functions exported by unmanaged libraries.</span></span> <span data-ttu-id="3e2c2-110">Die Beispiele zeigen auch, wann das <xref:System.Runtime.InteropServices.MarshalAsAttribute>-Attribut und die <xref:System.Runtime.InteropServices.Marshal>-Klasse zum expliziten Marshallen von Daten verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="3e2c2-110">The samples also demonstrate when to use the <xref:System.Runtime.InteropServices.MarshalAsAttribute> attribute and the <xref:System.Runtime.InteropServices.Marshal> class to explicitly marshal data.</span></span>  
  
## <a name="platform-invoke-data-types"></a><span data-ttu-id="3e2c2-111">Datentypen für den Plattformaufruf</span><span class="sxs-lookup"><span data-stu-id="3e2c2-111">Platform invoke data types</span></span>  
 <span data-ttu-id="3e2c2-112">Die folgende Tabelle listet die Datentypen auf, die in der WIN 32-API (aufgeführt in Wtypes.h) verwendet werden, und die Funktionen im C-Stil auf.</span><span class="sxs-lookup"><span data-stu-id="3e2c2-112">The following table lists data types used in the Win32 API (listed in Wtypes.h) and C-style functions.</span></span> <span data-ttu-id="3e2c2-113">Viele unverwaltete Bibliotheken enthalten Funktionen, die diese Datentypen als Parameter und Rückgabewerte übergeben.</span><span class="sxs-lookup"><span data-stu-id="3e2c2-113">Many unmanaged libraries contain functions that pass these data types as parameters and return values.</span></span> <span data-ttu-id="3e2c2-114">Die dritte Spalte enthält den entsprechenden in .NET Framework integrierten Werttype oder die Klasse, die Sie in verwaltetem Code verwenden.</span><span class="sxs-lookup"><span data-stu-id="3e2c2-114">The third column lists the corresponding .NET Framework built-in value type or class that you use in managed code.</span></span> <span data-ttu-id="3e2c2-115">In einigen Fällen können Sie einen Typ der gleichen Größe durch den in der Tabelle aufgeführten Typ ersetzen.</span><span class="sxs-lookup"><span data-stu-id="3e2c2-115">In some cases, you can substitute a type of the same size for the type listed in the table.</span></span>  
  
|<span data-ttu-id="3e2c2-116">Unverwalteter Typ in Wtypes.h</span><span class="sxs-lookup"><span data-stu-id="3e2c2-116">Unmanaged type in Wtypes.h</span></span>|<span data-ttu-id="3e2c2-117">Unverwalteter Typ in C-Sprache</span><span class="sxs-lookup"><span data-stu-id="3e2c2-117">Unmanaged C language type</span></span>|<span data-ttu-id="3e2c2-118">Name der verwalteten Klasse</span><span class="sxs-lookup"><span data-stu-id="3e2c2-118">Managed class name</span></span>|<span data-ttu-id="3e2c2-119">description</span><span class="sxs-lookup"><span data-stu-id="3e2c2-119">Description</span></span>|  
|--------------------------------|-------------------------------|------------------------|-----------------|  
|<span data-ttu-id="3e2c2-120">**HANDLE**</span><span class="sxs-lookup"><span data-stu-id="3e2c2-120">**HANDLE**</span></span>|<span data-ttu-id="3e2c2-121">**void\***</span><span class="sxs-lookup"><span data-stu-id="3e2c2-121">**void\***</span></span>|<xref:System.IntPtr?displayProperty=nameWithType>|<span data-ttu-id="3e2c2-122">32 Bit unter 32-Bit-Windows-Betriebssystemen, 64 Bit unter 64-Bit-Windows-Betriebssystemen.</span><span class="sxs-lookup"><span data-stu-id="3e2c2-122">32 bits on 32-bit Windows operating systems, 64 bits on 64-bit Windows operating systems.</span></span>|  
|<span data-ttu-id="3e2c2-123">**BYTE**</span><span class="sxs-lookup"><span data-stu-id="3e2c2-123">**BYTE**</span></span>|<span data-ttu-id="3e2c2-124">**unsigned char**</span><span class="sxs-lookup"><span data-stu-id="3e2c2-124">**unsigned char**</span></span>|<xref:System.Byte?displayProperty=nameWithType>|<span data-ttu-id="3e2c2-125">8 Bit</span><span class="sxs-lookup"><span data-stu-id="3e2c2-125">8 bits</span></span>|  
|<span data-ttu-id="3e2c2-126">**SHORT**</span><span class="sxs-lookup"><span data-stu-id="3e2c2-126">**SHORT**</span></span>|<span data-ttu-id="3e2c2-127">**short**</span><span class="sxs-lookup"><span data-stu-id="3e2c2-127">**short**</span></span>|<xref:System.Int16?displayProperty=nameWithType>|<span data-ttu-id="3e2c2-128">16 Bit</span><span class="sxs-lookup"><span data-stu-id="3e2c2-128">16 bits</span></span>|  
|<span data-ttu-id="3e2c2-129">**WORD**</span><span class="sxs-lookup"><span data-stu-id="3e2c2-129">**WORD**</span></span>|<span data-ttu-id="3e2c2-130">**unsigned short**</span><span class="sxs-lookup"><span data-stu-id="3e2c2-130">**unsigned short**</span></span>|<xref:System.UInt16?displayProperty=nameWithType>|<span data-ttu-id="3e2c2-131">16 Bit</span><span class="sxs-lookup"><span data-stu-id="3e2c2-131">16 bits</span></span>|  
|<span data-ttu-id="3e2c2-132">**INT**</span><span class="sxs-lookup"><span data-stu-id="3e2c2-132">**INT**</span></span>|<span data-ttu-id="3e2c2-133">**int**</span><span class="sxs-lookup"><span data-stu-id="3e2c2-133">**int**</span></span>|<xref:System.Int32?displayProperty=nameWithType>|<span data-ttu-id="3e2c2-134">32 Bit</span><span class="sxs-lookup"><span data-stu-id="3e2c2-134">32 bits</span></span>|  
|<span data-ttu-id="3e2c2-135">**UINT**</span><span class="sxs-lookup"><span data-stu-id="3e2c2-135">**UINT**</span></span>|<span data-ttu-id="3e2c2-136">**unsigned int**</span><span class="sxs-lookup"><span data-stu-id="3e2c2-136">**unsigned int**</span></span>|<xref:System.UInt32?displayProperty=nameWithType>|<span data-ttu-id="3e2c2-137">32 Bit</span><span class="sxs-lookup"><span data-stu-id="3e2c2-137">32 bits</span></span>|  
|<span data-ttu-id="3e2c2-138">**LONG**</span><span class="sxs-lookup"><span data-stu-id="3e2c2-138">**LONG**</span></span>|<span data-ttu-id="3e2c2-139">**long**</span><span class="sxs-lookup"><span data-stu-id="3e2c2-139">**long**</span></span>|<xref:System.Int32?displayProperty=nameWithType>|<span data-ttu-id="3e2c2-140">32 Bit</span><span class="sxs-lookup"><span data-stu-id="3e2c2-140">32 bits</span></span>|  
|<span data-ttu-id="3e2c2-141">**BOOL**</span><span class="sxs-lookup"><span data-stu-id="3e2c2-141">**BOOL**</span></span>|<span data-ttu-id="3e2c2-142">**long**</span><span class="sxs-lookup"><span data-stu-id="3e2c2-142">**long**</span></span>|<xref:System.Byte>|<span data-ttu-id="3e2c2-143">32 Bit</span><span class="sxs-lookup"><span data-stu-id="3e2c2-143">32 bits</span></span>|  
|<span data-ttu-id="3e2c2-144">**DWORD**</span><span class="sxs-lookup"><span data-stu-id="3e2c2-144">**DWORD**</span></span>|<span data-ttu-id="3e2c2-145">**unsigned long**</span><span class="sxs-lookup"><span data-stu-id="3e2c2-145">**unsigned long**</span></span>|<xref:System.UInt32?displayProperty=nameWithType>|<span data-ttu-id="3e2c2-146">32 Bit</span><span class="sxs-lookup"><span data-stu-id="3e2c2-146">32 bits</span></span>|  
|<span data-ttu-id="3e2c2-147">**ULONG**</span><span class="sxs-lookup"><span data-stu-id="3e2c2-147">**ULONG**</span></span>|<span data-ttu-id="3e2c2-148">**unsigned long**</span><span class="sxs-lookup"><span data-stu-id="3e2c2-148">**unsigned long**</span></span>|<xref:System.UInt32?displayProperty=nameWithType>|<span data-ttu-id="3e2c2-149">32 Bit</span><span class="sxs-lookup"><span data-stu-id="3e2c2-149">32 bits</span></span>|  
|<span data-ttu-id="3e2c2-150">**CHAR**</span><span class="sxs-lookup"><span data-stu-id="3e2c2-150">**CHAR**</span></span>|<span data-ttu-id="3e2c2-151">**char**</span><span class="sxs-lookup"><span data-stu-id="3e2c2-151">**char**</span></span>|<xref:System.Char?displayProperty=nameWithType>|<span data-ttu-id="3e2c2-152">Mit ANSI ergänzen.</span><span class="sxs-lookup"><span data-stu-id="3e2c2-152">Decorate with ANSI.</span></span>|  
|<span data-ttu-id="3e2c2-153">**WCHAR**</span><span class="sxs-lookup"><span data-stu-id="3e2c2-153">**WCHAR**</span></span>|<span data-ttu-id="3e2c2-154">**wchar_t**</span><span class="sxs-lookup"><span data-stu-id="3e2c2-154">**wchar_t**</span></span>|<xref:System.Char?displayProperty=nameWithType>|<span data-ttu-id="3e2c2-155">Mit Unicode ergänzen.</span><span class="sxs-lookup"><span data-stu-id="3e2c2-155">Decorate with Unicode.</span></span>|  
|<span data-ttu-id="3e2c2-156">**LPSTR**</span><span class="sxs-lookup"><span data-stu-id="3e2c2-156">**LPSTR**</span></span>|<span data-ttu-id="3e2c2-157">**char\***</span><span class="sxs-lookup"><span data-stu-id="3e2c2-157">**char\***</span></span>|<span data-ttu-id="3e2c2-158"><xref:System.String?displayProperty=nameWithType> oder <xref:System.Text.StringBuilder?displayProperty=nameWithType></span><span class="sxs-lookup"><span data-stu-id="3e2c2-158"><xref:System.String?displayProperty=nameWithType> or <xref:System.Text.StringBuilder?displayProperty=nameWithType></span></span>|<span data-ttu-id="3e2c2-159">Mit ANSI ergänzen.</span><span class="sxs-lookup"><span data-stu-id="3e2c2-159">Decorate with ANSI.</span></span>|  
|<span data-ttu-id="3e2c2-160">**LPCSTR**</span><span class="sxs-lookup"><span data-stu-id="3e2c2-160">**LPCSTR**</span></span>|<span data-ttu-id="3e2c2-161">**Const char\***</span><span class="sxs-lookup"><span data-stu-id="3e2c2-161">**Const char\***</span></span>|<span data-ttu-id="3e2c2-162"><xref:System.String?displayProperty=nameWithType> oder <xref:System.Text.StringBuilder?displayProperty=nameWithType></span><span class="sxs-lookup"><span data-stu-id="3e2c2-162"><xref:System.String?displayProperty=nameWithType> or <xref:System.Text.StringBuilder?displayProperty=nameWithType></span></span>|<span data-ttu-id="3e2c2-163">Mit ANSI ergänzen.</span><span class="sxs-lookup"><span data-stu-id="3e2c2-163">Decorate with ANSI.</span></span>|  
|<span data-ttu-id="3e2c2-164">**LPWSTR**</span><span class="sxs-lookup"><span data-stu-id="3e2c2-164">**LPWSTR**</span></span>|<span data-ttu-id="3e2c2-165">**wchar_t\***</span><span class="sxs-lookup"><span data-stu-id="3e2c2-165">**wchar_t\***</span></span>|<span data-ttu-id="3e2c2-166"><xref:System.String?displayProperty=nameWithType> oder <xref:System.Text.StringBuilder?displayProperty=nameWithType></span><span class="sxs-lookup"><span data-stu-id="3e2c2-166"><xref:System.String?displayProperty=nameWithType> or <xref:System.Text.StringBuilder?displayProperty=nameWithType></span></span>|<span data-ttu-id="3e2c2-167">Mit Unicode ergänzen.</span><span class="sxs-lookup"><span data-stu-id="3e2c2-167">Decorate with Unicode.</span></span>|  
|<span data-ttu-id="3e2c2-168">**LPCWSTR**</span><span class="sxs-lookup"><span data-stu-id="3e2c2-168">**LPCWSTR**</span></span>|<span data-ttu-id="3e2c2-169">**Const wchar_t\***</span><span class="sxs-lookup"><span data-stu-id="3e2c2-169">**Const wchar_t\***</span></span>|<span data-ttu-id="3e2c2-170"><xref:System.String?displayProperty=nameWithType> oder <xref:System.Text.StringBuilder?displayProperty=nameWithType></span><span class="sxs-lookup"><span data-stu-id="3e2c2-170"><xref:System.String?displayProperty=nameWithType> or <xref:System.Text.StringBuilder?displayProperty=nameWithType></span></span>|<span data-ttu-id="3e2c2-171">Mit Unicode ergänzen.</span><span class="sxs-lookup"><span data-stu-id="3e2c2-171">Decorate with Unicode.</span></span>|  
|<span data-ttu-id="3e2c2-172">**FLOAT**</span><span class="sxs-lookup"><span data-stu-id="3e2c2-172">**FLOAT**</span></span>|<span data-ttu-id="3e2c2-173">**Float**</span><span class="sxs-lookup"><span data-stu-id="3e2c2-173">**Float**</span></span>|<xref:System.Single?displayProperty=nameWithType>|<span data-ttu-id="3e2c2-174">32 Bit</span><span class="sxs-lookup"><span data-stu-id="3e2c2-174">32 bits</span></span>|  
|<span data-ttu-id="3e2c2-175">**DOUBLE**</span><span class="sxs-lookup"><span data-stu-id="3e2c2-175">**DOUBLE**</span></span>|<span data-ttu-id="3e2c2-176">**Double**</span><span class="sxs-lookup"><span data-stu-id="3e2c2-176">**Double**</span></span>|<xref:System.Double?displayProperty=nameWithType>|<span data-ttu-id="3e2c2-177">64 Bit</span><span class="sxs-lookup"><span data-stu-id="3e2c2-177">64 bits</span></span>|  
  
 <span data-ttu-id="3e2c2-178">Informationen zu den entsprechenden Typen in [!INCLUDE[vbprvblong](../../../includes/vbprvblong-md.md)], C# und C++ finden Sie unter [Einführung in die .NET Framework-Klassenbibliothek](../../../docs/standard/class-library-overview.md).</span><span class="sxs-lookup"><span data-stu-id="3e2c2-178">For corresponding types in [!INCLUDE[vbprvblong](../../../includes/vbprvblong-md.md)], C#, and C++, see the [Introduction to the .NET Framework Class Library](../../../docs/standard/class-library-overview.md).</span></span>  
  
## <a name="pinvokelibdll"></a><span data-ttu-id="3e2c2-179">PinvokeLib.dll</span><span class="sxs-lookup"><span data-stu-id="3e2c2-179">PinvokeLib.dll</span></span>  
 <span data-ttu-id="3e2c2-180">Mit dem folgenden Code werden die Bibliotheksfunktionen definiert, die von der Pinvoke.dll bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="3e2c2-180">The following code defines the library functions provided by Pinvoke.dll.</span></span> <span data-ttu-id="3e2c2-181">Viele Beispiele in diesem Abschnitt rufen diese Bibliothek auf.</span><span class="sxs-lookup"><span data-stu-id="3e2c2-181">Many samples described in this section call this library.</span></span>  
  
### <a name="example"></a><span data-ttu-id="3e2c2-182">Beispiel</span><span class="sxs-lookup"><span data-stu-id="3e2c2-182">Example</span></span>  
 [!code-cpp[PInvokeLib#1](../../../samples/snippets/cpp/VS_Snippets_CLR/pinvokelib/cpp/pinvokelib.cpp#1)]  
  
 [!code-cpp[PInvokeLib#2](../../../samples/snippets/cpp/VS_Snippets_CLR/pinvokelib/cpp/pinvokelib.h#2)]
