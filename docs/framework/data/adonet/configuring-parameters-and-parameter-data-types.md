---
title: Konfigurieren von Parametern und Parameterdatentypen
ms.custom: ''
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: ''
ms.suite: ''
ms.technology:
- dotnet-ado
ms.tgt_pltfrm: ''
ms.topic: article
dev_langs:
- csharp
- vb
ms.assetid: 537d8a2c-d40b-4000-83eb-bc1fcc93f707
caps.latest.revision: 6
author: douglaslMS
ms.author: douglasl
manager: craigg
ms.workload:
- dotnet
ms.openlocfilehash: cdb6efb428f5c096178895f95fe1256846e9c1e5
ms.sourcegitcommit: 86adcc06e35390f13c1e372c36d2e044f1fc31ef
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/26/2018
---
# <a name="configuring-parameters-and-parameter-data-types"></a><span data-ttu-id="ed0cb-102">Konfigurieren von Parametern und Parameterdatentypen</span><span class="sxs-lookup"><span data-stu-id="ed0cb-102">Configuring Parameters and Parameter Data Types</span></span>
<span data-ttu-id="ed0cb-103">Befehlsobjekte verwenden Parameter, um Werte an SQL-Anweisungen oder gespeicherte Prozeduren zu übergeben, und ermöglichen so Typüberprüfungen und Validierungen.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-103">Command objects use parameters to pass values to SQL statements or stored procedures, providing type checking and validation.</span></span> <span data-ttu-id="ed0cb-104">Im Unterschied zu Befehlstext wird die Parametereingabe als Literalwert und nicht als ausführbarer Code behandelt.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-104">Unlike command text, parameter input is treated as a literal value, not as executable code.</span></span> <span data-ttu-id="ed0cb-105">Dies hilft beim Schutz vor SQL Injection-Angriffen, bei denen ein Angreifer einen SQL-Befehl, der die Sicherheit auf dem Server gefährdet, in eine SQL-Anweisung einschleust.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-105">This helps guard against "SQL injection" attacks, in which an attacker inserts a command that compromises security on the server into an SQL statement.</span></span>  
  
 <span data-ttu-id="ed0cb-106">Parametrisierte Befehle können außerdem die Leistung bei der Abfrageausführung verbessern, da sie den Datenbankserver dabei unterstützen, den eingehenden Befehl mit dem richtigen zwischengespeicherten Abfrageplan abzugleichen.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-106">Parameterized commands can also improve query execution performance, because they help the database server accurately match the incoming command with a proper cached query plan.</span></span> <span data-ttu-id="ed0cb-107">Weitere Informationen finden Sie unter [Zwischenspeichern und Wiederverwenden von Ausführungsplänen](http://go.microsoft.com/fwlink/?LinkId=120424) und [Parameter und Wiederverwendung von Ausführungsplänen](http://go.microsoft.com/fwlink/?LinkId=120423) in der SQL Server-Onlinedokumentation.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-107">For more information, see [Execution Plan Caching and Reuse](http://go.microsoft.com/fwlink/?LinkId=120424) and [Parameters and Execution Plan Reuse](http://go.microsoft.com/fwlink/?LinkId=120423) in SQL Server Books Online.</span></span> <span data-ttu-id="ed0cb-108">Parametrisierte Befehle sind aber nicht nur aus Sicherheits- und Leistungsgründen vorteilhaft, sondern sie stellen auch eine bequeme Methode zum Organisieren von Werten dar, die an eine Datenquelle übergeben werden.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-108">In addition to the security and performance benefits, parameterized commands provide a convenient method for organizing values passed to a data source.</span></span>  
  
 <span data-ttu-id="ed0cb-109">Ein <xref:System.Data.Common.DbParameter> -Objekt kann mithilfe des zugehörigen Konstruktors erstellt werden, oder es wird durch Aufrufen der <xref:System.Data.Common.DbCommand.DbParameterCollection%2A> -Methode der `Add` -Auflistung zur <xref:System.Data.Common.DbParameterCollection> hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-109">A <xref:System.Data.Common.DbParameter> object can be created by using its constructor, or by adding it to the <xref:System.Data.Common.DbCommand.DbParameterCollection%2A> by calling the `Add` method of the <xref:System.Data.Common.DbParameterCollection> collection.</span></span> <span data-ttu-id="ed0cb-110">Die `Add` -Methode verwendet als Eingabe je nach Datenanbieter Konstruktorargumente oder ein vorhandenes Parameterobjekt.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-110">The `Add` method will take as input either constructor arguments or an existing parameter object, depending on the data provider.</span></span>  
  
## <a name="supplying-the-parameterdirection-property"></a><span data-ttu-id="ed0cb-111">Bereitstellen der "ParameterDirection"-Eigenschaft</span><span class="sxs-lookup"><span data-stu-id="ed0cb-111">Supplying the ParameterDirection Property</span></span>  
 <span data-ttu-id="ed0cb-112">Beim Hinzufügen von Parametern müssen Sie für alle Parameter, die keine Eingabeparameter sind, die <xref:System.Data.ParameterDirection> -Eigenschaft bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-112">When adding parameters, you must supply a <xref:System.Data.ParameterDirection> property for parameters other than input parameters.</span></span> <span data-ttu-id="ed0cb-113">Die folgende Tabelle zeigt die `ParameterDirection` -Werte, die Sie mit der <xref:System.Data.ParameterDirection> -Enumeration verwenden können.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-113">The following table shows the `ParameterDirection` values that you can use with the <xref:System.Data.ParameterDirection> enumeration.</span></span>  
  
|<span data-ttu-id="ed0cb-114">Membername</span><span class="sxs-lookup"><span data-stu-id="ed0cb-114">Member name</span></span>|<span data-ttu-id="ed0cb-115">Beschreibung</span><span class="sxs-lookup"><span data-stu-id="ed0cb-115">Description</span></span>|  
|-----------------|-----------------|  
|<xref:System.Data.ParameterDirection.Input>|<span data-ttu-id="ed0cb-116">Der Parameter ist ein Eingabeparameter.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-116">The parameter is an input parameter.</span></span> <span data-ttu-id="ed0cb-117">Dies ist die Standardeinstellung.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-117">This is the default.</span></span>|  
|<xref:System.Data.ParameterDirection.InputOutput>|<span data-ttu-id="ed0cb-118">Der Parameter kann sowohl für die Eingabe als auch für die Ausgabe verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-118">The parameter can perform both input and output.</span></span>|  
|<xref:System.Data.ParameterDirection.Output>|<span data-ttu-id="ed0cb-119">Der Parameter ist ein Ausgabeparameter.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-119">The parameter is an output parameter.</span></span>|  
|<xref:System.Data.ParameterDirection.ReturnValue>|<span data-ttu-id="ed0cb-120">Der Parameter steht für einen Eingabewert aus einem Vorgang, wie z. B. einer gespeicherten Prozedur, einer integrierten Funktion oder einer benutzerdefinierten Funktion.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-120">The parameter represents a return value from an operation such as a stored procedure, built-in function, or user-defined function.</span></span>|  
  
## <a name="working-with-parameter-placeholders"></a><span data-ttu-id="ed0cb-121">Arbeiten mit Parameterplatzhaltern</span><span class="sxs-lookup"><span data-stu-id="ed0cb-121">Working with Parameter Placeholders</span></span>  
 <span data-ttu-id="ed0cb-122">Die Syntax für Parameterplatzhalter ist abhängig von der jeweiligen Datenquelle.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-122">The syntax for parameter placeholders depends on the data source.</span></span> <span data-ttu-id="ed0cb-123">Die [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] -Datenanbieter handhaben die Benennung und das Angeben von Parametern und Parameterplatzhaltern unterschiedlich.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-123">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data providers handle naming and specifying parameters and parameter placeholders differently.</span></span> <span data-ttu-id="ed0cb-124">Diese Syntax wird an eine bestimmte Datenquelle angepasst, wie in der folgenden Tabelle beschrieben.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-124">This syntax is customized to a specific data source, as described in the following table.</span></span>  
  
|<span data-ttu-id="ed0cb-125">Datenanbieter</span><span class="sxs-lookup"><span data-stu-id="ed0cb-125">Data provider</span></span>|<span data-ttu-id="ed0cb-126">Syntax für Parameterbenennung</span><span class="sxs-lookup"><span data-stu-id="ed0cb-126">Parameter naming syntax</span></span>|  
|-------------------|-----------------------------|  
|<xref:System.Data.SqlClient>|<span data-ttu-id="ed0cb-127">Verwendet benannte Parameter im Format `@`*Parametername*.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-127">Uses named parameters in the format `@`*parametername*.</span></span>|  
|<xref:System.Data.OleDb>|<span data-ttu-id="ed0cb-128">Verwendet Positionsparametermarker, die durch ein Fragezeichen (`?`) gekennzeichnet sind.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-128">Uses positional parameter markers indicated by a question mark (`?`).</span></span>|  
|<xref:System.Data.Odbc>|<span data-ttu-id="ed0cb-129">Verwendet Positionsparametermarker, die durch ein Fragezeichen (`?`) gekennzeichnet sind.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-129">Uses positional parameter markers indicated by a question mark (`?`).</span></span>|  
|<xref:System.Data.OracleClient>|<span data-ttu-id="ed0cb-130">Verwendet benannte Parameter im Format `:`*Parametername* (oder *Parametername*).</span><span class="sxs-lookup"><span data-stu-id="ed0cb-130">Uses named parameters in the format `:`*parmname* (or *parmname*).</span></span>|  
  
## <a name="specifying-parameter-data-types"></a><span data-ttu-id="ed0cb-131">Angeben von Parameterdatentypen</span><span class="sxs-lookup"><span data-stu-id="ed0cb-131">Specifying Parameter Data Types</span></span>  
 <span data-ttu-id="ed0cb-132">Der Datentyp eines Parameters ist abhängig vom [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] -Datenanbieter.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-132">The data type of a parameter is specific to the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data provider.</span></span> <span data-ttu-id="ed0cb-133">Durch Angabe des Typs wird der Wert von `Parameter` in den Typ des [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] -Datenanbieters konvertiert, bevor er an die Datenquelle übergeben wird.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-133">Specifying the type converts the value of the `Parameter` to the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data provider type before passing the value to the data source.</span></span> <span data-ttu-id="ed0cb-134">Der Typ eines `Parameter` kann auch in generischer Form angegeben werden, indem die `DbType` -Eigenschaft des `Parameter` -Objekts auf einen bestimmten <xref:System.Data.DbType>festgelegt wird.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-134">You may also specify the type of a `Parameter` in a generic manner by setting the `DbType` property of the `Parameter` object to a particular <xref:System.Data.DbType>.</span></span>  
  
 <span data-ttu-id="ed0cb-135">Der [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] -Datenanbietertyp eines `Parameter` -Objekts wird vom [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] -Typ des `Value` des `Parameter` -Objekts oder vom `DbType` des `Parameter` -Objekts hergeleitet.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-135">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data provider type of a `Parameter` object is inferred from the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] type of the `Value` of the `Parameter` object, or from the `DbType` of the `Parameter` object.</span></span> <span data-ttu-id="ed0cb-136">Die folgende Tabelle zeigt den abgeleiteten `Parameter` -Typ basierend auf dem als `Parameter` -Wert übergebenen Objekt oder dem angegebenen `DbType`.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-136">The following table shows the inferred `Parameter` type based on the object passed as the `Parameter` value or the specified `DbType`.</span></span>  
  
|<span data-ttu-id="ed0cb-137">.NET Framework-Typ</span><span class="sxs-lookup"><span data-stu-id="ed0cb-137">.NET Framework type</span></span>|<span data-ttu-id="ed0cb-138">DbType</span><span class="sxs-lookup"><span data-stu-id="ed0cb-138">DbType</span></span>|<span data-ttu-id="ed0cb-139">SqlDbType</span><span class="sxs-lookup"><span data-stu-id="ed0cb-139">SqlDbType</span></span>|<span data-ttu-id="ed0cb-140">OleDbType</span><span class="sxs-lookup"><span data-stu-id="ed0cb-140">OleDbType</span></span>|<span data-ttu-id="ed0cb-141">OdbcType</span><span class="sxs-lookup"><span data-stu-id="ed0cb-141">OdbcType</span></span>|<span data-ttu-id="ed0cb-142">OracleType</span><span class="sxs-lookup"><span data-stu-id="ed0cb-142">OracleType</span></span>|  
|-------------------------|------------|---------------|---------------|--------------|----------------|  
|<xref:System.Boolean>|<span data-ttu-id="ed0cb-143">Boolean</span><span class="sxs-lookup"><span data-stu-id="ed0cb-143">Boolean</span></span>|<span data-ttu-id="ed0cb-144">Bit</span><span class="sxs-lookup"><span data-stu-id="ed0cb-144">Bit</span></span>|<span data-ttu-id="ed0cb-145">Boolesch</span><span class="sxs-lookup"><span data-stu-id="ed0cb-145">Boolean</span></span>|<span data-ttu-id="ed0cb-146">Bit</span><span class="sxs-lookup"><span data-stu-id="ed0cb-146">Bit</span></span>|<span data-ttu-id="ed0cb-147">Byte</span><span class="sxs-lookup"><span data-stu-id="ed0cb-147">Byte</span></span>|  
|<xref:System.Byte>|<span data-ttu-id="ed0cb-148">Byte</span><span class="sxs-lookup"><span data-stu-id="ed0cb-148">Byte</span></span>|<span data-ttu-id="ed0cb-149">TinyInt</span><span class="sxs-lookup"><span data-stu-id="ed0cb-149">TinyInt</span></span>|<span data-ttu-id="ed0cb-150">UnsignedTinyInt</span><span class="sxs-lookup"><span data-stu-id="ed0cb-150">UnsignedTinyInt</span></span>|<span data-ttu-id="ed0cb-151">TinyInt</span><span class="sxs-lookup"><span data-stu-id="ed0cb-151">TinyInt</span></span>|<span data-ttu-id="ed0cb-152">Byte</span><span class="sxs-lookup"><span data-stu-id="ed0cb-152">Byte</span></span>|  
|<span data-ttu-id="ed0cb-153">byte[]</span><span class="sxs-lookup"><span data-stu-id="ed0cb-153">byte[]</span></span>|<span data-ttu-id="ed0cb-154">Binär</span><span class="sxs-lookup"><span data-stu-id="ed0cb-154">Binary</span></span>|<span data-ttu-id="ed0cb-155">VarBinary`.` diese implizite Konvertierung schlägt fehl, wenn das Bytearray ist größer als die maximale Größe eines varbinary 8000 Bytes. Legen Sie für Bytearrays mit mehr als 8000 Bytes explizit die <xref:System.Data.SqlDbType>.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-155">VarBinary`.` This implicit conversion will fail if the byte array is larger than the maximum size of a VarBinary, which is 8000 bytes.For byte arrays larger than 8000 bytes, explicitly set the <xref:System.Data.SqlDbType>.</span></span>|<span data-ttu-id="ed0cb-156">VarBinary</span><span class="sxs-lookup"><span data-stu-id="ed0cb-156">VarBinary</span></span>|<span data-ttu-id="ed0cb-157">Binär</span><span class="sxs-lookup"><span data-stu-id="ed0cb-157">Binary</span></span>|<span data-ttu-id="ed0cb-158">Raw</span><span class="sxs-lookup"><span data-stu-id="ed0cb-158">Raw</span></span>|  
|<xref:System.Char>|``|<span data-ttu-id="ed0cb-159">Das Ableiten von <xref:System.Data.SqlDbType> aus char wird nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-159">Inferring a <xref:System.Data.SqlDbType> from char is not supported.</span></span>|<span data-ttu-id="ed0cb-160">Char</span><span class="sxs-lookup"><span data-stu-id="ed0cb-160">Char</span></span>|<span data-ttu-id="ed0cb-161">Char</span><span class="sxs-lookup"><span data-stu-id="ed0cb-161">Char</span></span>|<span data-ttu-id="ed0cb-162">Byte</span><span class="sxs-lookup"><span data-stu-id="ed0cb-162">Byte</span></span>|  
|<xref:System.DateTime>|<span data-ttu-id="ed0cb-163">DateTime</span><span class="sxs-lookup"><span data-stu-id="ed0cb-163">DateTime</span></span>|<span data-ttu-id="ed0cb-164">DateTime</span><span class="sxs-lookup"><span data-stu-id="ed0cb-164">DateTime</span></span>|<span data-ttu-id="ed0cb-165">DBTimeStamp</span><span class="sxs-lookup"><span data-stu-id="ed0cb-165">DBTimeStamp</span></span>|<span data-ttu-id="ed0cb-166">DateTime</span><span class="sxs-lookup"><span data-stu-id="ed0cb-166">DateTime</span></span>|<span data-ttu-id="ed0cb-167">DateTime</span><span class="sxs-lookup"><span data-stu-id="ed0cb-167">DateTime</span></span>|  
|<xref:System.DateTimeOffset>|<span data-ttu-id="ed0cb-168">DateTimeOffset</span><span class="sxs-lookup"><span data-stu-id="ed0cb-168">DateTimeOffset</span></span>|<span data-ttu-id="ed0cb-169">"DateTimeOffset" in SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-169">DateTimeOffset in SQL Server 2008.</span></span> <span data-ttu-id="ed0cb-170">Das Ableiten von <xref:System.Data.SqlDbType> aus DateTimeOffset wird erst ab SQL Server 2008 unterstützt.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-170">Inferring a <xref:System.Data.SqlDbType> from DateTimeOffset is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|||<span data-ttu-id="ed0cb-171">DateTime</span><span class="sxs-lookup"><span data-stu-id="ed0cb-171">DateTime</span></span>|  
|<xref:System.Decimal>|<span data-ttu-id="ed0cb-172">Decimal</span><span class="sxs-lookup"><span data-stu-id="ed0cb-172">Decimal</span></span>|<span data-ttu-id="ed0cb-173">Decimal</span><span class="sxs-lookup"><span data-stu-id="ed0cb-173">Decimal</span></span>|<span data-ttu-id="ed0cb-174">Decimal</span><span class="sxs-lookup"><span data-stu-id="ed0cb-174">Decimal</span></span>|<span data-ttu-id="ed0cb-175">Numeric</span><span class="sxs-lookup"><span data-stu-id="ed0cb-175">Numeric</span></span>|<span data-ttu-id="ed0cb-176">Nummer</span><span class="sxs-lookup"><span data-stu-id="ed0cb-176">Number</span></span>|  
|<xref:System.Double>|<span data-ttu-id="ed0cb-177">Double</span><span class="sxs-lookup"><span data-stu-id="ed0cb-177">Double</span></span>|<span data-ttu-id="ed0cb-178">Float</span><span class="sxs-lookup"><span data-stu-id="ed0cb-178">Float</span></span>|<span data-ttu-id="ed0cb-179">Double</span><span class="sxs-lookup"><span data-stu-id="ed0cb-179">Double</span></span>|<span data-ttu-id="ed0cb-180">Double</span><span class="sxs-lookup"><span data-stu-id="ed0cb-180">Double</span></span>|<span data-ttu-id="ed0cb-181">Double</span><span class="sxs-lookup"><span data-stu-id="ed0cb-181">Double</span></span>|  
|<xref:System.Single>|<span data-ttu-id="ed0cb-182">Single</span><span class="sxs-lookup"><span data-stu-id="ed0cb-182">Single</span></span>|<span data-ttu-id="ed0cb-183">Real</span><span class="sxs-lookup"><span data-stu-id="ed0cb-183">Real</span></span>|<span data-ttu-id="ed0cb-184">Single</span><span class="sxs-lookup"><span data-stu-id="ed0cb-184">Single</span></span>|<span data-ttu-id="ed0cb-185">Real</span><span class="sxs-lookup"><span data-stu-id="ed0cb-185">Real</span></span>|<span data-ttu-id="ed0cb-186">Float</span><span class="sxs-lookup"><span data-stu-id="ed0cb-186">Float</span></span>|  
|<xref:System.Guid>|<span data-ttu-id="ed0cb-187">Guid</span><span class="sxs-lookup"><span data-stu-id="ed0cb-187">Guid</span></span>|<span data-ttu-id="ed0cb-188">UniqueIdentifier</span><span class="sxs-lookup"><span data-stu-id="ed0cb-188">UniqueIdentifier</span></span>|<span data-ttu-id="ed0cb-189">Guid</span><span class="sxs-lookup"><span data-stu-id="ed0cb-189">Guid</span></span>|<span data-ttu-id="ed0cb-190">UniqueIdentifier</span><span class="sxs-lookup"><span data-stu-id="ed0cb-190">UniqueIdentifier</span></span>|<span data-ttu-id="ed0cb-191">Raw</span><span class="sxs-lookup"><span data-stu-id="ed0cb-191">Raw</span></span>|  
|<xref:System.Int16 >|<span data-ttu-id="ed0cb-192">Int16</span><span class="sxs-lookup"><span data-stu-id="ed0cb-192">Int16</span></span>|<span data-ttu-id="ed0cb-193">SmallInt</span><span class="sxs-lookup"><span data-stu-id="ed0cb-193">SmallInt</span></span>|<span data-ttu-id="ed0cb-194">SmallInt</span><span class="sxs-lookup"><span data-stu-id="ed0cb-194">SmallInt</span></span>|<span data-ttu-id="ed0cb-195">SmallInt</span><span class="sxs-lookup"><span data-stu-id="ed0cb-195">SmallInt</span></span>|<span data-ttu-id="ed0cb-196">Int16</span><span class="sxs-lookup"><span data-stu-id="ed0cb-196">Int16</span></span>|  
|<xref:System.Int32>|<span data-ttu-id="ed0cb-197">Int32</span><span class="sxs-lookup"><span data-stu-id="ed0cb-197">Int32</span></span>|<span data-ttu-id="ed0cb-198">Int</span><span class="sxs-lookup"><span data-stu-id="ed0cb-198">Int</span></span>|<span data-ttu-id="ed0cb-199">Int</span><span class="sxs-lookup"><span data-stu-id="ed0cb-199">Int</span></span>|<span data-ttu-id="ed0cb-200">Int</span><span class="sxs-lookup"><span data-stu-id="ed0cb-200">Int</span></span>|<span data-ttu-id="ed0cb-201">Int32</span><span class="sxs-lookup"><span data-stu-id="ed0cb-201">Int32</span></span>|  
|<xref:System.Int64>|<span data-ttu-id="ed0cb-202">Int64</span><span class="sxs-lookup"><span data-stu-id="ed0cb-202">Int64</span></span>|<span data-ttu-id="ed0cb-203">BigInt</span><span class="sxs-lookup"><span data-stu-id="ed0cb-203">BigInt</span></span>|<span data-ttu-id="ed0cb-204">BigInt</span><span class="sxs-lookup"><span data-stu-id="ed0cb-204">BigInt</span></span>|<span data-ttu-id="ed0cb-205">BigInt</span><span class="sxs-lookup"><span data-stu-id="ed0cb-205">BigInt</span></span>|<span data-ttu-id="ed0cb-206">Nummer</span><span class="sxs-lookup"><span data-stu-id="ed0cb-206">Number</span></span>|  
|<xref:System.Object>|<span data-ttu-id="ed0cb-207">Objekt</span><span class="sxs-lookup"><span data-stu-id="ed0cb-207">Object</span></span>|<span data-ttu-id="ed0cb-208">Variante</span><span class="sxs-lookup"><span data-stu-id="ed0cb-208">Variant</span></span>|<span data-ttu-id="ed0cb-209">Variante</span><span class="sxs-lookup"><span data-stu-id="ed0cb-209">Variant</span></span>|<span data-ttu-id="ed0cb-210">Das Ableiten von OdbcType aus Object wird nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-210">Inferring an OdbcType from Object is not supported.</span></span>|<span data-ttu-id="ed0cb-211">Blob</span><span class="sxs-lookup"><span data-stu-id="ed0cb-211">Blob</span></span>|  
|<xref:System.String>|<span data-ttu-id="ed0cb-212">Zeichenfolge</span><span class="sxs-lookup"><span data-stu-id="ed0cb-212">String</span></span>|<span data-ttu-id="ed0cb-213">NVarChar.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-213">NVarChar.</span></span> <span data-ttu-id="ed0cb-214">Diese implizite Konvertierung kann nicht ausgeführt werden, wenn die Zeichenfolge die maximale NVarChar-Länge (4000 Zeichen) überschreitet.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-214">This implicit conversion will fail if the string is larger than the maximum size of an NVarChar, which is 4000 characters.</span></span> <span data-ttu-id="ed0cb-215">Legen Sie für Zeichenfolgen mit mehr als 4000 Zeichen explizit <xref:System.Data.SqlDbType>fest.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-215">For strings larger than 4000 characters, explicitly set the <xref:System.Data.SqlDbType>.</span></span>|<span data-ttu-id="ed0cb-216">VarWChar</span><span class="sxs-lookup"><span data-stu-id="ed0cb-216">VarWChar</span></span>|<span data-ttu-id="ed0cb-217">NVarChar</span><span class="sxs-lookup"><span data-stu-id="ed0cb-217">NVarChar</span></span>|<span data-ttu-id="ed0cb-218">NVarChar</span><span class="sxs-lookup"><span data-stu-id="ed0cb-218">NVarChar</span></span>|  
|<xref:System.TimeSpan>|<span data-ttu-id="ed0cb-219">zeit</span><span class="sxs-lookup"><span data-stu-id="ed0cb-219">Time</span></span>|<span data-ttu-id="ed0cb-220">"Time" in SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-220">Time in SQL Server 2008.</span></span> <span data-ttu-id="ed0cb-221">Das Ableiten von <xref:System.Data.SqlDbType> aus TimeSpan wird erst ab SQL Server 2008 unterstützt.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-221">Inferring a <xref:System.Data.SqlDbType> from TimeSpan is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|<span data-ttu-id="ed0cb-222">DBTime</span><span class="sxs-lookup"><span data-stu-id="ed0cb-222">DBTime</span></span>|<span data-ttu-id="ed0cb-223">zeit</span><span class="sxs-lookup"><span data-stu-id="ed0cb-223">Time</span></span>|<span data-ttu-id="ed0cb-224">DateTime</span><span class="sxs-lookup"><span data-stu-id="ed0cb-224">DateTime</span></span>|  
|<xref:System.UInt16>|<span data-ttu-id="ed0cb-225">UInt16</span><span class="sxs-lookup"><span data-stu-id="ed0cb-225">UInt16</span></span>|<span data-ttu-id="ed0cb-226">Das Ableiten von <xref:System.Data.SqlDbType> aus UInt16 wird nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-226">Inferring a <xref:System.Data.SqlDbType> from UInt16 is not supported.</span></span>|<span data-ttu-id="ed0cb-227">UnsignedSmallInt</span><span class="sxs-lookup"><span data-stu-id="ed0cb-227">UnsignedSmallInt</span></span>|<span data-ttu-id="ed0cb-228">Int</span><span class="sxs-lookup"><span data-stu-id="ed0cb-228">Int</span></span>|<span data-ttu-id="ed0cb-229">UInt16</span><span class="sxs-lookup"><span data-stu-id="ed0cb-229">UInt16</span></span>|  
|<xref:System.UInt32>|<span data-ttu-id="ed0cb-230">UInt32</span><span class="sxs-lookup"><span data-stu-id="ed0cb-230">UInt32</span></span>|<span data-ttu-id="ed0cb-231">Das Ableiten von <xref:System.Data.SqlDbType> aus UInt32 wird nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-231">Inferring a <xref:System.Data.SqlDbType> from UInt32 is not supported.</span></span>|<span data-ttu-id="ed0cb-232">UnsignedInt</span><span class="sxs-lookup"><span data-stu-id="ed0cb-232">UnsignedInt</span></span>|<span data-ttu-id="ed0cb-233">BigInt</span><span class="sxs-lookup"><span data-stu-id="ed0cb-233">BigInt</span></span>|<span data-ttu-id="ed0cb-234">UInt32</span><span class="sxs-lookup"><span data-stu-id="ed0cb-234">UInt32</span></span>|  
|<xref:System.UInt64>|<span data-ttu-id="ed0cb-235">UInt64</span><span class="sxs-lookup"><span data-stu-id="ed0cb-235">UInt64</span></span>|<span data-ttu-id="ed0cb-236">Das Ableiten von <xref:System.Data.SqlDbType> aus UInt64 wird nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-236">Inferring a <xref:System.Data.SqlDbType> from UInt64 is not supported.</span></span>|<span data-ttu-id="ed0cb-237">UnsignedBigInt</span><span class="sxs-lookup"><span data-stu-id="ed0cb-237">UnsignedBigInt</span></span>|<span data-ttu-id="ed0cb-238">Numeric</span><span class="sxs-lookup"><span data-stu-id="ed0cb-238">Numeric</span></span>|<span data-ttu-id="ed0cb-239">Nummer</span><span class="sxs-lookup"><span data-stu-id="ed0cb-239">Number</span></span>|  
||<span data-ttu-id="ed0cb-240">AnsiString</span><span class="sxs-lookup"><span data-stu-id="ed0cb-240">AnsiString</span></span>|<span data-ttu-id="ed0cb-241">VarChar</span><span class="sxs-lookup"><span data-stu-id="ed0cb-241">VarChar</span></span>|<span data-ttu-id="ed0cb-242">VarChar</span><span class="sxs-lookup"><span data-stu-id="ed0cb-242">VarChar</span></span>|<span data-ttu-id="ed0cb-243">VarChar</span><span class="sxs-lookup"><span data-stu-id="ed0cb-243">VarChar</span></span>|<span data-ttu-id="ed0cb-244">VarChar</span><span class="sxs-lookup"><span data-stu-id="ed0cb-244">VarChar</span></span>|  
||<span data-ttu-id="ed0cb-245">AnsiStringFixedLength</span><span class="sxs-lookup"><span data-stu-id="ed0cb-245">AnsiStringFixedLength</span></span>|<span data-ttu-id="ed0cb-246">Char</span><span class="sxs-lookup"><span data-stu-id="ed0cb-246">Char</span></span>|<span data-ttu-id="ed0cb-247">Char</span><span class="sxs-lookup"><span data-stu-id="ed0cb-247">Char</span></span>|<span data-ttu-id="ed0cb-248">Char</span><span class="sxs-lookup"><span data-stu-id="ed0cb-248">Char</span></span>|<span data-ttu-id="ed0cb-249">Char</span><span class="sxs-lookup"><span data-stu-id="ed0cb-249">Char</span></span>|  
|``|<span data-ttu-id="ed0cb-250">Währung</span><span class="sxs-lookup"><span data-stu-id="ed0cb-250">Currency</span></span>|<span data-ttu-id="ed0cb-251">Money</span><span class="sxs-lookup"><span data-stu-id="ed0cb-251">Money</span></span>|<span data-ttu-id="ed0cb-252">Währung</span><span class="sxs-lookup"><span data-stu-id="ed0cb-252">Currency</span></span>|<span data-ttu-id="ed0cb-253">Das Ableiten von `OdbcType` aus `Currency` wird nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-253">Inferring an `OdbcType` from `Currency` is not supported.</span></span>|<span data-ttu-id="ed0cb-254">Nummer</span><span class="sxs-lookup"><span data-stu-id="ed0cb-254">Number</span></span>|  
|``|<span data-ttu-id="ed0cb-255">Datum</span><span class="sxs-lookup"><span data-stu-id="ed0cb-255">Date</span></span>|<span data-ttu-id="ed0cb-256">"Date" in SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-256">Date in SQL Server 2008.</span></span> <span data-ttu-id="ed0cb-257">Das Ableiten von <xref:System.Data.SqlDbType> aus Date wird erst ab SQL Server 2008 unterstützt.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-257">Inferring a <xref:System.Data.SqlDbType> from Date is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|<span data-ttu-id="ed0cb-258">DBDate</span><span class="sxs-lookup"><span data-stu-id="ed0cb-258">DBDate</span></span>|<span data-ttu-id="ed0cb-259">Datum</span><span class="sxs-lookup"><span data-stu-id="ed0cb-259">Date</span></span>|<span data-ttu-id="ed0cb-260">DateTime</span><span class="sxs-lookup"><span data-stu-id="ed0cb-260">DateTime</span></span>|  
|``|<span data-ttu-id="ed0cb-261">SByte</span><span class="sxs-lookup"><span data-stu-id="ed0cb-261">SByte</span></span>|<span data-ttu-id="ed0cb-262">Das Ableiten von <xref:System.Data.SqlDbType> aus SByte wird nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-262">Inferring a <xref:System.Data.SqlDbType> from SByte is not supported.</span></span>|<span data-ttu-id="ed0cb-263">TinyInt</span><span class="sxs-lookup"><span data-stu-id="ed0cb-263">TinyInt</span></span>|<span data-ttu-id="ed0cb-264">Das Ableiten von `OdbcType` aus SByte wird nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-264">Inferring an `OdbcType` from SByte is not supported.</span></span>|<span data-ttu-id="ed0cb-265">SByte</span><span class="sxs-lookup"><span data-stu-id="ed0cb-265">SByte</span></span>|  
||<span data-ttu-id="ed0cb-266">StringFixedLength</span><span class="sxs-lookup"><span data-stu-id="ed0cb-266">StringFixedLength</span></span>|<span data-ttu-id="ed0cb-267">NChar</span><span class="sxs-lookup"><span data-stu-id="ed0cb-267">NChar</span></span>|<span data-ttu-id="ed0cb-268">WChar</span><span class="sxs-lookup"><span data-stu-id="ed0cb-268">WChar</span></span>|<span data-ttu-id="ed0cb-269">NChar</span><span class="sxs-lookup"><span data-stu-id="ed0cb-269">NChar</span></span>|<span data-ttu-id="ed0cb-270">NChar</span><span class="sxs-lookup"><span data-stu-id="ed0cb-270">NChar</span></span>|  
||<span data-ttu-id="ed0cb-271">zeit</span><span class="sxs-lookup"><span data-stu-id="ed0cb-271">Time</span></span>|<span data-ttu-id="ed0cb-272">"Time" in SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-272">Time in SQL Server 2008.</span></span> <span data-ttu-id="ed0cb-273">Das Ableiten von <xref:System.Data.SqlDbType> aus Time wird erst ab SQL Server 2008 unterstützt.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-273">Inferring a <xref:System.Data.SqlDbType> from Time is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|<span data-ttu-id="ed0cb-274">DBTime</span><span class="sxs-lookup"><span data-stu-id="ed0cb-274">DBTime</span></span>|<span data-ttu-id="ed0cb-275">zeit</span><span class="sxs-lookup"><span data-stu-id="ed0cb-275">Time</span></span>|<span data-ttu-id="ed0cb-276">DateTime</span><span class="sxs-lookup"><span data-stu-id="ed0cb-276">DateTime</span></span>|  
||<span data-ttu-id="ed0cb-277">VarNumeric</span><span class="sxs-lookup"><span data-stu-id="ed0cb-277">VarNumeric</span></span>|<span data-ttu-id="ed0cb-278">Das Ableiten von <xref:System.Data.SqlDbType> aus VarNumeric wird nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-278">Inferring a <xref:System.Data.SqlDbType> from VarNumeric is not supported.</span></span>|<span data-ttu-id="ed0cb-279">VarNumeric</span><span class="sxs-lookup"><span data-stu-id="ed0cb-279">VarNumeric</span></span>|<span data-ttu-id="ed0cb-280">Das Ableiten von `OdbcType` aus VarNumeric wird nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-280">Inferring an `OdbcType` from VarNumeric is not supported.</span></span>|<span data-ttu-id="ed0cb-281">Nummer</span><span class="sxs-lookup"><span data-stu-id="ed0cb-281">Number</span></span>|  
|<span data-ttu-id="ed0cb-282">Benutzerdefinierter Typ (ein Objekt mit <xref:Microsoft.SqlServer.Server.SqlUserDefinedAggregateAttribute>)</span><span class="sxs-lookup"><span data-stu-id="ed0cb-282">user-defined type (an object with <xref:Microsoft.SqlServer.Server.SqlUserDefinedAggregateAttribute></span></span>|<span data-ttu-id="ed0cb-283">Object oder String, je nach Anbieter (SqlClient gibt immer ein Objekt zurück, ODBC immer eine Zeichenfolge, und der verwaltete OLE DB-Datenanbieter ist in der Lage, beide zu erkennen).</span><span class="sxs-lookup"><span data-stu-id="ed0cb-283">Object or String, depending the provider (SqlClient always returns an Object, Odbc always returns a String, and the OleDb managed data provider can see either</span></span>|<span data-ttu-id="ed0cb-284">SqlDbType.Udt, wenn <xref:Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute> vorhanden ist; andernfalls Variant</span><span class="sxs-lookup"><span data-stu-id="ed0cb-284">SqlDbType.Udt if <xref:Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute> is present, otherwise Variant</span></span>|<span data-ttu-id="ed0cb-285">OleDbType.VarWChar (wenn der Wert NULL ist); andernfalls OleDbType.Variant.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-285">OleDbType.VarWChar (if value is null) otherwise OleDbType.Variant.</span></span>|<span data-ttu-id="ed0cb-286">OdbcType.NVarChar</span><span class="sxs-lookup"><span data-stu-id="ed0cb-286">OdbcType.NVarChar</span></span>|<span data-ttu-id="ed0cb-287">wird nicht unterstützt</span><span class="sxs-lookup"><span data-stu-id="ed0cb-287">not supported</span></span>|  
  
> [!NOTE]
>  <span data-ttu-id="ed0cb-288">Beim Konvertieren von "decimal" in einen anderen Typ erhalten Sie nur eine annähernde Entsprechung, da der Wert auf die nächste Ganzzahl abgerundet wird.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-288">Conversions from decimal to other types are narrowing conversions that round the decimal value to the nearest integer value toward zero.</span></span> <span data-ttu-id="ed0cb-289">Wenn das Ergebnis der Konvertierung im Zieltyp nicht darstellbar ist, wird eine <xref:System.OverflowException> ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-289">If the result of the conversion is not representable in the destination type, an <xref:System.OverflowException> is thrown.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ed0cb-290">Wenn Sie einen NULL-Parameterwert an den Server senden, müssen Sie <xref:System.DBNull> und nicht `null` (in Visual Basic `Nothing`)+++ angeben.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-290">When you send a null parameter value to the server, you must specify <xref:System.DBNull>, not `null` (`Nothing` in Visual Basic).</span></span> <span data-ttu-id="ed0cb-291">Der NULL-Wert im System ist ein leeres Objekt, das über keinen Wert verfügt.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-291">The null value in the system is an empty object that has no value.</span></span> <span data-ttu-id="ed0cb-292"><xref:System.DBNull> wird zur Darstellung von NULL-Werten verwendet.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-292"><xref:System.DBNull> is used to represent null values.</span></span> <span data-ttu-id="ed0cb-293">Weitere Informationen zu NULL-Werten bei Datenbanken finden Sie unter [Handling Null Values](../../../../docs/framework/data/adonet/sql/handling-null-values.md).</span><span class="sxs-lookup"><span data-stu-id="ed0cb-293">For more information about database nulls, see [Handling Null Values](../../../../docs/framework/data/adonet/sql/handling-null-values.md).</span></span>  
  
## <a name="deriving-parameter-information"></a><span data-ttu-id="ed0cb-294">Ableiten von Parameterinformationen</span><span class="sxs-lookup"><span data-stu-id="ed0cb-294">Deriving Parameter Information</span></span>  
 <span data-ttu-id="ed0cb-295">Parameter können auch mit der `DbCommandBuilder` -Klasse aus einer gespeicherten Prozedur abgeleitet werden.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-295">Parameters can also be derived from a stored procedure using the `DbCommandBuilder` class.</span></span> <span data-ttu-id="ed0cb-296">Sowohl die `SqlCommandBuilder` -Klasse als auch die `OleDbCommandBuilder` -Klasse stellen die statische Methode `DeriveParameters`bereit, die automatisch die Parameterauflistung eines Befehlsobjekts füllt, das Parameterinformationen aus einer gespeicherten Prozedur verwendet.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-296">Both the `SqlCommandBuilder` and `OleDbCommandBuilder` classes provide a static method, `DeriveParameters`, which automatically populates the parameters collection of a command object that uses parameter information from a stored procedure.</span></span> <span data-ttu-id="ed0cb-297">Beachten Sie, dass `DeriveParameters` alle vorhandenen Parameterinformationen für den Befehl überschreibt.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-297">Note that `DeriveParameters` overwrites any existing parameter information for the command.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ed0cb-298">Das Ableiten von Parameterinformationen geht mit einem Leistungsverlust einher, weil zum Abrufen der Informationen ein zusätzlicher Roundtrip durch die Datenquelle erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-298">Deriving parameter information incurs a performance penalty because it requires an additional round trip to the data source to retrieve the information.</span></span> <span data-ttu-id="ed0cb-299">Wenn die Parameterinformationen zur Entwurfszeit bekannt sind, können Sie die Leistung der Anwendung verbessern, indem Sie die Parameter explizit festlegen.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-299">If parameter information is known at design time, you can improve the performance of your application by setting the parameters explicitly.</span></span>  
  
 <span data-ttu-id="ed0cb-300">Weitere Informationen finden Sie unter [Generieren von Befehlen mit CommandBuilder-Objekten](../../../../docs/framework/data/adonet/generating-commands-with-commandbuilders.md).</span><span class="sxs-lookup"><span data-stu-id="ed0cb-300">For more information, see [Generating Commands with CommandBuilders](../../../../docs/framework/data/adonet/generating-commands-with-commandbuilders.md).</span></span>  
  
## <a name="using-parameters-with-a-sqlcommand-and-a-stored-procedure"></a><span data-ttu-id="ed0cb-301">Verwenden von Parametern mit einem "SqlCommand" und einer gespeicherten Prozedur</span><span class="sxs-lookup"><span data-stu-id="ed0cb-301">Using Parameters with a SqlCommand and a Stored Procedure</span></span>  
 <span data-ttu-id="ed0cb-302">Gespeicherte Prozeduren bieten zahlreiche Vorteile in datengesteuerten Anwendungen.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-302">Stored procedures offer many advantages in data-driven applications.</span></span> <span data-ttu-id="ed0cb-303">Mit gespeicherten Prozeduren können Datenbankoperationen in einem einzelnen Befehl zusammengefasst, für die beste Leistung optimiert und mit zusätzlicher Sicherheit ausgestattet werden.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-303">By using stored procedures, database operations can be encapsulated in a single command, optimized for best performance, and enhanced with additional security.</span></span> <span data-ttu-id="ed0cb-304">Obwohl eine gespeicherte Prozedur aufgerufen werden kann, übergeben Sie den Namen der gespeicherten Prozedur gefolgt von Parameterargumenten als SQL-Anweisung, mit der <xref:System.Data.Common.DbCommand.Parameters%2A> Auflistung von der [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] <xref:System.Data.Common.DbCommand> Objekt können Sie gespeicherte Definition Prozedurparameter, sowie zum Zugriff auf Ausgabeparameter und Rückgabewerte.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-304">Although a stored procedure can be called by passing the stored procedure name followed by parameter arguments as an SQL statement, by using the <xref:System.Data.Common.DbCommand.Parameters%2A> collection of the [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] <xref:System.Data.Common.DbCommand> object enables you to more explicitly define stored procedure parameters, and to access output parameters and return values.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ed0cb-305">Parametrisierte Anweisungen werden auf dem Server mit `sp_executesql,` ausgeführt, sodass die Wiederverwendung von Abfrageplänen möglich ist.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-305">Parameterized statements are executed on the server by using `sp_executesql,` which allows for query plan reuse.</span></span> <span data-ttu-id="ed0cb-306">Lokale Cursor oder Variablen im `sp_executesql` -Batch sind für den Batch, der `sp_executesql`aufruft, nicht sichtbar.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-306">Local cursors or variables in the `sp_executesql` batch are not visible to the batch that calls `sp_executesql`.</span></span> <span data-ttu-id="ed0cb-307">Änderungen am Datenbankkontext sind nur bis zum Ende der `sp_executesql` -Anweisung gültig.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-307">Changes in database context last only to the end of the `sp_executesql` statement.</span></span> <span data-ttu-id="ed0cb-308">Weitere Informationen dazu finden Sie in der SQL Server-Onlinedokumentation.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-308">For more information, see SQL Server Books Online.</span></span>  
  
 <span data-ttu-id="ed0cb-309">Wenn Sie Parameter mit einem <xref:System.Data.SqlClient.SqlCommand> verwenden, um eine gespeicherte SQL Server-Prozedur auszuführen, müssen die der <xref:System.Data.SqlClient.SqlCommand.Parameters%2A> -Auflistung hinzugefügten Parameternamen mit den Namen der Parametermarkierungen in der gespeicherten Prozedur übereinstimmen.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-309">When using parameters with a <xref:System.Data.SqlClient.SqlCommand> to execute a SQL Server stored procedure, the names of the parameters added to the <xref:System.Data.SqlClient.SqlCommand.Parameters%2A> collection must match the names of the parameter markers in the stored procedure.</span></span> <span data-ttu-id="ed0cb-310">Der [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] -Datenanbieter für SQL Server unterstützt keine Fragezeichenplatzhalter (?) für die Übergabe von Parametern an eine SQL-Anweisung oder gespeicherte Prozedur.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-310">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for SQL Server does not support the question mark (?) placeholder for passing parameters to an SQL statement or a stored procedure.</span></span> <span data-ttu-id="ed0cb-311">Er behandelt die Parameter in der gespeicherten Prozedur als benannte Parameter und sucht nach den entsprechenden Parametermarkierungen.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-311">It treats parameters in the stored procedure as named parameters and searches for matching parameter markers.</span></span> <span data-ttu-id="ed0cb-312">Nehmen wir z. B. an, die gespeicherte Prozedur `CustOrderHist` ist mit einem Parameter mit dem Namen `@CustomerID`definiert.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-312">For example, the `CustOrderHist` stored procedure is defined by using a parameter named `@CustomerID`.</span></span> <span data-ttu-id="ed0cb-313">Wenn Ihr Code die gespeicherte Prozedur ausführt, muss er ebenfalls einen Parameter mit dem Namen `@CustomerID`verwenden.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-313">When your code executes the stored procedure, it must also use a parameter named `@CustomerID`.</span></span>  
  
```  
CREATE PROCEDURE dbo.CustOrderHist @CustomerID varchar(5)  
```  
  
### <a name="example"></a><span data-ttu-id="ed0cb-314">Beispiel</span><span class="sxs-lookup"><span data-stu-id="ed0cb-314">Example</span></span>  
 <span data-ttu-id="ed0cb-315">Dieses Beispiel zeigt, wie Sie eine gespeicherte SQL Server-Prozedur in der `Northwind` -Beispieldatenbank aufrufen können.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-315">This example demonstrates how to call a SQL Server stored procedure in the `Northwind` sample database.</span></span> <span data-ttu-id="ed0cb-316">Der Name der gespeicherten Prozedur ist `dbo.SalesByCategory` , und die Prozedur besitzt einen Eingabeparameter mit dem Namen `@CategoryName` und dem Datentyp `nvarchar(15)`.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-316">The name of the stored procedure is `dbo.SalesByCategory` and it has an input parameter named `@CategoryName` with a data type of `nvarchar(15)`.</span></span> <span data-ttu-id="ed0cb-317">Der Code erstellt eine neue <xref:System.Data.SqlClient.SqlConnection> innerhalb eines verwendeten Blocks, sodass die Verbindung nach dem Ende der Prozedur verworfen wird.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-317">The code creates a new <xref:System.Data.SqlClient.SqlConnection> inside a using block so that the connection is disposed when the procedure ends.</span></span> <span data-ttu-id="ed0cb-318">Es werden die Objekte <xref:System.Data.SqlClient.SqlCommand> und <xref:System.Data.SqlClient.SqlParameter> erstellt, und deren Eigenschaften werden festgelegt.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-318">The <xref:System.Data.SqlClient.SqlCommand> and <xref:System.Data.SqlClient.SqlParameter> objects are created, and their properties set.</span></span> <span data-ttu-id="ed0cb-319">Ein <xref:System.Data.SqlClient.SqlDataReader> führt den `SqlCommand` aus und gibt den Resultset aus der gespeicherten Prozedur zurück, wobei die Ausgabe im Konsolenfenster angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-319">A <xref:System.Data.SqlClient.SqlDataReader> executes the `SqlCommand` and returns the result set from the stored procedure, displaying the output in the console window.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ed0cb-320">Statt die Objekte `SqlCommand` und `SqlParameter` zu erstellen und dann die Eigenschaften in separaten Anweisungen festzulegen, können Sie auch mit einem der überladenen Konstruktoren mehrere Eigenschaften in einer einzigen Anweisung festlegen.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-320">Instead of creating `SqlCommand` and `SqlParameter` objects and then setting properties in separate statements, you can instead elect to use one of the overloaded constructors to set multiple properties in a single statement.</span></span>  
  
 [!code-csharp[DataWorks SqlClient.StoredProcedure#1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlClient.StoredProcedure/CS/source.cs#1)]
 [!code-vb[DataWorks SqlClient.StoredProcedure#1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlClient.StoredProcedure/VB/source.vb#1)]  
  
## <a name="using-parameters-with-an-oledbcommand-or-odbccommand"></a><span data-ttu-id="ed0cb-321">Verwenden von Parametern mit einem "OleDbCommand" oder "OdbcCommand"</span><span class="sxs-lookup"><span data-stu-id="ed0cb-321">Using Parameters with an OleDbCommand or OdbcCommand</span></span>  
 <span data-ttu-id="ed0cb-322">Wenn Sie Parameter mit einem <xref:System.Data.OleDb.OleDbCommand> oder einem <xref:System.Data.Odbc.OdbcCommand>verwenden, muss die Reihenfolge der der `Parameters` -Auflistung hinzugefügten Parameter mit der Reihenfolge der in der gespeicherten Prozedur definierten Parameter übereinstimmen.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-322">When using parameters with an <xref:System.Data.OleDb.OleDbCommand> or <xref:System.Data.Odbc.OdbcCommand>, the order of the parameters added to the `Parameters` collection must match the order of the parameters defined in your stored procedure.</span></span> <span data-ttu-id="ed0cb-323">Der [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]-Datenanbieter für OLE DB und der [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]-Datenanbieter für ODBC behandeln Parameter in einer gespeicherten Prozedur als Platzhalter und wenden Parameterwerte der Reihe nach an.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-323">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for OLE DB and [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for ODBC treat parameters in a stored procedure as placeholders and apply parameter values in order.</span></span> <span data-ttu-id="ed0cb-324">Außerdem müssen der `Parameters` -Auflistung zuerst die Parameter für die Rückgabewerte hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-324">In addition, return value parameters must be the first parameters added to the `Parameters` collection.</span></span>  
  
 <span data-ttu-id="ed0cb-325">Der [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] -Datenanbieter für OLE DB und der [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] -Datenanbieter für ODBC unterstützen keine benannten Parameter für die Übergabe von Parametern an eine SQL-Anweisung oder gespeicherte Prozedur.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-325">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for OLE DB and [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for ODBC do not support named parameters for passing parameters to an SQL statement or a stored procedure.</span></span> <span data-ttu-id="ed0cb-326">In diesem Fall muss der Fragezeichenplatzhalter (?) verwenden. Dies wird im folgenden Beispiel dargestellt.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-326">In this case, you must use the question mark (?) placeholder, as in the following example.</span></span>  
  
```  
SELECT * FROM Customers WHERE CustomerID = ?  
```  
  
 <span data-ttu-id="ed0cb-327">Dementsprechend muss die Reihenfolge, in der `Parameter` -Objekte der `Parameters` -Auflistung hinzugefügt werden, genau der Position des als Platzhalter für den Parameter fungierenden Fragezeichens (?)</span><span class="sxs-lookup"><span data-stu-id="ed0cb-327">As a result, the order in which `Parameter` objects are added to the `Parameters` collection must directly correspond to the position of the ?</span></span> <span data-ttu-id="ed0cb-328">entsprechen.</span><span class="sxs-lookup"><span data-stu-id="ed0cb-328">placeholder for the parameter.</span></span>  
  
### <a name="oledb-example"></a><span data-ttu-id="ed0cb-329">OLE DB-Beispiel</span><span class="sxs-lookup"><span data-stu-id="ed0cb-329">OleDb Example</span></span>  
  
```vb  
Dim command As OleDbCommand = New OleDbCommand( _  
  "SampleProc", connection)  
command.CommandType = CommandType.StoredProcedure  
  
Dim parameter As OleDbParameter = command.Parameters.Add( _  
  "RETURN_VALUE", OleDbType.Integer)  
parameter.Direction = ParameterDirection.ReturnValue  
  
parameter = command.Parameters.Add( _  
  "@InputParm", OleDbType.VarChar, 12)  
parameter.Value = "Sample Value"  
  
parameter = command.Parameters.Add( _  
  "@OutputParm", OleDbType.VarChar, 28)  
parameter.Direction = ParameterDirection.Output  
```  
  
```csharp  
OleDbCommand command = new OleDbCommand("SampleProc", connection);  
command.CommandType = CommandType.StoredProcedure;  
  
OleDbParameter parameter = command.Parameters.Add(  
  "RETURN_VALUE", OleDbType.Integer);  
parameter.Direction = ParameterDirection.ReturnValue;  
  
parameter = command.Parameters.Add(  
  "@InputParm", OleDbType.VarChar, 12);  
parameter.Value = "Sample Value";  
  
parameter = command.Parameters.Add(  
  "@OutputParm", OleDbType.VarChar, 28);  
parameter.Direction = ParameterDirection.Output;  
```  
  
## <a name="odbc-example"></a><span data-ttu-id="ed0cb-330">Beispiel zu "Odbc"</span><span class="sxs-lookup"><span data-stu-id="ed0cb-330">Odbc Example</span></span>  
  
```vb  
Dim command As OdbcCommand = New OdbcCommand( _  
  "{ ? = CALL SampleProc(?, ?) }", connection)  
command.CommandType = CommandType.StoredProcedure  
  
Dim parameter As OdbcParameter = command.Parameters.Add("RETURN_VALUE", OdbcType.Int)  
parameter.Direction = ParameterDirection.ReturnValue  
  
parameter = command.Parameters.Add( _  
  "@InputParm", OdbcType.VarChar, 12)  
parameter.Value = "Sample Value"  
  
parameter = command.Parameters.Add( _  
  "@OutputParm", OdbcType.VarChar, 28)  
parameter.Direction = ParameterDirection.Output  
```  
  
```csharp  
OdbcCommand command = new OdbcCommand( _  
  "{ ? = CALL SampleProc(?, ?) }", connection);  
command.CommandType = CommandType.StoredProcedure;  
  
OdbcParameter parameter = command.Parameters.Add( _  
  "RETURN_VALUE", OdbcType.Int);  
parameter.Direction = ParameterDirection.ReturnValue;  
  
parameter = command.Parameters.Add( _  
  "@InputParm", OdbcType.VarChar, 12);  
parameter.Value = "Sample Value";  
  
parameter = command.Parameters.Add( _  
  "@OutputParm", OdbcType.VarChar, 28);  
parameter.Direction = ParameterDirection.Output;  
```  
  
## <a name="see-also"></a><span data-ttu-id="ed0cb-331">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="ed0cb-331">See Also</span></span>  
 [<span data-ttu-id="ed0cb-332">Befehle und Parameter</span><span class="sxs-lookup"><span data-stu-id="ed0cb-332">Commands and Parameters</span></span>](../../../../docs/framework/data/adonet/commands-and-parameters.md)  
 [<span data-ttu-id="ed0cb-333">DataAdapter-Parameter</span><span class="sxs-lookup"><span data-stu-id="ed0cb-333">DataAdapter Parameters</span></span>](../../../../docs/framework/data/adonet/dataadapter-parameters.md)  
 [<span data-ttu-id="ed0cb-334">Datentypzuordnungen in ADO.NET</span><span class="sxs-lookup"><span data-stu-id="ed0cb-334">Data Type Mappings in ADO.NET</span></span>](../../../../docs/framework/data/adonet/data-type-mappings-in-ado-net.md)  
 [<span data-ttu-id="ed0cb-335">ADO.NET Managed Provider und DataSet Developer Center</span><span class="sxs-lookup"><span data-stu-id="ed0cb-335">ADO.NET Managed Providers and DataSet Developer Center</span></span>](http://go.microsoft.com/fwlink/?LinkId=217917)
