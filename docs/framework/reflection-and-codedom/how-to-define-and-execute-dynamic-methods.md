---
title: "Gewusst wie: Definieren und Ausführen von dynamischen Methoden"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology:
- dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- reflection emit, dynamic methods
- dynamic methods
ms.assetid: 07d08a99-62c5-4254-bce2-2a75e55a18ab
caps.latest.revision: 12
author: rpetrusha
ms.author: ronpet
manager: wpickett
ms.translationtype: HT
ms.sourcegitcommit: 306c608dc7f97594ef6f72ae0f5aaba596c936e1
ms.openlocfilehash: 67e909a7b64500bba533290061652e82ffde07a5
ms.contentlocale: de-de
ms.lasthandoff: 07/28/2017

---
# <a name="how-to-define-and-execute-dynamic-methods"></a><span data-ttu-id="42e1b-102">Gewusst wie: Definieren und Ausführen von dynamischen Methoden</span><span class="sxs-lookup"><span data-stu-id="42e1b-102">How to: Define and Execute Dynamic Methods</span></span>
<span data-ttu-id="42e1b-103">Die folgenden Verfahren zeigen, wie eine einfache dynamische Methode sowie eine dynamische Methode, die an eine Instanz einer Klasse gebunden ist, definiert und ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="42e1b-103">The following procedures show how to define and execute a simple dynamic method and a dynamic method bound to an instance of a class.</span></span> <span data-ttu-id="42e1b-104">Weitere Informationen zu dynamischen Methoden finden Sie in der <xref:System.Reflection.Emit.DynamicMethod>-Klasse und unter [Szenarios für die Reflektionsausgabe mit dynamischen Methoden](http://msdn.microsoft.com/en-us/7c27ea3d-0f24-4bf3-8ceb-f49d33faca5e).</span><span class="sxs-lookup"><span data-stu-id="42e1b-104">For more information on dynamic methods, see the <xref:System.Reflection.Emit.DynamicMethod> class and [Reflection Emit Dynamic Method Scenarios](http://msdn.microsoft.com/en-us/7c27ea3d-0f24-4bf3-8ceb-f49d33faca5e).</span></span>  
  
### <a name="to-define-and-execute-a-dynamic-method"></a><span data-ttu-id="42e1b-105">So definieren und Sie eine dynamische Methode und führen diese aus</span><span class="sxs-lookup"><span data-stu-id="42e1b-105">To define and execute a dynamic method</span></span>  
  
1.  <span data-ttu-id="42e1b-106">Deklarieren Sie einen Delegattyp, um die Methode auszuführen.</span><span class="sxs-lookup"><span data-stu-id="42e1b-106">Declare a delegate type to execute the method.</span></span> <span data-ttu-id="42e1b-107">Erwägen Sie, einen generischen Delegaten zu verwenden, um die Anzahl der Delegattypen zu minimieren, die Sie benötigen.</span><span class="sxs-lookup"><span data-stu-id="42e1b-107">Consider using a generic delegate to minimize the number of delegate types you need to declare.</span></span> <span data-ttu-id="42e1b-108">Der folgende Code deklariert zwei Delegattypen, die für eine `SquareIt`-Methode verwendet werden könnt. Eine Methode davon ist generisch.</span><span class="sxs-lookup"><span data-stu-id="42e1b-108">The following code declares two delegate types that could be used for the `SquareIt` method, and one of them is generic.</span></span>  
  
     <span data-ttu-id="42e1b-109">[!code-cpp[DynamicMethodHowTo#2](../../../samples/snippets/cpp/VS_Snippets_CLR/DynamicMethodHowTo/cpp/source.cpp#2)] [!code-csharp[DynamicMethodHowTo#2](../../../samples/snippets/csharp/VS_Snippets_CLR/DynamicMethodHowTo/cs/source.cs#2)] [!code-vb[DynamicMethodHowTo#2](../../../samples/snippets/visualbasic/VS_Snippets_CLR/DynamicMethodHowTo/vb/source.vb#2)]</span><span class="sxs-lookup"><span data-stu-id="42e1b-109">[!code-cpp[DynamicMethodHowTo#2](../../../samples/snippets/cpp/VS_Snippets_CLR/DynamicMethodHowTo/cpp/source.cpp#2)]  [!code-csharp[DynamicMethodHowTo#2](../../../samples/snippets/csharp/VS_Snippets_CLR/DynamicMethodHowTo/cs/source.cs#2)]  [!code-vb[DynamicMethodHowTo#2](../../../samples/snippets/visualbasic/VS_Snippets_CLR/DynamicMethodHowTo/vb/source.vb#2)]</span></span>  
  
2.  <span data-ttu-id="42e1b-110">Erstellen Sie ein Array, das die Parametertypen für die dynamische Methode angibt.</span><span class="sxs-lookup"><span data-stu-id="42e1b-110">Create an array that specifies the parameter types for the dynamic method.</span></span> <span data-ttu-id="42e1b-111">In diesem Beispiel ist der einzige Parameter ein `int` (`Integer` in Visual Basic), also verfügt das Array nur über ein Element.</span><span class="sxs-lookup"><span data-stu-id="42e1b-111">In this example, the only parameter is an `int` (`Integer` in Visual Basic), so the array has only one element.</span></span>  
  
     <span data-ttu-id="42e1b-112">[!code-cpp[DynamicMethodHowTo#3](../../../samples/snippets/cpp/VS_Snippets_CLR/DynamicMethodHowTo/cpp/source.cpp#3)] [!code-csharp[DynamicMethodHowTo#3](../../../samples/snippets/csharp/VS_Snippets_CLR/DynamicMethodHowTo/cs/source.cs#3)] [!code-vb[DynamicMethodHowTo#3](../../../samples/snippets/visualbasic/VS_Snippets_CLR/DynamicMethodHowTo/vb/source.vb#3)]</span><span class="sxs-lookup"><span data-stu-id="42e1b-112">[!code-cpp[DynamicMethodHowTo#3](../../../samples/snippets/cpp/VS_Snippets_CLR/DynamicMethodHowTo/cpp/source.cpp#3)]  [!code-csharp[DynamicMethodHowTo#3](../../../samples/snippets/csharp/VS_Snippets_CLR/DynamicMethodHowTo/cs/source.cs#3)]  [!code-vb[DynamicMethodHowTo#3](../../../samples/snippets/visualbasic/VS_Snippets_CLR/DynamicMethodHowTo/vb/source.vb#3)]</span></span>  
  
3.  <span data-ttu-id="42e1b-113">Erstellen Sie eine <xref:System.Reflection.Emit.DynamicMethod>.</span><span class="sxs-lookup"><span data-stu-id="42e1b-113">Create a <xref:System.Reflection.Emit.DynamicMethod>.</span></span> <span data-ttu-id="42e1b-114">In diesem Beispiel trägt die Methode die Bezeichnung `SquareIt`.</span><span class="sxs-lookup"><span data-stu-id="42e1b-114">In this example the method is named `SquareIt`.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="42e1b-115">Es ist nicht nötig, den dynamischen Methoden Namen zu geben. Sie können auch nicht nach Namen aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="42e1b-115">It is not necessary to give dynamic methods names, and they cannot be invoked by name.</span></span> <span data-ttu-id="42e1b-116">Mehrere dynamische Methoden können über denselben Namen verfügen.</span><span class="sxs-lookup"><span data-stu-id="42e1b-116">Multiple dynamic methods can have the same name.</span></span> <span data-ttu-id="42e1b-117">Jedoch erscheint der Name in Aufruflisten und kann für das Debuggen hilfreich sein.</span><span class="sxs-lookup"><span data-stu-id="42e1b-117">However, the name appears in call stacks and can be useful for debugging.</span></span>  
  
     <span data-ttu-id="42e1b-118">Der Typ des Rückgabewerts ist als `long` angegeben.</span><span class="sxs-lookup"><span data-stu-id="42e1b-118">The type of the return value is specified as `long`.</span></span> <span data-ttu-id="42e1b-119">Die Methode ist dem Modul zugeordnet, das die `Example`-Klasse besitzt, die den Beispielcode enthält.</span><span class="sxs-lookup"><span data-stu-id="42e1b-119">The method is associated with the module that contains the `Example` class, which contains the example code.</span></span> <span data-ttu-id="42e1b-120">Jedes geladene Modul kann angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="42e1b-120">Any loaded module could be specified.</span></span> <span data-ttu-id="42e1b-121">Die dynamische Methode verhält sich wie eine `static`-Methode auf Modulebene (`Shared` in Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="42e1b-121">The dynamic method acts like a module-level `static` method (`Shared` in Visual Basic).</span></span>  
  
     <span data-ttu-id="42e1b-122">[!code-cpp[DynamicMethodHowTo#4](../../../samples/snippets/cpp/VS_Snippets_CLR/DynamicMethodHowTo/cpp/source.cpp#4)] [!code-csharp[DynamicMethodHowTo#4](../../../samples/snippets/csharp/VS_Snippets_CLR/DynamicMethodHowTo/cs/source.cs#4)] [!code-vb[DynamicMethodHowTo#4](../../../samples/snippets/visualbasic/VS_Snippets_CLR/DynamicMethodHowTo/vb/source.vb#4)]</span><span class="sxs-lookup"><span data-stu-id="42e1b-122">[!code-cpp[DynamicMethodHowTo#4](../../../samples/snippets/cpp/VS_Snippets_CLR/DynamicMethodHowTo/cpp/source.cpp#4)]  [!code-csharp[DynamicMethodHowTo#4](../../../samples/snippets/csharp/VS_Snippets_CLR/DynamicMethodHowTo/cs/source.cs#4)]  [!code-vb[DynamicMethodHowTo#4](../../../samples/snippets/visualbasic/VS_Snippets_CLR/DynamicMethodHowTo/vb/source.vb#4)]</span></span>  
  
4.  <span data-ttu-id="42e1b-123">Geben Sie den Methodentext aus.</span><span class="sxs-lookup"><span data-stu-id="42e1b-123">Emit the method body.</span></span> <span data-ttu-id="42e1b-124">In diesem Beispiel wird ein <xref:System.Reflection.Emit.ILGenerator>-Objekt zum Ausgeben der Microsoft Intermediate Language (MSIL) verwendet.</span><span class="sxs-lookup"><span data-stu-id="42e1b-124">In this example, an <xref:System.Reflection.Emit.ILGenerator> object is used to emit the Microsoft intermediate language (MSIL).</span></span> <span data-ttu-id="42e1b-125">Alternativ kann ein <xref:System.Reflection.Emit.DynamicILInfo>-Objekt in Kombination mit nicht verwalteten Codegeneratoren verwendet werden, um den Methodentext für eine <xref:System.Reflection.Emit.DynamicMethod> auszugeben.</span><span class="sxs-lookup"><span data-stu-id="42e1b-125">Alternatively, a <xref:System.Reflection.Emit.DynamicILInfo> object can be used in conjunction with unmanaged code generators to emit the method body for a <xref:System.Reflection.Emit.DynamicMethod>.</span></span>  
  
     <span data-ttu-id="42e1b-126">Die MSIL lädt in diesem Beispiel das Argument (ein `int`) auf den Stapel, konvertiert es zu `long`, dupliziert `long` und multipliziert die zwei Zahlen.</span><span class="sxs-lookup"><span data-stu-id="42e1b-126">The MSIL in this example loads the argument, which is an `int`, onto the stack, converts it to a `long`, duplicates the `long`, and multiplies the two numbers.</span></span> <span data-ttu-id="42e1b-127">Dadurch verbleibt das quadratische Ergebnis im Stapel, und die Methode muss lediglich wieder zurückspringen.</span><span class="sxs-lookup"><span data-stu-id="42e1b-127">This leaves the squared result on the stack, and all the method has to do is return.</span></span>  
  
     <span data-ttu-id="42e1b-128">[!code-cpp[DynamicMethodHowTo#5](../../../samples/snippets/cpp/VS_Snippets_CLR/DynamicMethodHowTo/cpp/source.cpp#5)] [!code-csharp[DynamicMethodHowTo#5](../../../samples/snippets/csharp/VS_Snippets_CLR/DynamicMethodHowTo/cs/source.cs#5)] [!code-vb[DynamicMethodHowTo#5](../../../samples/snippets/visualbasic/VS_Snippets_CLR/DynamicMethodHowTo/vb/source.vb#5)]</span><span class="sxs-lookup"><span data-stu-id="42e1b-128">[!code-cpp[DynamicMethodHowTo#5](../../../samples/snippets/cpp/VS_Snippets_CLR/DynamicMethodHowTo/cpp/source.cpp#5)]  [!code-csharp[DynamicMethodHowTo#5](../../../samples/snippets/csharp/VS_Snippets_CLR/DynamicMethodHowTo/cs/source.cs#5)]  [!code-vb[DynamicMethodHowTo#5](../../../samples/snippets/visualbasic/VS_Snippets_CLR/DynamicMethodHowTo/vb/source.vb#5)]</span></span>  
  
5.  <span data-ttu-id="42e1b-129">Erstellen Sie eine Instanz des Delegaten (in Schritt 1 deklariert), der die dynamische Methode durch Aufruf der <xref:System.Reflection.Emit.DynamicMethod.CreateDelegate%2A>-Methode darstellt.</span><span class="sxs-lookup"><span data-stu-id="42e1b-129">Create an instance of the delegate (declared in step 1) that represents the dynamic method by calling the <xref:System.Reflection.Emit.DynamicMethod.CreateDelegate%2A> method.</span></span> <span data-ttu-id="42e1b-130">Durch die Erstellung des Delegaten wird die Methode abgeschlossen und alle weiteren Versuche, die Methode zu ändern, z.B. durch Hinzufügen weiterer MSIL, werden ignoriert.</span><span class="sxs-lookup"><span data-stu-id="42e1b-130">Creating the delegate completes the method, and any further attempts to change the method — for example, adding more MSIL — are ignored.</span></span> <span data-ttu-id="42e1b-131">Der folgende Code erstellt den Delegaten und ruft ihn mithilfe eines generischen Delegaten auf.</span><span class="sxs-lookup"><span data-stu-id="42e1b-131">The following code creates the delegate and invokes it, using a generic delegate.</span></span>  
  
     <span data-ttu-id="42e1b-132">[!code-cpp[DynamicMethodHowTo#6](../../../samples/snippets/cpp/VS_Snippets_CLR/DynamicMethodHowTo/cpp/source.cpp#6)] [!code-csharp[DynamicMethodHowTo#6](../../../samples/snippets/csharp/VS_Snippets_CLR/DynamicMethodHowTo/cs/source.cs#6)] [!code-vb[DynamicMethodHowTo#6](../../../samples/snippets/visualbasic/VS_Snippets_CLR/DynamicMethodHowTo/vb/source.vb#6)]</span><span class="sxs-lookup"><span data-stu-id="42e1b-132">[!code-cpp[DynamicMethodHowTo#6](../../../samples/snippets/cpp/VS_Snippets_CLR/DynamicMethodHowTo/cpp/source.cpp#6)]  [!code-csharp[DynamicMethodHowTo#6](../../../samples/snippets/csharp/VS_Snippets_CLR/DynamicMethodHowTo/cs/source.cs#6)]  [!code-vb[DynamicMethodHowTo#6](../../../samples/snippets/visualbasic/VS_Snippets_CLR/DynamicMethodHowTo/vb/source.vb#6)]</span></span>  
  
### <a name="to-define-and-execute-a-dynamic-method-that-is-bound-to-an-object"></a><span data-ttu-id="42e1b-133">So definieren Sie eine dynamische Methode, die an ein Objekt gebunden ist, und führen sie aus</span><span class="sxs-lookup"><span data-stu-id="42e1b-133">To define and execute a dynamic method that is bound to an object</span></span>  
  
1.  <span data-ttu-id="42e1b-134">Deklarieren Sie einen Delegattyp, um die Methode auszuführen.</span><span class="sxs-lookup"><span data-stu-id="42e1b-134">Declare a delegate type to execute the method.</span></span> <span data-ttu-id="42e1b-135">Erwägen Sie, einen generischen Delegaten zu verwenden, um die Anzahl der Delegattypen zu minimieren, die Sie benötigen.</span><span class="sxs-lookup"><span data-stu-id="42e1b-135">Consider using a generic delegate to minimize the number of delegate types you need to declare.</span></span> <span data-ttu-id="42e1b-136">Der folgende Code deklariert einen generischen Delegattyp, der zum Ausführen einer beliebigen Methode mit einem Parameter oder Rückgabewert bzw. einer Methode mit zwei Parametern und einem Rückgabewert verwendet werden kann, falls der Delegat an ein Objekt gebunden ist.</span><span class="sxs-lookup"><span data-stu-id="42e1b-136">The following code declares a generic delegate type that can be used to execute any method with one parameter and a return value, or a method with two parameters and a return value if the delegate is bound to an object.</span></span>  
  
     <span data-ttu-id="42e1b-137">[!code-cpp[DynamicMethodHowTo#12](../../../samples/snippets/cpp/VS_Snippets_CLR/DynamicMethodHowTo/cpp/source.cpp#12)] [!code-csharp[DynamicMethodHowTo#12](../../../samples/snippets/csharp/VS_Snippets_CLR/DynamicMethodHowTo/cs/source.cs#12)] [!code-vb[DynamicMethodHowTo#12](../../../samples/snippets/visualbasic/VS_Snippets_CLR/DynamicMethodHowTo/vb/source.vb#12)]</span><span class="sxs-lookup"><span data-stu-id="42e1b-137">[!code-cpp[DynamicMethodHowTo#12](../../../samples/snippets/cpp/VS_Snippets_CLR/DynamicMethodHowTo/cpp/source.cpp#12)]  [!code-csharp[DynamicMethodHowTo#12](../../../samples/snippets/csharp/VS_Snippets_CLR/DynamicMethodHowTo/cs/source.cs#12)]  [!code-vb[DynamicMethodHowTo#12](../../../samples/snippets/visualbasic/VS_Snippets_CLR/DynamicMethodHowTo/vb/source.vb#12)]</span></span>  
  
2.  <span data-ttu-id="42e1b-138">Erstellen Sie ein Array, das die Parametertypen für die dynamische Methode angibt.</span><span class="sxs-lookup"><span data-stu-id="42e1b-138">Create an array that specifies the parameter types for the dynamic method.</span></span> <span data-ttu-id="42e1b-139">Wenn der Delegat, der die Methode darstellt, an ein Objekt gebunden ist, muss der erste Parameter mit dem Typ übereinstimmen, an den der Delegat gebunden ist.</span><span class="sxs-lookup"><span data-stu-id="42e1b-139">If the delegate representing the method is to be bound to an object, the first parameter must match the type the delegate is bound to.</span></span> <span data-ttu-id="42e1b-140">In diesem Beispiel gibt es zwei Parameter vom Typ `Example` und `int` (`Integer` in Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="42e1b-140">In this example, there are two parameters, of type `Example` and type `int` (`Integer` in Visual Basic).</span></span>  
  
     <span data-ttu-id="42e1b-141">[!code-cpp[DynamicMethodHowTo#13](../../../samples/snippets/cpp/VS_Snippets_CLR/DynamicMethodHowTo/cpp/source.cpp#13)] [!code-csharp[DynamicMethodHowTo#13](../../../samples/snippets/csharp/VS_Snippets_CLR/DynamicMethodHowTo/cs/source.cs#13)] [!code-vb[DynamicMethodHowTo#13](../../../samples/snippets/visualbasic/VS_Snippets_CLR/DynamicMethodHowTo/vb/source.vb#13)]</span><span class="sxs-lookup"><span data-stu-id="42e1b-141">[!code-cpp[DynamicMethodHowTo#13](../../../samples/snippets/cpp/VS_Snippets_CLR/DynamicMethodHowTo/cpp/source.cpp#13)]  [!code-csharp[DynamicMethodHowTo#13](../../../samples/snippets/csharp/VS_Snippets_CLR/DynamicMethodHowTo/cs/source.cs#13)]  [!code-vb[DynamicMethodHowTo#13](../../../samples/snippets/visualbasic/VS_Snippets_CLR/DynamicMethodHowTo/vb/source.vb#13)]</span></span>  
  
3.  <span data-ttu-id="42e1b-142">Erstellen Sie eine <xref:System.Reflection.Emit.DynamicMethod>.</span><span class="sxs-lookup"><span data-stu-id="42e1b-142">Create a <xref:System.Reflection.Emit.DynamicMethod>.</span></span> <span data-ttu-id="42e1b-143">In diesem Beispiel hat die Methode keinen Namen.</span><span class="sxs-lookup"><span data-stu-id="42e1b-143">In this example the method has no name.</span></span> <span data-ttu-id="42e1b-144">Der Typ des Rückgabewerts ist als `int` (`Integer` in Visual Basic) angegeben.</span><span class="sxs-lookup"><span data-stu-id="42e1b-144">The type of the return value is specified as `int` (`Integer` in Visual Basic).</span></span> <span data-ttu-id="42e1b-145">Die Methode hat Zugriff auf die privaten und geschützten Member der `Example`-Klasse.</span><span class="sxs-lookup"><span data-stu-id="42e1b-145">The method has access to the private and protected members of the `Example` class.</span></span>  
  
     <span data-ttu-id="42e1b-146">[!code-cpp[DynamicMethodHowTo#14](../../../samples/snippets/cpp/VS_Snippets_CLR/DynamicMethodHowTo/cpp/source.cpp#14)] [!code-csharp[DynamicMethodHowTo#14](../../../samples/snippets/csharp/VS_Snippets_CLR/DynamicMethodHowTo/cs/source.cs#14)] [!code-vb[DynamicMethodHowTo#14](../../../samples/snippets/visualbasic/VS_Snippets_CLR/DynamicMethodHowTo/vb/source.vb#14)]</span><span class="sxs-lookup"><span data-stu-id="42e1b-146">[!code-cpp[DynamicMethodHowTo#14](../../../samples/snippets/cpp/VS_Snippets_CLR/DynamicMethodHowTo/cpp/source.cpp#14)]  [!code-csharp[DynamicMethodHowTo#14](../../../samples/snippets/csharp/VS_Snippets_CLR/DynamicMethodHowTo/cs/source.cs#14)]  [!code-vb[DynamicMethodHowTo#14](../../../samples/snippets/visualbasic/VS_Snippets_CLR/DynamicMethodHowTo/vb/source.vb#14)]</span></span>  
  
4.  <span data-ttu-id="42e1b-147">Geben Sie den Methodentext aus.</span><span class="sxs-lookup"><span data-stu-id="42e1b-147">Emit the method body.</span></span> <span data-ttu-id="42e1b-148">In diesem Beispiel wird ein <xref:System.Reflection.Emit.ILGenerator>-Objekt zum Ausgeben der Microsoft Intermediate Language (MSIL) verwendet.</span><span class="sxs-lookup"><span data-stu-id="42e1b-148">In this example, an <xref:System.Reflection.Emit.ILGenerator> object is used to emit the Microsoft intermediate language (MSIL).</span></span> <span data-ttu-id="42e1b-149">Alternativ kann ein <xref:System.Reflection.Emit.DynamicILInfo>-Objekt in Kombination mit nicht verwalteten Codegeneratoren verwendet werden, um den Methodentext für eine <xref:System.Reflection.Emit.DynamicMethod> auszugeben.</span><span class="sxs-lookup"><span data-stu-id="42e1b-149">Alternatively, a <xref:System.Reflection.Emit.DynamicILInfo> object can be used in conjunction with unmanaged code generators to emit the method body for a <xref:System.Reflection.Emit.DynamicMethod>.</span></span>  
  
     <span data-ttu-id="42e1b-150">Die MSIL lädt in diesem Beispiel das erste Argument, welches eine Instanz der `Example`-Klasse ist, und verwendet es, um den Wert eines privaten Instanzenfelds vom Typ `int` zu laden.</span><span class="sxs-lookup"><span data-stu-id="42e1b-150">The MSIL in this example loads the first argument, which is an instance of the `Example` class, and uses it to load the value of a private instance field of type `int`.</span></span> <span data-ttu-id="42e1b-151">Das zweite Argument wird geladen, und zwei Zahlen werden multipliziert.</span><span class="sxs-lookup"><span data-stu-id="42e1b-151">The second argument is loaded, and the two numbers are multiplied.</span></span> <span data-ttu-id="42e1b-152">Wenn das Ergebnis größer als `int` ist, wird der Wert abgeschnitten und die wichtigsten Teile verworfen.</span><span class="sxs-lookup"><span data-stu-id="42e1b-152">If the result is larger than `int`, the value is truncated and the most significant bits are discarded.</span></span> <span data-ttu-id="42e1b-153">Die Methode springt zurück und der zurückzugebende Wert befindet sich auf dem Stapel.</span><span class="sxs-lookup"><span data-stu-id="42e1b-153">The method returns, with the return value on the stack.</span></span>  
  
     <span data-ttu-id="42e1b-154">[!code-cpp[DynamicMethodHowTo#15](../../../samples/snippets/cpp/VS_Snippets_CLR/DynamicMethodHowTo/cpp/source.cpp#15)] [!code-csharp[DynamicMethodHowTo#15](../../../samples/snippets/csharp/VS_Snippets_CLR/DynamicMethodHowTo/cs/source.cs#15)] [!code-vb[DynamicMethodHowTo#15](../../../samples/snippets/visualbasic/VS_Snippets_CLR/DynamicMethodHowTo/vb/source.vb#15)]</span><span class="sxs-lookup"><span data-stu-id="42e1b-154">[!code-cpp[DynamicMethodHowTo#15](../../../samples/snippets/cpp/VS_Snippets_CLR/DynamicMethodHowTo/cpp/source.cpp#15)]  [!code-csharp[DynamicMethodHowTo#15](../../../samples/snippets/csharp/VS_Snippets_CLR/DynamicMethodHowTo/cs/source.cs#15)]  [!code-vb[DynamicMethodHowTo#15](../../../samples/snippets/visualbasic/VS_Snippets_CLR/DynamicMethodHowTo/vb/source.vb#15)]</span></span>  
  
5.  <span data-ttu-id="42e1b-155">Erstellen Sie eine Instanz des Delegaten (in Schritt 1 deklariert), der die dynamische Methode durch Aufruf der <xref:System.Reflection.Emit.DynamicMethod.CreateDelegate%28System.Type%2CSystem.Object%29>-Methodenüberladung darstellt.</span><span class="sxs-lookup"><span data-stu-id="42e1b-155">Create an instance of the delegate (declared in step 1) that represents the dynamic method by calling the <xref:System.Reflection.Emit.DynamicMethod.CreateDelegate%28System.Type%2CSystem.Object%29> method overload.</span></span> <span data-ttu-id="42e1b-156">Durch die Erstellung des Delegaten wird die Methode abgeschlossen und alle weiteren Versuche, die Methode zu ändern, z.B. durch Hinzufügen weiterer MSIL, werden ignoriert.</span><span class="sxs-lookup"><span data-stu-id="42e1b-156">Creating the delegate completes the method, and any further attempts to change the method — for example, adding more MSIL — are ignored.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="42e1b-157">Sie können die <xref:System.Reflection.Emit.DynamicMethod.CreateDelegate%2A>-Methode mehrfach aufrufen, um die Delegaten zu erstellen, die an andere Instanzen des Zieltyps gebunden sind.</span><span class="sxs-lookup"><span data-stu-id="42e1b-157">You can call the <xref:System.Reflection.Emit.DynamicMethod.CreateDelegate%2A> method multiple times to create delegates bound to other instances of the target type.</span></span>  
  
     <span data-ttu-id="42e1b-158">Der folgende Code bindet die Methode an eine neue Instanz der `Example`-Klasse, deren privates Testfeld auf 42 festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="42e1b-158">The following code binds the method to a new instance of the `Example` class whose private test field is set to 42.</span></span> <span data-ttu-id="42e1b-159">Das heißt, dass jedes Mal, wenn der Delegat aufgerufen wird, die Instanz von `Example` an den ersten Parameter der Methode übergeben wird.</span><span class="sxs-lookup"><span data-stu-id="42e1b-159">That is, each time the delegate is invoked the instance of `Example` is passed to the first parameter of the method.</span></span>  
  
     <span data-ttu-id="42e1b-160">Der Delegat `OneParameter` wird verwendet, da der erste Parameter der Methode immer die Instanz von `Example` erhält.</span><span class="sxs-lookup"><span data-stu-id="42e1b-160">The delegate `OneParameter` is used because the first parameter of the method always receives the instance of `Example`.</span></span> <span data-ttu-id="42e1b-161">Wenn der Delegat aufgerufen wird, ist nur der zweite Parameter erforderlich.</span><span class="sxs-lookup"><span data-stu-id="42e1b-161">When the delegate is invoked, only the second parameter is required.</span></span>  
  
     <span data-ttu-id="42e1b-162">[!code-cpp[DynamicMethodHowTo#16](../../../samples/snippets/cpp/VS_Snippets_CLR/DynamicMethodHowTo/cpp/source.cpp#16)] [!code-csharp[DynamicMethodHowTo#16](../../../samples/snippets/csharp/VS_Snippets_CLR/DynamicMethodHowTo/cs/source.cs#16)] [!code-vb[DynamicMethodHowTo#16](../../../samples/snippets/visualbasic/VS_Snippets_CLR/DynamicMethodHowTo/vb/source.vb#16)]</span><span class="sxs-lookup"><span data-stu-id="42e1b-162">[!code-cpp[DynamicMethodHowTo#16](../../../samples/snippets/cpp/VS_Snippets_CLR/DynamicMethodHowTo/cpp/source.cpp#16)]  [!code-csharp[DynamicMethodHowTo#16](../../../samples/snippets/csharp/VS_Snippets_CLR/DynamicMethodHowTo/cs/source.cs#16)]  [!code-vb[DynamicMethodHowTo#16](../../../samples/snippets/visualbasic/VS_Snippets_CLR/DynamicMethodHowTo/vb/source.vb#16)]</span></span>  
  
## <a name="example"></a><span data-ttu-id="42e1b-163">Beispiel</span><span class="sxs-lookup"><span data-stu-id="42e1b-163">Example</span></span>  
 <span data-ttu-id="42e1b-164">Das folgende Codebeispiel zeigt eine einfache dynamische Methode sowie eine dynamische Methode, die an eine Instanz einer Klasse gebunden ist.</span><span class="sxs-lookup"><span data-stu-id="42e1b-164">The following code example demonstrates a simple dynamic method and a dynamic method bound to an instance of a class.</span></span>  
  
 <span data-ttu-id="42e1b-165">Die einfache dynamische Methode nimmt ein Argument, einen 32-Bit-Integer und gibt das 64-Bit-Quadrat dieses Integers zurück.</span><span class="sxs-lookup"><span data-stu-id="42e1b-165">The simple dynamic method takes one argument, a 32-bit integer, and returns the 64-bit square of that integer.</span></span> <span data-ttu-id="42e1b-166">Ein generischer Delegat wird zum Aufrufen der Methode verwendet.</span><span class="sxs-lookup"><span data-stu-id="42e1b-166">A generic delegate is used to invoke the method.</span></span>  
  
 <span data-ttu-id="42e1b-167">Die zweite dynamische Methode hat zwei Parameter des Typs `Example` und `int` (`Integer` in Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="42e1b-167">The second dynamic method has two parameters, of type `Example` and type `int` (`Integer` in Visual Basic).</span></span> <span data-ttu-id="42e1b-168">Wenn die dynamische Methode erstellt wurde, wird sie mithilfe eines generischen Delegaten, der ein Argument vom Typ `int` besitzt, an eine Instanz von `Example` gebunden.</span><span class="sxs-lookup"><span data-stu-id="42e1b-168">When the dynamic method has been created, it is bound to an instance of `Example`, using a generic delegate that has one argument of type `int`.</span></span> <span data-ttu-id="42e1b-169">Der Delegat besitzt kein Argument vom Typ `Example`, da der erste Parameter der Methode immer die gebundene Instanz von `Example` erhält.</span><span class="sxs-lookup"><span data-stu-id="42e1b-169">The delegate does not have an argument of type `Example` because the first parameter of the method always receives the bound instance of `Example`.</span></span> <span data-ttu-id="42e1b-170">Wenn der Delegat aufgerufen wird, wird nur das `int`-Argument bereitgestellt.</span><span class="sxs-lookup"><span data-stu-id="42e1b-170">When the delegate is invoked, only the `int` argument is supplied.</span></span> <span data-ttu-id="42e1b-171">Diese dynamische Methode greift auf ein privates Feld der `Example`-Klasse zu und gibt das Produkt des privaten Felds und das `int`-Argument zurück.</span><span class="sxs-lookup"><span data-stu-id="42e1b-171">This dynamic method accesses a private field of the `Example` class and returns the product of the private field and the `int` argument.</span></span>  
  
 <span data-ttu-id="42e1b-172">Das Codebeispiel definiert Delegaten, die zum Ausführen dieser Methoden verwendet werden können.</span><span class="sxs-lookup"><span data-stu-id="42e1b-172">The code example defines delegates that can be used to execute the methods.</span></span>  
  
 <span data-ttu-id="42e1b-173">[!code-cpp[DynamicMethodHowTo#1](../../../samples/snippets/cpp/VS_Snippets_CLR/DynamicMethodHowTo/cpp/source.cpp#1)] [!code-csharp[DynamicMethodHowTo#1](../../../samples/snippets/csharp/VS_Snippets_CLR/DynamicMethodHowTo/cs/source.cs#1)] [!code-vb[DynamicMethodHowTo#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/DynamicMethodHowTo/vb/source.vb#1)]</span><span class="sxs-lookup"><span data-stu-id="42e1b-173">[!code-cpp[DynamicMethodHowTo#1](../../../samples/snippets/cpp/VS_Snippets_CLR/DynamicMethodHowTo/cpp/source.cpp#1)] [!code-csharp[DynamicMethodHowTo#1](../../../samples/snippets/csharp/VS_Snippets_CLR/DynamicMethodHowTo/cs/source.cs#1)] [!code-vb[DynamicMethodHowTo#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/DynamicMethodHowTo/vb/source.vb#1)]</span></span>  
  
## <a name="compiling-the-code"></a><span data-ttu-id="42e1b-174">Kompilieren des Codes</span><span class="sxs-lookup"><span data-stu-id="42e1b-174">Compiling the Code</span></span>  
  
-   <span data-ttu-id="42e1b-175">Der Code enthält die für die Kompilierung erforderlichen `using`-Anweisungen für C# (`Imports` in Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="42e1b-175">The code contains the C# `using` statements (`Imports` in Visual Basic) necessary for compilation.</span></span>  
  
-   <span data-ttu-id="42e1b-176">Er werden keine weiteren Assemblyverweise benötigt.</span><span class="sxs-lookup"><span data-stu-id="42e1b-176">No additional assembly references are required.</span></span>  
  
-   <span data-ttu-id="42e1b-177">Kompilieren Sie den Code über die Befehlszeile mit csc.exe, vbc.exe oder cl.exe.</span><span class="sxs-lookup"><span data-stu-id="42e1b-177">Compile the code at the command line using csc.exe, vbc.exe, or cl.exe.</span></span> <span data-ttu-id="42e1b-178">Um den Code in Visual Studio zu kompilieren, fügen Sie ihn in eine Projektvorlage für eine Konsolenanwendung ein.</span><span class="sxs-lookup"><span data-stu-id="42e1b-178">To compile the code in Visual Studio, place it in a console application project template.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="42e1b-179">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="42e1b-179">See Also</span></span>  
 <span data-ttu-id="42e1b-180"><xref:System.Reflection.Emit.DynamicMethod></span><span class="sxs-lookup"><span data-stu-id="42e1b-180"><xref:System.Reflection.Emit.DynamicMethod></span></span>   
 <span data-ttu-id="42e1b-181">[Verwenden der Reflektionsausgabe](http://msdn.microsoft.com/en-us/ccc6540d-0e2c-4d89-b456-eb7353f9e9ac) </span><span class="sxs-lookup"><span data-stu-id="42e1b-181">[Using Reflection Emit](http://msdn.microsoft.com/en-us/ccc6540d-0e2c-4d89-b456-eb7353f9e9ac) </span></span>  
 [<span data-ttu-id="42e1b-182">Szenarios für die Reflektionsausgabe mit dynamischen Methoden</span><span class="sxs-lookup"><span data-stu-id="42e1b-182">Reflection Emit Dynamic Method Scenarios</span></span>](http://msdn.microsoft.com/en-us/7c27ea3d-0f24-4bf3-8ceb-f49d33faca5e)

