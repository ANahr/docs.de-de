---
title: Testen einer Klassenbibliothek mit .NET Core in Visual Studio 2017
description: Erfahren Sie, wie Sie eine in C# geschriebene Klassenbibliothek mithilfe von Visual Studio 2017 testen.
author: BillWagner
ms.author: wiwagn
ms.date: 08/07/2017
dev_langs:
- csharp
- vb
ms.custom: vs-dotnet
ms.openlocfilehash: 04fef4f84658b3a8b82e4e71b62c3bab8537424d
ms.sourcegitcommit: 5bbfe34a9a14e4ccb22367e57b57585c208cf757
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 09/18/2018
ms.locfileid: "45990972"
---
# <a name="testing-a-class-library-with-net-core-in-visual-studio-2017"></a><span data-ttu-id="88faf-103">Testen einer Klassenbibliothek mit .NET Core in Visual Studio 2017</span><span class="sxs-lookup"><span data-stu-id="88faf-103">Testing a class library with .NET Core in Visual Studio 2017</span></span>

<span data-ttu-id="88faf-104">In [Building a class library with C# and .NET Core in Visual Studio 2017 (Erstellen einer Klassenbibliothek mit C# und .NET Core in Visual Studio2017)](library-with-visual-studio.md) oder [Building a class library with Visual Basic and .NET Core in Visual Studio 2017 (Erstellen einer Klassenbibliothek mit Visual Basic und .NET Core in Visual Studio 2017)](vb-library-with-visual-studio.md) haben Sie eine einfache Klassenbibliothek erstellt, die eine Erweiterungsmethode zur Klasse <xref:System.String> hinzufügt.</span><span class="sxs-lookup"><span data-stu-id="88faf-104">In [Building a class library with C# and .NET Core in Visual Studio 2017](library-with-visual-studio.md) or [Building a class library with Visual Basic and .NET Core in Visual Studio 2017](vb-library-with-visual-studio.md), you created a simple class library that adds an extension method to the <xref:System.String> class.</span></span> <span data-ttu-id="88faf-105">Jetzt erstellen Sie einen Komponententest, um sicherzustellen, dass es wie erwartet funktioniert.</span><span class="sxs-lookup"><span data-stu-id="88faf-105">Now, you'll create a unit test to make sure that it works as expected.</span></span> <span data-ttu-id="88faf-106">Sie fügen Ihr Komponententestprojekt der Projektmappe hinzu, die Sie im vorherigen Thema erstellt haben.</span><span class="sxs-lookup"><span data-stu-id="88faf-106">You'll add your unit test project to the solution you created in the previous topic.</span></span>

## <a name="creating-a-unit-test-project"></a><span data-ttu-id="88faf-107">Erstellen eines Komponententestprojekts</span><span class="sxs-lookup"><span data-stu-id="88faf-107">Creating a unit test project</span></span>

<span data-ttu-id="88faf-108">Um das Komponententestprojekt zu erstellen, führen Sie folgende Schritte aus:</span><span class="sxs-lookup"><span data-stu-id="88faf-108">To create the unit test project, do the following:</span></span>

# <a name="ctabcsharp"></a>[<span data-ttu-id="88faf-109">C#</span><span class="sxs-lookup"><span data-stu-id="88faf-109">C#</span></span>](#tab/csharp)
1. <span data-ttu-id="88faf-110">Öffnen Sie im **Projektmappen-Explorer** das Kontextmenü des Projektmappenknotens **ClassLibraryProject**, und wählen Sie **Hinzufügen** > **Neues Projekt** aus.</span><span class="sxs-lookup"><span data-stu-id="88faf-110">In **Solution Explorer**, open the context menu for the **ClassLibraryProjects** solution node and select **Add** > **New Project**.</span></span>

1. <span data-ttu-id="88faf-111">Klicken Sie auf den Knoten **Visual C#** im Dialogfeld **Neues Projekt hinzufügen**.</span><span class="sxs-lookup"><span data-stu-id="88faf-111">In the **Add New Project** dialog, select the **Visual C#** node.</span></span> <span data-ttu-id="88faf-112">Klicken Sie dann auf den Knoten **.NET Core**, gefolgt von der Projektvorlage **MSTest-Testprojekt (.NET Core)**.</span><span class="sxs-lookup"><span data-stu-id="88faf-112">Then select the **.NET Core** node followed by the **MSTest Test Project (.NET Core)** project template.</span></span> <span data-ttu-id="88faf-113">Geben Sie im Textfeld **Name** „StringLibraryTest“ als Namen des Projekts ein.</span><span class="sxs-lookup"><span data-stu-id="88faf-113">In the **Name** text box, enter "StringLibraryTest" as the name of the project.</span></span> <span data-ttu-id="88faf-114">Klicken Sie auf **OK**, um das Komponententestprojekt zu erstellen</span><span class="sxs-lookup"><span data-stu-id="88faf-114">Select **OK** to create the unit test project.</span></span>

   ![Dialogfeld „Neues Projekt hinzufügen“](./media/testing-library-with-visual-studio/testproject.png)

   > [!NOTE]  
   > <span data-ttu-id="88faf-116">Neben einem MSTest-Testprojekt können Sie auch Visual Studio verwenden, um ein xUnit-Testprojekt für .NET Core zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="88faf-116">In addition to an MSTest Test project, you can also use Visual Studio to create an xUnit test project for .NET Core.</span></span>

1. <span data-ttu-id="88faf-117">Visual Studio erstellt das Projekt und öffnet die *UnitTest1.cs*-Datei im Codefenster.</span><span class="sxs-lookup"><span data-stu-id="88faf-117">Visual Studio creates the project and opens the *UnitTest1.cs* file in the code window.</span></span>

   ![Das Codefenster von Visual Studio zeigt das standardmäßige UnitTest1-Klasse und TestMethod1-Methode des Komponententestprojekts.](./media/testing-library-with-visual-studio/unittestwindow.png)

   <span data-ttu-id="88faf-119">Der von der Vorlage für Komponententests erstellte Quellcode führt Folgendes aus:</span><span class="sxs-lookup"><span data-stu-id="88faf-119">The source code created by the unit test template does the following:</span></span>

   * <span data-ttu-id="88faf-120">Er importiert den Namespace <xref:Microsoft.VisualStudio.TestTools.UnitTesting?displayProperty=nameWithType>, der für Komponententests verwendeten Typen enthält.</span><span class="sxs-lookup"><span data-stu-id="88faf-120">It imports the <xref:Microsoft.VisualStudio.TestTools.UnitTesting?displayProperty=nameWithType> namespace, which contains the types used for unit testing.</span></span>

   * <span data-ttu-id="88faf-121">Er wendet das Attribut <xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestClassAttribute> auf die Klasse `UnitTest1` an.</span><span class="sxs-lookup"><span data-stu-id="88faf-121">It applies the <xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestClassAttribute> attribute to the `UnitTest1` class.</span></span> <span data-ttu-id="88faf-122">Jede mit dem \[TestMethod\]-Attribut markierte Testmethode in einer Testklasse wird automatisch ausgeführt, wenn der Komponententest ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="88faf-122">Each test method in a test class tagged with the \[TestMethod\] attribute is executed automatically when the unit test is run.</span></span>

   * <span data-ttu-id="88faf-123">Er wendet das Attribut <xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestMethodAttribute> an, um `TestMethod1` als Testmethode für die automatische Ausführung zu definieren, wenn der Komponententest ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="88faf-123">It applies the <xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestMethodAttribute> attribute to define `TestMethod1` as a test method for automatic execution when the unit test is run.</span></span>

1. <span data-ttu-id="88faf-124">Öffnen Sie im **Projektmappen-Explorer** das Kontextmenü für den Knoten **Abhängigkeiten** des **StringLibraryTest**-Projekts, und wählen Sie **Verweis hinzufügen** aus.</span><span class="sxs-lookup"><span data-stu-id="88faf-124">In **Solution Explorer**, right-click the **Dependencies** node of the **StringLibraryTest** project and select **Add Reference** from the context menu.</span></span>

   ![Kontextmenü der StringLibraryTest-Abhängigkeiten](./media/testing-library-with-visual-studio/addreference.png)

1. <span data-ttu-id="88faf-126">Erweitern Sie im Dialogfeld **Reference Manager** den Knoten **Projekte** und aktivieren Sie das Feld neben **StringLibrary**.</span><span class="sxs-lookup"><span data-stu-id="88faf-126">In the **Reference Manager** dialog, expand the **Projects** node and check the box next to **StringLibrary**.</span></span> <span data-ttu-id="88faf-127">Das Hinzufügen eines Verweises auf die `StringLibrary`-Assembly ermöglicht dem Compiler, **StringLibrary**-Methoden zu finden.</span><span class="sxs-lookup"><span data-stu-id="88faf-127">Adding a reference to the `StringLibrary` assembly allows the compiler to find **StringLibrary** methods.</span></span> <span data-ttu-id="88faf-128">Klicken Sie auf die Schaltfläche **OK**.</span><span class="sxs-lookup"><span data-stu-id="88faf-128">Select the **OK** button.</span></span> <span data-ttu-id="88faf-129">Dadurch wird ein Verweis auf Ihr Klassenbibliotheksprojekt, `StringLibrary`, hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="88faf-129">This adds a reference to your class library project, `StringLibrary`.</span></span>

   ![Verweis-Manager](./media/testing-library-with-visual-studio/referencemanager.png)
# <a name="visual-basictabvisual-basic"></a>[<span data-ttu-id="88faf-131">Visual Basic</span><span class="sxs-lookup"><span data-stu-id="88faf-131">Visual Basic</span></span>](#tab/visual-basic) 
1. <span data-ttu-id="88faf-132">Öffnen Sie im **Projektmappen-Explorer** das Kontextmenü des Projektmappenknotens **ClassLibraryProject**, und wählen Sie **Hinzufügen** > **Neues Projekt** aus.</span><span class="sxs-lookup"><span data-stu-id="88faf-132">In **Solution Explorer**, open the context menu for the **ClassLibraryProjects** solution node and select **Add** > **New Project**.</span></span>

1. <span data-ttu-id="88faf-133">Klicken Sie auf den Knoten **Visual Basic** im Dialogfeld **Neues Projekt hinzufügen**.</span><span class="sxs-lookup"><span data-stu-id="88faf-133">In the **Add New Project** dialog, select the **Visual Basic** node.</span></span> <span data-ttu-id="88faf-134">Klicken Sie dann auf den Knoten **.NET Core**, gefolgt von der Projektvorlage **MSTest-Testprojekt (.NET Core)**.</span><span class="sxs-lookup"><span data-stu-id="88faf-134">Then select the **.NET Core** node followed by the **MSTest Test Project (.NET Core)** project template.</span></span> <span data-ttu-id="88faf-135">Geben Sie im Textfeld **Name** „StringLibraryTest“ als Namen des Projekts ein.</span><span class="sxs-lookup"><span data-stu-id="88faf-135">In the **Name** text box, enter "StringLibraryTest" as the name of the project.</span></span> <span data-ttu-id="88faf-136">Klicken Sie auf **OK**, um das Komponententestprojekt zu erstellen</span><span class="sxs-lookup"><span data-stu-id="88faf-136">Select **OK** to create the unit test project.</span></span>

   ![Dialogfeld „Neues Projekt hinzufügen“](./media/testing-library-with-visual-studio/vb-testproject.png)

   > [!NOTE]  
   > <span data-ttu-id="88faf-138">Neben einem MSTest-Testprojekt können Sie auch Visual Studio verwenden, um ein xUnit-Testprojekt für .NET Core zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="88faf-138">In addition to an MSTest Test project, you can also use Visual Studio to create an xUnit test project for .NET Core.</span></span>

1. <span data-ttu-id="88faf-139">Visual Studio erstellt das Projekt und öffnet die *UnitTest1.vb*-Datei im Codefenster.</span><span class="sxs-lookup"><span data-stu-id="88faf-139">Visual Studio creates the project and opens the *UnitTest1.vb* file in the code window.</span></span>

   ![Das Codefenster von Visual Studio zeigt das standardmäßige UnitTest1-Klasse und TestMethod1-Methode des Komponententestprojekts.](./media/testing-library-with-visual-studio/vb-unittestwindow.png)

   <span data-ttu-id="88faf-141">Der von der Vorlage für Komponententests erstellte Quellcode führt Folgendes aus:</span><span class="sxs-lookup"><span data-stu-id="88faf-141">The source code created by the unit test template does the following:</span></span>

   * <span data-ttu-id="88faf-142">Er importiert den Namespace [Microsoft.VisualStudio.TestTools.UnitTesting]<xref:Microsoft.VisualStudio.TestTools.UnitTesting?displayProperty=namewithType>, der die für Komponententests verwendeten Typen enthält.</span><span class="sxs-lookup"><span data-stu-id="88faf-142">It imports the [Microsoft.VisualStudio.TestTools.UnitTesting]<xref:Microsoft.VisualStudio.TestTools.UnitTesting?displayProperty=namewithType> namespace, which contains the types used for unit testing.</span></span>

   * <span data-ttu-id="88faf-143">Er wendet das Attribut <xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestClassAttribute> auf die Klasse `UnitTest1` an.</span><span class="sxs-lookup"><span data-stu-id="88faf-143">It applies the <xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestClassAttribute>) attribute to the `UnitTest1` class.</span></span> <span data-ttu-id="88faf-144">Jede mit dem Attribut <xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestMethodAttribute> markierte Testmethode in einer Testklasse wird bei Ausführung des Komponententests automatisch ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="88faf-144">Each test method in a test class tagged with the <xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestMethodAttribute> attribute is executed automatically when the unit test is run.</span></span>

   * <span data-ttu-id="88faf-145">Er wendet das Attribut <xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestMethodAttribute> an, um `TestMethod1` als Testmethode für die automatische Ausführung zu definieren, wenn der Komponententest ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="88faf-145">It applies the <xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestMethodAttribute> attribute to define `TestMethod1` as a test method for automatic execution when the unit test is run.</span></span>

1. <span data-ttu-id="88faf-146">Öffnen Sie im **Projektmappen-Explorer** das Kontextmenü für den Knoten **Abhängigkeiten** des **StringLibraryTest**-Projekts, und wählen Sie **Verweis hinzufügen** aus.</span><span class="sxs-lookup"><span data-stu-id="88faf-146">In **Solution Explorer**, right-click the **Dependencies** node of the **StringLibraryTest** project and select **Add Reference** from the context menu.</span></span>

   ![Kontextmenü der StringLibraryTest-Abhängigkeiten](./media/testing-library-with-visual-studio/addreference.png)

1. <span data-ttu-id="88faf-148">Erweitern Sie im Dialogfeld **Reference Manager** den Knoten **Projekte** und aktivieren Sie das Feld neben **StringLibrary**.</span><span class="sxs-lookup"><span data-stu-id="88faf-148">In the **Reference Manager** dialog, expand the **Projects** node and check the box next to **StringLibrary**.</span></span> <span data-ttu-id="88faf-149">Das Hinzufügen eines Verweises auf die `StringLibrary`-Assembly ermöglicht dem Compiler, **StringLibrary**-Methoden zu finden.</span><span class="sxs-lookup"><span data-stu-id="88faf-149">Adding a reference to the `StringLibrary` assembly allows the compiler to find **StringLibrary** methods.</span></span> <span data-ttu-id="88faf-150">Klicken Sie auf die Schaltfläche **OK**.</span><span class="sxs-lookup"><span data-stu-id="88faf-150">Select the **OK** button.</span></span> <span data-ttu-id="88faf-151">Dadurch wird ein Verweis auf Ihr Klassenbibliotheksprojekt, `StringLibrary`, hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="88faf-151">This adds a reference to your class library project, `StringLibrary`.</span></span>

   ![Verweis-Manager](./media/testing-library-with-visual-studio/referencemanager.png)
---

## <a name="adding-and-running-unit-test-methods"></a><span data-ttu-id="88faf-153">Hinzufügen und Ausführen von Komponententestmethoden</span><span class="sxs-lookup"><span data-stu-id="88faf-153">Adding and running unit test methods</span></span>

<span data-ttu-id="88faf-154">Wenn Visual Studio einen Komponententest ausführt, wird jede Methode in einer Komponententestklasse – der Klasse, auf die das Attribut <xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestClassAttribute> angewendet wird – ausgeführt, die mit dem Attribut <xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestMethodAttribute> markiert ist.</span><span class="sxs-lookup"><span data-stu-id="88faf-154">When Visual Studio runs a unit test, it executes each method marked with the <xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestMethodAttribute> attribute in a unit test class, the class to which the  <xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestClassAttribute> attribute is applied.</span></span> <span data-ttu-id="88faf-155">Eine Testmethode endet, wenn der erste Fehler aufgetreten ist, oder wenn alle in der Methode enthaltenen Tests erfolgreich ausgeführt wurden.</span><span class="sxs-lookup"><span data-stu-id="88faf-155">A test method ends when the first failure is encountered or when all tests contained in the method have succeeded.</span></span>

<span data-ttu-id="88faf-156">In den am häufigsten verwendeten Tests werden Member der Klasse <xref:Microsoft.VisualStudio.TestTools.UnitTesting.Assert> aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="88faf-156">The most common tests call members of the <xref:Microsoft.VisualStudio.TestTools.UnitTesting.Assert> class.</span></span> <span data-ttu-id="88faf-157">Viele Assert-Methoden enthalten mindestens zwei Parameter, von denen einer das erwartete und der andere das tatsächliche Testergebnis ist.</span><span class="sxs-lookup"><span data-stu-id="88faf-157">Many assert methods include at least two parameters, one of which is the expected test result and the other of which is the actual test result.</span></span> <span data-ttu-id="88faf-158">Die am häufigsten aufgerufenen Methoden sind in der nachfolgenden Tabelle aufgeführt.</span><span class="sxs-lookup"><span data-stu-id="88faf-158">Some of its most frequently called methods are shown in the table below.</span></span>

<span data-ttu-id="88faf-159">Assert-Methoden</span><span class="sxs-lookup"><span data-stu-id="88faf-159">Assert methods</span></span> | <span data-ttu-id="88faf-160">Funktion</span><span class="sxs-lookup"><span data-stu-id="88faf-160">Function</span></span>
--- | ---
`Assert.AreEqual` | <span data-ttu-id="88faf-161">Überprüft, ob zwei Werte oder Objekte gleich sind.</span><span class="sxs-lookup"><span data-stu-id="88faf-161">Verifies that two values or objects are equal.</span></span> <span data-ttu-id="88faf-162">Die Bestätigung ist nicht erfolgreich, wenn die Werte oder Objekte nicht gleich sind.</span><span class="sxs-lookup"><span data-stu-id="88faf-162">The assert fails if the values or objects are not equal.</span></span>
`Assert.AreSame` | <span data-ttu-id="88faf-163">Überprüft, ob zwei Objektvariablen auf das gleiche Objekt verweisen.</span><span class="sxs-lookup"><span data-stu-id="88faf-163">Verifies that two object variables refer to the same object.</span></span> <span data-ttu-id="88faf-164">Die Bestätigung ist nicht erfolgreich, wenn die Variablen auf verschiedene Objekte verweisen.</span><span class="sxs-lookup"><span data-stu-id="88faf-164">The assert fails if the variables refer to different objects.</span></span>
`Assert.IsFalse` | <span data-ttu-id="88faf-165">Überprüft, ob eine Bedingung `false` ist.</span><span class="sxs-lookup"><span data-stu-id="88faf-165">Verifies that a condition is `false`.</span></span> <span data-ttu-id="88faf-166">Die Bestätigung ist nicht erfolgreich, wenn die Bedingung `true` ist.</span><span class="sxs-lookup"><span data-stu-id="88faf-166">The assert fails if the condition is `true`.</span></span>
`Assert.IsNotNull` | <span data-ttu-id="88faf-167">Überprüft, ob ein Objekt nicht `null` ist.</span><span class="sxs-lookup"><span data-stu-id="88faf-167">Verifies that an object is not `null`.</span></span> <span data-ttu-id="88faf-168">Die Bestätigung ist nicht erfolgreich, wenn das Objekt `null` ist.</span><span class="sxs-lookup"><span data-stu-id="88faf-168">The assert fails if the object is `null`.</span></span>

<span data-ttu-id="88faf-169">Sie können auch das Attribut <xref:Microsoft.VisualStudio.TestTools.UnitTesting.ExpectedExceptionAttribute> auf eine Testmethode anwenden.</span><span class="sxs-lookup"><span data-stu-id="88faf-169">You can also apply the <xref:Microsoft.VisualStudio.TestTools.UnitTesting.ExpectedExceptionAttribute> attribute to a test method.</span></span> <span data-ttu-id="88faf-170">Es gibt den Typ der Ausnahme an, die eine Testmethode auslösen soll.</span><span class="sxs-lookup"><span data-stu-id="88faf-170">It indicates the type of exception a test method is expected to throw.</span></span> <span data-ttu-id="88faf-171">Der Test ist nicht erfolgreich, wenn die angegebene Ausnahme nicht ausgelöst wird.</span><span class="sxs-lookup"><span data-stu-id="88faf-171">The test fails if the specified exception is not thrown.</span></span>

<span data-ttu-id="88faf-172">Beim Testen der `StringLibrary.StartsWithUpper`-Methode möchten Sie eine Reihe von Zeichenfolgen bereitstellen, die mit einem Großbuchstaben beginnen.</span><span class="sxs-lookup"><span data-stu-id="88faf-172">In testing the `StringLibrary.StartsWithUpper` method, you want to provide a number of strings that begin with an uppercase character.</span></span> <span data-ttu-id="88faf-173">Sie erwarten, dass die Methode in diesen Fällen `true` zurückgibt, also können Sie die Methode <xref:Microsoft.VisualStudio.TestTools.UnitTesting.Assert.IsTrue%2A> aufrufen.</span><span class="sxs-lookup"><span data-stu-id="88faf-173">You expect the method to return `true` in these cases, so you can call the <xref:Microsoft.VisualStudio.TestTools.UnitTesting.Assert.IsTrue%2A> method.</span></span> <span data-ttu-id="88faf-174">Außerdem möchten Sie eine Reihe von Zeichenfolgen bereitstellen, die nicht mit einem Großbuchstaben beginnen.</span><span class="sxs-lookup"><span data-stu-id="88faf-174">Similarly, you want to provide a number of strings that begin with something other than an uppercase character.</span></span> <span data-ttu-id="88faf-175">Sie erwarten, dass die Methode in diesen Fällen `false` zurückgibt, also können Sie die Methode <xref:Microsoft.VisualStudio.TestTools.UnitTesting.Assert.IsFalse%2A> aufrufen.</span><span class="sxs-lookup"><span data-stu-id="88faf-175">You expect the method to return `false` in these cases, so you can call the <xref:Microsoft.VisualStudio.TestTools.UnitTesting.Assert.IsFalse%2A> method.</span></span>

<span data-ttu-id="88faf-176">Da Ihre Bibliotheksmethode Zeichenfolgen behandelt, möchten Sie auch sicherstellen, dass sie eine [leere Zeichenfolge (`String.Empty`)](xref:System.String.Empty), eine gültige Zeichenfolge, die keine Zeichen enthält und deren <xref:System.String.Length> 0 ist, und eine `null`-Zeichenfolge, die nicht initialisiert wurde, erfolgreich behandelt.</span><span class="sxs-lookup"><span data-stu-id="88faf-176">Since your library method handles strings, you also want to make sure that it successfully handles an [empty string (`String.Empty`)](xref:System.String.Empty), a valid string that has no characters and whose <xref:System.String.Length> is 0, and a `null` string that has not been initialized.</span></span> <span data-ttu-id="88faf-177">Wenn `StartsWithUpper` als eine Erweiterungsmethode für eine <xref:System.String>-Instanz aufgerufen wird, kann ihr keine `null`-Zeichenfolge übergeben werden.</span><span class="sxs-lookup"><span data-stu-id="88faf-177">If `StartsWithUpper` is called as an extension method on a <xref:System.String> instance, it cannot be passed a `null` string.</span></span> <span data-ttu-id="88faf-178">Allerdings kann sie auch direkt als statische Methode aufgerufen und ihr ein einzelnes <xref:System.String>-Argument übergeben werden.</span><span class="sxs-lookup"><span data-stu-id="88faf-178">However, you can also call it directly as a static method and pass a single <xref:System.String> argument.</span></span>

<span data-ttu-id="88faf-179">Sie definieren drei Methoden, von denen jede die zugehörige Methode <xref:Microsoft.VisualStudio.TestTools.UnitTesting.Assert> wiederholt für jedes Element in einem Zeichenfolgenarray aufruft.</span><span class="sxs-lookup"><span data-stu-id="88faf-179">You'll define three methods, each of which calls its <xref:Microsoft.VisualStudio.TestTools.UnitTesting.Assert> method repeatedly for each element in a string array.</span></span> <span data-ttu-id="88faf-180">Da die Testmethode nicht fortgesetzt wird, sobald sie auf den ersten Fehler trifft, rufen Sie eine Methodenüberladung auf, mit der Sie eine Zeichenfolge übergeben können, die den Zeichenfolgenwert angibt, der im Methodenaufruf verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="88faf-180">Because the test method fails as soon as it encounters the first failure, you'll call a method overload that allows you to pass a string that indicates the string value used in the method call.</span></span>

<span data-ttu-id="88faf-181">So erstellen Sie die Testmethoden:</span><span class="sxs-lookup"><span data-stu-id="88faf-181">To create the test methods:</span></span>

# <a name="ctabcsharp"></a>[<span data-ttu-id="88faf-182">C#</span><span class="sxs-lookup"><span data-stu-id="88faf-182">C#</span></span>](#tab/csharp) 
1. <span data-ttu-id="88faf-183">Ersetzen Sie den Code im Codefenster *UnitTest1.cs* durch den folgenden Code:</span><span class="sxs-lookup"><span data-stu-id="88faf-183">In the *UnitTest1.cs* code window, replace the code with the following code:</span></span>

   [!CODE-csharp[Test#1](../../../samples/snippets/csharp/getting_started/with_visual_studio_2017/testlib1.cs)]

   <span data-ttu-id="88faf-184">Beachten Sie, dass Ihr Großbuchstabentest in der `TestStartsWithUpper`-Methode den griechischen Großbuchstaben Alpha (U+0391) und den kyrillischen Großbuchstaben EM (U+ 041C) umfasst, und der Kleinbuchstabentest in der `TestDoesNotStartWithUpper`-Methode den griechischen Kleinbuchstaben Alpha (U+03B1) und den kyrillischen Kleinbuchstaben Ghe (U+0433).</span><span class="sxs-lookup"><span data-stu-id="88faf-184">Note that your test of uppercase characters in the `TestStartsWithUpper` method includes the Greek capital letter alpha (U+0391) and the Cyrillic capital letter EM (U+041C), and the test of lowercase characters in the `TestDoesNotStartWithUpper` method includes the Greek small letter alpha (U+03B1) and the Cyrillic small letter Ghe (U+0433).</span></span>

1. <span data-ttu-id="88faf-185">Wählen Sie in der Menüleiste **Datei** > **UnitTest1.cs speichern unter** aus.</span><span class="sxs-lookup"><span data-stu-id="88faf-185">On the menu bar, select **File** > **Save UnitTest1.cs As**.</span></span> <span data-ttu-id="88faf-186">Wählen Sie im Dialogfeld **Datei speichern unter** den Pfeil neben der Schaltfläche **Speichern**, und wählen Sie dann **Mit Codierung speichern...** aus.</span><span class="sxs-lookup"><span data-stu-id="88faf-186">In the **Save File As** dialog, select the arrow beside the **Save** button, and select **Save with Encoding**.</span></span>

   ![Dialogfeld „Datei speichern unter“](./media/testing-library-with-visual-studio/savefileas.png)
# <a name="visual-basictabvisual-basic"></a>[<span data-ttu-id="88faf-188">Visual Basic</span><span class="sxs-lookup"><span data-stu-id="88faf-188">Visual Basic</span></span>](#tab/visual-basic) 
1. <span data-ttu-id="88faf-189">Ersetzen Sie den Code im Codefenster *UnitTest1.vb* durch den folgenden Code:</span><span class="sxs-lookup"><span data-stu-id="88faf-189">In the *UnitTest1.vb* code window, replace the code with the following code:</span></span>

    [!CODE-vb[Test#1](../../../samples/snippets/core/tutorials/vb-library-with-visual-studio/testlib.vb)]

   <span data-ttu-id="88faf-190">Beachten Sie, dass Ihr Großbuchstabentest in der `TestStartsWithUpper`-Methode den griechischen Großbuchstaben Alpha (U+0391) und den kyrillischen Großbuchstaben EM (U+ 041C) umfasst, und der Kleinbuchstabentest in der `TestDoesNotStartWithUpper`-Methode den griechischen Kleinbuchstaben Alpha (U+03B1) und den kyrillischen Kleinbuchstaben Ghe (U+0433).</span><span class="sxs-lookup"><span data-stu-id="88faf-190">Note that your test of uppercase characters in the `TestStartsWithUpper` method includes the Greek capital letter alpha (U+0391) and the Cyrillic capital letter EM (U+041C), and the test of lowercase characters in the `TestDoesNotStartWithUpper` method includes the Greek small letter alpha (U+03B1) and the Cyrillic small letter Ghe (U+0433).</span></span>

1. <span data-ttu-id="88faf-191">Wählen Sie in der Menüleiste **Datei** > **UnitTest1.vb speichern unter** aus.</span><span class="sxs-lookup"><span data-stu-id="88faf-191">On the menu bar, select **File** > **Save UnitTest1.vb As**.</span></span> <span data-ttu-id="88faf-192">Wählen Sie im Dialogfeld **Datei speichern unter** den Pfeil neben der Schaltfläche **Speichern**, und wählen Sie dann **Mit Codierung speichern...** aus.</span><span class="sxs-lookup"><span data-stu-id="88faf-192">In the **Save File As** dialog, select the arrow beside the **Save** button, and select **Save with Encoding**.</span></span>

   ![Dialogfeld „Datei speichern unter“](./media/testing-library-with-visual-studio/savefileas.png)
---

1. <span data-ttu-id="88faf-194">Wählen Sie im Dialogfeld **Speichern unter bestätigen** die Schaltfläche **Ja**, um die Datei zu speichern.</span><span class="sxs-lookup"><span data-stu-id="88faf-194">In the **Confirm Save As** dialog, select the **Yes** button to save the file.</span></span>

1. <span data-ttu-id="88faf-195">Wählen Sie im Dialogfeld **Erweiterte Speicheroptionen** **Unicode (UTF-8 mit Signatur) – Codepage 65001** aus der Dropdownliste **Codierung** aus, und klicken Sie auf **OK**.</span><span class="sxs-lookup"><span data-stu-id="88faf-195">In the **Advanced Save Options** dialog, select **Unicode (UTF-8 with signature) - Codepage 65001** from the **Encoding** drop-down list and select **OK**.</span></span>

   ![Dialogfeld „Erweiterte Speicheroptionen“](./media/testing-library-with-visual-studio/advancedsaveoptions.png)

   <span data-ttu-id="88faf-197">Wenn Sie den Quellcode nicht in einer UTF8-codierten Datei speichern, kann Visual Studio ihn als ASCII-Datei speichern.</span><span class="sxs-lookup"><span data-stu-id="88faf-197">If you fail to save your source code as a UTF8-encoded file, Visual Studio may save it as an ASCII file.</span></span> <span data-ttu-id="88faf-198">Wenn dies geschieht, decodiert die Laufzeit die UTF8-Zeichen außerhalb des ASCII-Bereichs nicht ordnungsgemäß, und die Testergebnisse sind nicht präzise.</span><span class="sxs-lookup"><span data-stu-id="88faf-198">When that happens, the runtime doesn't accurately decode the UTF8 characters outside of the ASCII range, and the test results won't be accurate.</span></span>

1. <span data-ttu-id="88faf-199">Wählen Sie auf der Menüleiste **Test** > **Ausführen** > **Alle Tests** aus.</span><span class="sxs-lookup"><span data-stu-id="88faf-199">On the menu bar, select **Test** > **Run** > **All Tests**.</span></span> <span data-ttu-id="88faf-200">Das Fenster **Test-Explorer** wird geöffnet und zeigt, dass der Test erfolgreich ausgeführt wurde.</span><span class="sxs-lookup"><span data-stu-id="88faf-200">The **Test Explorer** window opens and shows that the tests ran successfully.</span></span> <span data-ttu-id="88faf-201">Die drei Tests sind im Abschnitt **Bestandene Tests** aufgelistet, und im Abschnitt **Zusammenfassung** wird das Ergebnis des Testlaufs berichtet.</span><span class="sxs-lookup"><span data-stu-id="88faf-201">The three tests are listed in the **Passed Tests** section, and the **Summary** section reports the result of the test run.</span></span>

   ![Fenster „Test-Explorer“](./media/testing-library-with-visual-studio/firsttest.png)

## <a name="handling-test-failures"></a><span data-ttu-id="88faf-203">Behandeln von Testfehlern</span><span class="sxs-lookup"><span data-stu-id="88faf-203">Handling test failures</span></span>

<span data-ttu-id="88faf-204">In Ihrem Testlauf sind keine Fehler aufgetreten, darum verändern Sie ihn leicht , sodass eine der Testmethoden nicht fortgesetzt wird:</span><span class="sxs-lookup"><span data-stu-id="88faf-204">Your test run had no failures, but change it slightly so that one of the test methods fails:</span></span>

1. <span data-ttu-id="88faf-205">Verändern Sie das `words`-Array in der `TestDoesNotStartWithUpper`-Methode, um die Zeichenfolge "Error" einzufügen.</span><span class="sxs-lookup"><span data-stu-id="88faf-205">Modify the `words` array in the `TestDoesNotStartWithUpper` method to include the string "Error".</span></span> <span data-ttu-id="88faf-206">Sie müssen die Datei nicht speichern, das Visual Studio offene Dateien automatisch speichert, wenn eine Projektmappe zum Ausführen von Tests erstellt wurde.</span><span class="sxs-lookup"><span data-stu-id="88faf-206">You don't need to save the file because Visual Studio automatically saves open files when a solution is built to run tests.</span></span>

   ```csharp
   string[] words = { "alphabet", "Error", "zebra", "abc", "αυτοκινητοβιομηχανία", "государство",
                      "1234", ".", ";", " " };
   ```
   ```vb
   Dim words() As String = { "alphabet", "Error", "zebra", "abc", "αυτοκινητοβιομηχανία", "государство",
                      "1234", ".", ";", " " }

   ```
1. <span data-ttu-id="88faf-207">Führen Sie den Test aus, indem Sie **Test** > **Ausführen** > **Alle Tests** aus der Menüleiste auswählen.</span><span class="sxs-lookup"><span data-stu-id="88faf-207">Run the test by selecting **Test** > **Run** > **All Tests** from the menu bar.</span></span> <span data-ttu-id="88faf-208">Das Fenster **Test-Explorer** zeigt, dass zwei Tests erfolgreich ausgeführt wurden und einer nicht erfolgreich war.</span><span class="sxs-lookup"><span data-stu-id="88faf-208">The **Test Explorer** window indicates that two tests succeeded and one failed.</span></span>

   ![Fenster „Test-Explorer“](./media/testing-library-with-visual-studio/failedtest.png)

1. <span data-ttu-id="88faf-210">Wählen Sie den fehlerhaften Test, `TestDoesNotStartWith`, im Abschnitt **Fehlgeschlagene Tests** aus.</span><span class="sxs-lookup"><span data-stu-id="88faf-210">In the **Failed Tests** section, select the failed test, `TestDoesNotStartWith`.</span></span> <span data-ttu-id="88faf-211">Im Fenster **Test-Explorer** wird die Assert-Meldung angezeigt: „Fehler bei Assert.IsFalse.</span><span class="sxs-lookup"><span data-stu-id="88faf-211">The **Test Explorer** window displays the message produced by the assert: "Assert.IsFalse failed.</span></span> <span data-ttu-id="88faf-212">Für 'Error' erwartet False; tatsächlich: True“.</span><span class="sxs-lookup"><span data-stu-id="88faf-212">Expected for 'Error': false; actual: True".</span></span> <span data-ttu-id="88faf-213">Wegen des Fehlers wurden alle auf „Error“ folgenden Zeichenfolgen im Array nicht getestet.</span><span class="sxs-lookup"><span data-stu-id="88faf-213">Because of the failure, all strings in the array after "Error" were not tested.</span></span>

   ![Fenster „Test-Explorer“, das den Assertionsfehler „Ist FALSE“ zeigt](./media/testing-library-with-visual-studio/failedtestdetail.png)

1. <span data-ttu-id="88faf-215">Entfernen Sie den Code, der hinzugefügt wurde (`"Error", `), und führen den Test erneut aus.</span><span class="sxs-lookup"><span data-stu-id="88faf-215">Remove the code that you added (`"Error", `) and rerun the test.</span></span> <span data-ttu-id="88faf-216">Die Tests werden erfolgreich ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="88faf-216">The tests will pass.</span></span>

## <a name="testing-the-release-version-of-the-library"></a><span data-ttu-id="88faf-217">Testen der endgültigen Produktversion der Bibliothek</span><span class="sxs-lookup"><span data-stu-id="88faf-217">Testing the Release version of the library</span></span>

<span data-ttu-id="88faf-218">Sie haben Ihre Tests für die Debugversion der Bibliothek ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="88faf-218">You've been running your tests against the Debug version of the library.</span></span> <span data-ttu-id="88faf-219">Da nun alle Ihre Tests erfolgreich waren, und Sie Ihre Bibliothek ausreichend getestet haben, sollten Sie die Tests ein weiteres Mal für die endgültige Produktversion der Bibliothek ausführen.</span><span class="sxs-lookup"><span data-stu-id="88faf-219">Now that your tests have all passed and you've adequately tested your library, you should run the tests an additional time against the Release build of the library.</span></span> <span data-ttu-id="88faf-220">Eine Reihe von Faktoren einschließlich der Compileroptimierungen kann manchmal zu einem unterschiedlichen Verhalten von Debug- und endgültiger Produktversion führen.</span><span class="sxs-lookup"><span data-stu-id="88faf-220">A number of factors, including compiler optimizations, can sometimes produce different behavior between Debug and Release builds.</span></span>

<span data-ttu-id="88faf-221">So testen Sie die endgültige Produktversion:</span><span class="sxs-lookup"><span data-stu-id="88faf-221">To test the Release build:</span></span>

1. <span data-ttu-id="88faf-222">Ändern Sie in der Symbolleiste von Visual Studio die Buildkonfiguration von **Debuggen** zu **Freigabe**.</span><span class="sxs-lookup"><span data-stu-id="88faf-222">In the Visual Studio toolbar, change the build configuration from **Debug** to **Release**.</span></span>

   ![Visual Studio-Symbolleiste](./media/testing-library-with-visual-studio/toolbar.png)

1. <span data-ttu-id="88faf-224">Klicken Sie im **Projektmappen-Explorer** mit der rechten Maustaste auf das **StringLibrary**-Projekt, und wählen Sie aus dem Kontextmenü **Erstellen** aus, um die Bibliothek erneut zu kompilieren.</span><span class="sxs-lookup"><span data-stu-id="88faf-224">In **Solution Explorer**, right-click the **StringLibrary** project and select **Build** from the context menu to recompile the library.</span></span>

   ![Kontextmenü „StringLibrary“](./media/testing-library-with-visual-studio/buildlibrary.png)

1. <span data-ttu-id="88faf-226">Führen Sie den Komponententest aus, indem Sie **Test** > **Ausführen** > **Alle Tests** aus der Menüleiste auswählen.</span><span class="sxs-lookup"><span data-stu-id="88faf-226">Run the unit tests by choosing **Test** > **Run** > **All Tests** from the menu bar.</span></span> <span data-ttu-id="88faf-227">Die Tests sind erfolgreich.</span><span class="sxs-lookup"><span data-stu-id="88faf-227">The tests pass.</span></span>

<span data-ttu-id="88faf-228">Das Testen Ihrer Bibliothek ist jetzt abgeschlossen, und im nächsten Schritt machen Sie sie für die Aufrufer verfügbar.</span><span class="sxs-lookup"><span data-stu-id="88faf-228">Now that you've finished testing your library, the next step is to make it available to callers.</span></span> <span data-ttu-id="88faf-229">Sie können sie mit einer oder mehreren Anwendungen bündeln oder sie als NuGet-Paket verteilen.</span><span class="sxs-lookup"><span data-stu-id="88faf-229">You can bundle it with one or more applications, or you can distribute it as a NuGet package.</span></span> <span data-ttu-id="88faf-230">Informationen hierzu finden Sie unter [Consuming a .NET Standard Class Library (Nutzen einer .NET-Standardklassenbibliothek)](./consuming-library-with-visual-studio.md).</span><span class="sxs-lookup"><span data-stu-id="88faf-230">For more information, see [Consuming a .NET Standard Class Library](./consuming-library-with-visual-studio.md).</span></span>
